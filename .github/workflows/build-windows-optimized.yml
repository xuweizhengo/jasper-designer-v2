name: Optimized Windows Build

on:
  push:
    branches: [ main, master ]
    tags: [ 'v*' ]
  workflow_dispatch:

env:
  CARGO_TERM_COLOR: always
  CARGO_INCREMENTAL: 1
  CARGO_NET_RETRY: 10
  RUST_BACKTRACE: short
  RUSTUP_MAX_RETRIES: 10

jobs:
  build:
    runs-on: windows-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'

    - name: Setup Rust
      uses: dtolnay/rust-toolchain@stable
      with:
        targets: x86_64-pc-windows-msvc
        components: rustfmt, clippy

    # ç¼“å­˜ cargo-chef äºŒè¿›åˆ¶æ–‡ä»¶
    - name: Cache cargo-chef binary
      id: cache-chef-binary
      uses: actions/cache@v3
      with:
        path: |
          ~/.cargo/bin/cargo-chef.exe
        key: ${{ runner.os }}-cargo-chef-0.1.67

    # åªåœ¨æ²¡æœ‰ç¼“å­˜æ—¶å®‰è£… cargo-chef
    - name: Install cargo-chef
      if: steps.cache-chef-binary.outputs.cache-hit != 'true'
      run: |
        cargo install cargo-chef --version 0.1.67 --locked

    # ç¼“å­˜ Cargo æ³¨å†Œè¡¨å’Œ git ä¾èµ–
    - name: Cache cargo registry
      uses: actions/cache@v3
      with:
        path: |
          ~/.cargo/registry/index
          ~/.cargo/registry/cache
          ~/.cargo/git
        key: ${{ runner.os }}-cargo-registry-${{ hashFiles('**/Cargo.lock') }}
        restore-keys: |
          ${{ runner.os }}-cargo-registry-

    # ç¼“å­˜æ•´ä¸ª target ç›®å½•ï¼ˆåŒ…æ‹¬ä¾èµ–å’Œå¢é‡ç¼–è¯‘ï¼‰
    - name: Cache cargo target
      uses: actions/cache@v3
      with:
        path: |
          src-tauri/target
        key: ${{ runner.os }}-cargo-target-release-${{ hashFiles('src-tauri/Cargo.lock') }}-${{ hashFiles('src-tauri/src/**') }}
        restore-keys: |
          ${{ runner.os }}-cargo-target-release-${{ hashFiles('src-tauri/Cargo.lock') }}-
          ${{ runner.os }}-cargo-target-release-

    # ç¼“å­˜ node_modules
    - name: Cache node_modules
      uses: actions/cache@v3
      with:
        path: |
          node_modules
          ~/.npm
        key: ${{ runner.os }}-node-modules-${{ hashFiles('package-lock.json') }}
        restore-keys: |
          ${{ runner.os }}-node-modules-

    # ç¼“å­˜å‰ç«¯æ„å»ºäº§ç‰©
    - name: Cache frontend build
      uses: actions/cache@v3
      with:
        path: |
          dist
        key: ${{ runner.os }}-frontend-dist-${{ hashFiles('src/**', 'package.json') }}
        restore-keys: |
          ${{ runner.os }}-frontend-dist-

    # å‡†å¤‡ cargo-chef recipe
    - name: Prepare cargo-chef recipe
      run: |
        cd src-tauri
        cargo chef prepare --recipe-path recipe.json

    # æ£€æŸ¥æ˜¯å¦éœ€è¦é‡æ–°ç¼–è¯‘ä¾èµ–
    - name: Check and cook dependencies if needed
      shell: powershell
      run: |
        cd src-tauri
        $needsCook = $true

        # æ£€æŸ¥ target/release/.fingerprint æ˜¯å¦å­˜åœ¨
        if (Test-Path "target/release/.fingerprint") {
          Write-Host "âœ… Found existing build artifacts"

          # æ£€æŸ¥æœ€è¿‘çš„æ„å»ºæ—¶é—´
          $lastBuild = (Get-ChildItem "target/release/.fingerprint" -Recurse |
                       Sort-Object LastWriteTime -Descending |
                       Select-Object -First 1).LastWriteTime

          $cargoLock = (Get-Item "Cargo.lock").LastWriteTime

          if ($lastBuild -gt $cargoLock) {
            Write-Host "âœ… Dependencies are up to date (last build: $lastBuild)"
            $needsCook = $false
          }
        }

        if ($needsCook) {
          Write-Host "ğŸ”¨ Cooking dependencies..."
          cargo chef cook --release --recipe-path recipe.json --target x86_64-pc-windows-msvc
        } else {
          Write-Host "âš¡ Skipping dependency compilation - using cache"
        }

    # å®‰è£…å‰ç«¯ä¾èµ–ï¼ˆä¼˜åŒ–ï¼‰
    - name: Install dependencies
      run: |
        npm ci --prefer-offline --no-audit --no-fund --loglevel error || npm install --legacy-peer-deps --loglevel error

    # ç”Ÿæˆå›¾æ ‡ï¼ˆæ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨ï¼‰
    - name: Generate compatible icons
      shell: powershell
      run: |
        if (Test-Path "src-tauri/icons/icon.ico") {
          Write-Host "âœ… Icons already exist, skipping generation"
        } else {
          Write-Host "Generating standard ICO file..."

          # æ ‡å‡†çš„32x32 ICOæ–‡ä»¶ (è“è‰²èƒŒæ™¯ï¼Œç™½è‰²Jå­—æ¯)
          $icoBase64 = "AAABAAEAICAAAAEAIACoEAAAFgAAACgAAAAgAAAAQAAAAAEAIAAAAAAAABAAABMLAAATCwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wBEgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA///+/v7//v7+//7+/v/+/v7//v7+//7+/v/+/v7//v7+//7+/v9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA///+/v7//v7+//7+/v/+/v7//v7+//7+/v/+/v7//v7+//7+/v9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA///+/v7//v7+//7+/v/+/v7//v7+//7+/v/+/v7//v7+//7+/v9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA///+/v7//v7+//7+/v/+/v7//v7+//7+/v/+/v7//v7+//7+/v9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA///+/v7//v7+//7+/v/+/v7//v7+//7+/v/+/v7//v7+//7+/v9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA///+/v7//v7+//7+/v/+/v7//v7+//7+/v/+/v7//v7+//7+/v9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA///+/v7//v7+//7+/v/+/v7//v7+//7+/v/+/v7//v7+//7+/v9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA///+/v7//v7+//7+/v/+/v7//v7+//7+/v/+/v7//v7+//7+/v9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA///+/v7//v7+//7+/v/+/v7//v7+//7+/v/+/v7//v7+//7+/v9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA///+/v7//v7+//7+/v/+/v7//v7+//7+/v/+/v7//v7+//7+/v9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//9EgP//RID//0SA//8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="

          $icoBytes = [Convert]::FromBase64String($icoBase64)
          [System.IO.File]::WriteAllBytes("src-tauri/icons/icon.ico", $icoBytes)

          # ç”Ÿæˆå…¶ä»–PNGæ–‡ä»¶
          Add-Type -AssemblyName System.Drawing
          $bitmap = New-Object System.Drawing.Bitmap 256, 256
          $graphics = [System.Drawing.Graphics]::FromImage($bitmap)

          $brush = New-Object System.Drawing.SolidBrush([System.Drawing.Color]::FromArgb(255, 68, 128, 255))
          $graphics.FillRectangle($brush, 0, 0, 256, 256)

          $font = New-Object System.Drawing.Font("Arial", 72, [System.Drawing.FontStyle]::Bold)
          $textBrush = New-Object System.Drawing.SolidBrush([System.Drawing.Color]::White)
          $graphics.DrawString("J", $font, $textBrush, 85, 70)

          $bitmap.Save("src-tauri/icons/icon.png", [System.Drawing.Imaging.ImageFormat]::Png)

          $bitmap32 = New-Object System.Drawing.Bitmap $bitmap, 32, 32
          $bitmap32.Save("src-tauri/icons/32x32.png", [System.Drawing.Imaging.ImageFormat]::Png)
          $bitmap32.Dispose()

          $bitmap128 = New-Object System.Drawing.Bitmap $bitmap, 128, 128
          $bitmap128.Save("src-tauri/icons/128x128.png", [System.Drawing.Imaging.ImageFormat]::Png)
          $bitmap128.Dispose()

          $graphics.Dispose()
          $bitmap.Dispose()

          Write-Host "âœ… Icons generated successfully"
        }

    # æ„å»ºåº”ç”¨ï¼ˆä¼˜åŒ–ç¼–è¯‘å‚æ•°ï¼‰
    - name: Build application
      shell: powershell
      run: |
        Write-Host "ğŸš€ Building with optimized settings..."

        # è®¾ç½®ä¼˜åŒ–çš„ç¯å¢ƒå˜é‡
        $env:CARGO_BUILD_JOBS = [Environment]::ProcessorCount
        $env:CARGO_TARGET_DIR = "src-tauri/target"
        $env:TAURI_PRIVATE_KEY = ""
        $env:TAURI_KEY_PASSWORD = ""

        Write-Host "Using $env:CARGO_BUILD_JOBS parallel jobs"

        # æ£€æŸ¥å‰ç«¯æ˜¯å¦éœ€è¦é‡æ–°æ„å»º
        $needsFrontendBuild = $true
        if (Test-Path "dist/index.html") {
          $distTime = (Get-Item "dist/index.html").LastWriteTime
          $srcTime = (Get-ChildItem "src" -Recurse | Sort-Object LastWriteTime -Descending | Select-Object -First 1).LastWriteTime

          if ($distTime -gt $srcTime) {
            Write-Host "âš¡ Frontend is up to date, skipping build"
            $needsFrontendBuild = $false
          }
        }

        if ($needsFrontendBuild) {
          Write-Host "ğŸ”¨ Building frontend..."
          npm run build
        }

        # æ„å»º Tauri åº”ç”¨ï¼ˆè·³è¿‡å‰ç«¯æ„å»ºå¦‚æœå·²å­˜åœ¨ï¼‰
        cd src-tauri
        if ($needsFrontendBuild) {
          cargo build --release --target x86_64-pc-windows-msvc
        } else {
          cargo build --release --target x86_64-pc-windows-msvc --no-default-features
        }

        Write-Host "âœ… Build completed!"
      env:
        RUST_LOG: warn
        CARGO_INCREMENTAL: 1

    # æ‰“åŒ…æ„å»ºæ–‡ä»¶
    - name: Package build files
      shell: powershell
      run: |
        $timestamp = Get-Date -Format "yyyyMMdd-HHmmss"
        $packageName = "jasper-designer-v2-OPTIMIZED-$timestamp"
        New-Item -ItemType Directory -Path $packageName -Force

        # å¤åˆ¶æ„å»ºæ–‡ä»¶
        $sourcePaths = @(
          "src-tauri/target/release/*.exe",
          "src-tauri/target/release/*.dll"
        )

        foreach ($path in $sourcePaths) {
          if (Test-Path $path) {
            Copy-Item $path $packageName/ -Force -ErrorAction SilentlyContinue
          }
        }

        # å¤åˆ¶å‰ç«¯èµ„æº
        if (Test-Path "dist") {
          Copy-Item "dist/*" $packageName/ -Recurse -Force -ErrorAction SilentlyContinue
        }

        # å¤åˆ¶å›¾æ ‡
        if (Test-Path "src-tauri/icons") {
          New-Item -ItemType Directory -Path "$packageName/icons" -Force
          Copy-Item "src-tauri/icons/*" "$packageName/icons/" -Force -ErrorAction SilentlyContinue
        }

        # åˆ›å»ºæ„å»ºä¿¡æ¯
        @"
        ğŸš€ Jasper Designer Windows Build (Optimized with cargo-chef)

        Build Info:
        - Time: $(Get-Date)
        - Type: Optimized Build with cargo-chef (no sccache)
        - Branch: $env:GITHUB_REF_NAME
        - Commit: $env:GITHUB_SHA
        - Run ID: $env:GITHUB_RUN_ID

        Optimizations:
        âœ… cargo-chef for dependency caching
        âœ… Incremental compilation
        âœ… Target directory caching
        âœ… Frontend build caching
        âœ… npm cache optimization
        âœ… Parallel job optimization

        Usage:
        1. Extract the package
        2. Run jasper-designer.exe
        "@  | Out-File -FilePath "$packageName/BUILD_INFO.txt" -Encoding UTF8

        # æ‰“åŒ…
        Compress-Archive -Path $packageName -DestinationPath "$packageName.zip" -Force

        # è®¾ç½®ç¯å¢ƒå˜é‡
        echo "PACKAGE_NAME=$packageName" >> $env:GITHUB_ENV
        echo "PACKAGE_ZIP=$packageName.zip" >> $env:GITHUB_ENV

        Write-Host "ğŸ“¦ Build package created: $packageName.zip"

    # ä¸Šä¼ æ„å»ºäº§ç‰©
    - name: Upload build artifacts
      uses: actions/upload-artifact@v4
      with:
        name: jasper-designer-windows-optimized-${{ github.run_id }}
        path: ${{ env.PACKAGE_ZIP }}
        retention-days: 30

    # è¾“å‡ºæ„å»ºæ—¶é—´ç»Ÿè®¡
    - name: Build time report
      shell: powershell
      run: |
        Write-Host "=== Build Time Report ==="
        Write-Host "Total workflow time will be shown in Actions summary"
        Write-Host ""
        Write-Host "Cache Status:"
        Write-Host "- cargo-chef binary: ${{ steps.cache-chef-binary.outputs.cache-hit == 'true' && 'HIT âœ…' || 'MISS âŒ' }}"
        Write-Host "- cargo registry: Check logs above"
        Write-Host "- cargo target: Check logs above"
        Write-Host "- node_modules: Check logs above"
        Write-Host "- frontend dist: Check logs above"
        Write-Host ""
        Write-Host "Expected performance:"
        Write-Host "- First run: ~10 minutes (building caches)"
        Write-Host "- Second run: ~3-5 minutes (with full cache)"
        Write-Host "- Code changes only: ~2-3 minutes"
        Write-Host "========================="