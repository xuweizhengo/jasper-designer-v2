var Tn=Object.defineProperty;var En=(e,t,n)=>t in e?Tn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Be=(e,t,n)=>En(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))l(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&l(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const Ln=!1,Dn=(e,t)=>e===t,Ke=Symbol("solid-proxy"),At=Symbol("solid-track"),vt={equals:Dn};let Xt=rn;const Je=1,ft=2,Zt={owned:null,cleanups:null,context:null,owner:null};var Le=null;let Ct=null,Pn=null,De=null,Me=null,He=null,St=0;function ht(e,t){const n=De,l=Le,i=e.length===0,s=t===void 0?l:t,a=i?Zt:{owned:null,cleanups:null,context:s?s.context:null,owner:s},o=i?e:()=>e(()=>Ie(()=>at(a)));Le=a,De=null;try{return tt(o,!0)}finally{De=n,Le=l}}function Z(e,t){t=t?Object.assign({},vt,t):vt;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},l=i=>(typeof i=="function"&&(i=i(n.value)),sn(n,i));return[ln.bind(n),l]}function A(e,t,n){const l=It(e,t,!1,Je);dt(l)}function Ot(e,t,n){Xt=Mn;const l=It(e,t,!1,Je);l.user=!0,He?He.push(l):dt(l)}function Ce(e,t,n){n=n?Object.assign({},vt,n):vt;const l=It(e,t,!0,0);return l.observers=null,l.observerSlots=null,l.comparator=n.equals||void 0,dt(l),ln.bind(l)}function An(e){return tt(e,!1)}function Ie(e){if(De===null)return e();const t=De;De=null;try{return e()}finally{De=t}}function Ue(e){Ot(()=>Ie(e))}function wt(e){return Le===null||(Le.cleanups===null?Le.cleanups=[e]:Le.cleanups.push(e)),e}function zt(){return De}const[wc,Cc]=Z(!1);function en(e,t){const n=Symbol("context");return{id:n,Provider:On(n),defaultValue:e}}function tn(e){let t;return Le&&Le.context&&(t=Le.context[e.id])!==void 0?t:e.defaultValue}function nn(e){const t=Ce(e),n=Ce(()=>Rt(t()));return n.toArray=()=>{const l=n();return Array.isArray(l)?l:l!=null?[l]:[]},n}function ln(){if(this.sources&&this.state)if(this.state===Je)dt(this);else{const e=Me;Me=null,tt(()=>bt(this),!1),Me=e}if(De){const e=this.observers?this.observers.length:0;De.sources?(De.sources.push(this),De.sourceSlots.push(e)):(De.sources=[this],De.sourceSlots=[e]),this.observers?(this.observers.push(De),this.observerSlots.push(De.sources.length-1)):(this.observers=[De],this.observerSlots=[De.sources.length-1])}return this.value}function sn(e,t,n){let l=e.value;return(!e.comparator||!e.comparator(l,t))&&(e.value=t,e.observers&&e.observers.length&&tt(()=>{for(let i=0;i<e.observers.length;i+=1){const s=e.observers[i],a=Ct&&Ct.running;a&&Ct.disposed.has(s),(a?!s.tState:!s.state)&&(s.pure?Me.push(s):He.push(s),s.observers&&an(s)),a||(s.state=Je)}if(Me.length>1e6)throw Me=[],new Error},!1)),t}function dt(e){if(!e.fn)return;at(e);const t=St;zn(e,e.value,t)}function zn(e,t,n){let l;const i=Le,s=De;De=Le=e;try{l=e.fn(t)}catch(a){return e.pure&&(e.state=Je,e.owned&&e.owned.forEach(at),e.owned=null),e.updatedAt=n+1,on(a)}finally{De=s,Le=i}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?sn(e,l):e.value=l,e.updatedAt=n)}function It(e,t,n,l=Je,i){const s={fn:e,state:l,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:Le,context:Le?Le.context:null,pure:n};return Le===null||Le!==Zt&&(Le.owned?Le.owned.push(s):Le.owned=[s]),s}function mt(e){if(e.state===0)return;if(e.state===ft)return bt(e);if(e.suspense&&Ie(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<St);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===Je)dt(e);else if(e.state===ft){const l=Me;Me=null,tt(()=>bt(e,t[0]),!1),Me=l}}function tt(e,t){if(Me)return e();let n=!1;t||(Me=[]),He?n=!0:He=[],St++;try{const l=e();return Rn(n),l}catch(l){n||(He=null),Me=null,on(l)}}function Rn(e){if(Me&&(rn(Me),Me=null),e)return;const t=He;He=null,t.length&&tt(()=>Xt(t),!1)}function rn(e){for(let t=0;t<e.length;t++)mt(e[t])}function Mn(e){let t,n=0;for(t=0;t<e.length;t++){const l=e[t];l.user?e[n++]=l:mt(l)}for(t=0;t<n;t++)mt(e[t])}function bt(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const l=e.sources[n];if(l.sources){const i=l.state;i===Je?l!==t&&(!l.updatedAt||l.updatedAt<St)&&mt(l):i===ft&&bt(l,t)}}}function an(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=ft,n.pure?Me.push(n):He.push(n),n.observers&&an(n))}}function at(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),l=e.sourceSlots.pop(),i=n.observers;if(i&&i.length){const s=i.pop(),a=n.observerSlots.pop();l<i.length&&(s.sourceSlots[a]=l,i[l]=s,n.observerSlots[l]=a)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)at(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)at(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function Nn(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function on(e,t=Le){throw Nn(e)}function Rt(e){if(typeof e=="function"&&!e.length)return Rt(e());if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++){const l=Rt(e[n]);Array.isArray(l)?t.push.apply(t,l):t.push(l)}return t}return e}function On(e,t){return function(l){let i;return A(()=>i=Ie(()=>(Le.context={...Le.context,[e]:l.value},nn(()=>l.children))),void 0),i}}const In=Symbol("fallback");function Bt(e){for(let t=0;t<e.length;t++)e[t]()}function Un(e,t,n={}){let l=[],i=[],s=[],a=0,o=t.length>1?[]:null;return wt(()=>Bt(s)),()=>{let g=e()||[],c=g.length,b,u;return g[At],Ie(()=>{let v,d,p,_,y,$,C,k,E;if(c===0)a!==0&&(Bt(s),s=[],l=[],i=[],a=0,o&&(o=[])),n.fallback&&(l=[In],i[0]=ht(D=>(s[0]=D,n.fallback())),a=1);else if(a===0){for(i=new Array(c),u=0;u<c;u++)l[u]=g[u],i[u]=ht(m);a=c}else{for(p=new Array(c),_=new Array(c),o&&(y=new Array(c)),$=0,C=Math.min(a,c);$<C&&l[$]===g[$];$++);for(C=a-1,k=c-1;C>=$&&k>=$&&l[C]===g[k];C--,k--)p[k]=i[C],_[k]=s[C],o&&(y[k]=o[C]);for(v=new Map,d=new Array(k+1),u=k;u>=$;u--)E=g[u],b=v.get(E),d[u]=b===void 0?-1:b,v.set(E,u);for(b=$;b<=C;b++)E=l[b],u=v.get(E),u!==void 0&&u!==-1?(p[u]=i[b],_[u]=s[b],o&&(y[u]=o[b]),u=d[u],v.set(E,u)):s[b]();for(u=$;u<c;u++)u in p?(i[u]=p[u],s[u]=_[u],o&&(o[u]=y[u],o[u](u))):i[u]=ht(m);i=i.slice(0,a=c),l=g.slice(0)}return i});function m(v){if(s[u]=v,o){const[d,p]=Z(u);return o[u]=p,t(g[u],d)}return t(g[u])}}}function h(e,t){return Ie(()=>e(t||{}))}const cn=e=>`Stale read from <${e}>.`;function oe(e){const t="fallback"in e&&{fallback:()=>e.fallback};return Ce(Un(()=>e.each,e.children,t||void 0))}function M(e){const t=e.keyed,n=Ce(()=>e.when,void 0,void 0),l=t?n:Ce(n,void 0,{equals:(i,s)=>!i==!s});return Ce(()=>{const i=l();if(i){const s=e.children;return typeof s=="function"&&s.length>0?Ie(()=>s(t?i:()=>{if(!Ie(l))throw cn("Show");return n()})):s}return e.fallback},void 0,void 0)}function Fn(e){const t=nn(()=>e.children),n=Ce(()=>{const l=t(),i=Array.isArray(l)?l:[l];let s=()=>{};for(let a=0;a<i.length;a++){const o=a,g=i[a],c=s,b=Ce(()=>c()?void 0:g.when,void 0,void 0),u=g.keyed?b:Ce(b,void 0,{equals:(m,v)=>!m==!v});s=()=>c()||(u()?[o,b,g]:void 0)}return s});return Ce(()=>{const l=n()();if(!l)return e.fallback;const[i,s,a]=l,o=a.children;return typeof o=="function"&&o.length>0?Ie(()=>o(a.keyed?s():()=>{var c;if(((c=Ie(n)())==null?void 0:c[0])!==i)throw cn("Match");return s()})):o},void 0,void 0)}function it(e){return e}const xe=e=>Ce(()=>e());function Bn(e,t,n){let l=n.length,i=t.length,s=l,a=0,o=0,g=t[i-1].nextSibling,c=null;for(;a<i||o<s;){if(t[a]===n[o]){a++,o++;continue}for(;t[i-1]===n[s-1];)i--,s--;if(i===a){const b=s<l?o?n[o-1].nextSibling:n[s-o]:g;for(;o<s;)e.insertBefore(n[o++],b)}else if(s===o)for(;a<i;)(!c||!c.has(t[a]))&&t[a].remove(),a++;else if(t[a]===n[s-1]&&n[o]===t[i-1]){const b=t[--i].nextSibling;e.insertBefore(n[o++],t[a++].nextSibling),e.insertBefore(n[--s],b),t[i]=n[s]}else{if(!c){c=new Map;let u=o;for(;u<s;)c.set(n[u],u++)}const b=c.get(t[a]);if(b!=null)if(o<b&&b<s){let u=a,m=1,v;for(;++u<i&&u<s&&!((v=c.get(t[u]))==null||v!==b+m);)m++;if(m>b-o){const d=t[a];for(;o<b;)e.insertBefore(n[o++],d)}else e.replaceChild(n[o++],t[a++])}else a++;else t[a++].remove()}}}const qt="_$DX_DELEGATE";function qn(e,t,n,l={}){let i;return ht(s=>{i=s,t===document?e():r(t,e(),t.firstChild?null:void 0,n)},l.owner),()=>{i(),t.textContent=""}}function f(e,t,n,l){let i;const s=()=>{const o=l?document.createElementNS("http://www.w3.org/1998/Math/MathML","template"):document.createElement("template");return o.innerHTML=e,n?o.content.firstChild.firstChild:l?o.firstChild:o.content.firstChild},a=t?()=>Ie(()=>document.importNode(i||(i=s()),!0)):()=>(i||(i=s())).cloneNode(!0);return a.cloneNode=a,a}function Pe(e,t=window.document){const n=t[qt]||(t[qt]=new Set);for(let l=0,i=e.length;l<i;l++){const s=e[l];n.has(s)||(n.add(s),t.addEventListener(s,jn))}}function q(e,t,n){n==null?e.removeAttribute(t):e.setAttribute(t,n)}function _e(e,t){t==null?e.removeAttribute("class"):e.className=t}function Te(e,t,n,l){Array.isArray(n)?(e[`$$${t}`]=n[0],e[`$$${t}Data`]=n[1]):e[`$$${t}`]=n}function dn(e,t,n){if(!t)return n?q(e,"style"):t;const l=e.style;if(typeof t=="string")return l.cssText=t;typeof n=="string"&&(l.cssText=n=void 0),n||(n={}),t||(t={});let i,s;for(s in n)t[s]==null&&l.removeProperty(s),delete n[s];for(s in t)i=t[s],i!==n[s]&&(l.setProperty(s,i),n[s]=i);return n}function Ut(e,t,n){return Ie(()=>e(t,n))}function r(e,t,n,l){if(n!==void 0&&!l&&(l=[]),typeof t!="function")return pt(e,t,l,n);A(i=>pt(e,t(),i,n),l)}function jn(e){let t=e.target;const n=`$$${e.type}`,l=e.target,i=e.currentTarget,s=g=>Object.defineProperty(e,"target",{configurable:!0,value:g}),a=()=>{const g=t[n];if(g&&!t.disabled){const c=t[`${n}Data`];if(c!==void 0?g.call(t,c,e):g.call(t,e),e.cancelBubble)return}return t.host&&typeof t.host!="string"&&!t.host._$host&&t.contains(e.target)&&s(t.host),!0},o=()=>{for(;a()&&(t=t._$host||t.parentNode||t.host););};if(Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return t||document}}),e.composedPath){const g=e.composedPath();s(g[0]);for(let c=0;c<g.length-2&&(t=g[c],!!a());c++){if(t._$host){t=t._$host,o();break}if(t.parentNode===i)break}}else o();s(l)}function pt(e,t,n,l,i){for(;typeof n=="function";)n=n();if(t===n)return n;const s=typeof t,a=l!==void 0;if(e=a&&n[0]&&n[0].parentNode||e,s==="string"||s==="number"){if(s==="number"&&(t=t.toString(),t===n))return n;if(a){let o=n[0];o&&o.nodeType===3?o.data!==t&&(o.data=t):o=document.createTextNode(t),n=Ye(e,n,l,o)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t}else if(t==null||s==="boolean")n=Ye(e,n,l);else{if(s==="function")return A(()=>{let o=t();for(;typeof o=="function";)o=o();n=pt(e,o,n,l)}),()=>n;if(Array.isArray(t)){const o=[],g=n&&Array.isArray(n);if(Mt(o,t,n,i))return A(()=>n=pt(e,o,n,l,!0)),()=>n;if(o.length===0){if(n=Ye(e,n,l),a)return n}else g?n.length===0?jt(e,o,l):Bn(e,n,o):(n&&Ye(e),jt(e,o));n=o}else if(t.nodeType){if(Array.isArray(n)){if(a)return n=Ye(e,n,l,t);Ye(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function Mt(e,t,n,l){let i=!1;for(let s=0,a=t.length;s<a;s++){let o=t[s],g=n&&n[e.length],c;if(!(o==null||o===!0||o===!1))if((c=typeof o)=="object"&&o.nodeType)e.push(o);else if(Array.isArray(o))i=Mt(e,o,g)||i;else if(c==="function")if(l){for(;typeof o=="function";)o=o();i=Mt(e,Array.isArray(o)?o:[o],Array.isArray(g)?g:[g])||i}else e.push(o),i=!0;else{const b=String(o);g&&g.nodeType===3&&g.data===b?e.push(g):e.push(document.createTextNode(b))}}return i}function jt(e,t,n=null){for(let l=0,i=t.length;l<i;l++)e.insertBefore(t[l],n)}function Ye(e,t,n,l){if(n===void 0)return e.textContent="";const i=l||document.createTextNode("");if(t.length){let s=!1;for(let a=t.length-1;a>=0;a--){const o=t[a];if(i!==o){const g=o.parentNode===e;!s&&!a?g?e.replaceChild(i,o):e.insertBefore(i,n):g&&o.remove()}else s=!0}}else e.insertBefore(i,n);return[i]}var Hn=f("<div class=preview-toggle-container><div class=current-mode-indicator><span class=mode-icon></span><span class=mode-text></span></div><div class=mode-toggle-group>"),Qn=f("<span class=loading-indicator>‚è≥"),Jn=f("<button><span class=button-icon></span><span class=button-text>"),Vn=f("<span class=coming-soon>Êï¨ËØ∑ÊúüÂæÖ"),Wn=f("<div class=error-indicator>‚ùå");const un=en(),Gn=e=>{const[t,n]=Z({mode:"design",loading:!1,error:void 0}),l=u=>{n(m=>({...m,mode:u,error:void 0})),console.log(`üéØ È¢ÑËßàÊ®°ÂºèÂàáÊç¢: ${u==="design"?"ËÆæËÆ°Ê®°Âºè":"È¢ÑËßàÊ®°Âºè"}`),window.dispatchEvent(new CustomEvent("preview-mode-changed",{detail:{mode:u,timestamp:Date.now()}}))},b={state:t,actions:{setMode:l,toggleMode:()=>{const u=t().mode;l(u==="design"?"data":u==="data"?"preview":"design")},setLoading:u=>{n(m=>({...m,loading:u}))},setError:u=>{n(m=>({...m,error:u,loading:!1}))},isDesignMode:()=>t().mode==="design",isDataMode:()=>t().mode==="data",isPreviewMode:()=>t().mode==="preview"}};return h(un.Provider,{value:b,get children(){return e.children}})},gn=()=>{const e=tn(un);if(!e)throw new Error("usePreviewÂøÖÈ°ªÂú®PreviewProviderÂÜÖ‰ΩøÁî®");return e},Kn=()=>{const{state:e,actions:t}=gn(),n=i=>({design:{icon:"üé®",text:"ËÆæËÆ°Ê®°Âºè",color:"blue"},data:{icon:"üîó",text:"Êï∞ÊçÆÊ®°Âºè",color:"green"},preview:{icon:"üîç",text:"È¢ÑËßàÊ®°Âºè",color:"purple"}})[i],l=()=>n(e().mode);return(()=>{var i=Hn(),s=i.firstChild,a=s.firstChild,o=a.nextSibling,g=s.nextSibling;return r(a,()=>l().icon),r(o,()=>l().text),r(s,(()=>{var c=xe(()=>!!e().loading);return()=>c()&&Qn()})(),null),r(g,()=>["design","data","preview"].map(c=>{const b=n(c),u=e().mode===c,m=c==="preview";return(()=>{var v=Jn(),d=v.firstChild,p=d.nextSibling;return v.$$click=()=>{if(m){alert(`üîç È¢ÑËßàÊ®°ÂºèÂç≥Â∞ÜÊé®Âá∫ÔºÅ

‚ú® Âç≥Â∞ÜÊîØÊåÅÁöÑÂäüËÉΩÔºö
‚Ä¢ Á∫ØÂáÄÁöÑÊúÄÁªàÊïàÊûúÈ¢ÑËßà
‚Ä¢ ÈöêËóèÊâÄÊúâËÆæËÆ°ËæÖÂä©ÂÖÉÁ¥†
‚Ä¢ Âè™ËØªÊ®°ÂºèÔºå‰∏ìÊ≥®Êü•ÁúãËæìÂá∫ÊïàÊûú`);return}t.setMode(c)},_e(v,`mode-btn ${u?"active":""} ${m?"preview-placeholder":""}`),r(d,()=>b.icon),r(p,()=>b.text),r(v,m&&Vn(),null),A(_=>{var y=e().loading,$=m?"È¢ÑËßàÊ®°Âºè - Âç≥Â∞ÜÊé®Âá∫":`ÂàáÊç¢Âà∞${b.text}`;return y!==_.e&&(v.disabled=_.e=y),$!==_.t&&q(v,"title",_.t=$),_},{e:void 0,t:void 0}),v})()})),r(i,(()=>{var c=xe(()=>!!e().error);return()=>c()&&(()=>{var b=Wn();return A(()=>q(b,"title",e().error)),b})()})(),null),i})()},kt={getModeDisplayText:e=>({design:"ËÆæËÆ°Ê®°Âºè",data:"Êï∞ÊçÆÊ®°Âºè",preview:"È¢ÑËßàÊ®°Âºè"})[e],getModeIcon:e=>({design:"üé®",data:"üîó",preview:"üîç"})[e],shouldShowExpression:e=>e==="design",shouldEvaluateExpression:e=>e==="data"||e==="preview",shouldShowDesignAids:e=>e==="design"||e==="data",shouldAllowInteraction:e=>e==="design"||e==="data",isReadOnlyMode:e=>e==="preview",getModeTransitionClass:e=>`mode-${e}-active`};Pe(["click"]);const Nt=Symbol("store-raw"),et=Symbol("store-node"),qe=Symbol("store-has"),hn=Symbol("store-self");function vn(e){let t=e[Ke];if(!t&&(Object.defineProperty(e,Ke,{value:t=new Proxy(e,Zn)}),!Array.isArray(e))){const n=Object.keys(e),l=Object.getOwnPropertyDescriptors(e);for(let i=0,s=n.length;i<s;i++){const a=n[i];l[a].get&&Object.defineProperty(e,a,{enumerable:l[a].enumerable,get:l[a].get.bind(t)})}}return t}function yt(e){let t;return e!=null&&typeof e=="object"&&(e[Ke]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function ot(e,t=new Set){let n,l,i,s;if(n=e!=null&&e[Nt])return n;if(!yt(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let a=0,o=e.length;a<o;a++)i=e[a],(l=ot(i,t))!==i&&(e[a]=l)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const a=Object.keys(e),o=Object.getOwnPropertyDescriptors(e);for(let g=0,c=a.length;g<c;g++)s=a[g],!o[s].get&&(i=e[s],(l=ot(i,t))!==i&&(e[s]=l))}return e}function $t(e,t){let n=e[t];return n||Object.defineProperty(e,t,{value:n=Object.create(null)}),n}function ct(e,t,n){if(e[t])return e[t];const[l,i]=Z(n,{equals:!1,internal:!0});return l.$=i,e[t]=l}function Yn(e,t){const n=Reflect.getOwnPropertyDescriptor(e,t);return!n||n.get||!n.configurable||t===Ke||t===et||(delete n.value,delete n.writable,n.get=()=>e[Ke][t]),n}function fn(e){zt()&&ct($t(e,et),hn)()}function Xn(e){return fn(e),Reflect.ownKeys(e)}const Zn={get(e,t,n){if(t===Nt)return e;if(t===Ke)return n;if(t===At)return fn(e),n;const l=$t(e,et),i=l[t];let s=i?i():e[t];if(t===et||t===qe||t==="__proto__")return s;if(!i){const a=Object.getOwnPropertyDescriptor(e,t);zt()&&(typeof s!="function"||e.hasOwnProperty(t))&&!(a&&a.get)&&(s=ct(l,t,s)())}return yt(s)?vn(s):s},has(e,t){return t===Nt||t===Ke||t===At||t===et||t===qe||t==="__proto__"?!0:(zt()&&ct($t(e,qe),t)(),t in e)},set(){return!0},deleteProperty(){return!0},ownKeys:Xn,getOwnPropertyDescriptor:Yn};function _t(e,t,n,l=!1){if(!l&&e[t]===n)return;const i=e[t],s=e.length;n===void 0?(delete e[t],e[qe]&&e[qe][t]&&i!==void 0&&e[qe][t].$()):(e[t]=n,e[qe]&&e[qe][t]&&i===void 0&&e[qe][t].$());let a=$t(e,et),o;if((o=ct(a,t,i))&&o.$(()=>n),Array.isArray(e)&&e.length!==s){for(let g=e.length;g<s;g++)(o=a[g])&&o.$();(o=ct(a,"length",s))&&o.$(e.length)}(o=a[hn])&&o.$()}function mn(e,t){const n=Object.keys(t);for(let l=0;l<n.length;l+=1){const i=n[l];_t(e,i,t[i])}}function el(e,t){if(typeof t=="function"&&(t=t(e)),t=ot(t),Array.isArray(t)){if(e===t)return;let n=0,l=t.length;for(;n<l;n++){const i=t[n];e[n]!==i&&_t(e,n,i)}_t(e,"length",l)}else mn(e,t)}function rt(e,t,n=[]){let l,i=e;if(t.length>1){l=t.shift();const a=typeof l,o=Array.isArray(e);if(Array.isArray(l)){for(let g=0;g<l.length;g++)rt(e,[l[g]].concat(t),n);return}else if(o&&a==="function"){for(let g=0;g<e.length;g++)l(e[g],g)&&rt(e,[g].concat(t),n);return}else if(o&&a==="object"){const{from:g=0,to:c=e.length-1,by:b=1}=l;for(let u=g;u<=c;u+=b)rt(e,[u].concat(t),n);return}else if(t.length>1){rt(e[l],t,[l].concat(n));return}i=e[l],n=[l].concat(n)}let s=t[0];typeof s=="function"&&(s=s(i,n),s===i)||l===void 0&&s==null||(s=ot(s),l===void 0||yt(i)&&yt(s)&&!Array.isArray(s)?mn(i,s):_t(e,l,s))}function tl(...[e,t]){const n=ot(e||{}),l=Array.isArray(n),i=vn(n);function s(...a){An(()=>{l&&a.length===1?el(n,a[0]):rt(n,a)})}return[i,s]}function nl(){return window.crypto.getRandomValues(new Uint32Array(1))[0]}function Ht(e,t=!1){const n=nl(),l=`_${n}`;return Object.defineProperty(window,l,{value:i=>(t&&Reflect.deleteProperty(window,l),e==null?void 0:e(i)),writable:!1,configurable:!0}),n}async function ge(e,t={}){return new Promise((n,l)=>{const i=Ht(a=>{n(a),Reflect.deleteProperty(window,`_${s}`)},!0),s=Ht(a=>{l(a),Reflect.deleteProperty(window,`_${i}`)},!0);window.__TAURI_IPC__({cmd:e,callback:i,error:s,...t})})}const bn=en(),ll=e=>{const[t,n]=tl({elements:[],selected_ids:[],canvas_config:{width:595,height:842,zoom:1,offset_x:0,offset_y:0,show_grid:!0,show_rulers:!0,grid_size:10,snap_to_grid:!0,background_color:"#ffffff"},can_undo:!1,can_redo:!1,dirty:!1}),[l,i]=Z(!1),[s,a]=Z(null),[o,g]=Z(!1),c=async()=>{try{i(!0),console.log("üîÑ Loading app state...");const w=await ge("get_app_state");console.log("üîÑ App state loaded, selected_ids:",w.selected_ids),n(w)}catch(w){console.error("Failed to load app state:",w)}finally{i(!1)}};Ue(()=>{c()});const b=async(w,z,N,U={})=>{try{i(!0);const H=await ge("create_element",{request:{element_type:w,position:z,size:N,content_data:U}});return await c(),H}catch(H){throw console.error("Failed to create element:",H),H}finally{i(!1)}},u=async(w,z)=>{try{i(!0),await ge("update_element",{request:{id:w,updates:z}}),await c()}catch(N){throw console.error("Failed to update element:",N),N}finally{i(!1)}},m=async w=>{try{i(!0),await ge("batch_update_positions",{request:{updates:w}}),n(z=>{const N=z.elements.map(U=>{const H=w.find(J=>J.element_id===U.id);return H?{...U,position:H.new_position}:U});return{...z,elements:N,dirty:!0}}),console.log("üöÄ Optimized batch position update completed without full reload")}catch(z){throw console.error("Failed to batch update positions:",z),await c(),z}finally{i(!1)}},v=async w=>{try{i(!0),await ge("delete_element",{elementId:w}),await c()}catch(z){throw console.error("Failed to delete element:",z),z}finally{i(!1)}},d=async w=>{try{console.log("Selecting element:",w),await ge("select_element",{elementId:w}),console.log("Select command completed, reloading state..."),await c(),console.log("State reloaded, selected_ids:",t.selected_ids)}catch(z){throw console.error("Failed to select element:",z),z}},p=async w=>{try{console.log("Selecting multiple elements:",w),w.length>0?(await ge("select_multiple",{elementIds:w}),console.log("‚úÖ Multi-select completed for:",w.length,"elements")):await ge("clear_selection"),await c()}catch(z){throw console.error("Failed to select multiple elements:",z),z}},_=async w=>{try{console.log("Adding to selection:",w),await ge("add_to_selection",{elementId:w}),await c()}catch(z){throw console.error("Failed to add to selection:",z),z}},y=async w=>{try{console.log("Removing from selection:",w),await ge("remove_from_selection",{elementId:w}),await c()}catch(z){throw console.error("Failed to remove from selection:",z),z}},$=async w=>{try{console.log("Toggling selection:",w),await ge("toggle_selection",{elementId:w}),await c()}catch(z){throw console.error("Failed to toggle selection:",z),z}},C=async()=>{try{await ge("clear_selection"),await c()}catch(w){throw console.error("Failed to clear selection:",w),w}},k=async()=>{try{await ge("copy_selected")}catch(w){throw console.error("Failed to copy selected elements:",w),w}},B={state:t,setState:n,createElement:b,updateElement:u,batchUpdatePositions:m,deleteElement:v,selectElement:d,selectMultiple:p,addToSelection:_,removeFromSelection:y,toggleSelection:$,clearSelection:C,copySelected:k,copySelectedElements:async()=>k(),pasteElements:async(w,z)=>{try{i(!0);const N=await ge("paste_elements",{offsetX:w,offsetY:z});return await c(),N}catch(N){throw console.error("Failed to paste elements:",N),N}finally{i(!1)}},deleteElements:async w=>{try{i(!0);for(const z of w)await ge("delete_element",{elementId:z});await c()}catch(z){throw console.error("Failed to delete elements:",z),z}finally{i(!1)}},selectAllElements:async()=>{try{const w=t.elements.map(z=>z.id);await p(w)}catch(w){throw console.error("Failed to select all elements:",w),w}},moveElements:async(w,z,N)=>{try{i(!0);const U=t.elements.filter(H=>w.includes(H.id)).map(H=>({element_id:H.id,new_position:{x:H.position.x+z,y:H.position.y+N}}));U.length>0&&await m(U)}catch(U){throw console.error("Failed to move elements:",U),U}finally{i(!1)}},undo:async()=>{try{i(!0),await ge("undo"),await c()}catch(w){throw console.error("Failed to undo:",w),w}finally{i(!1)}},redo:async()=>{try{i(!0),await ge("redo"),await c()}catch(w){throw console.error("Failed to redo:",w),w}finally{i(!1)}},updateCanvasConfig:async w=>{try{i(!0),await ge("update_canvas_config",{request:w}),await c()}catch(z){throw console.error("Failed to update canvas config:",z),z}finally{i(!1)}},getElementsAtPoint:async(w,z)=>{try{return await ge("get_elements_at_point",{x:w,y:z})}catch(N){return console.error("Failed to get elements at point:",N),[]}},isLoading:l,setLoading:i,dragOperation:s,setDragOperation:a,resizeOperation:o,setResizeOperation:g};return h(bn.Provider,{value:B,get children(){return e.children}})},Ve=()=>{const e=tn(bn);if(!e)throw new Error("useAppContext must be used within an AppProvider");return e};async function pn(e){return ge("tauri",e)}async function il(e={}){return typeof e=="object"&&Object.freeze(e),pn({__tauriModule:"Dialog",message:{cmd:"openDialog",options:e}})}async function sl(e={}){return typeof e=="object"&&Object.freeze(e),pn({__tauriModule:"Dialog",message:{cmd:"saveDialog",options:e}})}class Tt{static async loadTemplate(t){return await ge("load_jasper_template",{filePath:t})}static async saveTemplate(t,n){await ge("save_jasper_template",{template:t,filePath:n})}static async saveTemplateAs(t,n,l){await ge("save_template_as",{template:t,filePath:n,format:l})}static async validateTemplate(t){return await ge("validate_template",{template:t})}static async createEmptyTemplate(){return await ge("create_empty_template")}static async getTemplateInfo(t){return await ge("get_template_info",{filePath:t})}static async detectTemplateFormat(t){return await ge("detect_template_format",{filePath:t})}static async generateTemplatePreview(t){return await ge("generate_template_preview",{template:t})}static async exportTemplateJson(t){return await ge("export_template_json",{template:t})}static async importTemplateJson(t){return await ge("import_template_json",{jsonData:t})}static async cloneTemplate(t){return await ge("clone_template",{template:t})}static async mergeTemplates(t,n){return await ge("merge_templates",{baseTemplate:t,overlayTemplate:n})}static async extractTemplateElements(t,n){return await ge("extract_template_elements",{template:t,elementIds:n})}}const rl="modulepreload",al=function(e){return"/"+e},Qt={},ol=function(t,n,l){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(n.map(g=>{if(g=al(g),g in Qt)return;Qt[g]=!0;const c=g.endsWith(".css"),b=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${b}`))return;const u=document.createElement("link");if(u.rel=c?"stylesheet":rl,c||(u.as="script"),u.crossOrigin="",u.href=g,o&&u.setAttribute("nonce",o),document.head.appendChild(u),c)return new Promise((m,v)=>{u.addEventListener("load",m),u.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${g}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})},cl=()=>({metadata:{version:"2.0.0",format_version:"1.0.0",created_at:new Date().toISOString(),last_modified:new Date().toISOString(),created_by:"jasper-designer-v2",tags:[],compatibility:{min_jasper_version:"2.0.0",jasperreports_version:"6.20.0"}},canvas:{width:595,height:842,unit:"pt",orientation:"portrait",margins:{top:20,bottom:20,left:20,right:20},grid:{enabled:!0,size:10,snap:!0,visible:!0},background:{color:"#ffffff"}},data_sources:[],elements:[],parameters:[],variables:[],groups:[]});class Et{static toJasperTemplate(t,n){const l={...cl()},i={...l.metadata,...n,last_modified:new Date().toISOString()},s=this.convertCanvasConfig(t.canvas_config),a=t.elements.map(o=>this.convertReportElementToTemplateElement(o));return{...l,metadata:i,canvas:s,elements:a}}static convertCanvasConfig(t){return{width:t.width,height:t.height,unit:"pt",orientation:t.width>t.height?"landscape":"portrait",margins:{top:20,bottom:20,left:20,right:20},grid:{enabled:t.show_grid,size:t.grid_size,snap:t.snap_to_grid,visible:t.show_grid},background:{color:t.background_color}}}static convertReportElementToTemplateElement(t){const n=this.getElementType(t.content),l=this.convertElementContent(t.content),i=this.convertElementStyle(t.content);return{id:t.id,element_type:n,position:{x:t.position.x,y:t.position.y},size:{width:t.size.width,height:t.size.height},z_index:t.z_index,visible:t.visible,content:l,style:i,data_binding:this.extractDataBinding(t.content)}}static getElementType(t){switch(t.type){case"Text":return"Text";case"DataField":return"DataField";case"Rectangle":return"Rectangle";case"Line":return"Line";case"Image":return"Image";default:return"Text"}}static convertElementContent(t){switch(t.type){case"Text":return{text:t.content,font:this.convertTextStyleToFont(t.style),alignment:this.convertTextStyleToAlignment(t.style),color:t.style.color};case"DataField":return{expression:t.expression,format:t.format,font:this.convertTextStyleToFont(t.style),alignment:this.convertTextStyleToAlignment(t.style),color:t.style.color};case"Rectangle":return{color:t.fill_color};case"Line":return{color:t.color};case"Image":return{expression:t.src,text:t.alt};default:return{}}}static convertTextStyleToFont(t){return{family:t.font_family||"Arial",size:t.font_size||12,weight:this.mapFontWeight(t.font_weight),style:"normal"}}static convertTextStyleToAlignment(t){return{horizontal:this.mapTextAlign(t.align),vertical:"middle"}}static convertElementStyle(t){const n={};switch(t.type){case"Rectangle":t.fill_color&&(n.background={color:t.fill_color}),t.border&&(n.border={width:t.border.width,color:t.border.color,style:this.mapBorderStyle(t.border.style)});break;case"Text":case"DataField":t.style.background&&(n.background={color:t.style.background.color}),t.style.border&&(n.border={width:t.style.border.width,color:t.style.border.color,style:this.mapBorderStyle(t.style.border.style)});break}return n}static extractDataBinding(t){if(t.type==="DataField"&&t.data_source_id)return{source_id:t.data_source_id,field_name:this.extractFieldNameFromExpression(t.expression)}}static extractFieldNameFromExpression(t){var l;const n=t.match(/^\{([^}]+)\}$/);return(l=n==null?void 0:n[1])!=null?l:t}static toAppState(t){const n=t.metadata.description||void 0;return{elements:t.elements.map(l=>this.convertTemplateElementToReportElement(l)),canvas_config:this.convertCanvasToCanvasConfig(t.canvas),selected_ids:[],can_undo:!1,can_redo:!1,dirty:!1,...n&&{template_name:n}}}static convertCanvasToCanvasConfig(t){return{width:t.width,height:t.height,zoom:1,offset_x:0,offset_y:0,show_grid:t.grid.enabled,show_rulers:!0,grid_size:t.grid.size,snap_to_grid:t.grid.snap,background_color:t.background.color}}static convertTemplateElementToReportElement(t){const n=this.convertTemplateContentToElementContent(t);return{id:t.id,position:{x:t.position.x,y:t.position.y},size:{width:t.size.width,height:t.size.height},content:n,z_index:t.z_index,visible:t.visible,locked:!1}}static convertTemplateContentToElementContent(t){var n,l,i,s,a,o;switch(t.element_type){case"Text":return{type:"Text",content:t.content.text||"",style:this.convertTemplateStyleToTextStyle(t)};case"DataField":return{type:"DataField",expression:t.content.expression||"{data}",...t.content.format&&{format:t.content.format},style:this.convertTemplateStyleToTextStyle(t),...((n=t.data_binding)==null?void 0:n.source_id)&&{data_source_id:t.data_binding.source_id}};case"Rectangle":return{type:"Rectangle",...((i=(l=t.style)==null?void 0:l.background)==null?void 0:i.color)&&{fill_color:t.style.background.color},...t.content.color&&!((a=(s=t.style)==null?void 0:s.background)!=null&&a.color)&&{fill_color:t.content.color},...((o=t.style)==null?void 0:o.border)&&{border:{color:t.style.border.color,width:t.style.border.width,style:this.mapTemplateBorderStyle(t.style.border.style)}},corner_radius:0,opacity:1};case"Line":return{type:"Line",color:t.content.color||"#000000",width:1,line_style:"Solid",opacity:1};case"Image":return{type:"Image",src:t.content.expression||"",...t.content.text&&{alt:t.content.text}};default:return{type:"Text",content:"Unknown Element",style:this.createDefaultTextStyle()}}}static convertTemplateStyleToTextStyle(t){const n=t.content.font,l=t.content.alignment,i=t.style;return{font_family:(n==null?void 0:n.family)||"Arial",font_size:(n==null?void 0:n.size)||12,font_weight:this.mapTemplateFont(n==null?void 0:n.weight),color:t.content.color||"#000000",align:this.mapTemplateAlignment(l==null?void 0:l.horizontal),background:i!=null&&i.background?{color:i.background.color||"",opacity:1,padding:0}:void 0,border:i!=null&&i.border?{color:i.border.color,width:i.border.width,style:this.mapTemplateBorderStyle(i.border.style),radius:0}:void 0}}static createDefaultTextStyle(){return{font_family:"Arial",font_size:12,font_weight:"normal",color:"#000000",align:"Left"}}static mapFontWeight(t){switch(t){case"bold":return"bold";case"light":return"light";default:return"normal"}}static mapTemplateFont(t){switch(t){case"bold":return"bold";case"light":return"light";default:return"normal"}}static mapTextAlign(t){switch(t){case"Center":return"center";case"Right":return"right";default:return"left"}}static mapTemplateAlignment(t){switch(t){case"center":return"Center";case"right":return"Right";default:return"Left"}}static mapBorderStyle(t){switch(t){case"Dashed":return"dashed";case"Dotted":return"dotted";default:return"solid"}}static mapTemplateBorderStyle(t){switch(t){case"dashed":return"Dashed";case"dotted":return"Dotted";default:return"Solid"}}}var dl=f("<span class=text-warning>‚óè"),ul=f("<span class=ml-2> ‰∏™ÂÖÉÁ¥†"),gl=f('<span class="ml-2 text-primary">Â∑≤ÈÄâÊã© <!> ‰∏™'),hl=f('<div class="h-12 bg-primary border-b border-default flex items-center justify-between px-4"><div class="flex items-center gap-2"><button class=toolbar-btn title="Êñ∞Âª∫Ê®°Êùø (Ctrl+N)"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg><span>Êñ∞Âª∫</span></button><button class=toolbar-btn title="ÊâìÂºÄÊ®°Êùø (Ctrl+O)"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"></path></svg><span>ÊâìÂºÄ</span></button><button class=toolbar-btn title="‰øùÂ≠òÊ®°Êùø (Ctrl+S)"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path></svg><span>‰øùÂ≠ò</span></button><div class="w-px h-6 bg-border-default mx-2"></div><button class=toolbar-btn title=Êï∞ÊçÆÊ∫êÁÆ°ÁêÜ><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"></path></svg><span>Êï∞ÊçÆÊ∫ê</span></button><button class="toolbar-btn opacity-50 cursor-not-allowed"title="ËæìÂá∫È¢ÑËßà - Âç≥Â∞ÜÊé®Âá∫ (PDF/ÊâìÂç∞È¢ÑËßàÂäüËÉΩ)"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg><span>ËæìÂá∫È¢ÑËßà</span></button></div><div class="flex items-center gap-2"><button><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"></path></svg></button><button><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M21 10H11a8 8 0 00-8 8v2m18-10l-6 6m6-6l-6-6"></path></svg></button><div class="w-px h-6 bg-border-default mx-2"></div><button class=toolbar-btn-icon title="Áº©Â∞è (Ctrl+-)"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM13 10H7"></path></svg></button><select class=zoom-select><option value=25%>25%</option><option value=50%>50%</option><option value=75%>75%</option><option value=100%>100%</option><option value=125%>125%</option><option value=150%>150%</option><option value=200%>200%</option><option value=fit>ÈÄÇÂ∫îÁ™óÂè£</option></select><button class=toolbar-btn-icon title="ÊîæÂ§ß (Ctrl++)"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"></path></svg></button><div class="w-px h-6 bg-border-default mx-2"></div><button title="ÊòæÁ§∫ÁΩëÊ†º (Ctrl+G)"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"></path></svg></button><button title="ÊòæÁ§∫Ê†áÂ∞∫ (Ctrl+R)"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v14a2 2 0 01-2 2H7zM20 3v18l-4-4V7l4-4z"></path></svg></button><div class="w-px h-6 bg-border-default mx-2"></div><button class="toolbar-btn-icon bg-yellow-100 hover:bg-yellow-200 text-yellow-800"title="ÂºÄÂêØ/ÂÖ≥Èó≠ÂºÄÂèëËÄÖÂ∑•ÂÖ∑ (F12)"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg></button></div><div class="flex items-center gap-2 text-secondary text-sm"><span>');const vl=e=>{const{state:t,undo:n,redo:l,updateCanvasConfig:i,setState:s}=Ve(),[a,o]=Z(t.canvas_config.zoom*100),g=async()=>{try{const y=await Tt.createEmptyTemplate(),$=Et.toAppState(y);s($),console.log("‚úÖ Êñ∞Âª∫Ê®°ÊùøÊàêÂäü")}catch(y){console.error("‚ùå Êñ∞Âª∫Ê®°ÊùøÂ§±Ë¥•:",y),alert("Êñ∞Âª∫Ê®°ÊùøÂ§±Ë¥•")}},c=async()=>{try{const y=await il({title:"ÊâìÂºÄÊ®°ÊùøÊñá‰ª∂",filters:[{name:"JasperÊ®°Êùø",extensions:["jasper","jbin","jrxml"]}],multiple:!1});if(y&&typeof y=="string"){const $=await Tt.loadTemplate(y),C=Et.toAppState($);s({...C,template_name:$.metadata.description||"Êú™ÂëΩÂêçÊ®°Êùø"}),console.log("‚úÖ Ê®°ÊùøÂä†ËΩΩÊàêÂäü:",y)}}catch(y){console.error("‚ùå Âä†ËΩΩÊ®°ÊùøÂ§±Ë¥•:",y),alert("Âä†ËΩΩÊ®°ÊùøÂ§±Ë¥•")}},b=async()=>{try{const y=await sl({title:"‰øùÂ≠òÊ®°ÊùøÊñá‰ª∂",filters:[{name:"JasperÊ®°Êùø",extensions:["jasper"]}],defaultPath:t.template_name||"Êú™ÂëΩÂêçÊ®°Êùø"});if(y){const $=Et.toJasperTemplate(t,{description:t.template_name||"Êú™ÂëΩÂêçÊ®°Êùø"});await Tt.saveTemplate($,y),console.log("‚úÖ Ê®°Êùø‰øùÂ≠òÊàêÂäü:",y)}}catch(y){console.error("‚ùå ‰øùÂ≠òÊ®°ÊùøÂ§±Ë¥•:",y),alert("‰øùÂ≠òÊ®°ÊùøÂ§±Ë¥•")}},u=async y=>{const $=y/100;o(y);try{await i({zoom:$})}catch(C){console.error("Failed to update zoom:",C)}},m=()=>{const y=Math.min(a()+25,500);u(y)},v=()=>{const y=Math.max(a()-25,25);u(y)},d=async()=>{try{await i({show_grid:!t.canvas_config.show_grid})}catch(y){console.error("Failed to toggle grid:",y)}},p=async()=>{try{await i({show_rulers:!t.canvas_config.show_rulers})}catch(y){console.error("Failed to toggle rulers:",y)}},_=async()=>{try{await ge("toggle_devtools"),console.log("üîß DevTools toggled")}catch(y){console.error("Failed to toggle DevTools:",y)}};return(()=>{var y=hl(),$=y.firstChild,C=$.firstChild,k=C.nextSibling,E=k.nextSibling,D=E.nextSibling,L=D.nextSibling,O=L.nextSibling,K=$.nextSibling,R=K.firstChild,P=R.nextSibling,S=P.nextSibling,Q=S.nextSibling,B=Q.nextSibling,w=B.nextSibling,z=w.nextSibling,N=z.nextSibling,U=N.nextSibling,H=U.nextSibling,J=H.nextSibling,me=K.nextSibling,X=me.firstChild;return C.$$click=g,k.$$click=c,E.$$click=b,r($,h(Kn,{}),L),L.$$click=()=>{console.log("üîÑ Êï∞ÊçÆÊ∫êÊåâÈíÆË¢´ÁÇπÂáªÔºÅ"),e.onOpenDataSources()},O.$$click=()=>{alert(`üìÑ ËæìÂá∫È¢ÑËßàÂç≥Â∞ÜÊé®Âá∫ÔºÅ

‚ú® Âç≥Â∞ÜÊîØÊåÅÁöÑÂäüËÉΩÔºö
‚Ä¢ PDFÊ†ºÂºèÈ¢ÑËßà
‚Ä¢ ÊâìÂç∞ÊïàÊûúÈ¢ÑËßà
‚Ä¢ ÂàÜÈ°µÊòæÁ§∫
‚Ä¢ ÂØºÂá∫ËÆæÁΩÆ`)},O.disabled=!0,Te(R,"click",n),Te(P,"click",l),Q.$$click=v,B.addEventListener("change",j=>{const se=j.target.value;if(se==="fit")console.log("Fit to window");else{const ve=parseInt(se.replace("%",""));u(ve)}}),w.$$click=m,N.$$click=d,U.$$click=p,J.$$click=_,r(me,h(M,{get when(){return t.dirty},get children(){return dl()}}),X),r(X,()=>t.template_name||"Êú™ÂëΩÂêçÊ®°Êùø"),r(me,h(M,{get when(){return t.elements.length>0},get children(){var j=ul(),se=j.firstChild;return r(j,()=>t.elements.length,se),j}}),null),r(me,h(M,{get when(){return t.selected_ids.length>0},get children(){var j=gl(),se=j.firstChild,ve=se.nextSibling;return ve.nextSibling,r(j,()=>t.selected_ids.length,ve),j}}),null),A(j=>{var se=`toolbar-btn-icon ${t.can_undo?"":"opacity-50 cursor-not-allowed"}`,ve=!t.can_undo,re=`Êí§ÈîÄ${t.undo_description?` (${t.undo_description})`:""} (Ctrl+Z)`,le=`toolbar-btn-icon ${t.can_redo?"":"opacity-50 cursor-not-allowed"}`,ee=!t.can_redo,ne=`ÈáçÂÅö${t.redo_description?` (${t.redo_description})`:""} (Ctrl+Y)`,de=`toolbar-btn-icon ${t.canvas_config.show_grid?"active":""}`,Y=`toolbar-btn-icon ${t.canvas_config.show_rulers?"active":""}`;return se!==j.e&&_e(R,j.e=se),ve!==j.t&&(R.disabled=j.t=ve),re!==j.a&&q(R,"title",j.a=re),le!==j.o&&_e(P,j.o=le),ee!==j.i&&(P.disabled=j.i=ee),ne!==j.n&&q(P,"title",j.n=ne),de!==j.s&&_e(N,j.s=de),Y!==j.h&&_e(U,j.h=Y),j},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),A(()=>B.value=`${Math.round(a())}%`),y})()};Pe(["click"]);var fl=f('<div class="flex flex-col h-full"><div class="p-4 border-b border-default"><h2 class="text-lg font-semibold text-primary mb-3">ÁªÑ‰ª∂Â∫ì</h2><input type=text placeholder=ÊêúÁ¥¢ÁªÑ‰ª∂... class=component-search></div><div class="flex-1 overflow-y-auto custom-scrollbar p-4"><div class=space-y-4><div><h3 class="text-sm font-medium text-secondary mb-2">Âü∫Á°ÄÁªÑ‰ª∂</h3><div class="grid grid-cols-2 gap-2"></div></div><div><h3 class="text-sm font-medium text-secondary mb-2">Êï∞ÊçÆÁªÑ‰ª∂</h3><div class="grid grid-cols-2 gap-2"></div></div><div><h3 class="text-sm font-medium text-secondary mb-2">Èì∂Ë°åÁªÑ‰ª∂</h3><div class="grid grid-cols-2 gap-2">'),ml=f('<div class=component-item><div class=text-center><div class="text-lg mb-1"></div><div class="text-xs font-medium text-primary">');const bl=()=>{const{createElement:e}=Ve(),[t,n]=Z(""),l=[{id:"text",name:"ÊñáÂ≠ó",category:"basic",icon:"üìù",description:"ÈùôÊÄÅÊñáÂ≠óÊ†áÁ≠æ",default_size:{width:100,height:24},create_content:c=>({type:"Text",content:(c==null?void 0:c.text)||"ÊñáÂ≠óÂÜÖÂÆπ",style:{font_family:"SimSun",font_size:14,font_weight:"normal",color:"#000000",align:"Left",border:{color:"#cccccc",width:1,style:"Solid",radius:0},background:{color:"#f8f9fa",opacity:.8,padding:2}}})},{id:"data_field",name:"Êï∞ÊçÆÂ≠óÊÆµ",category:"data",icon:"üîó",description:"Âä®ÊÄÅÊï∞ÊçÆÂ≠óÊÆµ",default_size:{width:120,height:24},create_content:c=>({type:"DataField",expression:(c==null?void 0:c.expression)||"${fieldName}",format:c==null?void 0:c.format,style:{font_family:"SimSun",font_size:14,font_weight:"normal",color:"#000000",align:"Left",border:{color:"#cccccc",width:1,style:"Solid",radius:0},background:{color:"#f8f9fa",opacity:.8,padding:2}}})},{id:"rectangle",name:"Áü©ÂΩ¢",category:"basic",icon:"‚ñ≠",description:"Áü©ÂΩ¢Ê°ÜÊû∂",default_size:{width:100,height:60},create_content:c=>({type:"Rectangle",fill_color:(c==null?void 0:c.fill_color)||"transparent",border:{color:(c==null?void 0:c.border_color)||"#000000",width:(c==null?void 0:c.border_width)||1,style:"Solid"}})},{id:"line",name:"Á∫øÊù°",category:"basic",icon:"‚îÅ",description:"ÂàÜÈöîÁ∫ø",default_size:{width:200,height:2},create_content:c=>({type:"Line",color:(c==null?void 0:c.color)||"#000000",width:(c==null?void 0:c.width)||1})},{id:"image",name:"ÂõæÁâá",category:"basic",icon:"üñºÔ∏è",description:"ÂõæÁâáÂç†‰ΩçÁ¨¶",default_size:{width:100,height:80},create_content:c=>({type:"Image",src:(c==null?void 0:c.src)||"",alt:(c==null?void 0:c.alt)||"ÂõæÁâá"})}],i=[{id:"bank_header",name:"Èì∂Ë°åÊä¨Â§¥",category:"bank",icon:"üè¶",description:"Èì∂Ë°åÊ†áÈ¢òÂíåLogoÂå∫Âüü",default_size:{width:300,height:60},create_content:()=>({type:"Text",content:"‰∏≠ÂõΩÂ∑•ÂïÜÈì∂Ë°åÁîµÂ≠êÂõûÂçï",style:{font_family:"SimHei",font_size:18,font_weight:"bold",color:"#000000",align:"Center",border:{color:"#cccccc",width:1,style:"Solid",radius:0},background:{color:"#f8f9fa",opacity:.8,padding:2}}})},{id:"amount_field",name:"ÈáëÈ¢ùÂ≠óÊÆµ",category:"bank",icon:"üí∞",description:"Ê†ºÂºèÂåñÈáëÈ¢ùÊòæÁ§∫",default_size:{width:120,height:24},create_content:()=>({type:"DataField",expression:"${amount}",format:"currency",style:{font_family:"SimSun",font_size:14,font_weight:"bold",color:"#000000",align:"Right",border:{color:"#cccccc",width:1,style:"Solid",radius:0},background:{color:"#f8f9fa",opacity:.8,padding:2}}})},{id:"customer_info",name:"ÂÆ¢Êà∑‰ø°ÊÅØ",category:"bank",icon:"üë§",description:"ÂÆ¢Êà∑ÂßìÂêçÂíåË¥¶Âè∑",default_size:{width:150,height:24},create_content:()=>({type:"DataField",expression:"${customerName}",style:{font_family:"SimSun",font_size:12,font_weight:"normal",color:"#000000",align:"Left",border:{color:"#cccccc",width:1,style:"Solid",radius:0},background:{color:"#f8f9fa",opacity:.8,padding:2}}})}],s=[...l,...i],a=()=>{const c=t().toLowerCase();return c?s.filter(b=>b.name.toLowerCase().includes(c)||b.description.toLowerCase().includes(c)):s},o=(c,b)=>{if(console.log("Starting drag for component:",c.id),b.dataTransfer){b.dataTransfer.effectAllowed="copy",b.dataTransfer.setData("application/json",JSON.stringify({type:"component",component:c}));const u=document.createElement("div");u.innerHTML=`
        <div style="
          background: #f3f4f6; 
          border: 2px solid #3b82f6; 
          border-radius: 8px; 
          padding: 8px 12px; 
          font-size: 12px;
          white-space: nowrap;
          box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        ">
          ${c.icon} ${c.name}
        </div>
      `,u.style.position="absolute",u.style.top="-1000px",document.body.appendChild(u),b.dataTransfer.setDragImage(u,50,20),setTimeout(()=>{document.body.removeChild(u)},0)}},g=async c=>{try{const b=await e(c.id,{x:100,y:100},c.default_size,c.create_content());console.log("Created element:",b)}catch(b){console.error("Failed to create element:",b)}};return(()=>{var c=fl(),b=c.firstChild,u=b.firstChild,m=u.nextSibling,v=b.nextSibling,d=v.firstChild,p=d.firstChild,_=p.firstChild,y=_.nextSibling,$=p.nextSibling,C=$.firstChild,k=C.nextSibling,E=$.nextSibling,D=E.firstChild,L=D.nextSibling;return m.$$input=O=>n(O.target.value),r(y,h(oe,{get each(){return a().filter(O=>O.category==="basic")},children:O=>h(Lt,{component:O,onDrag:K=>o(O,K),onClick:()=>g(O)})})),r(k,h(oe,{get each(){return a().filter(O=>O.category==="data")},children:O=>h(Lt,{component:O,onDrag:K=>o(O,K),onClick:()=>g(O)})})),r(L,h(oe,{get each(){return a().filter(O=>O.category==="bank")},children:O=>h(Lt,{component:O,onDrag:K=>o(O,K),onClick:()=>g(O)})})),A(()=>m.value=t()),c})()},Lt=e=>(()=>{var t=ml(),n=t.firstChild,l=n.firstChild,i=l.nextSibling;return Te(t,"click",e.onClick),t.addEventListener("dragstart",s=>e.onDrag(s)),q(t,"draggable",!0),r(l,()=>e.component.icon),r(i,()=>e.component.name),A(()=>q(t,"title",e.component.description)),t})();Pe(["input","click"]);class we{static async listDataSources(){return ge("list_data_sources")}static async deleteDataSource(t){return ge("delete_data_source",{source_id:t})}static async updateConfig(t,n){return ge("update_data_source_config",{source_id:t,config:n})}static async queryDataSource(t,n){return ge("query_data_source",{source_id:t,query:n})}static async getDataPreview(t,n){return ge("get_data_preview",{source_id:t,limit:n})}static async testConnection(t,n){return ge("test_data_source_connection",{provider_type:t,config:n})}static async discoverSchema(t,n){return ge("discover_schema",{provider_type:t,config:n})}static async testDatabaseConnection(t){return ge("test_database_connection",{config:t})}static async loadDatabaseSchema(t){return ge("load_database_schema",{config:t})}static async executeDatabasePreview(t,n,l){return ge("execute_database_preview",{config:t,sql:n,limit:l})}static async validateSqlSyntax(t,n){return ge("validate_sql_syntax",{sql:t,database_type:n})}static async formatSql(t,n){return ge("format_sql",{sql:t,database_type:n})}static async saveDataSource(t){try{const n=t.config,l=await ge("create_database_source",{name:t.name,description:t.description||null,database_type:n.database_type,host:n.host,port:n.port,database:n.database,username:n.username,password:n.password||null,sql:t.sql,selected_tables:t.selected_tables,tags:t.tags?t.tags:null});return{success:!0,data_source_id:String(l),message:`Êï∞ÊçÆÊ∫ê "${t.name}" ÂàõÂª∫ÊàêÂäü`,warnings:[],errors:[]}}catch(n){return{success:!1,data_source_id:"",message:`‰øùÂ≠òÊï∞ÊçÆÊ∫êÂ§±Ë¥•: ${n}`,warnings:[],errors:[String(n)]}}}static async createDataSource(t,n,l){return ge("create_data_source",{name:t,provider_type:n,config:l})}static async getPreview(t,n,l){return this.getDataPreview(t,l)}static async queryData(t,n){return this.queryDataSource(t,n||{})}static async evaluateExpression(t,n,l){return ge("evaluate_expression",{source_id:t,expression:n,context:l})}static async getAvailableTypes(){return ge("get_available_data_source_types")}static async getSchema(t){return ge("get_data_source_schema",{source_id:t})}static async getConfigSchema(t){return ge("get_config_schema",{provider_type:t})}static async getDefaultConfig(t){return ge("get_default_config",{provider_type:t})}static async validateConfig(t,n){return ge("validate_config",{provider_type:t,config:n})}static async captureDataPreview(t,n){return this.executeDatabasePreview(t,n,50)}static async validateDataSourceBeforeSave(t){try{const n=await this.testDatabaseConnection(t.config),l=await this.validateSqlSyntax(t.sql,t.config.database_type),i=await this.performSecurityCheck(t.config,t.sql);return{connection_valid:n.success,sql_valid:l.valid,security_passed:i.is_safe,performance_acceptable:!0,warnings:[...l.warnings||[],...i.warnings||[]],errors:[]}}catch(n){return{connection_valid:!1,sql_valid:!1,security_passed:!1,performance_acceptable:!1,warnings:[],errors:[String(n)]}}}static async performSecurityCheck(t,n){const l=[],i=[],s=[/drop\s+table/i,/truncate\s+table/i,/delete\s+from/i,/update\s+.*set/i,/insert\s+into/i,/alter\s+table/i];for(const a of s)if(a.test(n)){l.push("ÂåÖÂê´ÂèØËÉΩÂç±Èô©ÁöÑSQLÊìç‰Ωú");break}return{is_safe:l.length===0,security_issues:l,warnings:i}}}class pl{constructor(){Be(this,"styles",new Map);Be(this,"elementStyleMap",new Map);Be(this,"observers",new Set);Be(this,"initialized",!1);console.log("üé® TextStyleManager ÂàùÂßãÂåñ‰∏≠...")}async initialize(){if(!this.initialized)try{await this.loadSystemStyles(),await this.loadUserStyles(),this.initialized=!0,console.log(`‚úÖ TextStyleManager ÂàùÂßãÂåñÂÆåÊàêÔºåÂä†ËΩΩ‰∫Ü ${this.styles.size} ‰∏™Ê†∑Âºè`)}catch(t){throw console.error("‚ùå TextStyleManager ÂàùÂßãÂåñÂ§±Ë¥•:",t),t}}createStyle(t){const n=`style_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,l={...t,id:n,metadata:{createdAt:new Date,lastModified:new Date,author:"user",usageCount:0,isSystemStyle:!1,tags:[]}};return this.styles.set(n,l),this.notifyObservers("style-created",n),this.saveUserStyles(),console.log(`üé® ÂàõÂª∫Êñ∞Ê†∑Âºè: ${l.name} (${n})`),n}getStyle(t){return this.styles.get(t)||null}updateStyle(t,n){const l=this.styles.get(t);if(!l)return console.warn(`‚ö†Ô∏è Ê†∑Âºè ${t} ‰∏çÂ≠òÂú®`),!1;if(l.metadata.isSystemStyle)return console.warn(`‚ö†Ô∏è Êó†Ê≥ï‰øÆÊîπÁ≥ªÁªüÈ¢ÑËÆæÊ†∑Âºè ${t}`),!1;const i={...l,style:{...l.style,...n},metadata:{...l.metadata,lastModified:new Date}};return this.styles.set(t,i),this.syncAllStyleInstances(t),this.saveUserStyles(),this.notifyObservers("style-updated",t),console.log(`üîÑ Ê†∑ÂºèÂ∑≤Êõ¥Êñ∞: ${l.name} (${t})`),!0}deleteStyle(t){const n=this.styles.get(t);if(!n)return!1;if(n.metadata.isSystemStyle)return console.warn(`‚ö†Ô∏è Êó†Ê≥ïÂà†Èô§Á≥ªÁªüÈ¢ÑËÆæÊ†∑Âºè ${t}`),!1;const l=Array.from(this.elementStyleMap.entries()).filter(([i,s])=>s===t).map(([i,s])=>i);return l.length>0?(console.warn(`‚ö†Ô∏è Êó†Ê≥ïÂà†Èô§Ê†∑Âºè ${t}Ôºå‰ªçÊúâ ${l.length} ‰∏™ÂÖÉÁ¥†Âú®‰ΩøÁî®`),!1):(this.styles.delete(t),this.saveUserStyles(),this.notifyObservers("style-deleted",t),console.log(`üóëÔ∏è Ê†∑ÂºèÂ∑≤Âà†Èô§: ${n.name} (${t})`),!0)}applyStyleToElement(t,n){const l=this.styles.get(n);if(!l)return{success:!1,elementId:t,styleId:n,appliedAt:new Date,error:`Ê†∑Âºè ${n} ‰∏çÂ≠òÂú®`};try{const i=this.elementStyleMap.get(t);if(this.elementStyleMap.set(t,n),l.metadata.usageCount++,i&&i!==n){const s=this.styles.get(i);s&&(s.metadata.usageCount=Math.max(0,s.metadata.usageCount-1))}return this.applyStyleToDOM(t,l.style),this.notifyObservers("style-applied",{elementId:t,styleId:n}),console.log(`üéØ Â∫îÁî®Ê†∑Âºè: ${l.name} ‚Üí ÂÖÉÁ¥† ${t}`),{success:!0,elementId:t,styleId:n,appliedAt:new Date}}catch(i){return console.error(`‚ùå Â∫îÁî®Ê†∑ÂºèÂ§±Ë¥•: ${i}`),{success:!1,elementId:t,styleId:n,appliedAt:new Date,error:i instanceof Error?i.message:String(i)}}}getElementStyleId(t){return this.elementStyleMap.get(t)||null}removeElementStyle(t){const n=this.elementStyleMap.get(t);if(n){this.elementStyleMap.delete(t);const l=this.styles.get(n);l&&(l.metadata.usageCount=Math.max(0,l.metadata.usageCount-1)),console.log(`üîó ÁßªÈô§ÂÖÉÁ¥†Ê†∑ÂºèÊò†Â∞Ñ: ÂÖÉÁ¥† ${t}`)}}getStylesByCategory(t){const n=Array.from(this.styles.values());return(t?n.filter(i=>i.category===t):n).sort((i,s)=>i.metadata.isSystemStyle!==s.metadata.isSystemStyle?i.metadata.isSystemStyle?-1:1:s.metadata.usageCount-i.metadata.usageCount)}searchStyles(t,n){const l=this.getStylesByCategory(n),i=t.toLowerCase().trim();return i?l.filter(s=>s.name.toLowerCase().includes(i)||s.description.toLowerCase().includes(i)||s.metadata.tags.some(a=>a.toLowerCase().includes(i))):l}getStyleUsageStats(){const t=[];for(const[n,l]of this.styles){const i=Array.from(this.elementStyleMap.entries()).filter(([s,a])=>a===n).map(([s,a])=>s);t.push({styleId:n,usageCount:i.length,elements:i,lastUsed:l.metadata.lastModified})}return t.sort((n,l)=>l.usageCount-n.usageCount)}cleanupUnusedStyles(){const t=new Set(this.elementStyleMap.values()),n=[];for(const[l,i]of this.styles)!t.has(l)&&!i.metadata.isSystemStyle&&(this.styles.delete(l),n.push(l),console.log(`üßπ Ê∏ÖÁêÜÊú™‰ΩøÁî®Ê†∑Âºè: ${i.name} (${l})`));return n.length>0&&this.saveUserStyles(),n}exportStyles(t){const n=t?t.map(i=>this.styles.get(i)).filter(Boolean):Array.from(this.styles.values()),l=new Set(n.map(i=>i.category));return{version:"2.0.0",exportedAt:new Date,styles:n,metadata:{totalStyles:n.length,categories:Array.from(l),author:"user"}}}async importStyles(t){const n=[];for(const l of t.styles){if(Array.from(this.styles.values()).find(a=>a.name===l.name&&a.category===l.category)){console.warn(`‚ö†Ô∏è Ë∑≥ËøáÂ∑≤Â≠òÂú®ÁöÑÊ†∑Âºè: ${l.name}`);continue}const s=this.createStyle({name:l.name,description:l.description,category:l.category,style:l.style,...l.inheritance&&{inheritance:l.inheritance}});n.push(s)}return console.log(`üì¶ ÂØºÂÖ•ÂÆåÊàêÔºåÂÖ±ÂØºÂÖ• ${n.length} ‰∏™Ê†∑Âºè`),n}addObserver(t){this.observers.add(t)}removeObserver(t){this.observers.delete(t)}syncAllStyleInstances(t){const n=this.styles.get(t);if(!n)return;const l=[];for(const[i,s]of this.elementStyleMap)s===t&&(this.applyStyleToDOM(i,n.style),l.push(i));this.notifyObservers("styles-synced",{styleId:t,affectedElements:l}),console.log(`üîÑ Ê†∑ÂºèÂêåÊ≠•ÂÆåÊàê: ${t} ‚Üí ${l.length} ‰∏™ÂÖÉÁ¥†`)}applyStyleToDOM(t,n){console.log(`üé® Â∫îÁî®Ê†∑ÂºèÂà∞DOM: ÂÖÉÁ¥† ${t}`,{font_family:n.font_family,font_size:n.font_size,typography:n.typography})}async loadSystemStyles(){try{const{BANK_TEXT_STYLES:t}=await ol(async()=>{const{BANK_TEXT_STYLES:n}=await import("./bank-text-styles-BtzE7aIi.js");return{BANK_TEXT_STYLES:n}},[]);for(const n of t)this.styles.set(n.id,n);console.log(`üè¶ Âä†ËΩΩ‰∫Ü ${t.length} ‰∏™Èì∂Ë°åÈ¢ÑËÆæÊ†∑Âºè`)}catch(t){console.warn("‚ö†Ô∏è Âä†ËΩΩÁ≥ªÁªüÊ†∑ÂºèÂ§±Ë¥•:",t)}}async loadUserStyles(){try{const t=localStorage.getItem("jasper-text-styles");if(t){const n=JSON.parse(t);for(const l of n)l.metadata.createdAt=new Date(l.metadata.createdAt),l.metadata.lastModified=new Date(l.metadata.lastModified),this.styles.set(l.id,l);console.log(`üë§ Âä†ËΩΩ‰∫Ü ${n.length} ‰∏™Áî®Êà∑Ëá™ÂÆö‰πâÊ†∑Âºè`)}}catch(t){console.warn("‚ö†Ô∏è Âä†ËΩΩÁî®Êà∑Ê†∑ÂºèÂ§±Ë¥•:",t)}}saveUserStyles(){try{const t=Array.from(this.styles.values()).filter(n=>!n.metadata.isSystemStyle);localStorage.setItem("jasper-text-styles",JSON.stringify(t)),console.log(`üíæ ‰øùÂ≠ò‰∫Ü ${t.length} ‰∏™Áî®Êà∑Ëá™ÂÆö‰πâÊ†∑Âºè`)}catch(t){console.error("‚ùå ‰øùÂ≠òÁî®Êà∑Ê†∑ÂºèÂ§±Ë¥•:",t)}}notifyObservers(t,n){for(const l of this.observers)try{l.onStyleChange(t,n)}catch(i){console.error("‚ùå ËßÇÂØüËÄÖÈÄöÁü•Â§±Ë¥•:",i)}}}const Ne=new pl;class yl{calculateUnifiedBounds(t,n,l){const i=this.calculateFontMetrics(n),s=this.measureTextContent(t,n,l.width),a=this.calculateContainerHeight(s,i,l.height),o=this.calculateTextPositioning(n,l,a,i),g={containerBounds:{x:0,y:0,width:l.width,height:a},contentBounds:s.bounds,fontMetrics:i,positioning:o};return s.wrappedLines&&(g.textLayout={wrappedLines:s.wrappedLines,isWrapped:!0,originalLineCount:t.split(`
`).length,wrappedLineCount:s.wrappedLines.length}),g}calculateFontMetrics(t){const n=t.font_size,l=1.2,i=.75,s=.25,a=n*i,o=n*s;return{fontSize:n,lineHeight:n*l,ascender:a,descender:o,baseline:a}}getCharacterWidth(t,n){const l=n.font_size,i=n.font_family,s=/[\u4e00-\u9fa5]/.test(t),a={"Courier New":{chinese:.6,english:.6},Monaco:{chinese:.6,english:.6},Consolas:{chinese:.6,english:.6},SimSun:{chinese:1,english:.5},SimHei:{chinese:1,english:.5},KaiTi:{chinese:1.1,english:.6},FangSong:{chinese:1,english:.55},Arial:{chinese:1,english:.55},Helvetica:{chinese:1,english:.55},"Times New Roman":{chinese:1,english:.5},"Microsoft YaHei":{chinese:1,english:.52},"PingFang SC":{chinese:1,english:.52},"Noto Sans":{chinese:1,english:.53},default:{chinese:1,english:.55}},o=i.toLowerCase();let g=a.default;for(const[b,u]of Object.entries(a))if(o.includes(b.toLowerCase())||b.toLowerCase().includes(o)){g=u;break}const c=s?g.chinese:g.english;return l*c}calculateTextWidth(t,n){let l=0;for(const i of t)i!==`
`&&(l+=this.getCharacterWidth(i,n));return l}measureTextContent(t,n,l=0){const i=t.split(`
`),s=i.length;let a=0;for(const c of i){const b=this.calculateTextWidth(c,n);a=Math.max(a,b)}if(l>0&&a>l)return this.calculateWrappedText(t,n,l);const o=l>0?Math.min(a,l):a,g=s*n.font_size*1.2;return{bounds:{x:0,y:0,width:o,height:g},lineCount:s,actualHeight:g}}calculateWrappedText(t,n,l){const i=this.getCharacterWidth("Êµã",n);if(Math.floor(l/i)<1||l<i)return{bounds:{x:0,y:0,width:l,height:n.font_size*1.2},lineCount:1,actualHeight:n.font_size*1.2,wrappedLines:["..."]};const a=this.smartSegmentation(t);let o=[],g="",c=0;for(const u of a){const m=this.calculateTextWidth(u,n),v=c+m;if(v>l)if(g.trim())o.push(g.trim()),g=u,c=m;else{const{truncated:d,remaining:p}=this.forceTruncateSegment(u,l,n);o.push(d),g=p,c=this.calculateTextWidth(p,n)}else g+=u,c=v}g.trim()&&o.push(g.trim());const b=o.length*n.font_size*1.2;return{bounds:{x:0,y:0,width:l,height:b},lineCount:o.length,actualHeight:b,wrappedLines:o}}forceTruncateSegment(t,n,l){let i="",s=0,a=0;for(a=0;a<t.length;a++){const g=t[a];if(!g)break;const c=this.getCharacterWidth(g,l);if(s+c>n)break;i+=g,s+=c}const o=t.substring(a);return{truncated:i,remaining:o}}smartSegmentation(t){const n=[];let l="";for(let i=0;i<t.length;i++){const s=t[i];s&&(/[\u4e00-\u9fa5]/.test(s)?(l&&(n.push(l),l=""),n.push(s)):s===`
`?(l&&(n.push(l),l=""),n.push(`
`)):s===" "?l?(n.push(l+" "),l=""):n.push(" "):l+=s)}return l&&n.push(l),n.filter(i=>i.length>0)}calculateContainerHeight(t,n,l){const i=n.lineHeight*t.lineCount,s=n.ascender+n.descender,a=n.lineHeight,o=Math.max(i,s,a);return Math.max(o,l)}calculateTextPositioning(t,n,l,i){var b;const s=this.calculateHorizontalAnchor(t.align,n.width),a=i.baseline,o=((b=t.background)==null?void 0:b.padding)||0,g=-o,c=-o;return{textAnchorX:s,textAnchorY:a,backgroundX:g,backgroundY:c}}calculateHorizontalAnchor(t,n){switch(t){case"Left":return 0;case"Center":return n/2;case"Right":return n;default:return 0}}getTextAnchor(t){switch(t){case"Left":return"start";case"Center":return"middle";case"Right":return"end";default:return"start"}}debugBounds(t,n){}}const Xe=new yl;class $l{constructor(){Be(this,"initialized",!1);this.initialize()}async initialize(){if(!this.initialized)try{await Ne.initialize(),this.initialized=!0,console.log("üé® ProfessionalTextRenderer Â∑≤ÂàùÂßãÂåñ")}catch(t){console.error("‚ùå ProfessionalTextRenderer ÂàùÂßãÂåñÂ§±Ë¥•:",t)}}isElementUsingProfessionalStyle(t){return Ne.getElementStyleId(t)!==null}adaptLegacyTextStyle(t){return{...t,font_weight:t.font_weight,typography:{letterSpacing:0,lineHeight:1.2,paragraphSpacing:0,textIndent:0,decoration:{underline:!1,strikethrough:!1,overline:!1,decorationStyle:"solid"},textTransform:"none",whiteSpace:"normal"},fills:[{type:"solid",enabled:!0,opacity:1,solid:{color:t.color}}],effects:[]}}renderProfessionalText(t,n=!1){if(t.content.type!=="Text"&&t.content.type!=="DataField")return null;const l=Ne.getElementStyleId(t.id);let i;if(l){const o=Ne.getStyle(l);if(!o)return console.warn(`‚ö†Ô∏è Êâæ‰∏çÂà∞Ê†∑ÂºèÂÆö‰πâ: ${l}`),null;i=o.style,console.log(`üé® ‰ΩøÁî®‰∏ì‰∏öÊ†∑ÂºèÊ∏≤Êüì: ${o.name} (${l})`)}else{const o=t.content.type==="Text"||t.content.type==="DataField"?t.content.style:null;if(!o)return null;i=this.adaptLegacyTextStyle(o),console.log("üîÑ ÈÄÇÈÖç‰º†ÁªüÊ†∑ÂºèÂà∞‰∏ì‰∏öÊéíÁâàÁ≥ªÁªü")}const s=this.calculateEnhancedBounds(t.content.type==="Text"?t.content.content:t.content.expression||"[Êï∞ÊçÆÂ≠óÊÆµ]",i,t.size);return{element:this.createProfessionalTextElement(s,t.content.type==="Text"?t.content.content:t.content.expression||"[Êï∞ÊçÆÂ≠óÊÆµ]",i,!1),bounds:s,style:i}}calculateEnhancedBounds(t,n,l){const i=Xe.calculateUnifiedBounds(t,n,l),s=n.typography,a=this.calculateLetterSpacingEffect(t,s.letterSpacing),o=this.calculateLineHeightEffect(t,n.font_size,s.lineHeight),g=this.calculateParagraphSpacingEffect(t,s.paragraphSpacing);return{containerBounds:i.containerBounds,positioning:i.positioning,fontMetrics:i.fontMetrics,typography:{adjustedWidth:i.containerBounds.width+a.widthIncrease,adjustedHeight:i.containerBounds.height+o.heightIncrease+g.heightIncrease,letterSpacingData:a,lineHeightData:o,paragraphData:g}}}calculateLetterSpacingEffect(t,n){const l=t.split(`
`),i=l.reduce((a,o)=>a+o.length,0),s=Math.max(0,i-l.length);return{spacingValue:n,totalSpaces:s,widthIncrease:s*n,charPositions:[]}}calculateLineHeightEffect(t,n,l){const s=t.split(`
`).length,a=n*l,o=n*1.2,g=a-o;return{lineHeightRatio:l,actualLineHeight:a,lineCount:s,heightIncrease:g*Math.max(0,s-1),baselinePositions:[]}}calculateParagraphSpacingEffect(t,n){const i=t.split(`

`).length;return{spacing:n,paragraphCount:i,heightIncrease:n*Math.max(0,i-1),paragraphPositions:[]}}createProfessionalTextElement(t,n,l,i){const s=document.createElementNS("http://www.w3.org/2000/svg","g");return s.setAttribute("class","professional-text-container"),this.renderMultipleFills(s,t,l.fills),this.renderEffects(s,t,l.effects),this.renderTypographyText(s,t,n,l),this.renderTextDecorations(s,t,n,l.typography.decoration),s}renderMultipleFills(t,n,l){if(l&&l.length>0&&l[0].enabled){const i=l[0];i.type==="solid"&&i.solid&&console.log("üé® Â∫îÁî®Á∫ØËâ≤Â°´ÂÖÖ:",i.solid.color)}}renderEffects(t,n,l){if(!l||l.length===0)return;const i=document.createElementNS("http://www.w3.org/2000/svg","defs"),s=document.createElementNS("http://www.w3.org/2000/svg","filter"),a=`text-effects-${Date.now()}-${Math.random().toString(36).substr(2,5)}`;s.id=a;for(const o of l)if(o.enabled&&o.type==="drop-shadow"&&o.dropShadow){const g=document.createElementNS("http://www.w3.org/2000/svg","feDropShadow");g.setAttribute("dx",o.dropShadow.offsetX.toString()),g.setAttribute("dy",o.dropShadow.offsetY.toString()),g.setAttribute("stdDeviation",o.dropShadow.blur.toString()),g.setAttribute("flood-color",o.dropShadow.color),g.setAttribute("flood-opacity",o.dropShadow.opacity.toString()),s.appendChild(g),console.log("‚ú® Â∫îÁî®ÊäïÂΩ±ÊïàÊûú")}s.children.length>0&&(i.appendChild(s),t.appendChild(i),t.setAttribute("filter",`url(#${a})`))}renderTypographyText(t,n,l,i){var g,c;const s=document.createElementNS("http://www.w3.org/2000/svg","text");s.setAttribute("font-family",i.font_family),s.setAttribute("font-size",i.font_size.toString()),s.setAttribute("font-weight",i.font_weight),s.setAttribute("fill",((c=(g=i.fills[0])==null?void 0:g.solid)==null?void 0:c.color)||i.color),s.setAttribute("text-anchor",this.getTextAnchor(i.align));const a=l.split(`
`),o=i.typography;a.forEach((b,u)=>{const m=document.createElementNS("http://www.w3.org/2000/svg","tspan");o.letterSpacing!==0&&m.setAttribute("letter-spacing",`${o.letterSpacing}px`);const v=n.positioning.textAnchorY+u*n.typography.lineHeightData.actualLineHeight;if(m.setAttribute("x",n.positioning.textAnchorX.toString()),m.setAttribute("y",v.toString()),u===0&&o.textIndent!==0){const d=n.positioning.textAnchorX+o.textIndent;m.setAttribute("x",d.toString())}o.textTransform&&o.textTransform!=="none"?m.textContent=this.applyTextTransform(b,o.textTransform):m.textContent=b,s.appendChild(m)}),t.appendChild(s)}renderTextDecorations(t,n,l,i){if(!i.underline&&!i.strikethrough&&!i.overline)return;const s=l.split(`
`),a=i.decorationColor||"#000000",o=i.decorationThickness||1,g=i.decorationStyle==="dashed"?"4,2":i.decorationStyle==="dotted"?"1,1":"none";s.forEach((c,b)=>{if(!c.trim())return;const u=n.positioning.textAnchorY+b*n.typography.lineHeightData.actualLineHeight,m=c.length*n.fontMetrics.fontSize*.6,v=n.positioning.textAnchorX,d=v+m;if(i.underline){const p=u+n.fontMetrics.fontSize*.1;this.createDecorationLine(t,v,p,d,p,a,o,g,"underline")}if(i.strikethrough){const p=u-n.fontMetrics.fontSize*.3;this.createDecorationLine(t,v,p,d,p,a,o,g,"strikethrough")}if(i.overline){const p=u-n.fontMetrics.fontSize*.8;this.createDecorationLine(t,v,p,d,p,a,o,g,"overline")}})}createDecorationLine(t,n,l,i,s,a,o,g,c){const b=document.createElementNS("http://www.w3.org/2000/svg","line");b.setAttribute("x1",n.toString()),b.setAttribute("y1",l.toString()),b.setAttribute("x2",i.toString()),b.setAttribute("y2",s.toString()),b.setAttribute("stroke",a),b.setAttribute("stroke-width",o.toString()),b.setAttribute("stroke-dasharray",g),b.setAttribute("class",`text-decoration-${c}`),t.appendChild(b)}getTextAnchor(t){switch(t){case"Center":return"middle";case"Right":return"end";case"Left":default:return"start"}}applyTextTransform(t,n){switch(n){case"uppercase":return t.toUpperCase();case"lowercase":return t.toLowerCase();case"capitalize":return t.charAt(0).toUpperCase()+t.slice(1).toLowerCase();default:return t}}}const _l=new $l;var xl=f("<button class=search-clear title=Ê∏ÖÈô§ÊêúÁ¥¢>‚úï"),Sl=f('<div class=style-picker-container><div class=style-categories></div><div class=style-search><div class=search-input-container><span class=search-icon>üîç</span><input type=text placeholder=ÊêúÁ¥¢Ê†∑Âºè... class=search-input></div></div><div class=style-grid><div class="style-card create-style-card"><div class=create-style-content><div class=create-style-icon>‚ûï</div><div class=create-style-label>Êñ∞Âª∫Ê†∑Âºè</div></div></div></div><div class=style-stats><span class=stats-text> ‰∏™Ê†∑Âºè'),wl=f("<button><span class=category-icon></span><span class=category-label>"),Cl=f("<div><div class=style-preview></div><div class=style-info><div class=style-name></div><div class=style-meta><span class=style-category></span></div></div><div class=style-actions>"),kl=f("<span class=usage-count>"),Tl=f("<button class=edit-button title=ÁºñËæëÊ†∑Âºè>‚úèÔ∏è"),El=f("<span class=system-badge title=Á≥ªÁªüÈ¢ÑËÆæÊ†∑Âºè>üîí"),Ll=f("<div class=selection-indicator>‚úì");const Dl=e=>{const[t,n]=Z("bank-special"),[l,i]=Z(""),[s,a]=Z([]);(async()=>{await Ne.initialize();const m=Ne.getStylesByCategory();a(m)})();const g=Ce(()=>{let m=s();t()&&(m=m.filter(d=>d.category===t()));const v=l().toLowerCase().trim();return v&&(m=m.filter(d=>d.name.toLowerCase().includes(v)||d.description.toLowerCase().includes(v)||d.metadata.tags.some(p=>p.toLowerCase().includes(v)))),m}),c=[{key:"bank-special",label:"Èì∂Ë°å‰∏ìÁî®",icon:"üè¶"},{key:"heading",label:"Ê†áÈ¢ò",icon:"üì∞"},{key:"body",label:"Ê≠£Êñá",icon:"üìù"},{key:"caption",label:"ËØ¥Êòé",icon:"üí¨"},{key:"custom",label:"Ëá™ÂÆö‰πâ",icon:"‚öôÔ∏è"}],b=m=>{console.log("üéØ ÈÄâÊã©Ê†∑Âºè:",m),e.onStyleSelect(m)},u=m=>{n(m),console.log("üìÇ ÂàáÊç¢ÂàÜÁ±ª:",m)};return(()=>{var m=Sl(),v=m.firstChild,d=v.nextSibling,p=d.firstChild,_=p.firstChild,y=_.nextSibling,$=d.nextSibling,C=$.firstChild,k=$.nextSibling,E=k.firstChild,D=E.firstChild;return r(v,h(oe,{each:c,children:L=>(()=>{var O=wl(),K=O.firstChild,R=K.nextSibling;return O.$$click=()=>u(L.key),r(K,()=>L.icon),r(R,()=>L.label),A(P=>{var S=`category-button ${t()===L.key?"active":""}`,Q=L.label;return S!==P.e&&_e(O,P.e=S),Q!==P.t&&q(O,"title",P.t=Q),P},{e:void 0,t:void 0}),O})()})),y.$$input=L=>i(L.target.value),r(p,h(M,{get when(){return l()},get children(){var L=xl();return L.$$click=()=>i(""),L}}),null),r($,h(oe,{get each(){return g()},children:L=>h(Pl,{style:L,get selected(){return e.selectedStyleId===L.id},onClick:()=>b(L.id),onEdit:()=>e.onStyleEdit(L.id)})}),C),Te(C,"click",e.onStyleCreate),r(E,()=>g().length,D),r(E,(()=>{var L=xe(()=>!!l());return()=>L()&&` (ÊêúÁ¥¢: "${l()}")`})(),null),A(()=>y.value=l()),m})()},Pl=e=>{const t=()=>{switch(e.style.category){case"bank-special":return e.style.id.includes("amount")?"¬•123,456.78":e.style.id.includes("account")?"6222 0012 3456 7890":e.style.id.includes("institution")?e.style.name:e.style.id.includes("date")?"2025-08-19":e.style.name;case"heading":return e.style.name;case"body":return"Ê≠£ÊñáÁ§∫‰æãÊñáÂ≠ó Abc";case"caption":return"ËØ¥ÊòéÊñáÂ≠ó";default:return e.style.name}},n=Ce(()=>{var a,o,g,c,b,u,m,v;const s=e.style.style;return{fontFamily:s.font_family,fontSize:`${Math.min(s.font_size,14)}px`,fontWeight:s.font_weight,color:((g=(o=(a=s.fills)==null?void 0:a[0])==null?void 0:o.solid)==null?void 0:g.color)||s.color,textAlign:s.align.toLowerCase(),letterSpacing:`${((c=s.typography)==null?void 0:c.letterSpacing)||0}px`,textDecoration:(u=(b=s.typography)==null?void 0:b.decoration)!=null&&u.underline?"underline":(v=(m=s.typography)==null?void 0:m.decoration)!=null&&v.strikethrough?"line-through":"none"}}),l=s=>{s.preventDefault(),e.onClick()},i=s=>{s.preventDefault(),s.stopPropagation(),e.onEdit()};return(()=>{var s=Cl(),a=s.firstChild,o=a.nextSibling,g=o.firstChild,c=g.nextSibling,b=c.firstChild,u=o.nextSibling;return s.$$click=l,r(a,t),r(g,()=>e.style.name),r(b,()=>Al(e.style.category)),r(c,(()=>{var m=xe(()=>e.style.metadata.usageCount>0);return()=>m()&&(()=>{var v=kl();return r(v,()=>e.style.metadata.usageCount),A(()=>q(v,"title",`‰ΩøÁî®Ê¨°Êï∞: ${e.style.metadata.usageCount}`)),v})()})(),null),r(u,(()=>{var m=xe(()=>!e.style.metadata.isSystemStyle);return()=>m()&&(()=>{var v=Tl();return v.$$click=i,v})()})(),null),r(u,(()=>{var m=xe(()=>!!e.style.metadata.isSystemStyle);return()=>m()&&El()})(),null),r(s,(()=>{var m=xe(()=>!!e.selected);return()=>m()&&Ll()})(),null),A(m=>{var v=`style-card ${e.selected?"selected":""} ${e.style.metadata.isSystemStyle?"system-style":"user-style"}`,d=n();return v!==m.e&&_e(s,m.e=v),m.t=dn(a,d,m.t),m},{e:void 0,t:void 0}),s})()};function Al(e){return{"bank-special":"Èì∂Ë°å",heading:"Ê†áÈ¢ò",body:"Ê≠£Êñá",caption:"ËØ¥Êòé",custom:"Ëá™ÂÆö‰πâ"}[e]||e}Pe(["input","click"]);var zl=f("<button class=style-picker-toggle>"),Rl=f("<button class=style-reload-btn title=ÈáçÊñ∞Âä†ËΩΩÊ†∑ÂºèÁ≥ªÁªü>üîÑ"),Ml=f("<div class=initialization-fallback><div class=fallback-content><span class=fallback-icon>‚è≥</span><span class=fallback-text>‰∏ì‰∏öÊ†∑ÂºèÁ≥ªÁªüÂä†ËΩΩ‰∏≠...</span><div class=fallback-actions><button class=retry-btn>ÈáçËØïÂä†ËΩΩ"),Nl=f("<div class=quick-style-actions><button class=apply-style-btn><span class=btn-icon>üé®</span><span class=btn-text>ÈÄâÊã©Ê†∑Âºè</span></button><button class=create-style-btn title=Âü∫‰∫éÂΩìÂâçËÆæÁΩÆÂàõÂª∫Êñ∞Ê†∑Âºè><span class=btn-icon>‚ûï</span><span class=btn-text>Êñ∞Âª∫"),Ol=f("<div class=style-picker-panel>"),Il=f("<div class=property-group><div class=property-group-title><span>üìê</span><span>ÊéíÁâàÊéßÂà∂</span><div class=coming-soon-badge>Âç≥Â∞ÜÊé®Âá∫</div></div><div class=property-group-content><div class=typography-controls-placeholder><div class=placeholder-content><span class=placeholder-icon>‚öôÔ∏è</span><span class=placeholder-text>È´òÁ∫ßÊéíÁâàÊéßÂà∂ÂäüËÉΩ</span><span class=placeholder-subtitle>Â≠óÈó¥Ë∑ù„ÄÅË°åÈ´ò„ÄÅË£ÖÈ•∞Á≠â"),Ul=f("<div class=property-group><div class=property-group-title><span>‚ú®</span><span>ËßÜËßâÊïàÊûú</span><div class=coming-soon-badge>Âç≥Â∞ÜÊé®Âá∫</div></div><div class=property-group-content><div class=effects-controls-placeholder><div class=placeholder-content><span class=placeholder-icon>üåà</span><span class=placeholder-text>Â§öÈáçÂ°´ÂÖÖ & Èò¥ÂΩ±ÊïàÊûú</span><span class=placeholder-subtitle>Ê∏êÂèò„ÄÅÊäïÂΩ±„ÄÅÂèëÂÖâÁ≠â"),Fl=f('<div class="property-group debug-panel"><div class=property-group-title><span>üîß</span><span>Ë∞ÉËØï‰ø°ÊÅØ</span></div><div class=property-group-content><div class=debug-info><div class=debug-item><span class=debug-label>ÂÖÉÁ¥†ID:</span><span class=debug-value></span></div><div class=debug-item><span class=debug-label>ÂΩìÂâçÊ†∑ÂºèID:</span><span class=debug-value></span></div><div class=debug-item><span class=debug-label>ÂèØÁî®Ê†∑Âºè:</span><span class=debug-value> ‰∏™</span></div><div class=debug-item><span class=debug-label>‰ΩøÁî®‰∏ì‰∏öÊ∏≤Êüì:</span><span class=debug-value>'),Bl=f("<div class=professional-text-properties><div class=property-group><div class=property-group-title><span>üé®</span><span>‰∏ì‰∏öÊñáÂ≠óÊ†∑Âºè</span><div class=property-group-actions></div></div><div class=property-group-content>"),ql=f('<div class=current-style-info><div class=current-style-preview><div class=style-preview-badge><span class=style-name></span><span class=style-category></span></div><div class=style-actions><button class="style-action-btn edit-btn"title=ÁºñËæëÊ†∑Âºè>‚úèÔ∏è</button><button class="style-action-btn remove-btn"title=ÁßªÈô§Ê†∑Âºè>üóëÔ∏è');const Jt=e=>{const[t,n]=Z(null),[l,i]=Z(!1),[s,a]=Z([]),[o,g]=Z(!1);Ue(async()=>{try{await Ne.initialize();const y=Ne.getElementStyleId(e.element.id);n(y);const $=Ne.getStylesByCategory();a($),g(!0),console.log("üé® ProfessionalTextPropertiesPanel ÂàùÂßãÂåñÂÆåÊàê")}catch(y){console.error("‚ùå ‰∏ì‰∏öÊñáÂ≠óÂ±ûÊÄßÈù¢ÊùøÂàùÂßãÂåñÂ§±Ë¥•:",y)}});const c=Ce(()=>{const y=t();return y?Ne.getStyle(y):null}),b=Ce(()=>e.element.content.type==="Text"||e.element.content.type==="DataField"),u=async y=>{try{const $=await Ne.applyStyleToElement(e.element.id,y);if($.success){n(y);const C=Ne.getStyle(y);if(C){const k=m(C.style);e.onUpdate(e.element.id,"content",{...e.element.content,style:k})}console.log("‚úÖ Ê†∑ÂºèÂ∫îÁî®ÊàêÂäü:",$)}else console.error("‚ùå Ê†∑ÂºèÂ∫îÁî®Â§±Ë¥•:",$.error)}catch($){console.error("‚ùå Ê†∑ÂºèÈÄâÊã©Â§ÑÁêÜÂ§±Ë¥•:",$)}},m=y=>{var $,C,k;return{font_family:y.font_family,font_size:y.font_size,font_weight:y.font_weight,color:((k=(C=($=y.fills)==null?void 0:$[0])==null?void 0:C.solid)==null?void 0:k.color)||y.color,align:y.align}},v=()=>{console.log("üÜï ÂàõÂª∫Êñ∞Ê†∑Âºè")},d=y=>{console.log("‚úèÔ∏è ÁºñËæëÊ†∑Âºè:",y)},p=()=>{i(!l())},_=()=>{t()&&(Ne.removeElementStyle(e.element.id),n(null),console.log("üóëÔ∏è ÁßªÈô§ÂÖÉÁ¥†Ê†∑Âºè"))};return b()?(()=>{var y=Bl(),$=y.firstChild,C=$.firstChild,k=C.firstChild,E=k.nextSibling,D=E.nextSibling,L=C.nextSibling;return r(D,h(M,{get when(){return o()},get children(){var O=zl();return O.$$click=p,r(O,()=>l()?"üìù":"üìö"),A(()=>q(O,"title",l()?"ÈöêËóèÊ†∑ÂºèÂ∫ì":"ÊòæÁ§∫Ê†∑ÂºèÂ∫ì")),O}}),null),r(D,h(M,{get when(){return!o()},get children(){var O=Rl();return O.$$click=()=>window.location.reload(),O}}),null),r(L,h(M,{get when(){return!o()},get children(){var O=Ml(),K=O.firstChild,R=K.firstChild,P=R.nextSibling,S=P.nextSibling,Q=S.firstChild;return Q.$$click=async()=>{try{await Ne.initialize();const B=Ne.getStylesByCategory();a(B),g(!0),console.log("üîÑ Ê†∑ÂºèÁ≥ªÁªüÈáçÊñ∞ÂàùÂßãÂåñÊàêÂäü")}catch(B){console.error("‚ùå ÈáçÊñ∞ÂàùÂßãÂåñÂ§±Ë¥•:",B)}},O}}),null),r(L,h(M,{get when(){return o()},get children(){return[h(M,{get when(){return c()},children:O=>(()=>{var K=ql(),R=K.firstChild,P=R.firstChild,S=P.firstChild,Q=S.nextSibling,B=P.nextSibling,w=B.firstChild,z=w.nextSibling;return r(S,()=>O().name),r(Q,()=>jl(O().category)),w.$$click=()=>d(O().id),z.$$click=_,K})()}),h(M,{get when(){return!c()},get children(){var O=Nl(),K=O.firstChild,R=K.nextSibling;return K.$$click=p,R.$$click=v,O}}),h(M,{get when(){return l()},get children(){var O=Ol();return r(O,h(Dl,{get selectedStyleId(){return t()},onStyleSelect:u,onStyleCreate:v,onStyleEdit:d})),O}})]}}),null),r(y,h(M,{get when(){return c()},get children(){return Il()}}),null),r(y,h(M,{get when(){return c()},get children(){return Ul()}}),null),r(y,h(M,{get when(){return!1},get children(){var O=Fl(),K=O.firstChild,R=K.nextSibling,P=R.firstChild,S=P.firstChild,Q=S.firstChild,B=Q.nextSibling,w=S.nextSibling,z=w.firstChild,N=z.nextSibling,U=w.nextSibling,H=U.firstChild,J=H.nextSibling,me=J.firstChild,X=U.nextSibling,j=X.firstChild,se=j.nextSibling;return r(B,()=>e.element.id),r(N,()=>t()||"Êó†"),r(J,()=>s().length,me),r(se,()=>_l.isElementUsingProfessionalStyle(e.element.id)?"ÊòØ":"Âê¶"),O}}),null),y})():null};function jl(e){return{"bank-special":"Èì∂Ë°å",heading:"Ê†áÈ¢ò",body:"Ê≠£Êñá",caption:"ËØ¥Êòé",custom:"Ëá™ÂÆö‰πâ"}[e]||e}Pe(["click"]);var Hl=f('<div class="flex flex-col h-auto"><div class="p-4 border-b border-default"><h2 class="text-lg font-semibold text-primary">Â±ûÊÄßÈù¢Êùø</h2></div><div class=p-0>'),Ql=f('<div class="p-4 text-center text-muted"><svg class="w-12 h-12 mx-auto mb-2 opacity-50"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"></path></svg><p class=text-sm>ÈÄâÊã©ÂÖÉÁ¥†‰ª•Êü•ÁúãÂ±ûÊÄß'),Jl=f("<span class=property-value>"),Vl=f('<span class="property-value text-xs text-muted">'),xt=f("<div class=space-y-2>"),st=f("<input type=number class=property-input>"),Wl=f('<div class="grid grid-cols-2 gap-2">'),Vt=f("<input type=checkbox class=property-checkbox>"),Gl=f('<div class="p-4 space-y-4">'),Wt=f("<div>"),Kl=f("<div class=property-group><div class=property-group-title><span></span><span></span></div><div class=property-group-content>"),Yl=f("<div class=property-field><label class=property-label>"),Xl=f("<textarea class=property-textarea rows=2 placeholder=ËæìÂÖ•ÊñáÊú¨ÂÜÖÂÆπ...>"),yn=f('<select class=property-select><option value=SimSun>ÂÆã‰Ωì</option><option value=SimHei>Èªë‰Ωì</option><option value="Microsoft YaHei">ÂæÆËΩØÈõÖÈªë</option><option value=KaiTi>Ê•∑‰Ωì</option><option value=Arial>Arial</option><option value="Times New Roman">Times New Roman</option><option value=Helvetica>Helvetica'),$n=f("<select class=property-select><option value=normal>Ê≠£Â∏∏</option><option value=bold>Á≤ó‰Ωì</option><option value=lighter>ÁªÜ‰Ωì</option><option value=100>100</option><option value=200>200</option><option value=300>300</option><option value=400>400</option><option value=500>500</option><option value=600>600</option><option value=700>700</option><option value=800>800</option><option value=900>900"),Zl=f('<div class=space-y-2><div class="grid grid-cols-2 gap-2">'),_n=f("<select class=property-select><option value=Solid>ÂÆûÁ∫ø</option><option value=Dashed>ËôöÁ∫ø</option><option value=Dotted>ÁÇπÁ∫ø"),ei=f('<div class=space-y-2><div class="grid grid-cols-3 gap-2">'),xn=f('<div class=space-y-3><div class="grid grid-cols-2 gap-2"></div><div class="grid grid-cols-2 gap-2">'),Sn=f('<div class="flex gap-2 items-center"><input type=range class="property-slider flex-1"min=0 max=100 step=1><span class="property-value w-12 text-center">%'),ti=f('<div class=space-y-3><div class=space-y-2><div class="grid grid-cols-2 gap-2">'),ni=f("<select class=property-select><option value=Solid>ÂÆûÁ∫ø</option><option value=Dashed>ËôöÁ∫ø</option><option value=Dotted>ÁÇπÁ∫ø</option><option value=DashDot>ÁÇπÂàíÁ∫ø"),Gt=f("<select class=property-select><option value=None>Êó†</option><option value=Arrow>ÁÆ≠Â§¥</option><option value=Circle>ÂúÜÁÇπ</option><option value=Square>ÊñπÂùó"),li=f('<div class=space-y-3><div class="grid grid-cols-2 gap-2">'),ii=f("<input type=text class=property-input placeholder=https://example.com/image.jpg>"),si=f("<input type=text class=property-input placeholder=ÂõæÁâáÊèèËø∞ÊñáÂ≠ó>"),ri=f("<div class=property-image-preview><div class=property-image-placeholder><span>üì∑ Êó†ÂõæÁâá"),ai=f("<div class=space-y-3>"),oi=f("<img class=property-image>"),ci=f("<div class=property-loading>Âä†ËΩΩÊï∞ÊçÆÊ∫ê..."),di=f('<div class=data-source-info><div class="text-xs text-muted"><div><span class=font-medium>Áä∂ÊÄÅ:</span> <span></span></div><div><span class=font-medium>Á±ªÂûã:</span> </div><div><span class=font-medium>Êõ¥Êñ∞:</span> '),ui=f('<input type=text class=property-input placeholder="{name} Êàñ {user.email} Ê†ºÂºè"title="‰ΩøÁî® {fieldName} ËØ≠Ê≥ïÂºïÁî®Êï∞ÊçÆÂ≠óÊÆµÔºåÂ¶Ç {name}, {price}, {user.email} Á≠â">'),gi=f('<div class="text-xs text-blue-600">üí° ÊèêÁ§∫: ‰ΩøÁî® {fieldName} ËØ≠Ê≥ïÔºåÂ¶Ç {name}, {price}, {user.email} Á≠â'),hi=f('<div class="text-xs text-orange-600">‚ö†Ô∏è Ê≥®ÊÑè: ÈÄâÊã©Êï∞ÊçÆÊ∫êÂêéË°®ËææÂºèÊâçËÉΩÂú®È¢ÑËßàÊ®°Âºè‰∏ãÊ±ÇÂÄº'),vi=f("<select class=property-select><option value=default>ÈªòËÆ§</option><option value=currency>Ë¥ßÂ∏Å</option><option value=date>Êó•Êúü</option><option value=datetime>Êó•ÊúüÊó∂Èó¥</option><option value=number>Êï∞Â≠ó"),fi=f("<div class=space-y-4>"),mi=f("<select class=property-select><option value>ÈÄâÊã©Êï∞ÊçÆÊ∫ê"),bi=f("<option> (<!>)"),pi=f('<div class=flex><input type=number class="property-input flex-1">'),yi=f("<span class=property-unit>"),$i=f('<div class="flex gap-2"><div class=property-color-wrapper><input type=color class=property-color><div class=property-color-preview></div></div><input type=text class="property-input flex-1"placeholder=#000000>'),_i=f("<div class=property-alignment-group>"),xi=f("<button>");const Si=()=>{const{state:e,updateElement:t}=Ve(),n=Ce(()=>{const s=new Set(e.selected_ids);return e.elements.filter(a=>s.has(a.id))}),l=Ce(()=>n()[0]),i=async(s,a,o)=>{try{await t(s,{[a]:o})}catch(g){console.error("Failed to update element property:",g)}};return(()=>{var s=Hl(),a=s.firstChild,o=a.nextSibling;return r(o,h(M,{get when(){return l()},get fallback(){return Ql()},get children(){return h(wi,{get element(){return l()},onUpdate:i})}})),s})()},wi=e=>{const t=(l,i)=>{const s={...e.element.position,[l]:i};e.onUpdate(e.element.id,"position",s)},n=(l,i)=>{const s={...e.element.size,[l]:Math.max(1,i)};e.onUpdate(e.element.id,"size",s)};return(()=>{var l=Gl();return r(l,h(Qe,{title:"ÂÖÉÁ¥†‰ø°ÊÅØ",icon:"‚ÑπÔ∏è",get children(){var i=xt();return r(i,h($e,{label:"Á±ªÂûã",get children(){var s=Jl();return r(s,()=>e.element.content.type),s}}),null),r(i,h($e,{label:"ID",get children(){var s=Vl();return r(s,()=>e.element.id),s}}),null),i}}),null),r(l,h(Qe,{title:"‰ΩçÁΩÆÂíåÂ§ßÂ∞è",icon:"üìê",get children(){var i=Wl();return r(i,h($e,{label:"X",get children(){var s=st();return s.$$input=a=>t("x",parseFloat(a.target.value)||0),A(()=>s.value=e.element.position.x),s}}),null),r(i,h($e,{label:"Y",get children(){var s=st();return s.$$input=a=>t("y",parseFloat(a.target.value)||0),A(()=>s.value=e.element.position.y),s}}),null),r(i,h($e,{label:"ÂÆΩÂ∫¶",get children(){var s=st();return s.$$input=a=>n("width",parseFloat(a.target.value)||1),A(()=>s.value=e.element.size.width),s}}),null),r(i,h($e,{label:"È´òÂ∫¶",get children(){var s=st();return s.$$input=a=>n("height",parseFloat(a.target.value)||1),A(()=>s.value=e.element.size.height),s}}),null),i}}),null),r(l,h(Qe,{title:"Áä∂ÊÄÅ",icon:"üëÅÔ∏è",get children(){var i=xt();return r(i,h($e,{label:"ÂèØËßÅ",get children(){var s=Vt();return s.addEventListener("change",a=>e.onUpdate(e.element.id,"visible",a.target.checked)),A(()=>s.checked=e.element.visible),s}}),null),r(i,h($e,{label:"ÈîÅÂÆö",get children(){var s=Vt();return s.addEventListener("change",a=>e.onUpdate(e.element.id,"locked",a.target.checked)),A(()=>s.checked=e.element.locked),s}}),null),r(i,h($e,{label:"Â±ÇÁ∫ß",get children(){var s=st();return s.$$input=a=>e.onUpdate(e.element.id,"z_index",parseInt(a.target.value)||0),A(()=>s.value=e.element.z_index),s}}),null),i}}),null),r(l,h(Fn,{get children(){return[h(it,{get when(){return e.element.content.type==="Text"&&e.element.content},children:i=>(()=>{var s=Wt();return r(s,h(Jt,{get element(){return e.element},get onUpdate(){return e.onUpdate}}),null),r(s,h(Ci,{get content(){return i()},onUpdate:a=>{console.log("Text content update:",a),e.onUpdate(e.element.id,"content",a)}}),null),s})()}),h(it,{get when(){return e.element.content.type==="Rectangle"&&e.element.content},children:i=>h(ki,{get content(){return i()},onUpdate:s=>{console.log("Rectangle content update:",s),e.onUpdate(e.element.id,"content",s)}})}),h(it,{get when(){return e.element.content.type==="Line"&&e.element.content},children:i=>h(Ti,{get content(){return i()},onUpdate:s=>{console.log("Line content update:",s),e.onUpdate(e.element.id,"content",s)}})}),h(it,{get when(){return e.element.content.type==="Image"&&e.element.content},children:i=>h(Ei,{get content(){return i()},onUpdate:s=>{console.log("Image content update:",s),e.onUpdate(e.element.id,"content",s)}})}),h(it,{get when(){return e.element.content.type==="DataField"&&e.element.content},children:i=>(()=>{var s=Wt();return r(s,h(Jt,{get element(){return e.element},get onUpdate(){return e.onUpdate}}),null),r(s,h(Li,{get content(){return i()},onUpdate:a=>{console.log("DataField content update:",a),e.onUpdate(e.element.id,"content",a)}}),null),s})()})]}}),null),l})()},Qe=e=>(()=>{var t=Kl(),n=t.firstChild,l=n.firstChild,i=l.nextSibling,s=n.nextSibling;return r(l,()=>e.icon),r(i,()=>e.title),r(s,()=>e.children),t})(),$e=e=>(()=>{var t=Yl(),n=t.firstChild;return r(n,()=>e.label),r(t,()=>e.children,null),t})(),Ci=e=>h(Qe,{title:"ÊñáÂ≠óÊ†∑Âºè",icon:"üî§",get children(){var t=xn(),n=t.firstChild,l=n.nextSibling;return r(t,h($e,{label:"ÂÜÖÂÆπ",get children(){var i=Xl();return i.$$input=s=>e.onUpdate({content:s.target.value}),A(()=>i.value=e.content.content),i}}),n),r(n,h($e,{label:"Â≠ó‰Ωì",get children(){var i=yn();return i.addEventListener("change",s=>e.onUpdate({style:{...e.content.style,font_family:s.target.value}})),A(()=>i.value=e.content.style.font_family),i}}),null),r(n,h($e,{label:"Â§ßÂ∞è",get children(){return h(je,{get value(){return e.content.style.font_size},min:6,max:72,step:1,unit:"px",onUpdate:i=>e.onUpdate({style:{...e.content.style,font_size:i}})})}}),null),r(l,h($e,{label:"Â≠óÈáç",get children(){var i=$n();return i.addEventListener("change",s=>e.onUpdate({style:{...e.content.style,font_weight:s.target.value}})),A(()=>i.value=e.content.style.font_weight),i}}),null),r(l,h($e,{label:"ÂØπÈΩê",get children(){return h(wn,{get value(){return e.content.style.align},onUpdate:i=>e.onUpdate({style:{...e.content.style,align:i}})})}}),null),r(t,h($e,{label:"È¢úËâ≤",get children(){return h(Ge,{get value(){return e.content.style.color},onUpdate:i=>e.onUpdate({style:{...e.content.style,color:i}})})}}),null),r(t,h($e,{label:"ËÉåÊôØ",get children(){var i=Zl(),s=i.firstChild;return r(i,h(Ge,{get value(){var a;return((a=e.content.style.background)==null?void 0:a.color)||"transparent"},onUpdate:a=>e.onUpdate({style:{...e.content.style,background:{...e.content.style.background,color:a}}})}),s),r(s,h($e,{label:"ÈÄèÊòéÂ∫¶",get children(){return h(je,{get value(){var a;return((a=e.content.style.background)==null?void 0:a.opacity)||1},min:0,max:1,step:.1,onUpdate:a=>e.onUpdate({style:{...e.content.style,background:{...e.content.style.background,opacity:a}}})})}}),null),r(s,h($e,{label:"ÂÜÖËæπË∑ù",get children(){return h(je,{get value(){var a;return((a=e.content.style.background)==null?void 0:a.padding)||0},min:0,max:20,step:1,unit:"px",onUpdate:a=>e.onUpdate({style:{...e.content.style,background:{...e.content.style.background,padding:a}}})})}}),null),i}}),null),r(t,h($e,{label:"ËæπÊ°Ü",get children(){var i=ei(),s=i.firstChild;return r(i,h(Ge,{get value(){var a;return((a=e.content.style.border)==null?void 0:a.color)||"#000000"},onUpdate:a=>e.onUpdate({style:{...e.content.style,border:{...e.content.style.border,color:a}}})}),s),r(s,h($e,{label:"ÂÆΩÂ∫¶",get children(){return h(je,{get value(){var a;return((a=e.content.style.border)==null?void 0:a.width)||1},min:0,max:10,step:.5,unit:"px",onUpdate:a=>e.onUpdate({style:{...e.content.style,border:{...e.content.style.border,width:a}}})})}}),null),r(s,h($e,{label:"Ê†∑Âºè",get children(){var a=_n();return a.addEventListener("change",o=>e.onUpdate({style:{...e.content.style,border:{...e.content.style.border,style:o.target.value}}})),A(()=>{var o;return a.value=((o=e.content.style.border)==null?void 0:o.style)||"Solid"}),a}}),null),r(s,h($e,{label:"ÂúÜËßí",get children(){return h(je,{get value(){var a;return((a=e.content.style.border)==null?void 0:a.radius)||0},min:0,max:20,step:1,unit:"px",onUpdate:a=>e.onUpdate({style:{...e.content.style,border:{...e.content.style.border,radius:a}}})})}}),null),i}}),null),t}}),ki=e=>h(Qe,{title:"Áü©ÂΩ¢Ê†∑Âºè",icon:"‚ñ≠",get children(){var t=ti(),n=t.firstChild,l=n.firstChild;return r(t,h($e,{label:"Â°´ÂÖÖÈ¢úËâ≤",get children(){return h(Ge,{get value(){return e.content.fill_color||"#ffffff"},onUpdate:i=>e.onUpdate({fill_color:i})})}}),n),r(n,h($e,{label:"ËæπÊ°Ü",get children(){var i=xt();return r(i,h(Ge,{get value(){var s;return((s=e.content.border)==null?void 0:s.color)||"#000000"},onUpdate:s=>e.onUpdate({border:{...e.content.border,color:s}})})),i}}),l),r(l,h($e,{label:"ÂÆΩÂ∫¶",get children(){return h(je,{get value(){var i;return((i=e.content.border)==null?void 0:i.width)||1},min:0,max:20,step:.5,unit:"px",onUpdate:i=>e.onUpdate({border:{...e.content.border,width:i}})})}}),null),r(l,h($e,{label:"Ê†∑Âºè",get children(){var i=_n();return i.addEventListener("change",s=>e.onUpdate({border:{...e.content.border,style:s.target.value}})),A(()=>{var s;return i.value=((s=e.content.border)==null?void 0:s.style)||"Solid"}),i}}),null),r(t,h($e,{label:"ÂúÜËßíÂçäÂæÑ",get children(){return h(je,{get value(){return e.content.corner_radius||0},min:0,max:50,step:1,unit:"px",onUpdate:i=>e.onUpdate({corner_radius:i})})}}),null),r(t,h($e,{label:"ÈÄèÊòéÂ∫¶",get children(){var i=Sn(),s=i.firstChild,a=s.nextSibling,o=a.firstChild;return s.$$input=g=>e.onUpdate({opacity:parseFloat(g.target.value)/100}),r(a,()=>Math.round((e.content.opacity||1)*100),o),A(()=>s.value=(e.content.opacity||1)*100),i}}),null),t}}),Ti=e=>h(Qe,{title:"Á∫øÊù°Ê†∑Âºè",icon:"‚îÅ",get children(){var t=li(),n=t.firstChild;return r(t,h($e,{label:"È¢úËâ≤",get children(){return h(Ge,{get value(){return e.content.color},onUpdate:l=>e.onUpdate({color:l})})}}),n),r(t,h($e,{label:"ÂÆΩÂ∫¶",get children(){return h(je,{get value(){return e.content.width},min:.5,max:20,step:.5,unit:"px",onUpdate:l=>e.onUpdate({width:l})})}}),n),r(t,h($e,{label:"Ê†∑Âºè",get children(){var l=ni();return l.addEventListener("change",i=>e.onUpdate({line_style:i.target.value})),A(()=>l.value=e.content.line_style||"Solid"),l}}),n),r(n,h($e,{label:"Ëµ∑ÁÇπ",get children(){var l=Gt();return l.addEventListener("change",i=>e.onUpdate({start_cap:i.target.value})),A(()=>l.value=e.content.start_cap||"None"),l}}),null),r(n,h($e,{label:"ÁªàÁÇπ",get children(){var l=Gt();return l.addEventListener("change",i=>e.onUpdate({end_cap:i.target.value})),A(()=>l.value=e.content.end_cap||"None"),l}}),null),r(t,h($e,{label:"ÈÄèÊòéÂ∫¶",get children(){var l=Sn(),i=l.firstChild,s=i.nextSibling,a=s.firstChild;return i.$$input=o=>e.onUpdate({opacity:parseFloat(o.target.value)/100}),r(s,()=>Math.round((e.content.opacity||1)*100),a),A(()=>i.value=(e.content.opacity||1)*100),l}}),null),t}}),Ei=e=>h(Qe,{title:"ÂõæÁâáÂ±ûÊÄß",icon:"üñºÔ∏è",get children(){var t=ai();return r(t,h($e,{label:"ÂõæÁâáÂú∞ÂùÄ",get children(){var n=ii();return n.$$input=l=>e.onUpdate({src:l.target.value}),A(()=>n.value=e.content.src),n}}),null),r(t,h($e,{label:"Êõø‰ª£ÊñáÊú¨",get children(){var n=si();return n.$$input=l=>e.onUpdate({alt:l.target.value}),A(()=>n.value=e.content.alt||""),n}}),null),r(t,h($e,{label:"È¢ÑËßà",get children(){var n=ri(),l=n.firstChild;return r(n,(()=>{var i=xe(()=>!!e.content.src);return()=>i()?(()=>{var s=oi();return s.addEventListener("load",a=>{const o=a.target,g=o.nextElementSibling;o&&(o.style.display="block"),g&&(g.style.display="none")}),s.addEventListener("error",a=>{const o=a.target,g=o.nextElementSibling;o&&(o.style.display="none"),g&&(g.style.display="flex")}),A(a=>{var o=e.content.src,g=e.content.alt||"ÂõæÁâáÈ¢ÑËßà";return o!==a.e&&q(s,"src",a.e=o),g!==a.t&&q(s,"alt",a.t=g),a},{e:void 0,t:void 0}),s})():null})(),l),A(i=>(i=e.content.src?"none":"flex")!=null?l.style.setProperty("display",i):l.style.removeProperty("display")),n}}),null),t}}),Li=e=>{const[t,n]=Z([]),[l,i]=Z(!1);Ue(async()=>{try{i(!0);const o=await we.listDataSources();n(o)}catch(o){console.error("Failed to load data sources:",o)}finally{i(!1)}});const s=o=>{e.onUpdate({data_source_id:o===""?void 0:o})},a=Ce(()=>e.content.data_source_id?t().find(o=>o.id===e.content.data_source_id):null);return(()=>{var o=fi();return r(o,h(Qe,{title:"Êï∞ÊçÆÊ∫êÈÖçÁΩÆ",icon:"üîó",get children(){var g=xt();return r(g,h($e,{label:"Êï∞ÊçÆÊ∫ê",get children(){return h(M,{get when(){return l()},get fallback(){return(()=>{var c=mi();return c.firstChild,c.addEventListener("change",b=>s(b.currentTarget.value)),r(c,h(oe,{get each(){return t()},children:b=>(()=>{var u=bi(),m=u.firstChild,v=m.nextSibling;return v.nextSibling,r(u,()=>b.name,m),r(u,()=>b.provider_type,v),A(()=>u.value=b.id),u})()}),null),A(()=>c.value=e.content.data_source_id||""),c})()},get children(){return ci()}})}}),null),r(g,h(M,{get when(){return a()},get children(){var c=di(),b=c.firstChild,u=b.firstChild,m=u.firstChild,v=m.nextSibling,d=v.nextSibling,p=u.nextSibling,_=p.firstChild;_.nextSibling;var y=p.nextSibling,$=y.firstChild;return $.nextSibling,r(d,(()=>{var C=xe(()=>a().status==="active");return()=>C()?"Ê¥ªË∑É":a().status==="error"?"ÈîôËØØ":"Á¶ÅÁî®"})()),r(p,()=>a().provider_type,null),r(y,()=>new Date(a().last_updated).toLocaleString("zh-CN"),null),A(()=>_e(d,a().status==="active"?"text-green-600":a().status==="error"?"text-red-600":"text-gray-600")),c}}),null),r(g,h($e,{label:"Ë°®ËææÂºè",get children(){var c=ui();return c.$$input=b=>e.onUpdate({expression:b.currentTarget.value}),c.disabled=!1,A(()=>c.value=e.content.expression||""),c}}),null),r(g,h(M,{get when(){return!e.content.expression||!e.content.expression.trim()},get children(){return gi()}}),null),r(g,h(M,{get when(){return e.content.expression&&!e.content.data_source_id},get children(){return hi()}}),null),r(g,h($e,{label:"Ê†ºÂºè",get children(){var c=vi();return c.addEventListener("change",b=>e.onUpdate({format:b.currentTarget.value==="default"?void 0:b.currentTarget.value})),A(()=>c.value=e.content.format||"default"),c}}),null),g}}),null),r(o,h(Qe,{title:"Â≠óÊÆµÊ†∑Âºè",icon:"üé®",get children(){var g=xn(),c=g.firstChild,b=c.nextSibling;return r(c,h($e,{label:"Â≠ó‰Ωì",get children(){var u=yn();return u.addEventListener("change",m=>e.onUpdate({style:{...e.content.style,font_family:m.currentTarget.value}})),A(()=>u.value=e.content.style.font_family),u}}),null),r(c,h($e,{label:"Â§ßÂ∞è",get children(){return h(je,{get value(){return e.content.style.font_size},min:6,max:72,step:1,unit:"px",onUpdate:u=>e.onUpdate({style:{...e.content.style,font_size:u}})})}}),null),r(b,h($e,{label:"Â≠óÈáç",get children(){var u=$n();return u.addEventListener("change",m=>e.onUpdate({style:{...e.content.style,font_weight:m.currentTarget.value}})),A(()=>u.value=e.content.style.font_weight),u}}),null),r(b,h($e,{label:"ÂØπÈΩê",get children(){return h(wn,{get value(){return e.content.style.align},onUpdate:u=>e.onUpdate({style:{...e.content.style,align:u}})})}}),null),r(g,h($e,{label:"È¢úËâ≤",get children(){return h(Ge,{get value(){return e.content.style.color},onUpdate:u=>e.onUpdate({style:{...e.content.style,color:u}})})}}),null),g}}),null),o})()},je=e=>(()=>{var t=pi(),n=t.firstChild;return n.addEventListener("blur",l=>{const i=parseFloat(l.target.value)||e.value,s=Math.max(e.min||-1/0,Math.min(e.max||1/0,i));s!==i&&(l.target.value=s.toString(),e.onUpdate(s))}),n.$$input=l=>{const i=parseFloat(l.target.value);if(!isNaN(i)){const s=Math.max(e.min||-1/0,Math.min(e.max||1/0,i));e.onUpdate(s)}},r(t,(()=>{var l=xe(()=>!!e.unit);return()=>l()&&(()=>{var i=yi();return r(i,()=>e.unit),i})()})(),null),A(l=>{var i=e.min,s=e.max,a=e.step||1;return i!==l.e&&q(n,"min",l.e=i),s!==l.t&&q(n,"max",l.t=s),a!==l.a&&q(n,"step",l.a=a),l},{e:void 0,t:void 0,a:void 0}),A(()=>n.value=e.value),t})(),Ge=e=>(()=>{var t=$i(),n=t.firstChild,l=n.firstChild,i=l.nextSibling,s=n.nextSibling;return l.$$input=a=>e.onUpdate(a.target.value),s.$$input=a=>{const o=a.target.value;(/^#[0-9A-Fa-f]{6}$/.test(o)||/^#[0-9A-Fa-f]{3}$/.test(o))&&e.onUpdate(o)},A(a=>(a=e.value)!=null?i.style.setProperty("background-color",a):i.style.removeProperty("background-color")),A(()=>l.value=e.value),A(()=>s.value=e.value),t})(),wn=e=>{const t=[{value:"Left",icon:"‚¨ÖÔ∏è",label:"Â∑¶ÂØπÈΩê"},{value:"Center",icon:"‚ÜîÔ∏è",label:"Â±Ö‰∏≠"},{value:"Right",icon:"‚û°Ô∏è",label:"Âè≥ÂØπÈΩê"}];return(()=>{var n=_i();return r(n,()=>t.map(l=>(()=>{var i=xi();return i.$$click=()=>e.onUpdate(l.value),r(i,()=>l.icon),A(s=>{var a=`property-alignment-btn ${e.value===l.value?"active":""}`,o=l.label;return a!==s.e&&_e(i,s.e=a),o!==s.t&&q(i,"title",s.t=o),s},{e:void 0,t:void 0}),i})())),n})()};Pe(["input","click"]);var Di=f("<svg><defs><pattern id=canvas-grid patternUnits=userSpaceOnUse><line y1=0 stroke=#cbd5e1 stroke-width=0.5 opacity=0.8></line><line x1=0 stroke=#cbd5e1 stroke-width=0.5 opacity=0.8></svg>",!1,!0,!1),Pi=f("<svg><rect fill=url(#canvas-grid)></svg>",!1,!0,!1);const Ai=e=>h(M,{get when(){return e.config.show_grid},get children(){return[(()=>{var t=Di(),n=t.firstChild,l=n.firstChild,i=l.nextSibling;return A(s=>{var a=e.config.grid_size,o=e.config.grid_size,g=e.config.grid_size,c=e.config.grid_size,b=e.config.grid_size,u=e.config.grid_size,m=e.config.grid_size,v=e.config.grid_size;return a!==s.e&&q(n,"width",s.e=a),o!==s.t&&q(n,"height",s.t=o),g!==s.a&&q(l,"x1",s.a=g),c!==s.o&&q(l,"x2",s.o=c),b!==s.i&&q(l,"y2",s.i=b),u!==s.n&&q(i,"y1",s.n=u),m!==s.s&&q(i,"x2",s.s=m),v!==s.h&&q(i,"y2",s.h=v),s},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),t})(),(()=>{var t=Pi();return A(n=>{var l=e.config.width,i=e.config.height;return l!==n.e&&q(t,"width",n.e=l),i!==n.t&&q(t,"height",n.t=i),n},{e:void 0,t:void 0}),t})()]}});class zi{constructor(){Be(this,"expressionCache",new Map);Be(this,"maxCacheSize",1e3)}async evaluateExpression(t,n){if(!t||!t.trim())return{success:!1,error:"Ë°®ËææÂºè‰∏çËÉΩ‰∏∫Á©∫"};if(!n)return{success:!1,error:"Ê≤°ÊúâÂèØÁî®ÁöÑÊï∞ÊçÆ‰∏ä‰∏ãÊñá"};try{const l=this.preprocessExpression(t),i=this.getCompiledExpression(l),s=await this.executeCompiledExpression(i,n);return{success:!0,value:s.value,type:this.inferValueType(s.value)}}catch(l){return{success:!1,error:l instanceof Error?l.message:String(l)}}}validateExpression(t,n){if(!t||!t.trim())return{valid:!1,error:"Ë°®ËææÂºè‰∏çËÉΩ‰∏∫Á©∫"};try{const l=this.preprocessExpression(t),i=this.compileExpression(l);return this.staticValidation(i,n)}catch(l){return{valid:!1,error:l instanceof Error?l.message:"Ë°®ËææÂºèÊ†ºÂºèÈîôËØØ"}}}getFieldSuggestions(t,n){if(!n)return[];const l=t.toLowerCase().replace(/[{}]/g,""),i=[];if(n.fields.forEach(s=>{s.name.toLowerCase().includes(l)&&i.push(`{${s.name}}`),s.displayName&&s.displayName.toLowerCase().includes(l)&&i.push(`{${s.name}}`)}),n.currentRecord.data){const s=this.getNestedFieldSuggestions(l,n.currentRecord.data,"");i.push(...s)}return Array.from(new Set(i)).sort((s,a)=>{const o=s.replace(/[{}]/g,""),g=a.replace(/[{}]/g,"");return o===l?-1:g===l?1:o.startsWith(l)?-1:g.startsWith(l)?1:o.localeCompare(g)}).slice(0,20)}preprocessExpression(t){let n=t.trim();return!n.startsWith("{")&&!n.endsWith("}")&&(n=`{${n}}`),n=n.replace(/^\{+/,"{").replace(/\}+$/,"}"),n}getCompiledExpression(t){let n=this.expressionCache.get(t);if(!n){if(n=this.compileExpression(t),this.expressionCache.size>=this.maxCacheSize){const l=this.expressionCache.keys().next().value;l&&this.expressionCache.delete(l)}this.expressionCache.set(t,n)}return n}compileExpression(t){const n=t.slice(1,-1),l=this.parsePath(n);return{original:t,path:l,type:this.determineExpressionType(l)}}parsePath(t){const n=[];let l="",i=!1;for(let s=0;s<t.length;s++){const a=t[s];if(a==="["&&!i)l&&(n.push({type:"field",value:l}),l=""),i=!0;else if(a==="]"&&i){const o=parseInt(l,10);if(isNaN(o))throw new Error(`Êó†ÊïàÁöÑÊï∞ÁªÑÁ¥¢Âºï: ${l}`);n.push({type:"index",value:o}),l="",i=!1}else a==="."&&!i?l&&(n.push({type:"field",value:l}),l=""):l+=a}if(l){if(i)throw new Error("Êú™Èó≠ÂêàÁöÑÊï∞ÁªÑÁ¥¢Âºï");n.push({type:"field",value:l})}if(n.length===0)throw new Error("Á©∫ÁöÑÂ≠óÊÆµË∑ØÂæÑ");return n}async executeCompiledExpression(t,n){let l=n.currentRecord.data;for(const i of t.path){if(l==null)throw new Error("Êó†Ê≥ïËÆøÈóÆ null/undefined ÂÄºÁöÑÂ±ûÊÄß");if(i.type==="field"){if(typeof l!="object")throw new Error(`Â∞ùËØïËÆøÈóÆÈùûÂØπË±°Á±ªÂûãÁöÑÂ≠óÊÆµ: ${i.value}`);if(!(i.value in l))throw new Error(`Â≠óÊÆµ‰∏çÂ≠òÂú®: ${i.value}`);l=l[i.value]}else if(i.type==="index"){if(!Array.isArray(l))throw new Error("Â∞ùËØïÂØπÈùûÊï∞ÁªÑÁ±ªÂûã‰ΩøÁî®Á¥¢ÂºïËÆøÈóÆ");const s=i.value;if(s<0||s>=l.length)throw new Error(`Êï∞ÁªÑÁ¥¢ÂºïË∂ÖÂá∫ËåÉÂõ¥: ${s}`);l=l[s]}}return{value:l}}staticValidation(t,n){if(!n)return{valid:!0,warnings:["Ê≤°ÊúâÊï∞ÊçÆ‰∏ä‰∏ãÊñáÔºåÊó†Ê≥ïÈ™åËØÅÂ≠óÊÆµÊòØÂê¶Â≠òÂú®"]};const l=[],i=t.path[0];if(i&&i.type==="field"){const a=i.value;if(!n.fields.some(g=>g.name===a)){const g=n.fields.filter(c=>c.name.toLowerCase().includes(a.toLowerCase())||this.levenshteinDistance(c.name.toLowerCase(),a.toLowerCase())<=2).map(c=>`{${c.name}}`).slice(0,5);return{valid:!1,error:`Â≠óÊÆµ‰∏çÂ≠òÂú®: ${a}`,suggestions:g}}}t.path.length>5&&l.push("Ë°®ËææÂºèË∑ØÂæÑËøáÊ∑±ÔºåÂèØËÉΩÂΩ±ÂìçÊÄßËÉΩ");const s={valid:!0};return l.length>0&&(s.warnings=l),s}getNestedFieldSuggestions(t,n,l){const i=[];if(!n||typeof n!="object")return i;for(const s of Object.keys(n)){const a=l?`${l}.${s}`:s;a.toLowerCase().includes(t)&&i.push(`{${a}}`),l.split(".").length<3&&n[s]&&typeof n[s]=="object"&&i.push(...this.getNestedFieldSuggestions(t,n[s],a))}return i}inferValueType(t){return t==null?"object":typeof t=="string"?"string":typeof t=="number"?"number":typeof t=="boolean"?"boolean":t instanceof Date?"date":typeof t=="object"?"object":"string"}determineExpressionType(t){return t.length===1?"simple":t.length<=3&&t.every(n=>n.type==="field")?"nested":"complex"}levenshteinDistance(t,n){if(t.length===0)return n.length;if(n.length===0)return t.length;const l=new Array(n.length+1);for(let i=0;i<=n.length;i++)l[i]=new Array(t.length+1),l[i][0]=i;for(let i=0;i<=t.length;i++)l[0][i]=i;for(let i=1;i<=n.length;i++)for(let s=1;s<=t.length;s++){const a=t[s-1]===n[i-1]?0:1;l[i][s]=Math.min(l[i-1][s]+1,l[i][s-1]+1,l[i-1][s-1]+a)}return l[n.length][t.length]}clearCache(){this.expressionCache.clear()}getCacheStats(){return{size:this.expressionCache.size,maxSize:this.maxCacheSize,hitRate:0}}}const Dt=new zi;class Ri{constructor(){Be(this,"context",Z(null));Be(this,"subscribers",[]);this.context[1](null)}getCurrentContext(){return this.context[0]()}async setActiveDataSource(t){var n,l;try{const s=(await we.listDataSources()).find(u=>u.id===t);if(!s)throw new Error(`Êï∞ÊçÆÊ∫ê‰∏çÂ≠òÂú®: ${t}`);console.log("üîç ÊâæÂà∞Êï∞ÊçÆÊ∫ê:",s);const a=s.provider_type||s.type_name||"json";console.log("üîç Êé®Êñ≠ÁöÑ providerType:",a);const o=await we.getPreview(t,void 0,1);console.log("üîç È¢ÑËßàÊï∞ÊçÆ:",o);const g=await we.getSchema(t);console.log("üîç Schema‰ø°ÊÅØ:",g);const c=g.columns.map(u=>({name:u.name,displayName:u.description||u.name,type:this.mapDataType(u.data_type),nullable:u.nullable,sample:u.default_value})),b={dataSource:{id:t,type:this.inferDataSourceType(a),name:s.name,status:this.mapDataSourceStatus(s.status)},currentRecord:{index:0,total:(l=(n=o.total_rows)!=null?n:o.total_count)!=null?l:0,data:o.rows[0]||{}},fields:c};console.log("‚úÖ ÂàõÂª∫Êñ∞ÁöÑÊï∞ÊçÆ‰∏ä‰∏ãÊñá:",b),this.context[1](b),this.notifySubscribers(b)}catch(i){console.error("ËÆæÁΩÆÊï∞ÊçÆÊ∫êÂ§±Ë¥•:",i);const s={dataSource:{id:t,type:"json",name:"Êú™Áü•Êï∞ÊçÆÊ∫ê",status:"error"},currentRecord:{index:0,total:0,data:{}},fields:[],error:{type:"system",message:i instanceof Error?i.message:"Êï∞ÊçÆÊ∫êÂä†ËΩΩÂ§±Ë¥•",details:i}};this.context[1](s),this.notifySubscribers(s)}}async navigateToRecord(t){const n=this.getCurrentContext();if(!n||t<0||t>=n.currentRecord.total)return!1;try{const l=await we.queryData(n.dataSource.id,{limit:1,offset:t});if(l.rows.length===0)return!1;const i={...n,currentRecord:{...n.currentRecord,index:t,data:l.rows[0]}};return this.context[1](i),this.notifySubscribers(i),!0}catch(l){return console.error("ÂØºËà™Âà∞ËÆ∞ÂΩïÂ§±Ë¥•:",l),!1}}async navigateNext(){const t=this.getCurrentContext();return t?this.navigateToRecord(t.currentRecord.index+1):!1}async navigatePrevious(){const t=this.getCurrentContext();return t?this.navigateToRecord(t.currentRecord.index-1):!1}async evaluateExpression(t){const n=this.getCurrentContext();return await Dt.evaluateExpression(t,n)}validateExpression(t){const n=this.getCurrentContext(),l=Dt.validateExpression(t,n);return{valid:l.valid,...l.error&&{error:l.error},...l.suggestions&&{suggestions:l.suggestions}}}getFieldSuggestions(t){const n=this.getCurrentContext();return Dt.getFieldSuggestions(t,n)}subscribe(t){return this.subscribers.push(t),()=>{const n=this.subscribers.indexOf(t);n>-1&&this.subscribers.splice(n,1)}}destroy(){this.subscribers.length=0,this.context[1](null)}notifySubscribers(t){this.subscribers.forEach(n=>{try{n(t)}catch(l){console.error("Êï∞ÊçÆ‰∏ä‰∏ãÊñáËÆ¢ÈòÖÂõûË∞ÉÈîôËØØ:",l)}})}inferDataSourceType(t){if(!t)return console.warn("providerType is undefined, defaulting to json"),"json";switch(t.toLowerCase()){case"json":return"json";case"excel":return"excel";case"sql":return"sql";case"xml":return"xml";case"csv":return"csv";default:return"json"}}mapDataType(t){switch(t){case"String":return"string";case"Number":return"number";case"Boolean":return"boolean";case"Date":case"DateTime":return"date";case"Array":return"array";case"Object":return"object";default:return"string"}}mapDataSourceStatus(t){if(!t)return console.warn("status is undefined, defaulting to empty"),"empty";switch(t.toLowerCase()){case"active":case"connected":case"ready":return"ready";case"error":case"failed":return"error";case"loading":case"processing":case"connecting":return"loading";case"disabled":case"disconnected":case"inactive":return"empty";default:return console.warn(`Unknown status: ${t}, defaulting to empty`),"empty"}}}const Ze=new Ri;var Mi=f("<svg><g class=text-element-unified-container data-bounds-version=unified-v2><text dominant-baseline=hanging text-rendering=optimizeLegibility shape-rendering=geometricPrecision font-kerning=auto class=text-content-unified></svg>",!1,!0,!1),Kt=f("<svg><rect class=text-selection-unified></svg>",!1,!0,!1),Ni=f("<svg><rect class=text-background-unified></svg>",!1,!0,!1),Oi=f("<svg><rect fill=none class=text-border-unified></svg>",!1,!0,!1),Ii=f("<svg><tspan class=text-line-wrapped></svg>",!1,!0,!1),Ui=f("<svg><tspan class=text-line-original></svg>",!1,!0,!1),Fi=f("<svg><rect x=0 y=0></svg>",!1,!0,!1),Bi=f("<svg><line x1=0></svg>",!1,!0,!1),qi=f("<svg><g class=datafield-element-unified-container><text dominant-baseline=hanging text-rendering=optimizeLegibility shape-rendering=geometricPrecision font-kerning=auto></svg>",!1,!0,!1),ji=f('<svg><g class=design-mode-indicator><circle r=6 fill="rgba(24, 144, 255, 0.1)"stroke=#1890ff stroke-width=1></circle><text text-anchor=middle dominant-baseline=middle font-size=8 font-weight=bold fill=#1890ff></svg>',!1,!0,!1),Hi=f("<svg><tspan class=datafield-line-wrapped></svg>",!1,!0,!1),Qi=f("<svg><tspan dy=0></svg>",!1,!0,!1),Ji=f("<svg><rect x=0 y=0 fill=#f0f0f0 stroke=#ccc stroke-width=1 stroke-dasharray=5,5></svg>",!1,!0,!1),Vi=f("<svg><g></svg>",!1,!0,!1);const Wi=e=>{const{state:t}=gn(),[n,l]=Z("[Êï∞ÊçÆÂ≠óÊÆµ]");Ot(()=>{if(e.element.content.type==="DataField"){const a=e.element.content.expression||"",o=t().mode;kt.shouldShowExpression(o)?l(a||"[Êï∞ÊçÆÂ≠óÊÆµ]"):kt.shouldEvaluateExpression(o)&&Ze.evaluateExpression(a).then(g=>{g.success?l(String(g.value||"")):l(`[ÈîôËØØ: ${g.error}]`)}).catch(g=>{l(`[ÈîôËØØ: ${g}]`)})}});const i=Ce(()=>{const{position:a}=e.element;return{transform:`translate(${a.x}px, ${a.y}px)`,opacity:e.element.visible?1:.5}}),s=()=>{const{content:a,size:o}=e.element;if(a.type==="Text"&&a.content&&a.style){const g=Xe.calculateUnifiedBounds(a.content,a.style,o),c=Xe.getTextAnchor(a.style.align);return(()=>{var b=Mi(),u=b.firstChild;return r(b,(()=>{var m=xe(()=>!!e.selected);return()=>m()&&(()=>{var v=Kt();return A(d=>{var p=g.containerBounds.x,_=g.containerBounds.y,y=g.containerBounds.width,$=g.containerBounds.height;return p!==d.e&&q(v,"x",d.e=p),_!==d.t&&q(v,"y",d.t=_),y!==d.a&&q(v,"width",d.a=y),$!==d.o&&q(v,"height",d.o=$),d},{e:void 0,t:void 0,a:void 0,o:void 0}),v})()})(),u),r(b,(()=>{var m=xe(()=>!!a.style.background);return()=>m()&&(()=>{var v=Ni();return A(d=>{var L,O;var p=g.positioning.backgroundX,_=g.positioning.backgroundY,y=g.containerBounds.width+(a.style.background.padding||0)*2,$=g.containerBounds.height+(a.style.background.padding||0)*2,C=a.style.background.color,k=a.style.background.opacity||1,E=((L=a.style.border)==null?void 0:L.radius)||0,D=((O=a.style.border)==null?void 0:O.radius)||0;return p!==d.e&&q(v,"x",d.e=p),_!==d.t&&q(v,"y",d.t=_),y!==d.a&&q(v,"width",d.a=y),$!==d.o&&q(v,"height",d.o=$),C!==d.i&&q(v,"fill",d.i=C),k!==d.n&&q(v,"fill-opacity",d.n=k),E!==d.s&&q(v,"rx",d.s=E),D!==d.h&&q(v,"ry",d.h=D),d},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),v})()})(),u),r(b,(()=>{var m=xe(()=>!!a.style.border);return()=>m()&&(()=>{var v=Oi();return A(d=>{var O,K;var p=g.positioning.backgroundX,_=g.positioning.backgroundY,y=g.containerBounds.width+(((O=a.style.background)==null?void 0:O.padding)||0)*2,$=g.containerBounds.height+(((K=a.style.background)==null?void 0:K.padding)||0)*2,C=a.style.border.color,k=a.style.border.width,E=a.style.border.style==="Dashed"?"5,5":a.style.border.style==="Dotted"?"2,2":"none",D=a.style.border.radius||0,L=a.style.border.radius||0;return p!==d.e&&q(v,"x",d.e=p),_!==d.t&&q(v,"y",d.t=_),y!==d.a&&q(v,"width",d.a=y),$!==d.o&&q(v,"height",d.o=$),C!==d.i&&q(v,"stroke",d.i=C),k!==d.n&&q(v,"stroke-width",d.n=k),E!==d.s&&q(v,"stroke-dasharray",d.s=E),D!==d.h&&q(v,"rx",d.h=D),L!==d.r&&q(v,"ry",d.r=L),d},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),v})()})(),u),q(u,"text-anchor",c),r(u,(()=>{var m=xe(()=>{var v;return!!((v=g.textLayout)!=null&&v.isWrapped)});return()=>m()?g.textLayout.wrappedLines.map((v,d)=>(()=>{var p=Ii();return r(p,v),A(_=>{var y=g.positioning.textAnchorX,$=d===0?0:g.fontMetrics.lineHeight;return y!==_.e&&q(p,"x",_.e=y),$!==_.t&&q(p,"dy",_.t=$),_},{e:void 0,t:void 0}),p})()):a.content.split(`
`).map((v,d)=>(()=>{var p=Ui();return r(p,v),A(_=>{var y=g.positioning.textAnchorX,$=d===0?0:g.fontMetrics.lineHeight;return y!==_.e&&q(p,"x",_.e=y),$!==_.t&&q(p,"dy",_.t=$),_},{e:void 0,t:void 0}),p})())})()),A(m=>{var v=g.positioning.textAnchorX,d=g.positioning.textAnchorY,p=a.style.font_family,_=a.style.font_size.toString(),y=a.style.font_weight,$=a.style.color;return v!==m.e&&q(u,"x",m.e=v),d!==m.t&&q(u,"y",m.t=d),p!==m.a&&q(u,"font-family",m.a=p),_!==m.o&&q(u,"font-size",m.o=_),y!==m.i&&q(u,"font-weight",m.i=y),$!==m.n&&q(u,"fill",m.n=$),m},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),b})()}if(a.type==="Rectangle"){const g=a.opacity!==void 0?a.opacity:1,c=a.corner_radius||0;return(()=>{var b=Fi();return q(b,"rx",c),q(b,"ry",c),q(b,"fill-opacity",g),q(b,"stroke-opacity",g),A(u=>{var $,C,k,E;var m=o.width,v=o.height,d=a.fill_color||"transparent",p=(($=a.border)==null?void 0:$.color)||"#000000",_=((C=a.border)==null?void 0:C.width)||1,y=((k=a.border)==null?void 0:k.style)==="Dashed"?"5,5":((E=a.border)==null?void 0:E.style)==="Dotted"?"2,2":"none";return m!==u.e&&q(b,"width",u.e=m),v!==u.t&&q(b,"height",u.t=v),d!==u.a&&q(b,"fill",u.a=d),p!==u.o&&q(b,"stroke",u.o=p),_!==u.i&&q(b,"stroke-width",u.i=_),y!==u.n&&q(b,"stroke-dasharray",u.n=y),u},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),b})()}if(a.type==="Line"){const g=a.opacity!==void 0?a.opacity:1,c=a.line_style||"Solid",b=c==="Dashed"?"8,4":c==="Dotted"?"2,2":c==="DashDot"?"8,4,2,4":"none";return(()=>{var u=Bi();return q(u,"stroke-opacity",g),q(u,"stroke-dasharray",b),A(m=>{var v=o.height/2,d=o.width,p=o.height/2,_=a.color,y=a.width;return v!==m.e&&q(u,"y1",m.e=v),d!==m.t&&q(u,"x2",m.t=d),p!==m.a&&q(u,"y2",m.a=p),_!==m.o&&q(u,"stroke",m.o=_),y!==m.i&&q(u,"stroke-width",m.i=y),m},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),u})()}if(a.type==="DataField"&&a.style){const g=n(),c=Xe.calculateUnifiedBounds(g,a.style,o),b=Xe.getTextAnchor(a.style.align);return(()=>{var u=qi(),m=u.firstChild;return r(u,(()=>{var v=xe(()=>!!e.selected);return()=>v()&&(()=>{var d=Kt();return A(p=>{var _=c.containerBounds.x,y=c.containerBounds.y,$=c.containerBounds.width,C=c.containerBounds.height;return _!==p.e&&q(d,"x",p.e=_),y!==p.t&&q(d,"y",p.t=y),$!==p.a&&q(d,"width",p.a=$),C!==p.o&&q(d,"height",p.o=C),p},{e:void 0,t:void 0,a:void 0,o:void 0}),d})()})(),m),r(u,(()=>{var v=xe(()=>!!kt.shouldShowExpression(t().mode));return()=>v()&&(()=>{var d=ji(),p=d.firstChild,_=p.nextSibling;return A(y=>{var $=c.containerBounds.x+c.containerBounds.width-8,C=c.containerBounds.y+8,k=c.containerBounds.x+c.containerBounds.width-8,E=c.containerBounds.y+8;return $!==y.e&&q(p,"cx",y.e=$),C!==y.t&&q(p,"cy",y.t=C),k!==y.a&&q(_,"x",y.a=k),E!==y.o&&q(_,"y",y.o=E),y},{e:void 0,t:void 0,a:void 0,o:void 0}),d})()})(),m),q(m,"text-anchor",b),r(m,(()=>{var v=xe(()=>{var d;return!!((d=c.textLayout)!=null&&d.isWrapped)});return()=>v()?c.textLayout.wrappedLines.map((d,p)=>(()=>{var _=Hi();return r(_,d),A(y=>{var $=c.positioning.textAnchorX,C=p===0?0:c.fontMetrics.lineHeight;return $!==y.e&&q(_,"x",y.e=$),C!==y.t&&q(_,"dy",y.t=C),y},{e:void 0,t:void 0}),_})()):(()=>{var d=Qi();return r(d,g),A(()=>q(d,"x",c.positioning.textAnchorX)),d})()})()),A(v=>{var d=t().mode,p=c.positioning.textAnchorX,_=c.positioning.textAnchorY,y=a.style.font_family,$=a.style.font_size.toString(),C=a.style.font_weight,k=g.startsWith("[ÈîôËØØ:")?"#ff4d4f":a.style.color,E=`datafield-content-unified ${t().mode}-mode`;return d!==v.e&&q(u,"data-preview-mode",v.e=d),p!==v.t&&q(m,"x",v.t=p),_!==v.a&&q(m,"y",v.a=_),y!==v.o&&q(m,"font-family",v.o=y),$!==v.i&&q(m,"font-size",v.i=$),C!==v.n&&q(m,"font-weight",v.n=C),k!==v.s&&q(m,"fill",v.s=k),E!==v.h&&q(m,"class",v.h=E),v},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),u})()}return(()=>{var g=Ji();return A(c=>{var b=o.width,u=o.height;return b!==c.e&&q(g,"width",c.e=b),u!==c.t&&q(g,"height",c.t=u),c},{e:void 0,t:void 0}),g})()};return(()=>{var a=Vi();return r(a,s),A(o=>{var g=`element ${e.selected&&e.element.content.type!=="Text"&&e.element.content.type!=="DataField"?"element-selected":""}`,c=i(),b=e.element.id,u=e.element.content.type;return g!==o.e&&q(a,"class",o.e=g),o.t=dn(a,c,o.t),b!==o.a&&q(a,"data-element-id",o.a=b),u!==o.o&&q(a,"data-element-type",o.o=u),o},{e:void 0,t:void 0,a:void 0,o:void 0}),a})()};var Gi=f("<svg><g class=resize-handles></svg>",!1,!0,!1),Ki=f("<svg><g><circle r=6 fill=white stroke=#cccccc stroke-width=1 pointer-events=none></circle><rect class=resize-handle width=8 height=8 rx=1 fill=#007bff stroke=white stroke-width=1></svg>",!1,!0,!1);const Yi=e=>{const{updateElement:t,setResizeOperation:n}=Ve(),[l,i]=Z(!1),[s,a]=Z(null),[o,g]=Z({x:0,y:0}),[c,b]=Z({width:0,height:0}),[u,m]=Z({x:0,y:0}),[v,d]=Z({width:0,height:0}),[p,_]=Z({x:0,y:0}),[y,$]=Z(!1),C=Ce(()=>{const{position:R,size:P,content:S}=e.element,B=8/2;let w={x:R.x,y:R.y,width:P.width,height:P.height};if((S.type==="Text"||S.type==="DataField")&&S.style){const X=S.type==="Text"?S.content:S.expression||"[Êï∞ÊçÆÂ≠óÊÆµ]",j=Xe.calculateUnifiedBounds(X,S.style,P);w={x:R.x+j.containerBounds.x,y:R.y+j.containerBounds.y,width:j.containerBounds.width,height:j.containerBounds.height}}const z=w.x,N=w.y,U=w.x+w.width,H=w.y+w.height,J=w.x+w.width/2,me=w.y+w.height/2;return[{position:"nw",cursor:"nw-resize",x:z-B,y:N-B},{position:"ne",cursor:"ne-resize",x:U-B,y:N-B},{position:"sw",cursor:"sw-resize",x:z-B,y:H-B},{position:"se",cursor:"se-resize",x:U-B,y:H-B},{position:"n",cursor:"n-resize",x:J-B,y:N-B},{position:"s",cursor:"s-resize",x:J-B,y:H-B},{position:"w",cursor:"w-resize",x:z-B,y:me-B},{position:"e",cursor:"e-resize",x:U-B,y:me-B}]}),k=(R,P,S,Q=!1,B=!1)=>{const w=c(),z=u();let N=w.width,U=w.height,H=z.x,J=z.y;switch(R){case"nw":N=w.width-P,U=w.height-S,H=z.x+P,J=z.y+S;break;case"ne":N=w.width+P,U=w.height-S,J=z.y+S;break;case"sw":N=w.width-P,U=w.height+S,H=z.x+P;break;case"se":N=w.width+P,U=w.height+S;break;case"n":U=w.height-S,J=z.y+S;break;case"s":U=w.height+S;break;case"w":N=w.width-P,H=z.x+P;break;case"e":N=w.width+P;break}if(Q&&(R==="nw"||R==="ne"||R==="sw"||R==="se")){const X=w.width/w.height;N/U>X?(N=U*X,(R==="nw"||R==="sw")&&(H=z.x+(w.width-N))):(U=N/X,(R==="nw"||R==="ne")&&(J=z.y+(w.height-U)))}if(B){const X=z.x+w.width/2,j=z.y+w.height/2;H=X-N/2,J=j-U/2}const me=20;return N=Math.max(me,N),U=Math.max(me,U),{size:{width:N,height:U},position:{x:H,y:J}}},E=R=>(R.preventDefault(),R.stopPropagation(),R.stopImmediatePropagation(),!1),D=(R,P)=>{var S;n(!0),document.addEventListener("click",E,{capture:!0}),i(!0),a(R),g({x:P.clientX,y:P.clientY}),b({width:e.element.size.width,height:e.element.size.height}),m({x:e.element.position.x,y:e.element.position.y}),d(e.element.size),_(e.element.position),$(!1),document.addEventListener("mousemove",O),document.addEventListener("mouseup",K),document.body.style.cursor=((S=C().find(Q=>Q.position===R))==null?void 0:S.cursor)||"default"};let L=0;const O=R=>{if(!l())return;const P=s();if(!P)return;const S=o(),Q=R.clientX-S.x,B=R.clientY-S.y,w=k(P,Q,B,R.shiftKey,R.altKey);d(w.size),_(w.position),$(Math.abs(Q)>2||Math.abs(B)>2);const z=Date.now();if(z-L>50)try{t(e.element.id,{size:w.size,position:w.position}),L=z}catch{}},K=()=>{if(!l()||!s())return;const P=()=>{document.removeEventListener("click",E,{capture:!0}),n(!1),i(!1),a(null),document.body.style.cursor="default",document.removeEventListener("mousemove",O),document.removeEventListener("mouseup",K)};if(y()){const S=v(),Q=p();t(e.element.id,{size:S,position:Q}).catch(B=>{t(e.element.id,{size:c(),position:u()}).catch(w=>{})})}P()};return wt(()=>{n(!1),document.removeEventListener("click",E,{capture:!0}),document.removeEventListener("mousemove",O),document.removeEventListener("mouseup",K),document.body.style.cursor="default"}),(()=>{var R=Gi();return r(R,()=>C().map(P=>(()=>{var S=Ki(),Q=S.firstChild,B=Q.nextSibling;return B.addEventListener("mouseleave",w=>{l()||(document.body.style.cursor="default")}),B.addEventListener("mouseenter",w=>{l()||(document.body.style.cursor=P.cursor)}),B.$$mousedown=w=>{w.stopPropagation(),w.preventDefault(),D(P.position,w)},B.style.setProperty("pointer-events","all"),A(w=>{var z=P.x+4,N=P.y+4,U=P.x,H=P.y,J=P.cursor;return z!==w.e&&q(Q,"cx",w.e=z),N!==w.t&&q(Q,"cy",w.t=N),U!==w.a&&q(B,"x",w.a=U),H!==w.o&&q(B,"y",w.o=H),J!==w.i&&((w.i=J)!=null?B.style.setProperty("cursor",J):B.style.removeProperty("cursor")),w},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),S})())),R})()};Pe(["mousedown"]);var Oe=(e=>(e.IDLE="idle",e.HOVER="hover",e.SELECTING="selecting",e.DRAGGING="dragging",e))(Oe||{});const Xi={dragThreshold:3,updateThrottle:16};var Zi=f("<div tabindex=0>"),es=f("<div>"),ts=f("<div><div>üéØ ‰øÆÂ§çÁâà‰∫§‰∫íÂ±Ç</div><div>Ê®°Âºè: </div><div>ÈÄâ‰∏≠: </div><div>ÂÖâÊ†á: "),ns=f("<div>ÊãñÊãΩ: <!>‰∏™ÂÖÉÁ¥†"),ls=f("<div>[<!>]");const is=e=>{const{resizeOperation:t,setResizeOperation:n}=Ve(),l=Xi;let i;const[s,a]=Z(Oe.IDLE),[o,g]=Z([]),[c,b]=Z(null),[u,m]=Z(null),[v,d]=Z(null),p=(x,T)=>Math.sqrt(Math.pow(x.x-T.x,2)+Math.pow(x.y-T.y,2)),_=(x,T)=>x.length===T.length&&x.every((F,I)=>F===T[I]),y=()=>{d(null)},[$,C]=Z(null);let k="default";const E=(x,T)=>{!i||k===x||(i.style.cursor=x,k=x)},D=(x,...T)=>{console.log(`üéØ [InteractionLayer] ${x}`,...T)},L=x=>{if(!i)return{x:0,y:0};const T=i.getBoundingClientRect();return{x:x.clientX-T.left,y:x.clientY-T.top}},O=(x,T)=>x.x>=T.position.x&&x.x<=T.position.x+T.size.width&&x.y>=T.position.y&&x.y<=T.position.y+T.size.height,K=x=>{var F;const T=R(x);return T.length>0&&(F=T[0])!=null?F:null},R=x=>{const T=e.getAllElements();return T.filter(I=>I&&I.visible&&O(x,I)).sort((I,V)=>{var ye,ke;const ie=(ye=I.z_index)!=null?ye:T.indexOf(I);return((ke=V.z_index)!=null?ke:T.indexOf(V))-ie})},P=x=>{const T=o();if(T.length===0)return null;const F=e.getAllElements();for(const I of T){const V=F.find(Ee=>Ee.id===I);if(!V||!V.visible)continue;const ie=8,G=ie/2,ye=V.position.x,ke=V.position.y,ae=V.position.x+V.size.width,ze=V.position.y+V.size.height,Ae=V.position.x+V.size.width/2,Re=V.position.y+V.size.height/2,Se=[{direction:"nw",cursor:"nw-resize",x:ye-G,y:ke-G},{direction:"ne",cursor:"ne-resize",x:ae-G,y:ke-G},{direction:"sw",cursor:"sw-resize",x:ye-G,y:ze-G},{direction:"se",cursor:"se-resize",x:ae-G,y:ze-G},{direction:"n",cursor:"n-resize",x:Ae-G,y:ke-G},{direction:"s",cursor:"s-resize",x:Ae-G,y:ze-G},{direction:"w",cursor:"w-resize",x:ye-G,y:Re-G},{direction:"e",cursor:"e-resize",x:ae-G,y:Re-G}];for(const Ee of Se)if(x.x>=Ee.x&&x.x<Ee.x+ie&&x.y>=Ee.y&&x.y<Ee.y+ie)return{elementId:V.id,direction:Ee.direction,cursor:Ee.cursor}}return null},S=x=>e.getAllElements().filter(F=>{if(!F.visible)return!1;const I={x:F.position.x,y:F.position.y,width:F.size.width,height:F.size.height};return!(I.x>x.x+x.width||I.x+I.width<x.x||I.y>x.y+x.height||I.y+I.height<x.y)}),Q=(x,T)=>{var I,V,ie;const F=R(x);return D("ÈáçÂè†ÈÄâÊã©Ê£ÄÊµã",{elementsCount:F.length,isCtrlClick:T,elementIds:F.map(G=>G.id)}),F.length===0?null:F.length===1?(y(),((I=F[0])==null?void 0:I.id)||null):T?B(x,F):(y(),D("ÊôÆÈÄöÁÇπÂáªÈÄâ‰∏≠ÊúÄ‰∏äÂ±Ç",{elementId:(V=F[0])==null?void 0:V.id}),((ie=F[0])==null?void 0:ie.id)||null)},B=(x,T)=>{var ie,G,ye,ke;const F=v(),I=Date.now();if(D("Âæ™ÁéØÈÄâÊã©ÂºÄÂßã",{hasContext:!!F,elementIds:T.map(ae=>ae.id)}),!F||p(x,F.clickPoint)>5||I-F.lastClickTime>3e3||!_(T.map(ae=>ae.id),F.overlappingElements.map(ae=>ae.id))){const ae=T.length>1?1:0;return d({clickPoint:x,overlappingElements:T,currentSelectedIndex:ae,lastClickTime:I}),D("Âæ™ÁéØÈÄâÊã©ÈáçÁΩÆ",{selectedIndex:ae,selectedId:(ie=T[ae])==null?void 0:ie.id,reason:F?p(x,F.clickPoint)>5?"position_changed":I-F.lastClickTime>3e3?"timeout":"elements_changed":"no_context"}),w(ae+1,T.length,x),((G=T[ae])==null?void 0:G.id)||null}else{const ae=(F.currentSelectedIndex+1)%T.length;return d({...F,currentSelectedIndex:ae,lastClickTime:I}),D("Âæ™ÁéØÈÄâÊã©ÁªßÁª≠",{selectedIndex:ae,selectedId:(ye=T[ae])==null?void 0:ye.id}),w(ae+1,T.length,x),((ke=T[ae])==null?void 0:ke.id)||null}},w=(x,T,F)=>{const I=document.querySelector(".overlap-indicator");I!=null&&I.parentNode&&I.parentNode.removeChild(I);const V=document.createElement("div");V.className="overlap-indicator",V.textContent=`${x}/${T}`,Object.assign(V.style,{position:"fixed",background:"rgba(0, 0, 0, 0.8)",color:"white",padding:"2px 6px",fontSize:"11px",fontFamily:"monospace",borderRadius:"3px",pointerEvents:"none",zIndex:"9999",whiteSpace:"nowrap",left:`${F.x+10}px`,top:`${F.y-20}px`}),document.body.appendChild(V),D("ÊòæÁ§∫ÈáçÂè†ÊåáÁ§∫Âô®",{current:x,total:T,point:F}),setTimeout(()=>{V.parentNode&&(V.parentNode.removeChild(V),D("ÁßªÈô§ÈáçÂè†ÊåáÁ§∫Âô®"))},1500)},z=x=>{var F;const T=L(x);if($()){W(T);return}if(s()===Oe.DRAGGING){de(T);return}if(s()===Oe.SELECTING){Y(T);return}if(s()===Oe.IDLE&&c()&&!((F=c())!=null&&F.isDragging)){re(T);return}s()===Oe.IDLE&&!c()&&!$()&&N(T)},N=x=>{const T=P(x);if(T){E(T.cursor);return}const F=K(x);if(F){const V=o().includes(F.id)?"grab":"pointer";E(V);return}E("default")},U=x=>{const T=L(x),F=P(T);if(F){D("ÁÇπÂáªResizeHandle",{elementId:F.elementId,direction:F.direction}),H(F,T);return}if(t()){D("Ë∞ÉÊï¥Â§ßÂ∞èÊìç‰ΩúËøõË°å‰∏≠ÔºåË∑≥Ëøá‰∫§‰∫íÂ§ÑÁêÜ");return}const I=Q(T,x.ctrlKey);if(D("Èº†Ê†áÊåâ‰∏ã",{point:T,selectedElementId:I,currentMode:s(),isCtrlClick:x.ctrlKey}),I){const V=e.getAllElements().find(ie=>ie.id===I);V&&J(V,T,x)}else me(T)},H=(x,T,F)=>{const I=e.getAllElements().find(V=>V.id===x.elementId);I&&(D("ÂºÄÂßãresizeÊìç‰Ωú",{elementId:x.elementId,direction:x.direction}),n(!0),C({elementId:x.elementId,handlePosition:x.direction,startPoint:T,initialSize:{width:I.size.width,height:I.size.height},initialPosition:{x:I.position.x,y:I.position.y},cursor:x.cursor}),E(x.cursor),D("resizeÁä∂ÊÄÅÂ∑≤ËÆæÁΩÆ",$()))},J=(x,T,F)=>{const I=o().includes(x.id),V=o(),ie=!!v();D("ÂÖÉÁ¥†ÁÇπÂáª",{elementId:x.id,isSelected:I,currentlySelected:V,ctrlKey:F.ctrlKey,shiftKey:F.shiftKey,hasOverlapContext:ie}),F.ctrlKey&&!ie?X(x.id):F.shiftKey&&o().length>0?j(x.id):I?(D("ÁÇπÂáªÂ∑≤ÈÄâ‰∏≠ÂÖÉÁ¥†ÔºåÂáÜÂ§áÊãñÊãΩ",{selectedCount:V.length}),ve(V,T)):se(x.id,T)},me=(x,T)=>{var F;D("ÂºÄÂßãÊ°ÜÈÄâ",{point:x}),g([]),(F=e.onElementsSelect)==null||F.call(e,[]),y(),a(Oe.SELECTING),E("crosshair"),m({startPoint:x,currentPoint:x,selectedIds:[]})},X=x=>{var I;const T=o(),F=T.includes(x)?T.filter(V=>V!==x):[...T,x];D("ÂàáÊç¢ÈÄâÊã©",{elementId:x,newSelection:F}),g(F),(I=e.onElementsSelect)==null||I.call(e,F)},j=x=>{var F;const T=o();if(!T.includes(x)){const I=[...T,x];D("Ê∑ªÂä†Âà∞ÈÄâÊã©",{elementId:x,newSelection:I}),g(I),(F=e.onElementsSelect)==null||F.call(e,I)}},se=(x,T,F)=>{var I;D("ÈÄâÊã©Âπ∂ÂáÜÂ§áÊãñÊãΩ",{elementId:x,point:T}),g([x]),(I=e.onElementsSelect)==null||I.call(e,[x]),ve([x],T)},ve=(x,T,F)=>{D("ÂáÜÂ§áÊãñÊãΩÊìç‰Ωú",{elementIds:x,startPoint:T});const I=e.getAllElements(),V=new Map;x.forEach(ie=>{const G=I.find(ye=>ye.id===ie);G&&V.set(ie,{x:G.position.x,y:G.position.y})}),b({elementIds:x,startPoint:T,startPositions:V,currentOffset:{x:0,y:0},isDragging:!1})},re=x=>{const T=c();if(!T)return;const F=Math.sqrt(Math.pow(x.x-T.startPoint.x,2)+Math.pow(x.y-T.startPoint.y,2));F>l.dragThreshold&&(D("ÂºÄÂßãÊãñÊãΩ",{distance:F,threshold:l.dragThreshold}),a(Oe.DRAGGING),E("grabbing"),b({...T,isDragging:!0}))};let le=!1,ee=0;const ne=(x,T=!1)=>{if(T){x();return}Date.now()-ee>=l.updateThrottle&&!le&&(le=!0,requestAnimationFrame(()=>{x(),le=!1,ee=Date.now()}))},de=x=>{const T=c();if(!T)return;const F={x:x.x-T.startPoint.x,y:x.y-T.startPoint.y};b({...T,currentOffset:F}),ne(()=>{if(e.onBatchUpdatePositions&&T.elementIds.length>1){const I=T.elementIds.map(V=>{const ie=T.startPositions.get(V);return ie?{element_id:V,new_position:{x:ie.x+F.x,y:ie.y+F.y}}:null}).filter(Boolean);I.length>0&&e.onBatchUpdatePositions(I).catch(()=>{})}else if(e.onElementMove){const I=T.elementIds.map(V=>{const ie=T.startPositions.get(V);if(ie)return e.onElementMove(V,{x:ie.x+F.x,y:ie.y+F.y})}).filter(Boolean);Promise.allSettled(I).catch(()=>{})}})},Y=x=>{const T=u();if(!T)return;const F={...T,currentPoint:x};m(F);const I={x:Math.min(T.startPoint.x,x.x),y:Math.min(T.startPoint.y,x.y),width:Math.abs(x.x-T.startPoint.x),height:Math.abs(x.y-T.startPoint.y)},ie=S(I).map(G=>G.id);m({...F,selectedIds:ie}),g(ie)},W=x=>{const T=$();if(!T)return;const F=x.x-T.startPoint.x,I=x.y-T.startPoint.y,V=he(T.handlePosition,F,I,T.initialSize,T.initialPosition);ne(()=>{e.onElementResize&&e.onElementResize(T.elementId,V.size,V.position)})},he=(x,T,F,I,V)=>{let ie=I.width,G=I.height,ye=V.x,ke=V.y;switch(x){case"nw":ie=I.width-T,G=I.height-F,ye=V.x+T,ke=V.y+F;break;case"ne":ie=I.width+T,G=I.height-F,ke=V.y+F;break;case"sw":ie=I.width-T,G=I.height+F,ye=V.x+T;break;case"se":ie=I.width+T,G=I.height+F;break;case"n":G=I.height-F,ke=V.y+F;break;case"s":G=I.height+F;break;case"w":ie=I.width-T,ye=V.x+T;break;case"e":ie=I.width+T;break}const ae=10;return ie=Math.max(ae,ie),G=Math.max(ae,G),{size:{width:ie,height:G},position:{x:ye,y:ke}}},be=()=>{const x=s();if(D("Èº†Ê†áÈáäÊîæ",{currentMode:x,hasResizeState:!!$()}),$()){fe();return}x===Oe.DRAGGING?pe():x===Oe.SELECTING&&ue(),te()},pe=()=>{const x=c();if(!x||!x.isDragging&&x.currentOffset.x===0&&x.currentOffset.y===0){D("ÊãñÊãΩÂÆåÊàêÔºåÊó†ÂÆûÈôÖÁßªÂä®");return}if(e.onBatchUpdatePositions&&x.elementIds.length>1){const T=x.elementIds.map(F=>{const I=x.startPositions.get(F);return I?{element_id:F,new_position:{x:I.x+x.currentOffset.x,y:I.y+x.currentOffset.y}}:null}).filter(Boolean);T.length>0&&(D("ÊãñÊãΩÂÆåÊàê - ÊâπÈáèÊõ¥Êñ∞",{elementCount:T.length}),e.onBatchUpdatePositions(T).catch(F=>{console.warn("ÊâπÈáèÊõ¥Êñ∞ÊúÄÁªà‰ΩçÁΩÆÂ§±Ë¥•:",F)}))}},ue=()=>{const x=u();x&&(D("Ê°ÜÈÄâÂÆåÊàê",{selectedCount:x.selectedIds.length}),e.onElementsSelect&&e.onElementsSelect(x.selectedIds))},fe=()=>{const x=$();x&&(D("ÂÆåÊàêresizeÊìç‰Ωú",{elementId:x.elementId}),n(!1),C(null))},te=()=>{a(Oe.IDLE),E("default"),b(null),m(null),C(null),n(!1),y(),D("Áä∂ÊÄÅÈáçÁΩÆÂÆåÊàê")};Ue(async()=>{document.addEventListener("mousemove",z),document.addEventListener("mouseup",be),D("‰øÆÂ§çÁâà‰∫§‰∫íÂ±ÇÂ∑≤ÂàùÂßãÂåñ")}),wt(()=>{document.removeEventListener("mousemove",z),document.removeEventListener("mouseup",be),D("‰øÆÂ§çÁâà‰∫§‰∫íÂ±ÇÂ∑≤Ê∏ÖÁêÜ")});const ce=()=>{const x=u();if(!x||s()!==Oe.SELECTING)return null;const{startPoint:T,currentPoint:F}=x;return{x:Math.min(T.x,F.x),y:Math.min(T.y,F.y),width:Math.abs(F.x-T.x),height:Math.abs(F.y-T.y)}};return(()=>{var x=Zi();x.$$mousedown=U;var T=i;return typeof T=="function"?Ut(T,x):i=x,x.style.setProperty("position","absolute"),x.style.setProperty("top","0"),x.style.setProperty("left","0"),x.style.setProperty("width","100%"),x.style.setProperty("height","100%"),x.style.setProperty("z-index","10"),x.style.setProperty("pointer-events","all"),x.style.setProperty("background","transparent"),x.style.setProperty("user-select","none"),r(x,(()=>{var F=xe(()=>!!ce());return()=>F()&&(()=>{var I=es();return I.style.setProperty("position","absolute"),I.style.setProperty("border","1px dashed #007acc"),I.style.setProperty("background","rgba(0, 122, 204, 0.1)"),I.style.setProperty("pointer-events","none"),A(V=>{var ie=`${ce().x}px`,G=`${ce().y}px`,ye=`${ce().width}px`,ke=`${ce().height}px`;return ie!==V.e&&((V.e=ie)!=null?I.style.setProperty("left",ie):I.style.removeProperty("left")),G!==V.t&&((V.t=G)!=null?I.style.setProperty("top",G):I.style.removeProperty("top")),ye!==V.a&&((V.a=ye)!=null?I.style.setProperty("width",ye):I.style.removeProperty("width")),ke!==V.o&&((V.o=ke)!=null?I.style.setProperty("height",ke):I.style.removeProperty("height")),V},{e:void 0,t:void 0,a:void 0,o:void 0}),I})()})(),null),r(x,(()=>{var F=xe(()=>!!e.enableDebugMode);return()=>F()&&(()=>{var I=ts(),V=I.firstChild,ie=V.nextSibling;ie.firstChild;var G=ie.nextSibling;G.firstChild;var ye=G.nextSibling;return ye.firstChild,I.style.setProperty("position","fixed"),I.style.setProperty("top","10px"),I.style.setProperty("right","10px"),I.style.setProperty("padding","8px"),I.style.setProperty("background","rgba(0, 0, 0, 0.8)"),I.style.setProperty("color","white"),I.style.setProperty("font-family","monospace"),I.style.setProperty("font-size","12px"),I.style.setProperty("border-radius","4px"),I.style.setProperty("z-index","9999"),I.style.setProperty("pointer-events","none"),r(ie,s,null),r(G,()=>o().length,null),r(ye,k,null),r(I,(()=>{var ke=xe(()=>{var ae;return!!((ae=c())!=null&&ae.isDragging)});return()=>ke()&&(()=>{var ae=ns(),ze=ae.firstChild,Ae=ze.nextSibling;return Ae.nextSibling,ae.style.setProperty("color","#ffeb3b"),r(ae,()=>{var Re;return(Re=c())==null?void 0:Re.elementIds.length},Ae),ae})()})(),null),r(I,(()=>{var ke=xe(()=>o().length>0);return()=>ke()&&(()=>{var ae=ls(),ze=ae.firstChild,Ae=ze.nextSibling;return Ae.nextSibling,ae.style.setProperty("font-size","10px"),ae.style.setProperty("color","#ccc"),r(ae,()=>o().slice(0,3).join(", "),Ae),r(ae,()=>o().length>3&&"...",Ae),ae})()})(),null),I})()})(),null),x})()};Pe(["mousedown"]);var ss=f("<div class=toolbar-section><div class=section-title>Êô∫ËÉΩÂª∫ËÆÆ</div><button class=smart-align-button><div class=smart-icon>üéØ</div><div class=smart-text></div></button><div class=smart-reason>"),rs=f("<div class=toolbar-status><div class=status-text>ÈÄâÊã©Ëá≥Â∞ë2‰∏™ÂÖÉÁ¥†‰ª•‰ΩøÁî®ÂØπÈΩêÂäüËÉΩ"),as=f('<div class=toolbar-status><div class="status-text aligning"><div class=spinner></div>Ê≠£Âú®ÊâßË°åÂØπÈΩêÊìç‰Ωú...'),os=f('<div class=alignment-toolbar><div class=toolbar-section><div class=section-title>ÂØπÈΩê</div><div class=button-group><button class="align-button left"title=Â∑¶ÂØπÈΩê><div class=align-icon><div class="line left-line"></div><div class=shapes><div class=shape></div><div class=shape></div><div class=shape></div></div></div></button><button class="align-button h-center"title=Ê∞¥Âπ≥Â±Ö‰∏≠ÂØπÈΩê><div class=align-icon><div class="line center-line"></div><div class=shapes><div class=shape></div><div class=shape></div><div class=shape></div></div></div></button><button class="align-button right"title=Âè≥ÂØπÈΩê><div class=align-icon><div class="line right-line"></div><div class=shapes><div class=shape></div><div class=shape></div><div class=shape></div></div></div></button></div></div><div class=toolbar-section><div class=section-title>ÂûÇÁõ¥ÂØπÈΩê</div><div class=button-group><button class="align-button top"title=È°∂ÈÉ®ÂØπÈΩê><div class="align-icon vertical"><div class="line top-line"></div><div class="shapes vertical"><div class=shape></div><div class=shape></div><div class=shape></div></div></div></button><button class="align-button v-center"title=ÂûÇÁõ¥Â±Ö‰∏≠ÂØπÈΩê><div class="align-icon vertical"><div class="line v-center-line"></div><div class="shapes vertical"><div class=shape></div><div class=shape></div><div class=shape></div></div></div></button><button class="align-button bottom"title=Â∫ïÈÉ®ÂØπÈΩê><div class="align-icon vertical"><div class="line bottom-line"></div><div class="shapes vertical"><div class=shape></div><div class=shape></div><div class=shape></div></div></div></button></div></div><div class=toolbar-section><div class=section-title>ÂàÜÂ∏É</div><div class=button-group><button class="align-button distribute-h"title=Ê∞¥Âπ≥ÂùáÂåÄÂàÜÂ∏É><div class=align-icon><div class="shapes distribute"><div class=shape></div><div class=spacer></div><div class=shape></div><div class=spacer></div><div class=shape></div></div></div></button><button class="align-button distribute-v"title=ÂûÇÁõ¥ÂùáÂåÄÂàÜÂ∏É><div class="align-icon vertical"><div class="shapes distribute vertical"><div class=shape></div><div class=spacer></div><div class=shape></div><div class=spacer></div><div class=shape>');const cs=(e,t)=>{if(e.length<2)return[];const n=e.map(l=>({x:l.position.x,y:l.position.y,width:l.size.width,height:l.size.height}));return n.map((l,i)=>{let s=l.x,a=l.y;switch(t){case"left":s=Math.min(...n.map(u=>u.x));break;case"right":s=Math.max(...n.map(u=>u.x+u.width))-l.width;break;case"top":a=Math.min(...n.map(u=>u.y));break;case"bottom":a=Math.max(...n.map(u=>u.y+u.height))-l.height;break;case"h_center":s=n.reduce((u,m)=>u+m.x+m.width/2,0)/n.length-l.width/2;break;case"v_center":a=n.reduce((u,m)=>u+m.y+m.height/2,0)/n.length-l.height/2;break}return{element_id:e[i].id,new_position:{x:s,y:a}}})},ds=e=>{const{batchUpdatePositions:t,state:n}=Ve(),[l,i]=Z(!1),s=()=>e.selectedElementIds().length>=2,a=()=>{const b=e.selectedElementIds();return n.elements.filter(u=>b.includes(u.id))},o=async b=>{const u=a();if(u.length<2){console.warn("ÂØπÈΩêÂäüËÉΩÈúÄË¶ÅËá≥Â∞ë2‰∏™ÂÖÉÁ¥†");return}try{i(!0),console.log(`üéØ ÊâßË°å${b}ÂØπÈΩê:`,u.length,"‰∏™ÂÖÉÁ¥†");const m=cs(u,b);await t(m),console.log("‚úÖ ÂØπÈΩêÊìç‰ΩúÂÆåÊàê"),e.onAlignmentComplete&&e.onAlignmentComplete(m)}catch(m){console.error("‚ùå ÂØπÈΩêÊìç‰ΩúÂ§±Ë¥•:",m)}finally{i(!1)}},g=()=>a().length<2?null:{recommended:"left",reason:"Âª∫ËÆÆÂ∑¶ÂØπÈΩê",results:[]},c=()=>g();return(()=>{var b=os(),u=b.firstChild,m=u.firstChild,v=m.nextSibling,d=v.firstChild,p=d.nextSibling,_=p.nextSibling,y=u.nextSibling,$=y.firstChild,C=$.nextSibling,k=C.firstChild,E=k.nextSibling,D=E.nextSibling,L=y.nextSibling,O=L.firstChild,K=O.nextSibling,R=K.firstChild,P=R.nextSibling;return d.$$click=()=>o("left"),p.addEventListener("mouseenter",()=>{var S;return(S=e.onAlignmentPreview)==null?void 0:S.call(e,"h_center")}),p.$$click=()=>o("h_center"),_.addEventListener("mouseenter",()=>{var S;return(S=e.onAlignmentPreview)==null?void 0:S.call(e,"right")}),_.$$click=()=>o("right"),k.addEventListener("mouseenter",()=>{var S;return(S=e.onAlignmentPreview)==null?void 0:S.call(e,"top")}),k.$$click=()=>o("top"),E.addEventListener("mouseenter",()=>{var S;return(S=e.onAlignmentPreview)==null?void 0:S.call(e,"v_center")}),E.$$click=()=>o("v_center"),D.addEventListener("mouseenter",()=>{var S;return(S=e.onAlignmentPreview)==null?void 0:S.call(e,"bottom")}),D.$$click=()=>o("bottom"),R.addEventListener("mouseenter",()=>{var S;return(S=e.onAlignmentPreview)==null?void 0:S.call(e,"distribute_h")}),R.$$click=()=>o("distribute_h"),P.addEventListener("mouseenter",()=>{var S;return(S=e.onAlignmentPreview)==null?void 0:S.call(e,"distribute_v")}),P.$$click=()=>o("distribute_v"),r(b,h(M,{get when(){return xe(()=>!!s())()&&c()},get children(){var S=ss(),Q=S.firstChild,B=Q.nextSibling,w=B.firstChild,z=w.nextSibling,N=B.nextSibling;return B.$$click=()=>o(c().recommended),r(z,()=>c().recommended==="left"&&"Â∑¶ÂØπÈΩê",null),r(z,()=>c().recommended==="right"&&"Âè≥ÂØπÈΩê",null),r(z,()=>c().recommended==="top"&&"È°∂ÂØπÈΩê",null),r(z,()=>c().recommended==="bottom"&&"Â∫ïÂØπÈΩê",null),r(z,()=>c().recommended==="h_center"&&"Ê∞¥Âπ≥Â±Ö‰∏≠",null),r(z,()=>c().recommended==="v_center"&&"ÂûÇÁõ¥Â±Ö‰∏≠",null),r(N,()=>c().reason),A(U=>{var H=l(),J=c().reason;return H!==U.e&&(B.disabled=U.e=H),J!==U.t&&q(B,"title",U.t=J),U},{e:void 0,t:void 0}),S}}),null),r(b,h(M,{get when(){return!s()},get children(){var S=rs(),Q=S.firstChild;return Q.firstChild,r(Q,()=>e.selectedElementIds().length<3&&"ÔºåËá≥Â∞ë3‰∏™ÂÖÉÁ¥†‰ª•‰ΩøÁî®ÂàÜÂ∏ÉÂäüËÉΩ",null),S}}),null),r(b,h(M,{get when(){return l()},get children(){return as()}}),null),A(S=>{var Q=!s()||l(),B=!s()||l(),w=!s()||l(),z=!s()||l(),N=!s()||l(),U=!s()||l(),H=e.selectedElementIds().length<3||l(),J=e.selectedElementIds().length<3||l();return Q!==S.e&&(d.disabled=S.e=Q),B!==S.t&&(p.disabled=S.t=B),w!==S.a&&(_.disabled=S.a=w),z!==S.o&&(k.disabled=S.o=z),N!==S.i&&(E.disabled=S.i=N),U!==S.n&&(D.disabled=S.n=U),H!==S.s&&(R.disabled=S.s=H),J!==S.h&&(P.disabled=S.h=J),S},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),b})()},us=`
.alignment-toolbar {
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding: 16px;
  background: #f8f9fa;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  min-width: 280px;
}

.toolbar-section {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.section-title {
  font-size: 12px;
  font-weight: 600;
  color: #6b7280;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.button-group {
  display: flex;
  gap: 4px;
}

.align-button {
  width: 36px;
  height: 36px;
  border: 1px solid #d1d5db;
  background: white;
  border-radius: 6px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  position: relative;
}

.align-button:hover:not(:disabled) {
  background: #f3f4f6;
  border-color: #9ca3af;
  transform: translateY(-1px);
}

.align-button:active:not(:disabled) {
  transform: translateY(0);
  background: #e5e7eb;
}

.align-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.align-icon {
  position: relative;
  width: 20px;
  height: 16px;
}

.align-icon.vertical {
  width: 16px;
  height: 20px;
}

.line {
  position: absolute;
  background: #3b82f6;
  z-index: 2;
}

.left-line, .right-line, .center-line {
  width: 2px;
  height: 16px;
  top: 0;
}

.left-line { left: 2px; }
.right-line { right: 2px; }
.center-line { left: 9px; }

.top-line, .bottom-line, .v-center-line {
  height: 2px;
  width: 16px;
  left: 0;
}

.top-line { top: 2px; }
.bottom-line { bottom: 2px; }
.v-center-line { top: 9px; }

.shapes {
  display: flex;
  gap: 2px;
  align-items: flex-start;
}

.shapes.vertical {
  flex-direction: column;
  height: 100%;
  align-items: flex-start;
}

.shapes.distribute {
  align-items: center;
  justify-content: space-between;
  width: 100%;
}

.shapes.distribute.vertical {
  height: 100%;
  width: auto;
}

.shape {
  width: 4px;
  height: 6px;
  background: #6b7280;
  border-radius: 1px;
}

.shapes.vertical .shape {
  width: 6px;
  height: 4px;
}

.spacer {
  width: 2px;
  height: 1px;
  background: #d1d5db;
}

.shapes.distribute.vertical .spacer {
  width: 1px;
  height: 2px;
}

.smart-align-button {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  background: #3b82f6;
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.smart-align-button:hover:not(:disabled) {
  background: #2563eb;
  transform: translateY(-1px);
}

.smart-align-button:disabled {
  opacity: 0.7;
  cursor: not-allowed;
}

.smart-icon {
  font-size: 16px;
}

.smart-text {
  font-size: 14px;
  font-weight: 500;
}

.smart-reason {
  font-size: 11px;
  color: #6b7280;
  font-style: italic;
  margin-top: 4px;
}

.toolbar-status {
  padding: 8px;
  border-radius: 4px;
  background: #f3f4f6;
  border: 1px solid #d1d5db;
}

.status-text {
  font-size: 12px;
  color: #6b7280;
  text-align: center;
}

.status-text.aligning {
  color: #3b82f6;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.spinner {
  width: 12px;
  height: 12px;
  border: 2px solid #e5e7eb;
  border-top: 2px solid #3b82f6;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

.preview-info {
  padding: 6px 8px;
  background: #eff6ff;
  border: 1px solid #bfdbfe;
  border-radius: 4px;
}

.preview-text {
  font-size: 11px;
  color: #1d4ed8;
  text-align: center;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
`;if(typeof document<"u"){const e=document.createElement("style");e.textContent=us,document.head.appendChild(e)}Pe(["click"]);var gs=f("<div>"),hs=f('<div class="flex-1 flex flex-col overflow-hidden"><div class="h-12 bg-primary border-b border-default flex items-center px-4"><div class="text-sm text-secondary">Canvas: <!> √ó <!>px<span class="ml-4 px-2 py-1 bg-blue-100 rounded text-xs">ÂÖÉÁ¥†: <!> | ÈÄâ‰∏≠: </span></div></div><div class="flex-1 overflow-auto custom-scrollbar bg-tertiary p-4"><div class="flex items-center justify-center min-h-full"><div class="bg-canvas-bg shadow-lg rounded-lg overflow-hidden"><svg class=block><rect></rect><rect fill=none stroke=var(--color-border) stroke-width=1></rect><g class=elements-layer></g><g class=resize-handles-layer>'),vs=f("<span class=ml-2>Zoom: <!>%");const fs=()=>{const{state:e,selectElement:t,clearSelection:n,createElement:l,selectMultiple:i,updateElement:s,batchUpdatePositions:a}=Ve();let o;const[g,c]=Z([]),b=Ce(()=>e.elements.filter(C=>C.visible)),u=(C,k)=>{if(!o)return{x:0,y:0};const E=o.getBoundingClientRect(),D=(C-E.left)/e.canvas_config.zoom,L=(k-E.top)/e.canvas_config.zoom;return{x:D,y:L}},m=async C=>{console.log("üéØ ÈÄâÊã©ÂÖÉÁ¥†",C),c([...C]);try{C.length===0?await n():C.length===1?await t(C[0]):await i([...C])}catch(k){console.error("‚ùå ÈÄâÊã©ÂÖÉÁ¥†Â§±Ë¥•:",k)}},v=async C=>{try{await a(C)}catch(k){console.error("‚ùå ÊâπÈáèÊõ¥Êñ∞‰ΩçÁΩÆÂ§±Ë¥•:",k)}},d=async(C,k)=>{try{await s(C,{position:{x:k.x,y:k.y}})}catch(E){console.error("‚ùå ÁßªÂä®ÂÖÉÁ¥†Â§±Ë¥•:",E)}},p=async(C,k,E)=>{try{await s(C,{size:k,position:E})}catch(D){console.error("‚ùå Ë∞ÉÊï¥Â§ßÂ∞èÂ§±Ë¥•:",D)}},_=async C=>{console.log("üñ±Ô∏è ÁîªÂ∏ÉÁÇπÂáª",C)},y=async C=>{var k;C.preventDefault();try{const E=(k=C.dataTransfer)==null?void 0:k.getData("application/json");if(!E)return;const{type:D,component:L}=JSON.parse(E);if(D==="component"){const{x:O,y:K}=u(C.clientX,C.clientY),R=Math.max(0,O-L.default_size.width/2),P=Math.max(0,K-L.default_size.height/2);console.log("üéØ ÈÄöËøáÊãñÊîæÂàõÂª∫ÁªÑ‰ª∂:",L.name,"at",R,P);const S=await l(L.id,{x:R,y:P},L.default_size,L.create_content());console.log("‚úÖ ÈÄöËøáÊãñÊîæÂàõÂª∫ÂÖÉÁ¥†ÊàêÂäü:",S),c([S]),await t(S)}}catch(E){console.error("ÊãñÊîæÂ§ÑÁêÜÂ§±Ë¥•:",E)}};Ue(()=>{c([...e.selected_ids])}),Ce(()=>{c([...e.selected_ids])});const $=Ce(()=>{const{width:C,height:k}=e.canvas_config;return`0 0 ${C} ${k}`});return(()=>{var C=hs(),k=C.firstChild,E=k.firstChild,D=E.firstChild,L=D.nextSibling,O=L.nextSibling,K=O.nextSibling,R=K.nextSibling,P=R.nextSibling,S=P.firstChild,Q=S.nextSibling;Q.nextSibling;var B=k.nextSibling,w=B.firstChild,z=w.firstChild,N=z.firstChild,U=N.firstChild,H=U.nextSibling,J=H.nextSibling,me=J.nextSibling;r(E,()=>e.canvas_config.width,L),r(E,()=>e.canvas_config.height,K),r(E,(()=>{var j=xe(()=>e.canvas_config.zoom!==1);return()=>j()&&(()=>{var se=vs(),ve=se.firstChild,re=ve.nextSibling;return re.nextSibling,r(se,()=>Math.round(e.canvas_config.zoom*100),re),se})()})(),P),r(P,()=>e.elements.length,Q),r(P,()=>g().length,null),z.style.setProperty("position","relative"),N.addEventListener("drop",y),N.addEventListener("dragover",j=>{j.preventDefault(),j.dataTransfer.dropEffect="copy"}),N.$$contextmenu=j=>j.preventDefault();var X=o;return typeof X=="function"?Ut(X,N):o=N,r(N,h(Ai,{get config(){return e.canvas_config}}),H),r(J,h(oe,{get each(){return b()},children:j=>h(Wi,{element:j,get selected(){return g().includes(j.id)}})})),r(me,h(oe,{get each(){return b().filter(j=>g().includes(j.id))},children:j=>h(Yi,{element:j})})),r(z,h(is,{canvasRef:o,getAllElements:()=>[...e.elements],onElementsSelect:m,onElementMove:d,onBatchUpdatePositions:v,onElementResize:p,onCanvasClick:_,get enableDebugMode(){return!1}}),null),r(z,h(M,{get when(){return g().length>=2},get children(){var j=gs();return j.style.setProperty("position","fixed"),j.style.setProperty("top","80px"),j.style.setProperty("right","20px"),j.style.setProperty("z-index","1000"),j.style.setProperty("background","white"),j.style.setProperty("border-radius","8px"),j.style.setProperty("box-shadow","0 4px 12px rgba(0, 0, 0, 0.15)"),j.style.setProperty("border","1px solid #e5e7eb"),r(j,h(ds,{selectedElementIds:g,onAlignmentComplete:se=>{console.log("‚úÖ ÂØπÈΩêÊìç‰ΩúÂÆåÊàê:",se)},onAlignmentPreview:se=>{console.log("üëÅÔ∏è ÂØπÈΩêÈ¢ÑËßà:",se)},onPreviewCancel:()=>{console.log("‚ùå ÂèñÊ∂àÂØπÈΩêÈ¢ÑËßà")}})),j}}),null),A(j=>{var se=e.canvas_config.width*e.canvas_config.zoom,ve=e.canvas_config.height*e.canvas_config.zoom,re=$(),le=e.canvas_config.width,ee=e.canvas_config.height,ne=e.canvas_config.background_color,de=e.canvas_config.width,Y=e.canvas_config.height;return se!==j.e&&q(N,"width",j.e=se),ve!==j.t&&q(N,"height",j.t=ve),re!==j.a&&q(N,"viewBox",j.a=re),le!==j.o&&q(U,"width",j.o=le),ee!==j.i&&q(U,"height",j.i=ee),ne!==j.n&&q(U,"fill",j.n=ne),de!==j.s&&q(H,"width",j.s=de),Y!==j.h&&q(H,"height",j.h=Y),j},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),C})()};Pe(["contextmenu"]);var ms=f("<div class=wizard-errors>"),bs=f("<div class=data-source-wizard><div class=wizard-header><button class=back-btn>‚Üê ËøîÂõû</button><div class=wizard-title><h3>Ê∑ªÂä†JSONÊï∞ÊçÆÊ∫ê</h3><p></p></div></div><div class=wizard-content>"),ps=f("<div class=error-message>"),ys=f("<div class=wizard-progress>"),$s=f("<div><div class=step-indicator><span class=step-number></span></div><div class=step-info><div class=step-title></div><div class=step-description>"),_s=f("<div class=source-type-step><div class=step-header><h4>ÈÄâÊã©JSONÊï∞ÊçÆÁöÑËæìÂÖ•ÊñπÂºè</h4><p>ËØ∑ÈÄâÊã©ÊúÄÈÄÇÂêàÊÇ®‰ΩøÁî®Âú∫ÊôØÁöÑÊï∞ÊçÆËæìÂÖ•ÊñπÂºè</p></div><div class=source-options>"),xs=f("<div><div class=option-header><div class=option-title></div><div class=option-description></div></div><div class=option-features></div><div class=option-example></div><div class=option-selector><input type=radio>"),Ss=f("<span class=feature-tag>"),ws=f("<div class=data-input-step><div class=step-header><h4></h4><p>"),Cs=f("<div class=selected-file><span class=file-icon>üìÑ</span><span class=file-name></span><button class=remove-file>‚úï"),ks=f("<div class=file-error>"),Ts=f('<div class=file-selection-panel><div><div class=drop-zone-content><div class=drop-icon>üìÅ</div><div class=drop-text><div>Â∞ÜJSONÊñá‰ª∂ÊãñÊãΩÂà∞Ê≠§Â§Ñ</div><div>ÊàñËÄÖÁÇπÂáª‰∏ãÊñπÊåâÈíÆÈÄâÊã©Êñá‰ª∂</div></div></div></div><div class=file-input-section><label class=file-select-btn><input type=file accept=.json>ÈÄâÊã©JSONÊñá‰ª∂</label></div><div class=file-help><div class=help-title>üìù ÊîØÊåÅÁöÑÊñá‰ª∂Ê†ºÂºè:</div><ul class=help-list><li>JSONÂØπË±°: <code>{"name": "value"}</code></li><li>JSONÊï∞ÁªÑ: <code>[{"id": 1}, {"id": 2}]</code></li><li>Êñá‰ª∂Â§ßÂ∞è: ÊúÄÂ§ß10MB</li><li>ÁºñÁ†ÅÊ†ºÂºè: UTF-8'),Es=f("<div class=field-error>"),Ls=f("<div class=form-field><label class=field-label>Âà∑Êñ∞Èó¥Èöî (Áßí)</label><div class=interval-input-group><input type=range class=interval-slider min=10 max=3600 step=10><input type=number class=interval-number min=10 max=3600><span class=interval-unit>Áßí</span></div><div class=field-hint>Êé®ËçêËÆæÁΩÆ: 5ÂàÜÈíü (300Áßí) ÈÄÇÂêàÂ§ßÂ§öÊï∞Âú∫ÊôØ"),Ds=f('<div class=form-section><div class=section-title><span class=title-icon>üîÑ</span><h5>Ëá™Âä®Âà∑Êñ∞ËÆæÁΩÆ</h5></div><div class=form-field><label class="field-label checkbox-label"><input type=checkbox class=refresh-checkbox><span class=checkbox-text>ÂêØÁî®Ëá™Âä®Âà∑Êñ∞</span></label><div class=field-hint>ÂΩìJSONÊñá‰ª∂ÂèëÁîüÂèòÂåñÊó∂ÔºåËá™Âä®ÈáçÊñ∞Âä†ËΩΩÊï∞ÊçÆ'),Ps=f('<div class=summary-item><span class=summary-label>Êñá‰ª∂Ë∑ØÂæÑ:</span><span class="summary-value file-path">'),As=f("<div class=summary-item><span class=summary-label>Ëá™Âä®Âà∑Êñ∞:</span><span class=summary-value>"),zs=f("<div class=summary-item><span class=summary-label>ÂÜÖÂÆπÈïøÂ∫¶:</span><span class=summary-value> Â≠óÁ¨¶"),Rs=f('<div class=configuration-step><div class=step-header><h4>‚öôÔ∏è ÈÖçÁΩÆÊï∞ÊçÆÊ∫ê</h4><p>‰∏∫ÊÇ®ÁöÑÊï∞ÊçÆÊ∫êËÆæÁΩÆÂêçÁß∞ÂíåÂü∫Êú¨ÈÄâÈ°π</p></div><div class=config-form><div class=form-section><div class=section-title><span class=title-icon>üè∑Ô∏è</span><h5>Âü∫Êú¨‰ø°ÊÅØ</h5></div><div class=form-field><label class=field-label>Êï∞ÊçÆÊ∫êÂêçÁß∞ <span class=required>*</span></label><input type=text placeholder="ËØ∑ËæìÂÖ•Êï∞ÊçÆÊ∫êÂêçÁß∞ÔºåÂ¶Ç: ÂÆ¢Êà∑Êï∞ÊçÆ„ÄÅÈîÄÂîÆÊä•Ë°®Á≠â"maxlength=50><div class=field-hint>‰∏∫ÊÇ®ÁöÑÊï∞ÊçÆÊ∫êËµ∑‰∏Ä‰∏™ÂÆπÊòìËØÜÂà´ÁöÑÂêçÁß∞ÔºåÊñπ‰æøÂêéÁª≠‰ΩøÁî®ÂíåÁÆ°ÁêÜ</div></div></div><div class=form-section><div class=section-title><span class=title-icon>üìã</span><h5>ÈÖçÁΩÆÊ¶ÇËßà</h5></div><div class=config-summary><div class=summary-item><span class=summary-label>Êï∞ÊçÆÊù•Ê∫ê:</span><span class=summary-value></span></div></div></div><div class=form-section><div class=usage-tips><div class=tips-title>üí° ‰ΩøÁî®Âª∫ËÆÆ:</div><ul class=tips-list><li>‰ΩøÁî®ÂÖ∑ÊúâÊèèËø∞ÊÄßÁöÑÂêçÁß∞ÔºåÂ¶Ç"2024Âπ¥ÈîÄÂîÆÊï∞ÊçÆ"ËÄå‰∏çÊòØ"data1"</li><li>ÂØπ‰∫éÁªèÂ∏∏ÂèòÂåñÁöÑÊñá‰ª∂ÔºåÂª∫ËÆÆÂêØÁî®Ëá™Âä®Âà∑Êñ∞ÂäüËÉΩ</li><li>ËæÉÂ§ßÁöÑJSONÊñá‰ª∂Âª∫ËÆÆËÆæÁΩÆËæÉÈïøÁöÑÂà∑Êñ∞Èó¥Èöî‰ª•ÈÅøÂÖçÊÄßËÉΩÈóÆÈ¢ò</li><li>Áõ¥Êé•ËæìÂÖ•ÁöÑJSONÂÜÖÂÆπ‰ºö‰øùÂ≠òÂú®Â∫îÁî®‰∏≠Ôºå‰∏ç‰ºöËá™Âä®Êõ¥Êñ∞'),Ms=f("<span class=status-success>‚úÖ JSONÊ†ºÂºèÊ≠£Á°Æ"),Ns=f("<span class=status-error>‚ùå Ê†ºÂºèÈîôËØØ"),Os=f("<div class=template-selector><div class=template-header>ÈÄâÊã©JSONÊ®°Êùø:</div><div class=template-list>"),Is=f("<div class=syntax-error><div class=error-title>‚ùå JSONÊ†ºÂºèÈîôËØØ:</div><div class=error-message>"),Us=f(`<div class=content-editing-panel><div class=editor-toolbar><button class=template-btn>üìã ‰ΩøÁî®Ê®°Êùø</button><button class=clear-btn>üóëÔ∏è Ê∏ÖÁ©∫</button><div class=editor-status></div></div><div class=json-editor><textarea placeholder="ËØ∑ËæìÂÖ•ÊàñÁ≤òË¥¥JSONÂÜÖÂÆπ...

Á§∫‰æã:
{
  &quot;name&quot;: &quot;Á§∫‰æãÊï∞ÊçÆ&quot;,
  &quot;value&quot;: 123
}"rows=15></textarea></div><div class=editor-help><div class=help-title>üí° ‰ΩøÁî®ÊèêÁ§∫:</div><ul class=help-list><li>ÊîØÊåÅJSONÂØπË±°ÂíåÊï∞ÁªÑÊ†ºÂºè</li><li>Â≠óÁ¨¶‰∏≤ÈúÄË¶ÅÁî®ÂèåÂºïÂè∑ÂåÖÂõ¥</li><li>ÂèØ‰ª•‰ΩøÁî®Ctrl+AÂÖ®ÈÄâÔºåCtrl+VÁ≤òË¥¥</li><li>Á≥ªÁªü‰ºöËá™Âä®È™åËØÅJSONÊ†ºÂºè`),Fs=f("<div class=template-item><div class=template-name></div><div class=template-description>"),Bs=f("<div class=error-details><div class=error-title>ÈîôËØØËØ¶ÊÉÖ:</div><div class=error-content>"),qs=f("<div><div class=result-message><span class=result-icon></span><span class=result-text>"),js=f('<div class=info-item><span class=info-label>Êñá‰ª∂Ë∑ØÂæÑ:</span><span class="info-value file-path">'),Hs=f("<div class=info-item><span class=info-label>Ëá™Âä®Âà∑Êñ∞:</span><span class=info-value>"),Qs=f("<div class=advanced-content><div class=info-grid><div class=info-item><span class=info-label>Êï∞ÊçÆÊ∫êÁ±ªÂûã:</span><span class=info-value></span></div><div class=info-item><span class=info-label>È¢ÑËßàÈôêÂà∂:</span><span class=info-value>ÊúÄÂ§öÊòæÁ§∫5Êù°ËÆ∞ÂΩï"),Js=f("<div class=data-preview><div class=preview-header><div class=preview-title><span class=preview-icon>üìä</span><h5>Êï∞ÊçÆÈ¢ÑËßà</h5></div><div class=preview-stats><span class=stat-item><span class=stat-label>ËÆ∞ÂΩïÊï∞:</span><span class=stat-value></span></span><span class=stat-item><span class=stat-label>Â≠óÊÆµÊï∞:</span><span class=stat-value></span></span></div></div><div class=fields-info><div class=fields-title>üìã Ê£ÄÊµãÂà∞ÁöÑÂ≠óÊÆµ:</div><div class=fields-grid></div></div><div class=preview-table-container><div class=table-title>üîç Á§∫‰æãÊï∞ÊçÆ (Ââç5Êù°):</div><div class=preview-table><table><thead><tr></tr></thead><tbody></tbody></table></div></div><div class=advanced-info><button class=advanced-toggle><span class=toggle-icon></span><span class=toggle-text>È´òÁ∫ß‰ø°ÊÅØ"),Vs=f("<li>È¶ñÊ¨°ÈÖçÁΩÆÊï∞ÊçÆÊ∫êÊó∂ÔºåÂª∫ËÆÆÂÖàÊµãËØïËøûÊé•Á°Æ‰øùÈÖçÁΩÆÊ≠£Á°Æ"),Ws=f("<li>ÊµãËØïËøáÁ®ã‰ºöÈ™åËØÅJSONÊ†ºÂºèÂíåÊñá‰ª∂ËÆøÈóÆÊùÉÈôê"),Gs=f("<li>È¢ÑËßàÂäüËÉΩÂèØ‰ª•Â∏ÆÂä©ÊÇ®Á°ÆËÆ§Êï∞ÊçÆÁªìÊûÑÊòØÂê¶Á¨¶ÂêàÈ¢ÑÊúü"),Ks=f("<li>‚úÖ ËøûÊé•ÊµãËØïÊàêÂäüÔºÅÊÇ®ÂèØ‰ª•ÁªßÁª≠ÂàõÂª∫Êï∞ÊçÆÊ∫ê"),Ys=f("<li>È¢ÑËßàÊòæÁ§∫ÁöÑÊòØÂÆûÈôÖÊï∞ÊçÆÔºåÂàõÂª∫ÂêéÂèØÁî®‰∫éÊä•Ë°®ËÆæËÆ°"),Xs=f("<li>Â≠óÊÆµÂêçÁß∞Â∞ÜÁî®‰∫éÊï∞ÊçÆÁªëÂÆöË°®ËææÂºè"),Zs=f("<li>‚ùå ËØ∑Ê£ÄÊü•JSONÊ†ºÂºèÊòØÂê¶Ê≠£Á°Æ"),er=f("<li>Â¶ÇÊûúÊòØÊñá‰ª∂Á±ªÂûãÔºåËØ∑Á°ÆËÆ§Êñá‰ª∂Ë∑ØÂæÑÂ≠òÂú®‰∏îÂèØËÆøÈóÆ"),tr=f("<li>ÂèØ‰ª•ËøîÂõû‰∏ä‰∏ÄÊ≠•‰øÆÊîπÈÖçÁΩÆÂêéÈáçÊñ∞ÊµãËØï"),nr=f("<div class=security-notice><div class=notice-icon>üîí</div><div class=notice-content><div class=notice-title>ÂÆâÂÖ®ÊèêÁ§∫</div><div class=notice-text>Â∫îÁî®Â∞ÜËØªÂèñÊåáÂÆöÁöÑJSONÊñá‰ª∂„ÄÇËØ∑Á°Æ‰øùÊñá‰ª∂ÂÜÖÂÆπÂÆâÂÖ®ÔºåÈÅøÂÖçÂåÖÂê´ÊïèÊÑü‰ø°ÊÅØ„ÄÇ ÂêØÁî®Ëá™Âä®Âà∑Êñ∞Êó∂ÔºåÂ∫îÁî®‰ºöÂÆöÊúüÊ£ÄÊü•Êñá‰ª∂ÂèòÂåñ„ÄÇ"),lr=f("<div class=test-preview-step><div class=step-header><h4>üß™ ÊµãËØï‰∏éÈ¢ÑËßà</h4><p>È™åËØÅÊï∞ÊçÆÊ∫êÈÖçÁΩÆÂπ∂È¢ÑËßàÊï∞ÊçÆÂÜÖÂÆπ</p></div><div class=test-section><div class=test-connection><div class=test-header><div class=test-title><span class=test-icon></span><span class=test-text></span></div><button></button></div></div><div class=test-suggestions><div class=suggestions-title>üí° ÊµãËØïÂª∫ËÆÆ:</div><ul class=suggestions-list>"),ir=f("<span class=loading-spinner>‚è≥"),sr=f("<span class=test-button-icon>üîå"),rr=f("<div class=field-tag><span class=field-name>"),ar=f("<th>"),or=f("<tr>"),cr=f("<td><div class=cell-content>"),dr=f("<span class=validation-hint><span class=hint-icon>‚ö†Ô∏è</span>ËØ∑ÂÆåÊàêÂΩìÂâçÊ≠•È™§ÁöÑÂøÖÂ°´È°π"),ur=f('<button class="control-btn next-btn"><span class=btn-text>‰∏ã‰∏ÄÊ≠•</span><span class=btn-icon>‚Üí'),gr=f('<button class="control-btn finish-btn">'),hr=f("<span class=hint-text>ÈÄâÊã©ÊÇ®ÁöÑJSONÊï∞ÊçÆÊù•Ê∫êÊñπÂºè"),Yt=f("<span class=hint-text>"),vr=f("<span class=hint-text>ËÆæÁΩÆÊï∞ÊçÆÊ∫êÂêçÁß∞ÂíåÈÄâÈ°π"),fr=f('<div class=wizard-controls><div class=controls-info><span class=current-step-info>Ê≠•È™§ <!> / 4: </span></div><div class=control-buttons><button class="control-btn back-btn"><span class=btn-icon>‚Üê</span><span class=btn-text>‰∏ä‰∏ÄÊ≠•</span></button></div><div class=progress-hints>'),mr=f("<span class=btn-loading>‚è≥"),br=f("<span class=btn-text>ÂàõÂª∫‰∏≠..."),pr=f("<span class=btn-icon>‚úì"),yr=f("<span class=btn-text>ÂàõÂª∫Êï∞ÊçÆÊ∫ê");function Cn(e){const[t,n]=Z({currentStep:1,sourceType:null,name:"",config:{source_type:"content",auto_refresh:!1,refresh_interval:300},validation:{isValid:!1,errors:[],warnings:[]},testResult:null,loading:!1}),l=[{step:1,title:"ÈÄâÊã©Êï∞ÊçÆÊù•Ê∫ê",description:"ÈÄâÊã©JSONÊï∞ÊçÆÁöÑËæìÂÖ•ÊñπÂºè"},{step:2,title:"ËæìÂÖ•Êï∞ÊçÆ",description:"Êèê‰æõÂÖ∑‰ΩìÁöÑJSONÊï∞ÊçÆ"},{step:3,title:"Âü∫Á°ÄÈÖçÁΩÆ",description:"ËÆæÁΩÆÊï∞ÊçÆÊ∫êÂêçÁß∞ÂíåÈÄâÈ°π"},{step:4,title:"ÊµãËØïÈ¢ÑËßà",description:"È™åËØÅÊï∞ÊçÆÊ∫êÂπ∂È¢ÑËßàÊïàÊûú"}],i=Ce(()=>{const d=t();switch(d.currentStep){case 1:return d.sourceType!==null;case 2:return s(d);case 3:return a(d);case 4:return o(d);default:return!1}}),s=d=>{var p,_;if(d.sourceType==="file")return!!((p=d.config.file_path)!=null&&p.trim());if(d.sourceType==="content"){const y=(_=d.config.json_content)==null?void 0:_.trim();if(!y)return!1;try{return JSON.parse(y),!0}catch{return!1}}return!1},a=d=>{const p=d.name.trim();return!(p.length<2||p.length>50||!/^[\u4e00-\u9fa5a-zA-Z0-9\s\-_]+$/.test(p))},o=d=>{var p;return!!((p=d.testResult)!=null&&p.success)},g=d=>{const p=t();n(_=>({..._,validation:{..._.validation,errors:[]}})),p.currentStep===1&&p.sourceType?n(_=>({..._,currentStep:d,config:{..._.config,source_type:p.sourceType}})):n(_=>({..._,currentStep:d}))},c=()=>{const d=t();d.currentStep<4&&i()&&g(d.currentStep+1)},b=()=>{const d=t();d.currentStep>1&&(d.currentStep===4?n(p=>({...p,currentStep:p.currentStep-1,testResult:null})):g(d.currentStep-1))},u=d=>{n(p=>({...p,...d}))},m=async()=>{var p,_;const d=t();u({loading:!0,testResult:null});try{console.log("üîÑ ÂºÄÂßãÊµãËØïËøûÊé•...");const y={...d.config,source_type:d.sourceType};if(await we.testConnection("json",y)){console.log("‚úÖ ËøûÊé•ÊµãËØïÊàêÂäüÔºåËé∑ÂèñÈ¢ÑËßàÊï∞ÊçÆ...");const C=await we.discoverSchema("json",y),k=`temp_${Date.now()}`,E=await we.createDataSource(k,"json",y),D=await we.getPreview(E,void 0,5);await we.deleteDataSource(E),u({testResult:{success:!0,message:"ËøûÊé•ÊµãËØïÊàêÂäüÔºÅÊï∞ÊçÆÊ†ºÂºèÊ≠£Á°Æ„ÄÇ",preview:{record_count:(_=(p=D.total_rows)!=null?p:D.total_count)!=null?_:0,fields:C.columns.map(L=>L.name),sample_data:D.rows}},loading:!1})}}catch(y){console.error("‚ùå ËøûÊé•ÊµãËØïÂ§±Ë¥•:",y),u({testResult:{success:!1,message:"ËøûÊé•ÊµãËØïÂ§±Ë¥•",error:y instanceof Error?y.message:String(y)},loading:!1})}},v=async()=>{const d=t();u({loading:!0});try{console.log("üîÑ ÂºÄÂßãÂàõÂª∫Êï∞ÊçÆÊ∫ê...");const p={...d.config,source_type:d.sourceType},_=await we.createDataSource(d.name,"json",p);console.log("‚úÖ Êï∞ÊçÆÊ∫êÂàõÂª∫ÊàêÂäüÔºåID:",_);try{await Ze.setActiveDataSource(_),console.log("‚úÖ Êï∞ÊçÆÊ∫êËá™Âä®ÊøÄÊ¥ªÊàêÂäü")}catch(y){console.warn("‚ö†Ô∏è Êï∞ÊçÆÊ∫êÊøÄÊ¥ªÂ§±Ë¥•Ôºå‰ΩÜÂàõÂª∫ÊàêÂäü:",y)}e.onSuccess(),e.onBack()}catch(p){console.error("‚ùå ÂàõÂª∫Êï∞ÊçÆÊ∫êÂ§±Ë¥•:",p),u({validation:{isValid:!1,errors:[`ÂàõÂª∫Â§±Ë¥•: ${p}`],warnings:[]},loading:!1})}};return(()=>{var d=bs(),p=d.firstChild,_=p.firstChild,y=_.nextSibling,$=y.firstChild,C=$.nextSibling,k=p.nextSibling;return Te(_,"click",e.onBack),r(C,()=>{var E;return(E=l[t().currentStep-1])==null?void 0:E.description}),r(d,h($r,{get currentStep(){return t().currentStep},stepInfo:l,onStepClick:g}),k),r(k,h(M,{get when(){return t().currentStep===1},get children(){return h(_r,{get selectedType(){return t().sourceType},onSelect:E=>u({sourceType:E,config:{...t().config,source_type:E}})})}}),null),r(k,h(M,{get when(){return t().currentStep===2},get children(){return h(xr,{get sourceType(){return t().sourceType},get config(){return t().config},onConfigUpdate:E=>u({config:{...t().config,...E}})})}}),null),r(k,h(M,{get when(){return t().currentStep===3},get children(){return h(wr,{get name(){return t().name},get config(){return t().config},onNameChange:E=>u({name:E}),onConfigUpdate:E=>u({config:{...t().config,...E}})})}}),null),r(k,h(M,{get when(){return t().currentStep===4},get children(){return h(kr,{get config(){return t().config},get testResult(){return t().testResult},get loading(){return t().loading},onTest:m})}}),null),r(d,h(Tr,{get currentStep(){return t().currentStep},get canProceed(){return i()},get loading(){return t().loading},get testResult(){return t().testResult},onPrevious:b,onNext:c,onFinish:v}),null),r(d,h(M,{get when(){return t().validation.errors.length>0},get children(){var E=ms();return r(E,h(oe,{get each(){return t().validation.errors},children:D=>(()=>{var L=ps();return r(L,D),L})()})),E}}),null),d})()}function $r(e){return(()=>{var t=ys();return r(t,h(oe,{get each(){return e.stepInfo},children:n=>{const l=e.currentStep===n.step,i=e.currentStep>n.step,s=e.currentStep>=n.step;return(()=>{var a=$s(),o=a.firstChild,g=o.firstChild,c=o.nextSibling,b=c.firstChild,u=b.nextSibling;return a.$$click=()=>s&&e.onStepClick(n.step),_e(a,`progress-step ${l?"active":""} ${i?"completed":""}`),r(g,()=>i?"‚úì":n.step),r(b,()=>n.title),r(u,()=>n.description),a})()}})),t})()}function _r(e){const t=[{type:"file",title:"üìÅ ‰ªéÊñá‰ª∂Âä†ËΩΩ",description:"‰ªéÊú¨Âú∞JSONÊñá‰ª∂ÂØºÂÖ•Êï∞ÊçÆ",features:["ÊîØÊåÅÂ§ßÊñá‰ª∂","Ëá™Âä®Âà∑Êñ∞","ÈÄÇÂêàÈùôÊÄÅÊï∞ÊçÆ"],example:"ÈÄÇÂêàÔºöÊú¨Âú∞ÈÖçÁΩÆÊñá‰ª∂„ÄÅÂØºÂá∫Êï∞ÊçÆÁ≠â"},{type:"content",title:"‚úèÔ∏è Áõ¥Êé•ËæìÂÖ•ÂÜÖÂÆπ",description:"Á≤òË¥¥ÊàñËæìÂÖ•JSONÂÜÖÂÆπ",features:["Âø´ÈÄüÊµãËØï","Âä®ÊÄÅÁºñËæë","ÈÄÇÂêàÂ∞èÊï∞ÊçÆ"],example:"ÈÄÇÂêàÔºöAPIÂìçÂ∫î„ÄÅ‰∏¥Êó∂Êï∞ÊçÆ„ÄÅÊµãËØïÊï∞ÊçÆÁ≠â"}];return(()=>{var n=_s(),l=n.firstChild,i=l.nextSibling;return r(i,h(oe,{each:t,children:s=>(()=>{var a=xs(),o=a.firstChild,g=o.firstChild,c=g.nextSibling,b=o.nextSibling,u=b.nextSibling,m=u.nextSibling,v=m.firstChild;return a.$$click=()=>e.onSelect(s.type),r(g,()=>s.title),r(c,()=>s.description),r(b,h(oe,{get each(){return s.features},children:d=>(()=>{var p=Ss();return r(p,d),p})()})),r(u,()=>s.example),v.addEventListener("change",()=>e.onSelect(s.type)),A(()=>_e(a,`source-option ${e.selectedType===s.type?"selected":""}`)),A(()=>v.checked=e.selectedType===s.type),a})()})),n})()}function xr(e){return(()=>{var t=ws(),n=t.firstChild,l=n.firstChild,i=l.nextSibling;return r(l,()=>e.sourceType==="file"?"üìÅ ÈÄâÊã©JSONÊñá‰ª∂":"‚úèÔ∏è ËæìÂÖ•JSONÂÜÖÂÆπ"),r(i,()=>e.sourceType==="file"?"ËØ∑ÈÄâÊã©Ë¶ÅÂØºÂÖ•ÁöÑJSONÊñá‰ª∂ÔºåÊîØÊåÅÊãñÊãΩ‰∏ä‰º†":"ËØ∑Á≤òË¥¥ÊàñËæìÂÖ•ÊÇ®ÁöÑJSONÊï∞ÊçÆÂÜÖÂÆπ"),r(t,h(M,{get when(){return e.sourceType==="file"},get children(){return h(Sr,{get filePath(){return e.config.file_path||""},onFileSelect:s=>e.onConfigUpdate({file_path:s})})}}),null),r(t,h(M,{get when(){return e.sourceType==="content"},get children(){return h(Cr,{get content(){return e.config.json_content||""},onContentChange:s=>e.onConfigUpdate({json_content:s})})}}),null),t})()}function Sr(e){const[t,n]=Z(!1),[l,i]=Z(null),s=g=>{var u;const b=(u=g.target.files)==null?void 0:u[0];b&&o(b)},a=g=>{var b,u;g.preventDefault(),n(!1);const c=(u=(b=g.dataTransfer)==null?void 0:b.files)==null?void 0:u[0];c&&o(c)},o=g=>{if(i(null),!g.name.endsWith(".json")){i("ËØ∑ÈÄâÊã©JSONÊñá‰ª∂Ôºà.jsonÊ†ºÂºèÔºâ");return}if(g.size>10*1024*1024){i("Êñá‰ª∂Â§ßÂ∞è‰∏çËÉΩË∂ÖËøá10MB");return}const c=new FileReader;c.onload=b=>{var u;try{const m=(u=b.target)==null?void 0:u.result;JSON.parse(m),e.onFileSelect(g.name),console.log("‚úÖ Êñá‰ª∂ÈÄâÊã©ÊàêÂäü:",g.name)}catch{i("Êñá‰ª∂ÂÜÖÂÆπ‰∏çÊòØÊúâÊïàÁöÑJSONÊ†ºÂºè")}},c.readAsText(g)};return(()=>{var g=Ts(),c=g.firstChild,b=c.nextSibling,u=b.firstChild,m=u.firstChild,v=b.nextSibling;return c.addEventListener("drop",a),c.addEventListener("dragleave",()=>n(!1)),c.addEventListener("dragover",d=>{d.preventDefault(),n(!0)}),m.addEventListener("change",s),r(b,h(M,{get when(){return e.filePath},get children(){var d=Cs(),p=d.firstChild,_=p.nextSibling,y=_.nextSibling;return r(_,()=>e.filePath),y.$$click=()=>e.onFileSelect(""),d}}),null),r(g,h(M,{get when(){return l()},get children(){var d=ks();return r(d,l),d}}),v),A(()=>_e(c,`file-drop-zone ${t()?"active":""}`)),g})()}function wr(e){const[t,n]=Z(null),l=s=>{e.onNameChange(s),s.trim().length===0?n("Êï∞ÊçÆÊ∫êÂêçÁß∞‰∏çËÉΩ‰∏∫Á©∫"):s.trim().length<2?n("Êï∞ÊçÆÊ∫êÂêçÁß∞Ëá≥Â∞ëÈúÄË¶Å2‰∏™Â≠óÁ¨¶"):s.trim().length>50?n("Êï∞ÊçÆÊ∫êÂêçÁß∞‰∏çËÉΩË∂ÖËøá50‰∏™Â≠óÁ¨¶"):/^[\u4e00-\u9fa5a-zA-Z0-9\s\-_]+$/.test(s.trim())?n(null):n("Êï∞ÊçÆÊ∫êÂêçÁß∞Âè™ËÉΩÂåÖÂê´‰∏≠Êñá„ÄÅËã±Êñá„ÄÅÊï∞Â≠ó„ÄÅÁ©∫Ê†º„ÄÅËøûÂ≠óÁ¨¶Âíå‰∏ãÂàíÁ∫ø")},i=s=>{const a=parseInt(s);!isNaN(a)&&a>=10&&a<=3600&&e.onConfigUpdate({refresh_interval:a})};return(()=>{var s=Rs(),a=s.firstChild,o=a.nextSibling,g=o.firstChild,c=g.firstChild,b=c.nextSibling,u=b.firstChild,m=u.nextSibling,v=m.nextSibling,d=g.nextSibling,p=d.firstChild,_=p.nextSibling,y=_.firstChild,$=y.firstChild,C=$.nextSibling;return m.$$input=k=>l(k.currentTarget.value),r(b,h(M,{get when(){return t()},get children(){var k=Es();return r(k,t),k}}),v),r(o,h(M,{get when(){return e.config.source_type==="file"},get children(){var k=Ds(),E=k.firstChild,D=E.nextSibling,L=D.firstChild,O=L.firstChild;return O.addEventListener("change",K=>e.onConfigUpdate({auto_refresh:K.currentTarget.checked})),r(k,h(M,{get when(){return e.config.auto_refresh},get children(){var K=Ls(),R=K.firstChild,P=R.nextSibling,S=P.firstChild,Q=S.nextSibling;return S.$$input=B=>i(B.currentTarget.value),Q.addEventListener("change",B=>i(B.currentTarget.value)),A(()=>S.value=e.config.refresh_interval),A(()=>Q.value=e.config.refresh_interval),K}}),null),A(()=>O.checked=e.config.auto_refresh),k}}),d),r(C,()=>e.config.source_type==="file"?"üìÅ ‰ªéÊñá‰ª∂Âä†ËΩΩ":"‚úèÔ∏è Áõ¥Êé•ËæìÂÖ•ÂÜÖÂÆπ"),r(_,h(M,{get when(){return e.config.source_type==="file"},get children(){return[(()=>{var k=Ps(),E=k.firstChild,D=E.nextSibling;return r(D,()=>e.config.file_path||"(Êú™ÈÄâÊã©Êñá‰ª∂)"),k})(),(()=>{var k=As(),E=k.firstChild,D=E.nextSibling;return r(D,()=>e.config.auto_refresh?`‚úÖ ÊØè ${e.config.refresh_interval} ÁßíÊ£ÄÊü•‰∏ÄÊ¨°`:"‚ùå Â∑≤ÂÖ≥Èó≠"),k})()]}}),null),r(_,h(M,{get when(){return e.config.source_type==="content"},get children(){var k=zs(),E=k.firstChild,D=E.nextSibling,L=D.firstChild;return r(D,()=>{var O;return((O=e.config.json_content)==null?void 0:O.length)||0},L),k}}),null),A(()=>_e(m,`name-input ${t()?"error":""}`)),A(()=>m.value=e.name),s})()}function Cr(e){const[t,n]=Z(null),[l,i]=Z(!1),s=[{name:"ÁÆÄÂçïÂØπË±°",description:"Âçï‰∏™JSONÂØπË±°",content:`{
  "name": "Á§∫‰æãÊï∞ÊçÆ",
  "value": 123,
  "active": true,
  "created_at": "2024-12-21"
}`},{name:"ÂØπË±°Êï∞ÁªÑ",description:"Â§öÊù°ËÆ∞ÂΩïÊï∞ÊçÆ",content:`[
  {
    "id": 1,
    "name": "Âº†‰∏â",
    "age": 25,
    "department": "ÊäÄÊúØÈÉ®"
  },
  {
    "id": 2,
    "name": "ÊùéÂõõ", 
    "age": 30,
    "department": "ÈîÄÂîÆÈÉ®"
  }
]`},{name:"Â§çÊùÇÂµåÂ•ó",description:"ÂåÖÂê´ÂµåÂ•óÂØπË±°ÂíåÊï∞ÁªÑ",content:`{
  "company": "Á§∫‰æãÂÖ¨Âè∏",
  "employees": [
    {
      "name": "Âº†‰∏â",
      "position": "Â∑•Á®ãÂ∏à",
      "skills": ["JavaScript", "Python"],
      "contact": {
        "email": "zhang@example.com",
        "phone": "138****1234"
      }
    }
  ],
  "metadata": {
    "total": 1,
    "updated": "2024-12-21T10:30:00Z"
  }
}`}],a=g=>{if(e.onContentChange(g),g.trim())try{JSON.parse(g),n(null)}catch(c){n(c instanceof Error?c.message:"Êó†ÊïàÁöÑJSONÊ†ºÂºè")}else n(null)},o=g=>{e.onContentChange(g.content),n(null),i(!1)};return(()=>{var g=Us(),c=g.firstChild,b=c.firstChild,u=b.nextSibling,m=u.nextSibling,v=c.nextSibling,d=v.firstChild,p=v.nextSibling;return b.$$click=()=>i(!l()),u.$$click=()=>e.onContentChange(""),r(m,h(M,{get when(){return xe(()=>!t())()&&e.content.trim()},get children(){return Ms()}}),null),r(m,h(M,{get when(){return t()},get children(){return Ns()}}),null),r(g,h(M,{get when(){return l()},get children(){var _=Os(),y=_.firstChild,$=y.nextSibling;return r($,h(oe,{each:s,children:C=>(()=>{var k=Fs(),E=k.firstChild,D=E.nextSibling;return k.$$click=()=>o(C),r(E,()=>C.name),r(D,()=>C.description),k})()})),_}}),v),d.$$input=_=>a(_.currentTarget.value),r(g,h(M,{get when(){return t()},get children(){var _=Is(),y=_.firstChild,$=y.nextSibling;return r($,t),_}}),p),A(_=>{var y=!e.content,$=`json-textarea ${t()?"error":""}`;return y!==_.e&&(u.disabled=_.e=y),$!==_.t&&_e(d,_.t=$),_},{e:void 0,t:void 0}),A(()=>d.value=e.content),g})()}function kr(e){const[t,n]=Z(!1),l=()=>e.loading?"üîÑ":e.testResult?e.testResult.success?"‚úÖ":"‚ùå":"‚ö°",i=()=>e.loading?"ÊµãËØïËøûÊé•‰∏≠...":e.testResult?e.testResult.success?"ËøûÊé•ÊµãËØïÊàêÂäü":"ËøûÊé•ÊµãËØïÂ§±Ë¥•":"ÁÇπÂáªÊµãËØïËøûÊé•",s=()=>e.loading?"testing":e.testResult?e.testResult.success?"success":"error":"ready",a=o=>typeof o=="object"?JSON.stringify(o,null,2):String(o);return(()=>{var o=lr(),g=o.firstChild,c=g.nextSibling,b=c.firstChild,u=b.firstChild,m=u.firstChild,v=m.firstChild,d=v.nextSibling,p=m.nextSibling,_=b.nextSibling,y=_.firstChild,$=y.nextSibling;return r(v,l),r(d,i),Te(p,"click",e.onTest),r(p,(()=>{var C=xe(()=>!!e.loading);return()=>C()?[ir(),"ÊµãËØï‰∏≠..."]:[sr(),"ÊµãËØïËøûÊé•"]})()),r(b,h(M,{get when(){return e.testResult},get children(){var C=qs(),k=C.firstChild,E=k.firstChild,D=E.nextSibling;return r(E,l),r(D,()=>e.testResult.message),r(C,h(M,{get when(){return e.testResult.error},get children(){var L=Bs(),O=L.firstChild,K=O.nextSibling;return r(K,()=>e.testResult.error),L}}),null),A(()=>_e(C,`test-result ${s()}`)),C}}),null),r(c,h(M,{get when(){var C;return((C=e.testResult)==null?void 0:C.success)&&e.testResult.preview},get children(){var C=Js(),k=C.firstChild,E=k.firstChild,D=E.nextSibling,L=D.firstChild,O=L.firstChild,K=O.nextSibling,R=L.nextSibling,P=R.firstChild,S=P.nextSibling,Q=k.nextSibling,B=Q.firstChild,w=B.nextSibling,z=Q.nextSibling,N=z.firstChild,U=N.nextSibling,H=U.firstChild,J=H.firstChild,me=J.firstChild,X=J.nextSibling,j=z.nextSibling,se=j.firstChild,ve=se.firstChild;return r(K,()=>e.testResult.preview.record_count),r(S,()=>e.testResult.preview.fields.length),r(w,h(oe,{get each(){return e.testResult.preview.fields},children:re=>(()=>{var le=rr(),ee=le.firstChild;return r(ee,re),le})()})),r(me,h(oe,{get each(){return e.testResult.preview.fields},children:re=>(()=>{var le=ar();return r(le,re),le})()})),r(X,h(oe,{get each(){return e.testResult.preview.sample_data},children:re=>(()=>{var le=or();return r(le,h(oe,{get each(){return e.testResult.preview.fields},children:ee=>(()=>{var ne=cr(),de=ne.firstChild;return r(de,(()=>{var Y=xe(()=>re[ee]!==void 0);return()=>Y()?a(re[ee]):"-"})()),ne})()})),le})()})),se.$$click=()=>n(!t()),r(ve,()=>t()?"‚ñº":"‚ñ∂"),r(j,h(M,{get when(){return t()},get children(){var re=Qs(),le=re.firstChild,ee=le.firstChild,ne=ee.firstChild,de=ne.nextSibling,Y=ee.nextSibling;return r(de,()=>e.config.source_type==="file"?"JSONÊñá‰ª∂":"JSONÂÜÖÂÆπ"),r(le,h(M,{get when(){return e.config.source_type==="file"},get children(){return[(()=>{var W=js(),he=W.firstChild,be=he.nextSibling;return r(be,()=>e.config.file_path),W})(),(()=>{var W=Hs(),he=W.firstChild,be=he.nextSibling;return r(be,()=>e.config.auto_refresh?"Â∑≤ÂêØÁî®":"Â∑≤Á¶ÅÁî®"),W})()]}}),Y),re}}),null),C}}),_),r($,h(M,{get when(){return!e.testResult},get children(){return[Vs(),Ws(),Gs()]}}),null),r($,h(M,{get when(){var C;return(C=e.testResult)==null?void 0:C.success},get children(){return[Ks(),Ys(),Xs()]}}),null),r($,h(M,{get when(){return e.testResult&&!e.testResult.success},get children(){return[Zs(),er(),tr()]}}),null),r(c,h(M,{get when(){return e.config.source_type==="file"},get children(){return nr()}}),null),A(C=>{var k=`test-button ${s()}`,E=e.loading;return k!==C.e&&_e(p,C.e=k),E!==C.t&&(p.disabled=C.t=E),C},{e:void 0,t:void 0}),o})()}function Tr(e){const t=s=>{switch(s){case 1:return"ÈÄâÊã©Êù•Ê∫ê";case 2:return"ËæìÂÖ•Êï∞ÊçÆ";case 3:return"Âü∫Á°ÄÈÖçÁΩÆ";case 4:return"ÊµãËØïÈ¢ÑËßà";default:return`Ê≠•È™§${s}`}},n=()=>e.currentStep>1,l=()=>e.currentStep<4&&e.canProceed,i=()=>e.currentStep===4&&e.canProceed;return(()=>{var s=fr(),a=s.firstChild,o=a.firstChild,g=o.firstChild,c=g.nextSibling;c.nextSibling;var b=a.nextSibling,u=b.firstChild,m=b.nextSibling;return r(o,()=>e.currentStep,c),r(o,()=>t(e.currentStep),null),r(a,h(M,{get when(){return!e.canProceed&&e.currentStep<4},get children(){return dr()}}),null),Te(u,"click",e.onPrevious),r(b,h(M,{get when(){return e.currentStep<4},get children(){var v=ur();return Te(v,"click",e.onNext),A(()=>v.disabled=!l()||e.loading),v}}),null),r(b,h(M,{get when(){return e.currentStep===4},get children(){var v=gr();return Te(v,"click",e.onFinish),r(v,(()=>{var d=xe(()=>!!e.loading);return()=>d()?[mr(),br()]:[pr(),yr()]})()),A(()=>v.disabled=!i()||e.loading),v}}),null),r(m,h(M,{get when(){return e.currentStep===1},get children(){return hr()}}),null),r(m,h(M,{get when(){return e.currentStep===2},get children(){var v=Yt();return r(v,()=>{var d;return(d=e.testResult)!=null&&d.success?"Êï∞ÊçÆÊ†ºÂºèÈ™åËØÅÊàêÂäü":"ËØ∑Êèê‰æõJSONÊï∞ÊçÆÂÜÖÂÆπ"}),v}}),null),r(m,h(M,{get when(){return e.currentStep===3},get children(){return vr()}}),null),r(m,h(M,{get when(){return e.currentStep===4},get children(){var v=Yt();return r(v,()=>{var d;return(d=e.testResult)!=null&&d.success?"‰∏ÄÂàáÂ∞±Áª™ÔºåÂèØ‰ª•ÂàõÂª∫Êï∞ÊçÆÊ∫ê":"Âª∫ËÆÆÂÖàÊµãËØïËøûÊé•‰ª•Á°Æ‰øùÈÖçÁΩÆÊ≠£Á°Æ"}),v}}),null),A(()=>u.disabled=!n()||e.loading),s})()}Pe(["click","input"]);var Er=f("<div class=data-sources-panel role=dialog aria-modal=true aria-labelledby=data-panel-title aria-describedby=data-panel-description><a href=#data-panel-content class=skip-to-content>Ë∑≥ËΩ¨Âà∞ÂÜÖÂÆπ</a><div class=panel-header><h2 id=data-panel-title>Êï∞ÊçÆÊ∫êÁÆ°ÁêÜ</h2><span id=data-panel-description class=sr-only>ÁÆ°ÁêÜJSONÊï∞ÊçÆÊ∫êÔºåÂåÖÊã¨ÂàõÂª∫„ÄÅÁºñËæë„ÄÅÊµãËØïÂíåÈ¢ÑËßàÂäüËÉΩ</span><button class=close-btn aria-label=ÂÖ≥Èó≠Êï∞ÊçÆÊ∫êÈù¢Êùø title=ÂÖ≥Èó≠Êï∞ÊçÆÊ∫êÈù¢Êùø>√ó</button></div><div class=panel-content id=data-panel-content>"),Lr=f("<div class=error-message>"),Dr=f("<div class=loading-message>Âä†ËΩΩ‰∏≠..."),Pr=f("<div class=empty-state><p>Â∞öÊú™ÈÖçÁΩÆ‰ªª‰ΩïÊï∞ÊçÆÊ∫ê</p><button>Ê∑ªÂä†Á¨¨‰∏Ä‰∏™Êï∞ÊçÆÊ∫ê"),Ar=f("<div class=sources-grid>"),zr=f("<div class=data-sources-list><div class=list-header><div class=list-title><h3>Â∑≤ÈÖçÁΩÆÁöÑÊï∞ÊçÆÊ∫ê (<!>)</h3><button class=refresh-btn>üîÑ Âà∑Êñ∞</button></div><button class=add-btn aria-label=Ê∑ªÂä†Êñ∞ÁöÑÊï∞ÊçÆÊ∫ê title=ÂàõÂª∫Êñ∞ÁöÑJSONÊï∞ÊçÆÊ∫ê>+ Ê∑ªÂä†Êï∞ÊçÆÊ∫ê"),Rr=f('<div class=source-card><div class=source-header><div class=source-info><h4></h4><span class=source-type></span></div><div class=source-status></div></div><div class=source-meta><div class=meta-item><span>ÂàõÂª∫Êó∂Èó¥:</span><span></span></div><div class=meta-item><span>ÊúÄÂêéÊõ¥Êñ∞:</span><span></span></div></div><div class=source-actions><button class="action-btn preview-btn">üëÅÔ∏è È¢ÑËßà</button><button class="action-btn test-btn">üîå ÊµãËØï</button><button class="action-btn edit-btn">‚úèÔ∏è ÁºñËæë</button><button class="action-btn delete-btn">üóëÔ∏è Âà†Èô§'),Mr=f("<span class=changes-indicator>‚óè ÊúâÊú™‰øùÂ≠òÁöÑÊõ¥Êîπ"),Nr=f("<div class=error-details>"),Or=f("<div><div class=result-message> "),Ir=f("<div class=error-message>‚ùå "),Ur=f("<button type=button class=reset-btn>ÈáçÁΩÆÊõ¥Êîπ"),Fr=f('<div class=edit-data-source-form><div class=form-header><button class=back-btn>‚Üê ËøîÂõû</button><div class=header-info><h3>ÁºñËæëÊï∞ÊçÆÊ∫ê</h3><div class=source-meta><span class=source-type></span><span class=source-id>ID: </span></div></div></div><div class=edit-content><div class=edit-section><div class=section-header><h4>üè∑Ô∏è Âü∫Êú¨‰ø°ÊÅØ</h4></div><div class=form-field><label>Êï∞ÊçÆÊ∫êÂêçÁß∞</label><input type=text placeholder=ËØ∑ËæìÂÖ•Êï∞ÊçÆÊ∫êÂêçÁß∞></div></div><div class=edit-section><div class=section-header><h4>‚öôÔ∏è ÈÖçÁΩÆ‰ø°ÊÅØ</h4></div><div class=form-field><label>Êï∞ÊçÆÊ∫êÈÖçÁΩÆ</label><textarea rows=12 placeholder="Êï∞ÊçÆÊ∫êÈÖçÁΩÆ (JSONÊ†ºÂºè)"></textarea><div class=config-hint>üí° ‰øÆÊîπÈÖçÁΩÆÂêéÂª∫ËÆÆÂÖàÊµãËØïËøûÊé•ÔºåÁ°Æ‰øùÈÖçÁΩÆÊúâÊïà</div></div></div><div class=edit-section><div class=section-header><h4>üîå ËøûÊé•ÊµãËØï</h4><button class=test-connection-btn></button></div></div><div class=edit-section><div class=section-header><h4>üìä Êï∞ÊçÆÊ∫êÁä∂ÊÄÅ</h4></div><div class=status-grid><div class=status-item><span class=status-label>ÂΩìÂâçÁä∂ÊÄÅ:</span><span></span></div><div class=status-item><span class=status-label>ÂàõÂª∫Êó∂Èó¥:</span><span class=status-value></span></div><div class=status-item><span class=status-label>ÊúÄÂêéÊõ¥Êñ∞:</span><span class=status-value></span></div></div></div><div class=form-actions><button type=button class=cancel-btn>ÂèñÊ∂à</button><button type=button></button></div><div class=edit-tips><div class=tips-title>üí° ÁºñËæëÊèêÁ§∫:</div><ul><li>‰øÆÊîπÈÖçÁΩÆÂêéÂª∫ËÆÆÂÖàÊµãËØïËøûÊé•Á°Æ‰øùÊúâÊïàÊÄß</li><li>‰øùÂ≠òÊõ¥ÊîπÂêéÂèØËÉΩÈúÄË¶ÅÈáçÊñ∞ÊøÄÊ¥ªÊï∞ÊçÆÊ∫ê</li><li>JSONÈÖçÁΩÆÊ†ºÂºèÈîôËØØ‰ºöÈòªÊ≠¢‰øùÂ≠ò</li><li>ÈáçÁΩÆÊõ¥ÊîπÂèØÊÅ¢Â§çÂà∞‰øùÂ≠òÂâçÁöÑÁä∂ÊÄÅ'),Br=f("<div class=data-preview><div class=preview-header><button class=back-btn>‚Üê ËøîÂõû</button><h3>Êï∞ÊçÆÈ¢ÑËßà: </h3><div class=preview-info>ÂÖ± <!> Ë°åÊï∞ÊçÆÔºåÊòæÁ§∫Ââç <!> Ë°å</div></div><div class=preview-table><table><thead><tr></tr></thead><tbody>"),qr=f("<th>"),jr=f("<tr>"),Hr=f("<td>");function Qr(e){const[t,n]=Z([]),[l,i]=Z([]),[s,a]=Z("list"),[o,g]=Z(null),[c,b]=Z(null),[u,m]=Z(!1),[v,d]=Z(null);Ue(async()=>{try{await p(),await _()}catch(D){console.error("üö® DataSourcesPanelÂàùÂßãÂåñÂ§±Ë¥•:",D),d(`Êï∞ÊçÆÊ∫êÊ®°ÂùóÂàùÂßãÂåñÂ§±Ë¥•: ${D}`)}});const p=async()=>{try{m(!0),console.log("üîÑ ÂºÄÂßãÂä†ËΩΩÊï∞ÊçÆÊ∫êÂàóË°®...");const D=await we.listDataSources();console.log("‚úÖ Êï∞ÊçÆÊ∫êÂàóË°®Âä†ËΩΩÊàêÂäü:",D),n(D),d(null)}catch(D){console.error("‚ùå Âä†ËΩΩÊï∞ÊçÆÊ∫êÂ§±Ë¥•:",D),d(`Âä†ËΩΩÊï∞ÊçÆÊ∫êÂ§±Ë¥•: ${D}`)}finally{m(!1)}},_=async()=>{try{console.log("üîÑ ÂºÄÂßãÂä†ËΩΩÂèØÁî®Êï∞ÊçÆÊ∫êÁ±ªÂûã...");const D=await we.getAvailableTypes();console.log("‚úÖ Êï∞ÊçÆÊ∫êÁ±ªÂûãÂä†ËΩΩÊàêÂäü:",D),i(D)}catch(D){console.error("‚ùå Âä†ËΩΩÊï∞ÊçÆÊ∫êÁ±ªÂûãÂ§±Ë¥•:",D)}},y=()=>{a("add"),g(null)},$=D=>{g(D),a("edit")},C=async D=>{try{m(!0),d(null),g(D),console.log("üîÑ ÂºÄÂßãÈ¢ÑËßàÊï∞ÊçÆÊ∫ê:",D.name),D.status!=="active"&&(console.log("‚ö†Ô∏è  Êï∞ÊçÆÊ∫êÁä∂ÊÄÅ‰∏çÊòØÊøÄÊ¥ªÁä∂ÊÄÅ:",D.status),d(`Êï∞ÊçÆÊ∫êÁä∂ÊÄÅ‰∏∫ ${D.status}ÔºåÂèØËÉΩÊó†Ê≥ïÈ¢ÑËßàÊï∞ÊçÆ`));const L=await we.getPreview(D.id);b(L),a("preview"),console.log("‚úÖ Êï∞ÊçÆÈ¢ÑËßàÂä†ËΩΩÊàêÂäü:",L)}catch(L){console.error("‚ùå Êï∞ÊçÆÈ¢ÑËßàÂ§±Ë¥•:",L);const O=`È¢ÑËßàÊï∞ÊçÆÊ∫ê "${D.name}" Â§±Ë¥•: ${L}`;d(O);const K={connection:"ËøûÊé•Â§±Ë¥•ÔºåËØ∑Ê£ÄÊü•Êï∞ÊçÆÊ∫êÈÖçÁΩÆ",permission:"ÊùÉÈôê‰∏çË∂≥ÔºåËØ∑Ê£ÄÊü•ËÆ§ËØÅ‰ø°ÊÅØ",not_found:"Êï∞ÊçÆÊ∫êÊàñÊï∞ÊçÆ‰∏çÂ≠òÂú®",timeout:"ËØ∑Ê±ÇË∂ÖÊó∂ÔºåËØ∑Á®çÂêéÈáçËØï"},R=String(L).toLowerCase(),P=Object.keys(K).find(S=>R.includes(S));P&&d(`È¢ÑËßàÂ§±Ë¥•: ${K[P]}`)}finally{m(!1)}},k=async D=>{if(confirm("Á°ÆÂÆöË¶ÅÂà†Èô§Ëøô‰∏™Êï∞ÊçÆÊ∫êÂêóÔºü"))try{await we.deleteDataSource(D),await p()}catch(L){d(`Âà†Èô§Êï∞ÊçÆÊ∫êÂ§±Ë¥•: ${L}`)}},E=async D=>{try{m(!0),d(null),console.log("üîÑ ÂºÄÂßãÊµãËØïÊï∞ÊçÆÊ∫êËøûÊé•:",D);const L=t().find(R=>R.id===D);if(!L){const R=`Êï∞ÊçÆÊ∫ê‰∏çÂ≠òÂú®: ${D}`;console.error("‚ùå",R),d(R);return}console.log("üìã Êï∞ÊçÆÊ∫ê‰ø°ÊÅØ:",{id:L.id,name:L.name,type_name:L.type_name,provider_type:L.provider_type,config:L.config});let O=L.provider_type||L.type_name;(L.name.includes("MySQL")||L.name.includes("Êï∞ÊçÆÂ∫ì")||JSON.stringify(L.config).includes("mysql")||JSON.stringify(L.config).includes("3306"))&&(O="database",console.log("üóÑÔ∏è Ê£ÄÊµãÂà∞Êï∞ÊçÆÂ∫ìÁ±ªÂûãÔºå‰ΩøÁî®provider_type: database")),console.log("üîç Ë∞ÉÁî®ÊµãËØïËøûÊé•API:",{providerType:O,config:L.config});const K=await we.testConnection(O,L.config||{});console.log("üì® APIËøîÂõûÁªìÊûú:",K),K?(console.log("‚úÖ Êï∞ÊçÆÊ∫êËøûÊé•ÊµãËØïÊàêÂäü:",D),alert(`‚úÖ Êï∞ÊçÆÊ∫ê "${L.name}" ËøûÊé•ÊµãËØïÊàêÂäüÔºÅ

üéâ Êï∞ÊçÆÂ∫ìËøûÊé•Ê≠£Â∏∏ÔºåÂèØ‰ª•Ê≠£Â∏∏‰ΩøÁî®`)):(console.log("‚ùå Êï∞ÊçÆÊ∫êËøûÊé•ÊµãËØïÂ§±Ë¥•:",D),alert(`‚ùå Êï∞ÊçÆÊ∫ê "${L.name}" ËøûÊé•ÊµãËØïÂ§±Ë¥•

ËØ∑Ê£ÄÊü•ÈÖçÁΩÆ‰ø°ÊÅØÊòØÂê¶Ê≠£Á°Æ`))}catch(L){console.error("‚ùå ÊµãËØïËøûÊé•Êó∂ÂèëÁîüÈîôËØØ:",L),console.error("‚ùå ÈîôËØØËØ¶ÊÉÖ:",{error:L,errorType:typeof L,errorString:String(L),errorJSON:JSON.stringify(L,null,2)});const O=t().find(R=>R.id===D),K=`ÊµãËØïËøûÊé•Â§±Ë¥•: ${L}`;d(K),!L||String(L)===""||String(L)==="null"?alert(`‚ùå Êï∞ÊçÆÊ∫ê "${(O==null?void 0:O.name)||D}" ËøûÊé•ÊµãËØïÈÅáÂà∞Êú™Áü•ÈîôËØØ

ËØ∑Ê£ÄÊü•Ôºö
‚Ä¢ ÂºÄÂèëËÄÖÂ∑•ÂÖ∑ÊéßÂà∂Âè∞ÁöÑËØ¶ÁªÜÈîôËØØ‰ø°ÊÅØ
‚Ä¢ ÂêéÁ´ØÊúçÂä°ÊòØÂê¶Ê≠£Â∏∏ËøêË°å
‚Ä¢ ÈÖçÁΩÆÂèÇÊï∞ÊòØÂê¶Ê≠£Á°Æ`):alert(`‚ùå Êï∞ÊçÆÊ∫ê "${(O==null?void 0:O.name)||D}" ËøûÊé•ÊµãËØïÂ§±Ë¥•:

${L}

üí° Â¶ÇÊûúÊòØÁ©∫ÈîôËØØÔºåËØ∑Ê£ÄÊü•ÂºÄÂèëËÄÖÂ∑•ÂÖ∑ÊéßÂà∂Âè∞Ëé∑ÂèñËØ¶ÁªÜ‰ø°ÊÅØ`)}finally{m(!1)}};return h(M,{get when(){return e.isOpen},get children(){var D=Er(),L=D.firstChild,O=L.nextSibling,K=O.firstChild,R=K.nextSibling,P=R.nextSibling,S=O.nextSibling;return Te(P,"click",e.onClose),r(S,h(M,{get when(){return s()==="list"},get children(){return h(Jr,{get dataSources(){return t()},get loading(){return u()},get error(){return v()},onAdd:y,onEdit:$,onPreview:C,onDelete:k,onTestConnection:E,onRefresh:p})}}),null),r(S,h(M,{get when(){return s()==="add"},get children(){return h(Cn,{get availableTypes(){return l()},onBack:()=>a("list"),onSuccess:p})}}),null),r(S,h(M,{get when(){return xe(()=>s()==="edit")()&&o()},get children(){return h(Vr,{get dataSource(){return o()},onBack:()=>a("list"),onSuccess:p})}}),null),r(S,h(M,{get when(){return xe(()=>!!(s()==="preview"&&o()))()&&c()},get children(){return h(Wr,{get dataSource(){return o()},get data(){return c()},onBack:()=>a("list")})}}),null),D}})}function Jr(e){const t=l=>{switch(l){case"active":return"#22c55e";case"error":return"#ef4444";case"disabled":return"#6b7280";default:return"#6b7280"}},n=l=>new Date(l).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});return(()=>{var l=zr(),i=l.firstChild,s=i.firstChild,a=s.firstChild,o=a.firstChild,g=o.nextSibling;g.nextSibling;var c=a.nextSibling,b=s.nextSibling;return r(a,()=>e.dataSources.length,g),Te(c,"click",e.onRefresh),Te(b,"click",e.onAdd),r(l,h(M,{get when(){return e.error},get children(){var u=Lr();return r(u,()=>e.error),u}}),null),r(l,h(M,{get when(){return e.loading},get children(){return Dr()}}),null),r(l,h(M,{get when(){return!e.loading&&e.dataSources.length===0},get children(){var u=Pr(),m=u.firstChild,v=m.nextSibling;return Te(v,"click",e.onAdd),u}}),null),r(l,h(M,{get when(){return!e.loading&&e.dataSources.length>0},get children(){var u=Ar();return r(u,h(oe,{get each(){return e.dataSources},children:m=>(()=>{var v=Rr(),d=v.firstChild,p=d.firstChild,_=p.firstChild,y=_.nextSibling,$=p.nextSibling,C=d.nextSibling,k=C.firstChild,E=k.firstChild,D=E.nextSibling,L=k.nextSibling,O=L.firstChild,K=O.nextSibling,R=C.nextSibling,P=R.firstChild,S=P.nextSibling,Q=S.nextSibling,B=Q.nextSibling;return r(_,()=>m.name),r(y,()=>m.provider_type),r(D,()=>n(m.created_at)),r(K,()=>n(m.last_updated)),P.$$click=()=>e.onPreview(m),S.$$click=()=>e.onTestConnection(m.id),Q.$$click=()=>e.onEdit(m),B.$$click=()=>e.onDelete(m.id),A(w=>{var z=t(m.status),N=`Áä∂ÊÄÅ: ${m.status}`,U=m.status!=="active";return z!==w.e&&((w.e=z)!=null?$.style.setProperty("background-color",z):$.style.removeProperty("background-color")),N!==w.t&&q($,"title",w.t=N),U!==w.a&&(P.disabled=w.a=U),w},{e:void 0,t:void 0,a:void 0}),v})()})),u}}),null),A(u=>{var m=e.loading,v=e.loading?"Ê≠£Âú®Âà∑Êñ∞Êï∞ÊçÆÊ∫êÂàóË°®":"Âà∑Êñ∞Êï∞ÊçÆÊ∫êÂàóË°®",d=e.loading?"Ê≠£Âú®Âà∑Êñ∞...":"Âà∑Êñ∞Êï∞ÊçÆÊ∫êÂàóË°®";return m!==u.e&&(c.disabled=u.e=m),v!==u.t&&q(c,"aria-label",u.t=v),d!==u.a&&q(c,"title",u.a=d),u},{e:void 0,t:void 0,a:void 0}),l})()}function Vr(e){const[t,n]=Z({name:e.dataSource.name,config:e.dataSource.config||{},loading:!1,error:null,testResult:null,hasChanges:!1}),[l]=Z(JSON.stringify(e.dataSource.config||{})),i=()=>{const b=t(),u=b.name!==e.dataSource.name,m=JSON.stringify(b.config)!==l();n(v=>({...v,hasChanges:u||m}))},s=b=>{n(u=>({...u,name:b})),i()},a=b=>{n(u=>({...u,config:b})),i()},o=async()=>{const b=t();n(u=>({...u,loading:!0,testResult:null}));try{console.log("üîÑ ÊµãËØïËøûÊé•ÈÖçÁΩÆ..."),await we.testConnection(e.dataSource.type_name,b.config)&&(console.log("‚úÖ ËøûÊé•ÊµãËØïÊàêÂäü"),n(m=>({...m,testResult:{success:!0,message:"ËøûÊé•ÊµãËØïÊàêÂäüÔºÅÈÖçÁΩÆÊúâÊïà„ÄÇ"},loading:!1})))}catch(u){console.error("‚ùå ËøûÊé•ÊµãËØïÂ§±Ë¥•:",u),n(m=>({...m,testResult:{success:!1,message:"ËøûÊé•ÊµãËØïÂ§±Ë¥•",error:u instanceof Error?u.message:String(u)},loading:!1}))}},g=async()=>{const b=t();if(!b.hasChanges){e.onBack();return}if(!b.name.trim()){n(u=>({...u,error:"Êï∞ÊçÆÊ∫êÂêçÁß∞‰∏çËÉΩ‰∏∫Á©∫"}));return}try{n(u=>({...u,loading:!0,error:null})),console.log("üîÑ Êõ¥Êñ∞Êï∞ÊçÆÊ∫êÈÖçÁΩÆ..."),await we.updateConfig(e.dataSource.id,b.config),b.name!==e.dataSource.name?(console.log("‚ö†Ô∏è  ÂêçÁß∞Êõ¥Êñ∞ÂäüËÉΩÂæÖÂÆûÁé∞ÔºåÂΩìÂâçÂè™Êõ¥Êñ∞‰∫ÜÈÖçÁΩÆ"),n(u=>({...u,error:"ÈÖçÁΩÆÂ∑≤Êõ¥Êñ∞Ôºå‰ΩÜÂêçÁß∞Êõ¥Êñ∞ÂäüËÉΩÂæÖÂÆûÁé∞"}))):console.log("‚úÖ Êï∞ÊçÆÊ∫êÈÖçÁΩÆÊõ¥Êñ∞ÊàêÂäü"),e.onSuccess(),e.onBack()}catch(u){console.error("‚ùå Êõ¥Êñ∞Êï∞ÊçÆÊ∫êÂ§±Ë¥•:",u),n(m=>({...m,error:`Êõ¥Êñ∞Â§±Ë¥•: ${u}`,loading:!1}))}},c=()=>{n(b=>({...b,name:e.dataSource.name,config:e.dataSource.config||{},hasChanges:!1,error:null,testResult:null}))};return(()=>{var b=Fr(),u=b.firstChild,m=u.firstChild,v=m.nextSibling,d=v.firstChild,p=d.nextSibling,_=p.firstChild,y=_.nextSibling;y.firstChild;var $=u.nextSibling,C=$.firstChild,k=C.firstChild,E=k.nextSibling,D=E.firstChild,L=D.nextSibling,O=C.nextSibling,K=O.firstChild;K.firstChild;var R=K.nextSibling,P=R.firstChild,S=P.nextSibling,Q=O.nextSibling,B=Q.firstChild,w=B.firstChild,z=w.nextSibling,N=Q.nextSibling,U=N.firstChild,H=U.nextSibling,J=H.firstChild,me=J.firstChild,X=me.nextSibling,j=J.nextSibling,se=j.firstChild,ve=se.nextSibling,re=j.nextSibling,le=re.firstChild,ee=le.nextSibling,ne=N.nextSibling,de=ne.firstChild,Y=de.nextSibling;return Te(m,"click",e.onBack),r(_,()=>e.dataSource.type_name),r(y,()=>e.dataSource.id,null),L.$$input=W=>s(W.currentTarget.value),r(K,h(M,{get when(){return t().hasChanges},get children(){return Mr()}}),null),S.$$input=W=>{try{const he=JSON.parse(W.currentTarget.value);a(he),n(be=>({...be,error:null}))}catch{n(be=>({...be,error:"ÈÖçÁΩÆÊ†ºÂºèÈîôËØØÔºåËØ∑Ê£ÄÊü•JSONËØ≠Ê≥ï"}))}},z.$$click=o,r(z,()=>t().loading?"ÊµãËØï‰∏≠...":"ÊµãËØïËøûÊé•"),r(Q,h(M,{get when(){return t().testResult},get children(){var W=Or(),he=W.firstChild,be=he.firstChild;return r(he,()=>{var pe;return(pe=t().testResult)!=null&&pe.success?"‚úÖ":"‚ùå"},be),r(he,()=>{var pe;return(pe=t().testResult)==null?void 0:pe.message},null),r(W,h(M,{get when(){var pe;return(pe=t().testResult)==null?void 0:pe.error},get children(){var pe=Nr();return r(pe,()=>{var ue;return(ue=t().testResult)==null?void 0:ue.error}),pe}}),null),A(()=>{var pe;return _e(W,`test-result ${(pe=t().testResult)!=null&&pe.success?"success":"error"}`)}),W}}),null),r(X,()=>e.dataSource.status==="active"?"‚úÖ Ê¥ªË∑É":e.dataSource.status==="error"?"‚ùå ÈîôËØØ":"‚ö†Ô∏è Êú™Áü•"),r(ve,()=>new Date(e.dataSource.created_at).toLocaleString("zh-CN")),r(ee,()=>new Date(e.dataSource.last_updated).toLocaleString("zh-CN")),r($,h(M,{get when(){return t().error},get children(){var W=Ir();return W.firstChild,r(W,()=>t().error,null),W}}),ne),Te(de,"click",e.onBack),r(ne,h(M,{get when(){return t().hasChanges},get children(){var W=Ur();return W.$$click=c,A(()=>W.disabled=t().loading),W}}),Y),Y.$$click=g,r(Y,(()=>{var W=xe(()=>!!t().loading);return()=>W()?"‰øùÂ≠ò‰∏≠...":t().hasChanges?"‰øùÂ≠òÊõ¥Êîπ":"Êó†Êõ¥Êîπ"})()),A(W=>{var ce;var he=t().error&&!t().name.trim()?"error":"",be=t().error&&((ce=t().error)!=null&&ce.includes("ÈÖçÁΩÆÊ†ºÂºè"))?"error":"",pe=t().loading,ue=`status-value status-${e.dataSource.status}`,fe=`save-btn ${t().hasChanges?"has-changes":""}`,te=t().loading;return he!==W.e&&_e(L,W.e=he),be!==W.t&&_e(S,W.t=be),pe!==W.a&&(z.disabled=W.a=pe),ue!==W.o&&_e(X,W.o=ue),fe!==W.i&&_e(Y,W.i=fe),te!==W.n&&(Y.disabled=W.n=te),W},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),A(()=>L.value=t().name),A(()=>S.value=JSON.stringify(t().config,null,2)),b})()}function Wr(e){return(()=>{var t=Br(),n=t.firstChild,l=n.firstChild,i=l.nextSibling;i.firstChild;var s=i.nextSibling,a=s.firstChild,o=a.nextSibling,g=o.nextSibling,c=g.nextSibling;c.nextSibling;var b=n.nextSibling,u=b.firstChild,m=u.firstChild,v=m.firstChild,d=m.nextSibling;return Te(l,"click",e.onBack),r(i,()=>e.dataSource.name,null),r(s,()=>e.data.total_rows,o),r(s,()=>e.data.rows.length,c),r(v,h(oe,{get each(){return e.data.columns},children:p=>(()=>{var _=qr();return r(_,p),_})()})),r(d,h(oe,{get each(){return e.data.rows.slice(0,50)},children:p=>(()=>{var _=jr();return r(_,h(oe,{get each(){return e.data.columns},children:y=>(()=>{var $=Hr();return r($,(()=>{var C=xe(()=>typeof p[y]=="object");return()=>C()?JSON.stringify(p[y]):String(p[y]||"")})()),$})()})),_})()})),t})()}Pe(["click","input"]);var Gr=f("<div class=empty-context><div class=empty-icon>üì≠</div><div class=empty-title>ÊöÇÊó†Êï∞ÊçÆÊ∫ê</div><div class=empty-description>ËØ∑Âú®Êï∞ÊçÆÊ∫êÈù¢Êùø‰∏≠ÂàõÂª∫Âπ∂ÈÄâÊã©‰∏Ä‰∏™Êï∞ÊçÆÊ∫ê"),Kr=f("<div class=loading-overlay><div class=loading-spinner>‚è≥</div><div class=loading-text>Âä†ËΩΩ‰∏≠..."),Yr=f("<div class=data-context-panel><div class=panel-header><h3 class=panel-title>üìã Êï∞ÊçÆ‰∏ä‰∏ãÊñá</h3><div class=status-indicator><span class=status-icon></span><span class=status-text>"),Xr=f("<div class=current-record>"),Zr=f("<div class=empty-record>ÊöÇÊó†ËÆ∞ÂΩïÊï∞ÊçÆ"),ea=f("<div class=available-fields>"),ta=f("<div class=no-fields>ÊöÇÊó†ÂèØÁî®Â≠óÊÆµ"),na=f('<div class=context-content><div class=section><div class=section-header><h4 class=section-title>üóÑÔ∏è Êï∞ÊçÆÊ∫ê‰ø°ÊÅØ</h4></div><div class=data-source-info><div class=info-item><span class=info-label>ÂêçÁß∞:</span><span class=info-value></span></div><div class=info-item><span class=info-label>Á±ªÂûã:</span><span class=info-value></span></div><div class=info-item><span class=info-label>ID:</span><span class="info-value info-id"></span></div></div></div><div class=section><div class=section-header><h4 class=section-title>üî¢ ËÆ∞ÂΩïÂØºËà™</h4></div><div class=navigation-controls><button class=nav-button title=‰∏ä‰∏ÄÊù°ËÆ∞ÂΩï>‚¨ÖÔ∏è</button><span class=record-info> / </span><button class=nav-button title=‰∏ã‰∏ÄÊù°ËÆ∞ÂΩï>‚û°Ô∏è</button></div></div><div class=section><div class=section-header><h4 class=section-title>üìã ÂΩìÂâçËÆ∞ÂΩï</h4></div></div><div class=section><div class=section-header><h4 class=section-title>üîç ÂèØÁî®Â≠óÊÆµ</h4><div class=field-count>(<!> ‰∏™Â≠óÊÆµ)'),la=f("<div class=record-field><div class=field-key>:</div><div class=field-value>"),ia=f("<div class=field-display-name>"),sa=f("<div class=field-sample>Á§∫‰æã: "),ra=f("<div class=field-item><div class=field-header><span class=field-name></span><span class=field-type>(<!>)</span></div><div class=field-expression>Ë°®ËææÂºè: <code>"),aa=f("<details class=error-details><summary>ËØ¶ÁªÜ‰ø°ÊÅØ</summary><pre class=error-details-content>"),oa=f('<div class="section error-section"><div class=section-header><h4 class="section-title error-title">‚ùå ÈîôËØØ‰ø°ÊÅØ</h4></div><div class=error-content><div class=error-type>ÈîôËØØÁ±ªÂûã: </div><div class=error-message>ÈîôËØØÊèèËø∞: ');const ca=()=>{const[e,t]=Z(null),[n,l]=Z(!1);Ot(()=>{const c=Ze.subscribe(b=>{t(b)});return t(Ze.getCurrentContext()),c});const i=Ce(()=>{const c=e();if(!c)return{text:"Êú™ÈÄâÊã©Êï∞ÊçÆÊ∫ê",color:"#666",icon:"üìÇ"};switch(c.dataSource.status){case"ready":return{text:`Êï∞ÊçÆÂ∑≤Â∞±Áª™ - ${c.dataSource.name}`,color:"#52c41a",icon:"‚úÖ"};case"loading":return{text:"Ê≠£Âú®Âä†ËΩΩÊï∞ÊçÆ...",color:"#1890ff",icon:"‚è≥"};case"error":return{text:"Êï∞ÊçÆÂä†ËΩΩÂ§±Ë¥•",color:"#ff4d4f",icon:"‚ùå"};case"empty":return{text:"Êï∞ÊçÆÊ∫ê‰∏∫Á©∫",color:"#faad14",icon:"üì≠"};default:return{text:"Êú™Áü•Áä∂ÊÄÅ",color:"#666",icon:"‚ùì"}}}),s=async()=>{l(!0);try{await Ze.navigateNext()}catch(c){console.error("ÂØºËà™Âà∞‰∏ã‰∏ÄËÆ∞ÂΩïÂ§±Ë¥•:",c)}finally{l(!1)}},a=async()=>{l(!0);try{await Ze.navigatePrevious()}catch(c){console.error("ÂØºËà™Âà∞‰∏ä‰∏ÄËÆ∞ÂΩïÂ§±Ë¥•:",c)}finally{l(!1)}},o=c=>c==null?"(Á©∫)":typeof c=="string"?`"${c}"`:typeof c=="object"?JSON.stringify(c,null,2):String(c),g=c=>({string:"ÊñáÊú¨",number:"Êï∞Â≠ó",boolean:"Â∏ÉÂ∞î",date:"Êó•Êúü",object:"ÂØπË±°",array:"Êï∞ÁªÑ"})[c]||c;return(()=>{var c=Yr(),b=c.firstChild,u=b.firstChild,m=u.nextSibling,v=m.firstChild,d=v.nextSibling;return r(v,()=>i().icon),r(d,()=>i().text),r(c,h(M,{get when(){return e()},children:p=>(()=>{var _=na(),y=_.firstChild,$=y.firstChild,C=$.nextSibling,k=C.firstChild,E=k.firstChild,D=E.nextSibling,L=k.nextSibling,O=L.firstChild,K=O.nextSibling,R=L.nextSibling,P=R.firstChild,S=P.nextSibling,Q=y.nextSibling,B=Q.firstChild,w=B.nextSibling,z=w.firstChild,N=z.nextSibling,U=N.firstChild,H=N.nextSibling,J=Q.nextSibling;J.firstChild;var me=J.nextSibling,X=me.firstChild,j=X.firstChild,se=j.nextSibling,ve=se.firstChild,re=ve.nextSibling;return re.nextSibling,r(D,()=>p().dataSource.name),r(K,()=>p().dataSource.type.toUpperCase()),r(S,()=>p().dataSource.id),z.$$click=a,r(N,()=>p().currentRecord.index+1,U),r(N,()=>p().currentRecord.total,null),H.$$click=s,r(J,h(M,{get when(){return Object.keys(p().currentRecord.data).length>0},get children(){var le=Xr();return r(le,h(oe,{get each(){return Object.entries(p().currentRecord.data)},children:([ee,ne])=>(()=>{var de=la(),Y=de.firstChild,W=Y.firstChild,he=Y.nextSibling;return r(Y,ee,W),r(he,()=>o(ne)),de})()})),le}}),null),r(J,h(M,{get when(){return Object.keys(p().currentRecord.data).length===0},get children(){return Zr()}}),null),r(se,()=>p().fields.length,re),r(me,h(M,{get when(){return p().fields.length>0},get children(){var le=ea();return r(le,h(oe,{get each(){return p().fields},children:ee=>(()=>{var ne=ra(),de=ne.firstChild,Y=de.firstChild,W=Y.nextSibling,he=W.firstChild,be=he.nextSibling;be.nextSibling;var pe=de.nextSibling,ue=pe.firstChild,fe=ue.nextSibling;return r(Y,()=>ee.name),r(W,()=>g(ee.type),be),r(ne,h(M,{get when(){return ee.displayName&&ee.displayName!==ee.name},get children(){var te=ia();return r(te,()=>ee.displayName),te}}),pe),r(ne,h(M,{get when(){return ee.sample!==void 0},get children(){var te=sa();return te.firstChild,r(te,()=>o(ee.sample),null),te}}),pe),r(fe,()=>`{${ee.name}}`),ne})()})),le}}),null),r(me,h(M,{get when(){return p().fields.length===0},get children(){return ta()}}),null),r(_,h(M,{get when(){return p().error},children:le=>(()=>{var ee=oa(),ne=ee.firstChild,de=ne.nextSibling,Y=de.firstChild;Y.firstChild;var W=Y.nextSibling;return W.firstChild,r(Y,()=>le().type,null),r(W,()=>le().message,null),r(de,h(M,{get when(){return le().details},get children(){var he=aa(),be=he.firstChild,pe=be.nextSibling;return r(pe,()=>JSON.stringify(le().details,null,2)),he}}),null),ee})()}),null),A(le=>{var ee=n()||p().currentRecord.index<=0,ne=n()||p().currentRecord.index>=p().currentRecord.total-1;return ee!==le.e&&(z.disabled=le.e=ee),ne!==le.t&&(H.disabled=le.t=ne),le},{e:void 0,t:void 0}),_})()}),null),r(c,h(M,{get when(){return!e()},get children(){return Gr()}}),null),r(c,h(M,{get when(){return n()},get children(){return Kr()}}),null),A(p=>(p=i().color)!=null?d.style.setProperty("color",p):d.style.removeProperty("color")),c})()};Pe(["click"]);var da=f(`<div class=sql-editor><div class=editor-toolbar><div class=toolbar-left><span class=editor-label>SQLÁºñËæëÂô®</span><span class=database-type>(<!>)</span></div><div class=toolbar-right><span class=cursor-position>Ë°å <!>, Âàó </span><span class=character-count> Â≠óÁ¨¶</span></div></div><div class=template-toolbar><span class=template-label>Ê®°Êùø:</span></div><div><textarea class=sql-textarea placeholder="ËØ∑ËæìÂÖ•SQLÊü•ËØ¢ËØ≠Âè•...

Á§∫‰æã:
SELECT u.username, u.email, COUNT(o.id) as order_count
FROM users u
LEFT JOIN orders o ON u.id = o.user_id
WHERE u.created_at >= '2024-01-01'
GROUP BY u.id, u.username, u.email
ORDER BY order_count DESC
LIMIT 10;"rows=15></textarea><div class=line-numbers></div></div><div class=editor-help><div class=help-item><kbd>Tab</kbd> Áº©Ëøõ</div><div class=help-item><kbd>Ctrl+F</kbd> Ê†ºÂºèÂåñ</div><div class=help-item><kbd>Enter</kbd> Ëá™Âä®Áº©Ëøõ</div></div><style>
        .sql-editor {
          display: flex;
          flex-direction: column;
          border: 1px solid #ddd;
          border-radius: 6px;
          background: white;
          font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
        }

        .editor-toolbar {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 8px 12px;
          background: #f8f9fa;
          border-bottom: 1px solid #ddd;
          font-size: 12px;
        }

        .toolbar-left {
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .editor-label {
          font-weight: bold;
          color: #2c3e50;
        }

        .database-type {
          background: #3498db;
          color: white;
          padding: 2px 6px;
          border-radius: 3px;
          font-size: 10px;
        }

        .toolbar-right {
          display: flex;
          align-items: center;
          gap: 12px;
          color: #666;
        }

        .template-toolbar {
          display: flex;
          align-items: center;
          gap: 6px;
          padding: 6px 12px;
          background: #f1f3f5;
          border-bottom: 1px solid #ddd;
          font-size: 12px;
        }

        .template-label {
          color: #666;
          font-weight: bold;
        }

        .template-btn {
          background: #e9ecef;
          border: 1px solid #ced4da;
          border-radius: 4px;
          padding: 4px 8px;
          font-size: 11px;
          cursor: pointer;
          transition: all 0.2s;
        }

        .template-btn:hover:not(:disabled) {
          background: #dee2e6;
          border-color: #adb5bd;
        }

        .template-btn:disabled {
          opacity: 0.6;
          cursor: not-allowed;
        }

        .editor-container {
          position: relative;
          flex: 1;
          min-height: 300px;
        }

        .editor-container.focused {
          box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }

        .editor-container.disabled {
          opacity: 0.6;
          pointer-events: none;
        }

        .sql-textarea {
          width: 100%;
          height: 100%;
          padding: 12px 12px 12px 48px;
          border: none;
          outline: none;
          resize: vertical;
          font-family: inherit;
          font-size: 14px;
          line-height: 1.5;
          background: transparent;
        }

        .line-numbers {
          position: absolute;
          left: 0;
          top: 0;
          bottom: 0;
          width: 36px;
          background: #f8f9fa;
          border-right: 1px solid #e9ecef;
          padding: 12px 4px;
          user-select: none;
          overflow: hidden;
        }

        .line-number {
          text-align: right;
          font-size: 12px;
          color: #6c757d;
          line-height: 1.5;
          padding-right: 8px;
        }

        .editor-help {
          display: flex;
          justify-content: center;
          gap: 16px;
          padding: 6px;
          background: #f8f9fa;
          border-top: 1px solid #ddd;
          font-size: 11px;
          color: #666;
        }

        .help-item {
          display: flex;
          align-items: center;
          gap: 4px;
        }

        kbd {
          background: #e9ecef;
          border: 1px solid #ced4da;
          border-radius: 3px;
          padding: 2px 4px;
          font-size: 10px;
          font-family: inherit;
        }
      `),ua=f("<button class=template-btn>"),ga=f("<div class=line-number>");function ha(e){let t;const[n,l]=Z(!1),[i,s]=Z({line:1,column:1}),a=m=>{const v=m.target;e.onSQLChange(v.value),o()},o=()=>{if(!t)return;const m=t.selectionStart,d=e.sql.substring(0,m).split(`
`);s({line:d.length,column:(d[d.length-1]||"").length+1})},g=m=>{var _;if(!t||e.disabled)return;const v=m.target,d=v.selectionStart,p=v.selectionEnd;if(m.key==="Tab"){m.preventDefault();const y=e.sql.substring(0,d)+"  "+e.sql.substring(p);e.onSQLChange(y),setTimeout(()=>{t&&(t.selectionStart=t.selectionEnd=d+2,o())},0)}else if(m.key==="Enter"){const y=e.sql.substring(0,d).split(`
`),$=y[y.length-1],C=((_=$==null?void 0:$.match(/^\s*/))==null?void 0:_[0])||"",k=($==null?void 0:$.trim().toUpperCase())||"",D=["SELECT","FROM","WHERE","GROUP BY","ORDER BY","HAVING"].some(L=>k.endsWith(L)||k.includes(L+" "))?C+"  ":C;if(D){m.preventDefault();const L=e.sql.substring(0,d)+`
`+D+e.sql.substring(p);e.onSQLChange(L),setTimeout(()=>{if(t){const O=d+1+D.length;t.selectionStart=t.selectionEnd=O,o()}},0)}}},c=m=>{(m.ctrlKey||m.metaKey)&&m.key==="f"&&(m.preventDefault(),console.log("Ê†ºÂºèÂåñÂø´Êç∑ÈîÆËß¶Âèë"))},b=m=>{if(!t||e.disabled)return;const v=t.selectionStart,d=t.selectionEnd,p=e.sql.substring(0,v)+m+e.sql.substring(d);e.onSQLChange(p),setTimeout(()=>{t&&(t.focus(),t.selectionStart=t.selectionEnd=v+m.length,o())},0)};Ue(()=>{o(),t&&(t.addEventListener("selectionchange",o),t.addEventListener("click",o))});const u=[{name:"Âü∫Á°ÄÊü•ËØ¢",template:"SELECT * FROM table_name WHERE condition;"},{name:"ËÅîË°®Êü•ËØ¢",template:`SELECT t1.*, t2.*
FROM table1 t1
JOIN table2 t2 ON t1.id = t2.table1_id
WHERE condition;`},{name:"ËÅöÂêàÊü•ËØ¢",template:`SELECT column, COUNT(*), AVG(value)
FROM table_name
GROUP BY column
HAVING COUNT(*) > 1
ORDER BY column;`},{name:"Â≠êÊü•ËØ¢",template:`SELECT *
FROM table1
WHERE column IN (
  SELECT column
  FROM table2
  WHERE condition
);`}];return(()=>{var m=da(),v=m.firstChild,d=v.firstChild,p=d.firstChild,_=p.nextSibling,y=_.firstChild,$=y.nextSibling;$.nextSibling;var C=d.nextSibling,k=C.firstChild,E=k.firstChild,D=E.nextSibling;D.nextSibling;var L=k.nextSibling,O=L.firstChild,K=v.nextSibling;K.firstChild;var R=K.nextSibling,P=R.firstChild,S=P.nextSibling;r(_,()=>e.databaseType.toUpperCase(),$),r(k,()=>i().line,D),r(k,()=>i().column,null),r(L,()=>e.sql.length,O),r(K,()=>u.map(B=>(()=>{var w=ua();return w.$$click=()=>b(B.template),r(w,()=>B.name),A(z=>{var N=e.disabled,U=`ÊèíÂÖ•${B.name}Ê®°Êùø`;return N!==z.e&&(w.disabled=z.e=N),U!==z.t&&q(w,"title",z.t=U),z},{e:void 0,t:void 0}),w})()),null),P.addEventListener("blur",()=>l(!1)),P.addEventListener("focus",()=>l(!0)),P.addEventListener("keypress",c),P.$$keydown=g,P.$$input=a;var Q=t;return typeof Q=="function"?Ut(Q,P):t=P,q(P,"spellcheck",!1),r(S,()=>e.sql.split(`
`).map((B,w)=>(()=>{var z=ga();return r(z,w+1),z})())),A(B=>{var w=`editor-container ${n()?"focused":""} ${e.disabled?"disabled":""}`,z=e.disabled;return w!==B.e&&_e(R,B.e=w),z!==B.t&&(P.disabled=B.t=z),B},{e:void 0,t:void 0}),A(()=>P.value=e.sql),m})()}Pe(["input","keydown","click"]);var va=f("<div class=empty-message><p>ËØ∑ÈÄâÊã©Ë¶ÅÊü•ËØ¢ÁöÑÂ≠óÊÆµ</p><button>Ëá™Âä®ÈÄâÊã©Â≠óÊÆµ"),fa=f("<div class=builder-section><div class=section-header><h4>üîó Ë°®ÂÖ≥ËÅî (JOIN)</h4><button class=add-btn>+ Ê∑ªÂä†ÂÖ≥ËÅî</button></div><div class=joins-list>"),ma=f(`<div class=visual-query-builder><div class=query-options><label class=option-checkbox><input type=checkbox><span>ÂéªÈáçÊü•ËØ¢ (DISTINCT)</span></label></div><div class=builder-section><div class=section-header><h4>üìã ÈÄâÊã©Â≠óÊÆµ (SELECT)</h4><button class=add-btn>+ Ê∑ªÂä†Â≠óÊÆµ</button></div><div class=fields-list></div></div><div class=builder-section><div class=section-header><h4>üîç Á≠õÈÄâÊù°‰ª∂ (WHERE)</h4><button class=add-btn>+ Ê∑ªÂä†Êù°‰ª∂</button></div><div class=where-list></div></div><div class=builder-section><div class=section-header><h4>‚öôÔ∏è ÂÖ∂‰ªñÈÄâÈ°π</h4></div><div class=options-grid><div class=option-group><label>ÈôêÂà∂Ë°åÊï∞ (LIMIT):</label><input type=number placeholder=Êó†ÈôêÂà∂ min=1 max=10000></div></div></div><style>
        .visual-query-builder {
          display: flex;
          flex-direction: column;
          gap: 20px;
          padding: 16px;
          background: #f8f9fa;
          border-radius: 8px;
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }

        .query-options {
          display: flex;
          gap: 16px;
        }

        .option-checkbox {
          display: flex;
          align-items: center;
          gap: 6px;
          cursor: pointer;
        }

        .builder-section {
          background: white;
          border-radius: 6px;
          padding: 16px;
          border: 1px solid #dee2e6;
        }

        .section-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 12px;
          padding-bottom: 8px;
          border-bottom: 1px solid #e9ecef;
        }

        .section-header h4 {
          margin: 0;
          color: #2c3e50;
          font-size: 14px;
        }

        .add-btn {
          background: #28a745;
          color: white;
          border: none;
          border-radius: 4px;
          padding: 6px 12px;
          font-size: 12px;
          cursor: pointer;
        }

        .add-btn:hover:not(:disabled) {
          background: #218838;
        }

        .field-item, .join-item, .where-item {
          display: flex;
          align-items: center;
          gap: 8px;
          margin-bottom: 8px;
          padding: 8px;
          background: #f8f9fa;
          border-radius: 4px;
          flex-wrap: wrap;
        }

        .join-condition {
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .separator {
          font-weight: bold;
          color: #6c757d;
        }

        select, input {
          padding: 4px 8px;
          border: 1px solid #ced4da;
          border-radius: 3px;
          font-size: 13px;
        }

        select {
          background: white;
        }

        input[type="text"] {
          min-width: 100px;
          flex: 1;
        }

        input[type="number"] {
          width: 100px;
        }

        .remove-btn {
          background: #dc3545;
          color: white;
          border: none;
          border-radius: 50%;
          width: 24px;
          height: 24px;
          cursor: pointer;
          font-size: 14px;
        }

        .remove-btn:hover:not(:disabled) {
          background: #c82333;
        }

        .empty-message {
          text-align: center;
          padding: 20px;
          color: #6c757d;
        }

        .empty-message button {
          background: #007bff;
          color: white;
          border: none;
          border-radius: 4px;
          padding: 8px 16px;
          cursor: pointer;
          margin-top: 8px;
        }

        .options-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 16px;
        }

        .option-group {
          display: flex;
          flex-direction: column;
          gap: 4px;
        }

        .option-group label {
          font-weight: bold;
          color: #495057;
          font-size: 13px;
        }

        button:disabled, select:disabled, input:disabled {
          opacity: 0.6;
          cursor: not-allowed;
        }
      `),ba=f('<div class=field-item><select></select><span class=separator>.</span><select></select><select><option value>Êó†ËÅöÂêà</option><option value=COUNT>COUNT</option><option value=SUM>SUM</option><option value=AVG>AVG</option><option value=MIN>MIN</option><option value=MAX>MAX</option><option value=DISTINCT>DISTINCT</option></select><input type=text placeholder="Âà´Âêç (ÂèØÈÄâ)"><button class=remove-btn>√ó'),We=f("<option>"),pa=f("<option> (<!>)"),ya=f("<div class=join-item><select><option value=INNER>INNER JOIN</option><option value=LEFT>LEFT JOIN</option><option value=RIGHT>RIGHT JOIN</option><option value=FULL>FULL JOIN</option></select><div class=join-condition><select></select><select></select><span>=</span><select></select><select></select></div><button class=remove-btn>√ó"),$a=f("<select><option value=AND>AND</option><option value=OR>OR"),_a=f("<input type=text>"),xa=f('<div class=where-item><select></select><select></select><select><option value="=">=</option><option value="!=">!=</option><option value=">">&gt;</option><option value="<">&lt;</option><option value=">=">&gt;=</option><option value="<=">&lt;=</option><option value=LIKE>LIKE</option><option value=IN>IN</option><option value="IS NULL">IS NULL</option><option value="IS NOT NULL">IS NOT NULL</option></select><button class=remove-btn>√ó');function Sa(e){const[t,n]=Z([]),[l,i]=Z([]),[s,a]=Z([]),[o]=Z([]),[g]=Z([]),[c,b]=Z(void 0),[u,m]=Z(!1),v=Ce(()=>{var P,S,Q;return(Q=(S=(P=e.schema)==null?void 0:P.schemas)==null?void 0:S[0])!=null&&Q.tables?e.schema.schemas[0].tables.filter(B=>e.selectedTables.includes(B.name)):[]}),d=P=>{const S=v().find(Q=>Q.name===P);return(S==null?void 0:S.columns)||[]},p=Ce(()=>{var U;const P=v();if(P.length===0||t().length===0)return"";let S="";S+=u()?"SELECT DISTINCT ":"SELECT ";const Q=t().map(H=>{let J=`${H.table}.${H.column}`;return H.aggregate&&(H.aggregate==="DISTINCT"?J=`DISTINCT ${J}`:J=`${H.aggregate}(${J})`),H.alias&&(J+=` AS ${H.alias}`),J});S+=Q.join(`,
       `),S+=`
FROM ${((U=P[0])==null?void 0:U.name)||"table1"}`;const B=l();for(const H of B)S+=`
${H.joinType} JOIN ${H.rightTable} ON ${H.leftTable}.${H.leftColumn} = ${H.rightTable}.${H.rightColumn}`;const w=s();if(w.length>0){S+=`
WHERE `;const H=w.map((J,me)=>{let X="";return me>0&&(X+=`${J.logicalOperator} `),X+=`${J.table}.${J.column} ${J.operator}`,["IS NULL","IS NOT NULL"].includes(J.operator)||(J.operator==="IN"?X+=` (${J.value})`:J.operator==="LIKE"?X+=` '%${J.value}%'`:X+=` '${J.value}'`),X});S+=H.join(" ")}const z=g();z.length>0&&(S+=`
GROUP BY ${z.join(", ")}`);const N=o();if(N.length>0){const H=N.map(J=>`${J.table}.${J.column} ${J.direction}`);S+=`
ORDER BY ${H.join(", ")}`}return c()&&(S+=`
LIMIT ${c()}`),S});Ue(()=>{y()});const _=()=>{e.onQueryChange(p())},y=()=>{const P=v();if(P.length===0)return;const S=[];P.forEach(Q=>{var w;(((w=Q.columns)==null?void 0:w.slice(0,3))||[]).forEach(z=>{S.push({table:Q.name,column:z.name})})}),n(S),_()},$=()=>{var B,w;const P=v();if(P.length===0)return;const S=P[0];if(!S)return;const Q=((w=(B=S.columns)==null?void 0:B[0])==null?void 0:w.name)||"id";n(z=>[...z,{table:S.name,column:Q}]),_()},C=P=>{n(S=>S.filter((Q,B)=>B!==P)),_()},k=(P,S)=>{n(Q=>Q.map((B,w)=>{if(w===P){const z={...B,...S};return S.hasOwnProperty("aggregate")&&S.aggregate===void 0&&delete z.aggregate,S.hasOwnProperty("alias")&&S.alias===void 0&&delete z.alias,z}return B})),_()},E=()=>{var N,U,H,J;const P=v();if(P.length<2)return;const S=P[0],Q=P[1];if(!S||!Q)return;const B=((U=(N=S.columns)==null?void 0:N[0])==null?void 0:U.name)||"id",w=((J=(H=Q.columns)==null?void 0:H[0])==null?void 0:J.name)||"id",z={id:Date.now().toString(),leftTable:S.name,leftColumn:B,rightTable:Q.name,rightColumn:w,joinType:"INNER"};i(me=>[...me,z]),_()},D=P=>{i(S=>S.filter(Q=>Q.id!==P)),_()},L=(P,S)=>{i(Q=>Q.map(B=>B.id===P?{...B,...S}:B)),_()},O=()=>{var w,z;const P=v();if(P.length===0)return;const S=P[0];if(!S)return;const Q=((z=(w=S.columns)==null?void 0:w[0])==null?void 0:z.name)||"id",B={id:Date.now().toString(),table:S.name,column:Q,operator:"=",value:"",logicalOperator:"AND"};a(N=>[...N,B]),_()},K=P=>{a(S=>S.filter(Q=>Q.id!==P)),_()},R=(P,S)=>{a(Q=>Q.map(B=>B.id===P?{...B,...S}:B)),_()};return(()=>{var P=ma(),S=P.firstChild,Q=S.firstChild,B=Q.firstChild,w=S.nextSibling,z=w.firstChild,N=z.firstChild,U=N.nextSibling,H=z.nextSibling,J=w.nextSibling,me=J.firstChild,X=me.firstChild,j=X.nextSibling,se=me.nextSibling,ve=J.nextSibling,re=ve.firstChild,le=re.nextSibling,ee=le.firstChild,ne=ee.firstChild,de=ne.nextSibling;return B.addEventListener("change",Y=>{m(Y.currentTarget.checked),_()}),U.$$click=$,r(H,h(oe,{get each(){return t()},children:(Y,W)=>(()=>{var he=ba(),be=he.firstChild,pe=be.nextSibling,ue=pe.nextSibling,fe=ue.nextSibling,te=fe.nextSibling,ce=te.nextSibling;return be.addEventListener("change",x=>{var V,ie;const F=v().find(G=>G.name===x.currentTarget.value),I=((ie=(V=F==null?void 0:F.columns)==null?void 0:V[0])==null?void 0:ie.name)||"id";k(W(),{table:x.currentTarget.value,column:I})}),r(be,h(oe,{get each(){return v()},children:x=>(()=>{var T=We();return r(T,()=>x.name),A(()=>T.value=x.name),T})()})),ue.addEventListener("change",x=>k(W(),{column:x.currentTarget.value})),r(ue,h(oe,{get each(){return d(Y.table)},children:x=>(()=>{var T=pa(),F=T.firstChild,I=F.nextSibling;return I.nextSibling,r(T,()=>x.name,F),r(T,()=>x.data_type,I),A(()=>T.value=x.name),T})()})),fe.addEventListener("change",x=>{const T=x.currentTarget.value;T===""?k(W(),{aggregate:void 0}):k(W(),{aggregate:T})}),te.$$input=x=>{const T=x.currentTarget.value;T===""?k(W(),{alias:void 0}):k(W(),{alias:T})},ce.$$click=()=>C(W()),A(x=>{var T=e.disabled,F=e.disabled,I=e.disabled,V=e.disabled,ie=e.disabled;return T!==x.e&&(be.disabled=x.e=T),F!==x.t&&(ue.disabled=x.t=F),I!==x.a&&(fe.disabled=x.a=I),V!==x.o&&(te.disabled=x.o=V),ie!==x.i&&(ce.disabled=x.i=ie),x},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),A(()=>be.value=Y.table),A(()=>ue.value=Y.column),A(()=>fe.value=Y.aggregate||""),A(()=>te.value=Y.alias||""),he})()}),null),r(H,h(M,{get when(){return t().length===0},get children(){var Y=va(),W=Y.firstChild,he=W.nextSibling;return he.$$click=y,A(()=>he.disabled=e.disabled),Y}}),null),r(P,h(M,{get when(){return v().length>1},get children(){var Y=fa(),W=Y.firstChild,he=W.firstChild,be=he.nextSibling,pe=W.nextSibling;return be.$$click=E,r(pe,h(oe,{get each(){return l()},children:ue=>(()=>{var fe=ya(),te=fe.firstChild,ce=te.nextSibling,x=ce.firstChild,T=x.nextSibling,F=T.nextSibling,I=F.nextSibling,V=I.nextSibling,ie=ce.nextSibling;return te.addEventListener("change",G=>L(ue.id,{joinType:G.currentTarget.value})),x.addEventListener("change",G=>L(ue.id,{leftTable:G.currentTarget.value})),r(x,h(oe,{get each(){return v()},children:G=>(()=>{var ye=We();return r(ye,()=>G.name),A(()=>ye.value=G.name),ye})()})),T.addEventListener("change",G=>L(ue.id,{leftColumn:G.currentTarget.value})),r(T,h(oe,{get each(){return d(ue.leftTable)},children:G=>(()=>{var ye=We();return r(ye,()=>G.name),A(()=>ye.value=G.name),ye})()})),I.addEventListener("change",G=>L(ue.id,{rightTable:G.currentTarget.value})),r(I,h(oe,{get each(){return v()},children:G=>(()=>{var ye=We();return r(ye,()=>G.name),A(()=>ye.value=G.name),ye})()})),V.addEventListener("change",G=>L(ue.id,{rightColumn:G.currentTarget.value})),r(V,h(oe,{get each(){return d(ue.rightTable)},children:G=>(()=>{var ye=We();return r(ye,()=>G.name),A(()=>ye.value=G.name),ye})()})),ie.$$click=()=>D(ue.id),A(G=>{var ye=e.disabled,ke=e.disabled,ae=e.disabled,ze=e.disabled,Ae=e.disabled,Re=e.disabled;return ye!==G.e&&(te.disabled=G.e=ye),ke!==G.t&&(x.disabled=G.t=ke),ae!==G.a&&(T.disabled=G.a=ae),ze!==G.o&&(I.disabled=G.o=ze),Ae!==G.i&&(V.disabled=G.i=Ae),Re!==G.n&&(ie.disabled=G.n=Re),G},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),A(()=>te.value=ue.joinType),A(()=>x.value=ue.leftTable),A(()=>T.value=ue.leftColumn),A(()=>I.value=ue.rightTable),A(()=>V.value=ue.rightColumn),fe})()})),A(()=>be.disabled=e.disabled),Y}}),J),j.$$click=O,r(se,h(oe,{get each(){return s()},children:(Y,W)=>(()=>{var he=xa(),be=he.firstChild,pe=be.nextSibling,ue=pe.nextSibling,fe=ue.nextSibling;return r(he,h(M,{get when(){return W()>0},get children(){var te=$a();return te.addEventListener("change",ce=>R(Y.id,{logicalOperator:ce.currentTarget.value})),A(()=>te.disabled=e.disabled),A(()=>te.value=Y.logicalOperator),te}}),be),be.addEventListener("change",te=>R(Y.id,{table:te.currentTarget.value})),r(be,h(oe,{get each(){return v()},children:te=>(()=>{var ce=We();return r(ce,()=>te.name),A(()=>ce.value=te.name),ce})()})),pe.addEventListener("change",te=>R(Y.id,{column:te.currentTarget.value})),r(pe,h(oe,{get each(){return d(Y.table)},children:te=>(()=>{var ce=We();return r(ce,()=>te.name),A(()=>ce.value=te.name),ce})()})),ue.addEventListener("change",te=>R(Y.id,{operator:te.currentTarget.value})),r(he,h(M,{get when(){return!["IS NULL","IS NOT NULL"].includes(Y.operator)},get children(){var te=_a();return te.$$input=ce=>R(Y.id,{value:ce.currentTarget.value}),A(ce=>{var x=Y.operator==="IN"?"ÂÄº1,ÂÄº2,ÂÄº3":"ÂÄº",T=e.disabled;return x!==ce.e&&q(te,"placeholder",ce.e=x),T!==ce.t&&(te.disabled=ce.t=T),ce},{e:void 0,t:void 0}),A(()=>te.value=Y.value),te}}),fe),fe.$$click=()=>K(Y.id),A(te=>{var ce=e.disabled,x=e.disabled,T=e.disabled,F=e.disabled;return ce!==te.e&&(be.disabled=te.e=ce),x!==te.t&&(pe.disabled=te.t=x),T!==te.a&&(ue.disabled=te.a=T),F!==te.o&&(fe.disabled=te.o=F),te},{e:void 0,t:void 0,a:void 0,o:void 0}),A(()=>be.value=Y.table),A(()=>pe.value=Y.column),A(()=>ue.value=Y.operator),he})()})),de.$$input=Y=>{const W=parseInt(Y.currentTarget.value)||void 0;b(W),_()},A(Y=>{var W=e.disabled,he=e.disabled,be=e.disabled,pe=e.disabled;return W!==Y.e&&(B.disabled=Y.e=W),he!==Y.t&&(U.disabled=Y.t=he),be!==Y.a&&(j.disabled=Y.a=be),pe!==Y.o&&(de.disabled=Y.o=pe),Y},{e:void 0,t:void 0,a:void 0,o:void 0}),A(()=>B.checked=u()),A(()=>de.value=c()||""),P})()}Pe(["click","input"]);var wa=f('<button class="action-btn close-btn"title=ÂÖ≥Èó≠È¢ÑËßà>‚úï'),Ca=f("<table class=result-table><thead><tr></tr></thead><tbody>"),ka=f("<div class=pagination><div class=pagination-info>ÊòæÁ§∫ <!> - <!>/ <!> Ë°å</div><div class=pagination-controls><select><option value=10>10Ë°å/È°µ</option><option value=25>25Ë°å/È°µ</option><option value=50>50Ë°å/È°µ</option><option value=100>100Ë°å/È°µ</option></select><div class=page-buttons><button>È¶ñÈ°µ</button><button>‰∏ä‰∏ÄÈ°µ</button><span class=page-info> / </span><button>‰∏ã‰∏ÄÈ°µ</button><button>Êú´È°µ"),Ta=f(`<div class=query-preview><div class=preview-header><div class=header-info><h4>üìä Êü•ËØ¢ÁªìÊûúÈ¢ÑËßà</h4><div class=result-stats><span class=stat-item>üìã <!> Ë°åÊï∞ÊçÆ</span><span class=stat-item>üìä <!> Âàó</span><span class=stat-item>‚è±Ô∏è <!>ms</span></div></div><div class=header-actions><button class="action-btn export-btn"title=ÂØºÂá∫‰∏∫CSVÊñá‰ª∂>üì§ ÂØºÂá∫CSV</button></div></div><div class=query-info><details><summary>üîç Êü•ËØ¢ËØ¶ÊÉÖ</summary><div class=query-details><div class=query-sql><strong>SQLÊü•ËØ¢:</strong><pre class=sql-code></pre></div><div class=query-metadata><div class=metadata-item><strong>ÊâßË°åÊó∂Èó¥:</strong> <!>ms</div><div class=metadata-item><strong>ËøîÂõûË°åÊï∞:</strong> </div><div class=metadata-item><strong>ÂàóÊï∞Èáè:</strong> </div></div></div></details></div><div class=table-container></div><style>
        .query-preview {
          background: white;
          border: 1px solid #dee2e6;
          border-radius: 8px;
          overflow: hidden;
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }

        .preview-header {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          padding: 16px;
          background: #f8f9fa;
          border-bottom: 1px solid #dee2e6;
        }

        .header-info h4 {
          margin: 0 0 8px 0;
          color: #2c3e50;
        }

        .result-stats {
          display: flex;
          gap: 16px;
          font-size: 13px;
        }

        .stat-item {
          color: #6c757d;
        }

        .header-actions {
          display: flex;
          gap: 8px;
        }

        .action-btn {
          padding: 6px 12px;
          border: 1px solid #ced4da;
          border-radius: 4px;
          background: white;
          cursor: pointer;
          font-size: 12px;
          transition: all 0.2s;
        }

        .export-btn:hover {
          background: #28a745;
          color: white;
          border-color: #28a745;
        }

        .close-btn:hover {
          background: #dc3545;
          color: white;
          border-color: #dc3545;
        }

        .query-info {
          padding: 12px 16px;
          border-bottom: 1px solid #e9ecef;
        }

        .query-details {
          margin-top: 8px;
        }

        .query-sql {
          margin-bottom: 12px;
        }

        .sql-code {
          background: #f8f9fa;
          border: 1px solid #e9ecef;
          border-radius: 4px;
          padding: 12px;
          font-family: 'Monaco', 'Consolas', monospace;
          font-size: 12px;
          overflow-x: auto;
          margin: 4px 0;
        }

        .query-metadata {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 12px;
          font-size: 13px;
        }

        .metadata-item {
          color: #495057;
        }

        .table-container {
          overflow: auto;
          max-height: 500px;
        }

        .result-table {
          width: 100%;
          border-collapse: collapse;
          font-size: 13px;
        }

        .result-table th {
          background: #f8f9fa;
          border: 1px solid #dee2e6;
          padding: 8px 12px;
          text-align: left;
          font-weight: 600;
          position: sticky;
          top: 0;
          z-index: 1;
        }

        .result-table th.sortable {
          cursor: pointer;
          user-select: none;
        }

        .result-table th.sortable:hover {
          background: #e9ecef;
        }

        .column-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
        }

        .sort-indicator {
          opacity: 0.5;
          font-size: 12px;
        }

        .result-table th.sorted-asc .sort-indicator,
        .result-table th.sorted-desc .sort-indicator {
          opacity: 1;
          color: #007bff;
        }

        .result-table td {
          border: 1px solid #dee2e6;
          padding: 6px 12px;
          max-width: 200px;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
        }

        .result-table tr.even {
          background: #f8f9fa;
        }

        .result-table tr:hover {
          background: #e3f2fd;
        }

        .cell-null {
          color: #6c757d;
          font-style: italic;
        }

        .cell-boolean {
          text-align: center;
          font-weight: bold;
        }

        .cell-integer, .cell-float {
          text-align: right;
          font-family: 'Monaco', 'Consolas', monospace;
        }

        .cell-datetime {
          font-family: 'Monaco', 'Consolas', monospace;
          color: #6f42c1;
        }

        .cell-object {
          font-family: 'Monaco', 'Consolas', monospace;
          color: #e83e8c;
        }

        .empty-result {
          text-align: center;
          padding: 40px 20px;
          color: #6c757d;
        }

        .empty-icon {
          font-size: 48px;
          margin-bottom: 16px;
        }

        .empty-text {
          font-size: 18px;
          font-weight: 500;
          margin-bottom: 8px;
        }

        .empty-hint {
          font-size: 14px;
        }

        .pagination {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 12px 16px;
          background: #f8f9fa;
          border-top: 1px solid #dee2e6;
          font-size: 13px;
        }

        .pagination-controls {
          display: flex;
          align-items: center;
          gap: 12px;
        }

        .page-buttons {
          display: flex;
          align-items: center;
          gap: 4px;
        }

        .page-buttons button {
          padding: 4px 8px;
          border: 1px solid #ced4da;
          background: white;
          border-radius: 4px;
          cursor: pointer;
          font-size: 12px;
        }

        .page-buttons button:hover:not(:disabled) {
          background: #e9ecef;
        }

        .page-buttons button:disabled {
          opacity: 0.6;
          cursor: not-allowed;
        }

        .page-info {
          margin: 0 8px;
          font-weight: 500;
        }

        details summary {
          cursor: pointer;
          font-weight: 500;
          color: #495057;
        }

        details[open] summary {
          margin-bottom: 8px;
        }
      `),Ea=f("<div class=empty-result><div class=empty-icon>üì≠</div><div class=empty-text>Êü•ËØ¢Êú™ËøîÂõû‰ªª‰ΩïÊï∞ÊçÆ</div><div class=empty-hint>ËØ∑Ê£ÄÊü•Êü•ËØ¢Êù°‰ª∂ÊàñÊï∞ÊçÆÊ∫ê"),La=f("<th><div class=column-header><span class=column-name></span><span class=sort-indicator>"),Da=f("<tr>"),Pa=f("<td>");function Aa(e){const[t,n]=Z(1),[l,i]=Z(10),[s,a]=Z(null),[o,g]=Z("asc"),c=Ce(()=>{let d=[...e.result.rows];if(s()){const y=s();d.sort(($,C)=>{const k=$[y],E=C[y];if(k==null)return 1;if(E==null)return-1;const D=String(k).localeCompare(String(E),void 0,{numeric:!0});return o()==="asc"?D:-D})}const p=(t()-1)*l(),_=p+l();return{data:d.slice(p,_),totalPages:Math.ceil(d.length/l()),totalRows:d.length}}),b=d=>{s()===d?g(p=>p==="asc"?"desc":"asc"):(a(d),g("asc"))},u=d=>{if(d==null)return"";if(typeof d=="object")return JSON.stringify(d);if(typeof d=="boolean")return d?"‚úì":"‚úó";if(typeof d=="number")return Number.isInteger(d)?d.toLocaleString():d.toFixed(2);const p=String(d);if(p.match(/^\d{4}-\d{2}-\d{2}/)||p.includes("T"))try{const _=new Date(p);if(!isNaN(_.getTime()))return _.toLocaleString("zh-CN")}catch{}return p.length>50?p.substring(0,47)+"...":p},m=d=>{if(d==null)return"null";if(typeof d=="boolean")return"boolean";if(typeof d=="number")return Number.isInteger(d)?"integer":"float";if(typeof d=="object")return"object";const p=String(d);if(p.match(/^\d{4}-\d{2}-\d{2}/)||p.includes("T"))try{const _=new Date(p);if(!isNaN(_.getTime()))return"datetime"}catch{}return"string"},v=()=>{const d=e.result.columns.join(","),p=e.result.rows.map(k=>e.result.columns.map(E=>{const D=k[E],L=u(D);return L.includes(",")||L.includes('"')||L.includes(`
`)?`"${L.replace(/"/g,'""')}"`:L}).join(",")).join(`
`),_=d+`
`+p,y=new Blob([_],{type:"text/csv;charset=utf-8;"}),$=document.createElement("a"),C=URL.createObjectURL(y);$.setAttribute("href",C),$.setAttribute("download",`query_result_${Date.now()}.csv`),document.body.appendChild($),$.click(),document.body.removeChild($)};return(()=>{var d=Ta(),p=d.firstChild,_=p.firstChild,y=_.firstChild,$=y.nextSibling,C=$.firstChild,k=C.firstChild,E=k.nextSibling;E.nextSibling;var D=C.nextSibling,L=D.firstChild,O=L.nextSibling;O.nextSibling;var K=D.nextSibling,R=K.firstChild,P=R.nextSibling;P.nextSibling;var S=_.nextSibling,Q=S.firstChild,B=p.nextSibling,w=B.firstChild,z=w.firstChild,N=z.nextSibling,U=N.firstChild,H=U.firstChild,J=H.nextSibling,me=U.nextSibling,X=me.firstChild,j=X.firstChild,se=j.nextSibling,ve=se.nextSibling;ve.nextSibling;var re=X.nextSibling,le=re.firstChild;le.nextSibling;var ee=re.nextSibling,ne=ee.firstChild;ne.nextSibling;var de=B.nextSibling,Y=de.nextSibling;return r(C,()=>e.result.total_rows,E),r(D,()=>e.result.columns.length,O),r(K,()=>e.result.execution_time,P),Q.$$click=v,r(S,h(M,{get when(){return e.onClose},get children(){var W=wa();return Te(W,"click",e.onClose),W}}),null),r(J,()=>e.result.query),r(X,()=>e.result.execution_time,ve),r(re,()=>e.result.total_rows,null),r(ee,()=>e.result.columns.length,null),r(de,h(M,{get when(){return e.result.rows.length>0},get fallback(){return Ea()},get children(){var W=Ca(),he=W.firstChild,be=he.firstChild,pe=he.nextSibling;return r(be,h(oe,{get each(){return e.result.columns},children:ue=>(()=>{var fe=La(),te=fe.firstChild,ce=te.firstChild,x=ce.nextSibling;return fe.$$click=()=>b(ue),q(fe,"title",`ÁÇπÂáªÊéíÂ∫è ${ue}`),r(ce,ue),r(x,(()=>{var T=xe(()=>s()===ue);return()=>T()?o()==="asc"?"‚Üë":"‚Üì":"‚Üï"})()),A(()=>_e(fe,`sortable ${s()===ue?`sorted-${o()}`:""}`)),fe})()})),r(pe,h(oe,{get each(){return c().data},children:(ue,fe)=>(()=>{var te=Da();return r(te,h(oe,{get each(){return e.result.columns},children:ce=>(()=>{var x=Pa();return r(x,()=>u(ue[ce])),A(T=>{var F=`cell-${m(ue[ce])}`,I=`${ce}: ${u(ue[ce])}`;return F!==T.e&&_e(x,T.e=F),I!==T.t&&q(x,"title",T.t=I),T},{e:void 0,t:void 0}),x})()})),A(()=>_e(te,fe()%2===0?"even":"odd")),te})()})),W}})),r(d,h(M,{get when(){return c().totalPages>1},get children(){var W=ka(),he=W.firstChild,be=he.firstChild,pe=be.nextSibling,ue=pe.nextSibling,fe=ue.nextSibling,te=fe.nextSibling,ce=te.nextSibling;ce.nextSibling;var x=he.nextSibling,T=x.firstChild,F=T.nextSibling,I=F.firstChild,V=I.nextSibling,ie=V.nextSibling,G=ie.firstChild,ye=ie.nextSibling,ke=ye.nextSibling;return r(he,()=>(t()-1)*l()+1,pe),r(he,()=>Math.min(t()*l(),c().totalRows),fe),r(he,()=>c().totalRows,ce),T.addEventListener("change",ae=>{i(parseInt(ae.currentTarget.value)),n(1)}),I.$$click=()=>n(1),V.$$click=()=>n(ae=>Math.max(1,ae-1)),r(ie,t,G),r(ie,()=>c().totalPages,null),ye.$$click=()=>n(ae=>Math.min(c().totalPages,ae+1)),ke.$$click=()=>n(c().totalPages),A(ae=>{var ze=t()===1,Ae=t()===1,Re=t()===c().totalPages,Se=t()===c().totalPages;return ze!==ae.e&&(I.disabled=ae.e=ze),Ae!==ae.t&&(V.disabled=ae.t=Ae),Re!==ae.a&&(ye.disabled=ae.a=Re),Se!==ae.o&&(ke.disabled=ae.o=Se),ae},{e:void 0,t:void 0,a:void 0,o:void 0}),A(()=>T.value=l()),W}}),Y),d})()}Pe(["click"]);var za=f("<span>ÈÄöËøáÂèØËßÜÂåñÁïåÈù¢ÊûÑÂª∫Êü•ËØ¢ÔºåÈÄÇÂêàÂàùÂ≠¶ËÄÖ‰ΩøÁî®"),Ra=f("<span>Áõ¥Êé•ÁºñÂÜôSQLËØ≠Âè•ÔºåÈÄÇÂêàÊúâÁªèÈ™åÁöÑÁî®Êà∑"),Ma=f("<div class=error-message>‚ùå "),Na=f("<div class=validation-errors><strong>ÈîôËØØ:</strong><ul>"),Oa=f("<div class=validation-warnings><strong>Ë≠¶Âëä:</strong><ul>"),Ia=f("<div class=validation-suggestions><strong>Âª∫ËÆÆ:</strong><ul>"),Ua=f("<div><div class=validation-header><span class=validation-status></span><span class=security-status>"),Fa=f('<div class=sql-query-builder><div class=query-mode-selector><div class=mode-tabs><button>üéØ ÂèØËßÜÂåñÊûÑÂª∫</button><button>üíª Ëá™ÂÆö‰πâSQL</button></div><div class=mode-description></div></div><div class=query-content></div><div class=query-preview-section><div class=preview-header><h4>üìã SQLÊü•ËØ¢È¢ÑËßà</h4><div class=preview-actions><button class="action-btn format-btn"title=Ê†ºÂºèÂåñSQL‰ª£Á†Å>üé® Ê†ºÂºèÂåñ</button><button class="action-btn validate-btn"title=È™åËØÅSQLËØ≠Ê≥ï>‚úì È™åËØÅËØ≠Ê≥ï</button><button class="action-btn copy-btn"title=Â§çÂà∂SQLÂà∞Ââ™Ë¥¥Êùø>üìã Â§çÂà∂</button><button class="action-btn execute-btn"title=ÊâßË°åÊü•ËØ¢È¢ÑËßà></button></div></div><div class=sql-display><pre class=sql-code><code></code></pre></div></div><div class=query-help><details><summary>üí° Êü•ËØ¢ÊûÑÂª∫Â∏ÆÂä©</summary><div class=help-content><div class=help-section><h5>ÂèØËßÜÂåñÊûÑÂª∫:</h5><ul><li>ÈÄâÊã©Ë°®ÂíåÂ≠óÊÆµÊù•Ëá™Âä®ÁîüÊàêÊü•ËØ¢</li><li>ÊîØÊåÅJOINÂÖ≥ËÅî„ÄÅWHEREÊù°‰ª∂„ÄÅORDER BYÊéíÂ∫è</li><li>ÈÄÇÂêàSQLÂàùÂ≠¶ËÄÖ‰ΩøÁî®</li></ul></div><div class=help-section><h5>Ëá™ÂÆö‰πâSQL:</h5><ul><li>Áõ¥Êé•ÁºñÂÜôSQLËØ≠Âè•ÔºåÊîØÊåÅÂ§çÊùÇÊü•ËØ¢</li><li>Êèê‰æõËØ≠Ê≥ïÈ™åËØÅÂíåÊ†ºÂºèÂåñÂäüËÉΩ</li><li>ÈÄÇÂêàÊúâÁªèÈ™åÁöÑÁî®Êà∑</li></ul></div><div class=help-section><h5>ÂÆâÂÖ®ÊèêÁ§∫:</h5><ul><li>Á≥ªÁªü‰ºöËá™Âä®Ê£ÄÊµãSQLÊ≥®ÂÖ•È£éÈô©</li><li>È¢ÑËßàÊü•ËØ¢ÈôêÂà∂ËøîÂõûË°åÊï∞ÔºåÈÅøÂÖçÊÄßËÉΩÈóÆÈ¢ò</li><li>Âª∫ËÆÆÂÖàÈ™åËØÅËØ≠Ê≥ïÔºåÂÜçÊâßË°åÈ¢ÑËßà'),Pt=f("<li>");function Ba(e){const[t,n]=Z("visual"),[l,i]=Z(!1),[s,a]=Z(null),[o,g]=Z(null),[c,b]=Z(null),[u,m]=Z(""),v=Ce(()=>t()==="visual"?u():e.sql),d=Ce(()=>o()),p=async()=>{const k=v().trim();if(!k){g(null),e.onValidationChange(null);return}try{i(!0),a(null),console.log("üîç È™åËØÅSQLËØ≠Ê≥ï:",k);const E=await we.validateSqlSyntax(k,e.config.database_type);g(E),e.onValidationChange(E),console.log("‚úÖ SQLÈ™åËØÅÁªìÊûú:",E)}catch(E){console.error("‚ùå SQLÈ™åËØÅÂ§±Ë¥•:",E);const D={valid:!1,errors:[`È™åËØÅÂ§±Ë¥•: ${E}`],warnings:[],suggestions:[],is_safe:!1,security_issues:["Êó†Ê≥ïÈ™åËØÅÊü•ËØ¢ÂÆâÂÖ®ÊÄß"]};g(D),e.onValidationChange(D),a(`SQLÈ™åËØÅÂ§±Ë¥•: ${E}`)}finally{i(!1)}},_=async()=>{const k=v().trim();if(k)try{i(!0),a(null),console.log("üé® Ê†ºÂºèÂåñSQL:",k);const E=await we.formatSql(k,e.config.database_type);t()==="visual"?m(E):e.onSQLChange(E),console.log("‚úÖ SQLÊ†ºÂºèÂåñÂÆåÊàê")}catch(E){console.error("‚ùå SQLÊ†ºÂºèÂåñÂ§±Ë¥•:",E),a(`Ê†ºÂºèÂåñÂ§±Ë¥•: ${E}`)}finally{i(!1)}},y=async()=>{const k=v().trim();if(!k){a("ËØ∑ËæìÂÖ•SQLÊü•ËØ¢ËØ≠Âè•");return}try{i(!0),a(null),console.log("‚ñ∂Ô∏è ÊâßË°åÊü•ËØ¢È¢ÑËßà:",k),await p();const E=o();if(E&&!E.valid){a("SQLËØ≠Ê≥ïÈ™åËØÅÂ§±Ë¥•ÔºåËØ∑‰øÆÊ≠£ÂêéÈáçËØï");return}const D=await we.executeDatabasePreview(e.config,k,50);b(D),e.onQueryResult(D),console.log("‚úÖ Êü•ËØ¢È¢ÑËßàÊàêÂäü:",D)}catch(E){console.error("‚ùå Êü•ËØ¢È¢ÑËßàÂ§±Ë¥•:",E),a(`Êü•ËØ¢ÊâßË°åÂ§±Ë¥•: ${E}`),b(null),e.onQueryResult(null)}finally{i(!1)}},$=async()=>{const k=v();if(k)try{await navigator.clipboard.writeText(k),console.log("üìã SQLÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø")}catch(E){console.error("‚ùå Â§çÂà∂Â§±Ë¥•:",E),a(`Â§çÂà∂Â§±Ë¥•: ${E}`)}},C=k=>{n(k),a(null),k==="custom"&&u()&&e.onSQLChange(u())};return(()=>{var k=Fa(),E=k.firstChild,D=E.firstChild,L=D.firstChild,O=L.nextSibling,K=D.nextSibling,R=E.nextSibling,P=R.nextSibling,S=P.firstChild,Q=S.firstChild,B=Q.nextSibling,w=B.firstChild,z=w.nextSibling,N=z.nextSibling,U=N.nextSibling,H=S.nextSibling,J=H.firstChild,me=J.firstChild;return L.$$click=()=>C("visual"),O.$$click=()=>C("custom"),r(K,h(M,{get when(){return t()==="visual"},get children(){return za()}}),null),r(K,h(M,{get when(){return t()==="custom"},get children(){return Ra()}}),null),r(k,h(M,{get when(){return s()},get children(){var X=Ma();return X.firstChild,r(X,s,null),X}}),R),r(R,h(M,{get when(){return t()==="visual"},get children(){return h(Sa,{get selectedTables(){return e.selectedTables},get schema(){return e.schema},onQueryChange:m,get disabled(){return l()}})}}),null),r(R,h(M,{get when(){return t()==="custom"},get children(){return h(ha,{get sql(){return e.sql},get onSQLChange(){return e.onSQLChange},get databaseType(){return e.config.database_type},get disabled(){return l()}})}}),null),w.$$click=_,z.$$click=p,N.$$click=$,U.$$click=y,r(U,()=>l()?"‚è≥ ÊâßË°å‰∏≠...":"‚ñ∂Ô∏è È¢ÑËßàÊü•ËØ¢"),r(me,()=>v()||"-- ËØ∑ÊûÑÂª∫ÊàñËæìÂÖ•SQLÊü•ËØ¢ËØ≠Âè•"),r(P,h(M,{get when(){return d()},get children(){var X=Ua(),j=X.firstChild,se=j.firstChild,ve=se.nextSibling;return r(se,()=>d().valid?"‚úÖ ËØ≠Ê≥ïÊ≠£Á°Æ":"‚ùå ËØ≠Ê≥ïÈîôËØØ"),r(ve,()=>d().is_safe?"üîí Êü•ËØ¢ÂÆâÂÖ®":"‚ö†Ô∏è ÂÆâÂÖ®Ë≠¶Âëä"),r(X,h(M,{get when(){return xe(()=>!!d().errors)()&&d().errors.length>0},get children(){var re=Na(),le=re.firstChild,ee=le.nextSibling;return r(ee,h(oe,{get each(){return d().errors},children:ne=>(()=>{var de=Pt();return r(de,ne),de})()})),re}}),null),r(X,h(M,{get when(){return xe(()=>{var re;return!!((re=d())!=null&&re.warnings)})()&&d().warnings.length>0},get children(){var re=Oa(),le=re.firstChild,ee=le.nextSibling;return r(ee,h(oe,{get each(){return d().warnings},children:ne=>(()=>{var de=Pt();return r(de,ne),de})()})),re}}),null),r(X,h(M,{get when(){return xe(()=>{var re;return!!((re=d())!=null&&re.suggestions)})()&&d().suggestions.length>0},get children(){var re=Ia(),le=re.firstChild,ee=le.nextSibling;return r(ee,h(oe,{get each(){return d().suggestions},children:ne=>(()=>{var de=Pt();return r(de,ne),de})()})),re}}),null),A(()=>{var re;return _e(X,`validation-result ${(re=d())!=null&&re.valid?"valid":"invalid"}`)}),X}}),null),r(P,h(M,{get when(){return c()},get children(){return h(Aa,{get result(){return c()},onClose:()=>{b(null),e.onQueryResult(null)}})}}),null),A(X=>{var j=`mode-tab ${t()==="visual"?"active":""}`,se=l(),ve=`mode-tab ${t()==="custom"?"active":""}`,re=l(),le=l()||!v(),ee=l()||!v(),ne=l()||!v(),de=l()||!v();return j!==X.e&&_e(L,X.e=j),se!==X.t&&(L.disabled=X.t=se),ve!==X.a&&_e(O,X.a=ve),re!==X.o&&(O.disabled=X.o=re),le!==X.i&&(w.disabled=X.i=le),ee!==X.n&&(z.disabled=X.n=ee),ne!==X.s&&(N.disabled=X.s=ne),de!==X.h&&(U.disabled=X.h=de),X},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),k})()}Pe(["click"]);var qa=f("<div class=error-messages>"),ja=f("<div class=loading-overlay><div class=loading-spinner>‚è≥</div><div class=loading-text>Â§ÑÁêÜ‰∏≠..."),Ha=f('<div class=form-row><div class="form-group flex-2"><label>‰∏ªÊú∫Âú∞ÂùÄ</label><input type=text placeholder=localhost></div><div class="form-group flex-1"><label>Á´ØÂè£</label><input type=number>'),Qa=f("<div class=form-group><label>Êï∞ÊçÆÂ∫ìÊñá‰ª∂Ë∑ØÂæÑ</label><input type=text placeholder=/path/to/database.db>"),Ja=f("<div class=form-group><label>Êï∞ÊçÆÂ∫ìÂêç</label><input type=text placeholder=myapp_production>"),Va=f("<div class=form-row><div class=form-group><label>Áî®Êà∑Âêç</label><input type=text></div><div class=form-group><label>ÂØÜÁ†Å</label><input type=password>"),kn=f("<div><div class=result-message><span class=result-icon></span><span class=result-text>"),Wa=f("<div class=connection-step><div class=step-header><h4>üîå Êï∞ÊçÆÂ∫ìËøûÊé•ÈÖçÁΩÆ</h4><p>ËØ∑Â°´ÂÜôÊï∞ÊçÆÂ∫ìËøûÊé•‰ø°ÊÅØ</p></div><div class=form-section><div class=form-group><label>Êï∞ÊçÆÂ∫ìÁ±ªÂûã</label><select><option value=mysql>MySQL</option><option value=postgresql>PostgreSQL</option><option value=sqlite>SQLite</option><option value=sqlserver>SQL Server</option><option value=oracle>Oracle</option></select></div><div class=connection-test><button class=test-connection-btn>"),Ga=f("<div class=schema-loading><button class=load-schema-btn>üîÑ Âä†ËΩΩË°®ÁªìÊûÑ</button><p class=loading-hint>ÁÇπÂáªÊåâÈíÆÂä†ËΩΩÊï∞ÊçÆÂ∫ìÁöÑË°®ÁªìÊûÑ‰ø°ÊÅØ"),Ka=f("<div class=views-section><h5>üëÅÔ∏è Êï∞ÊçÆËßÜÂõæÂàóË°®</h5><div class=views-list>"),Ya=f("<div class=schema-content><div class=schema-summary><div class=summary-item><span class=summary-label>Êï∞ÊçÆÂ∫ì:</span><span class=summary-value></span></div><div class=summary-item><span class=summary-label>Ë°®Êï∞Èáè:</span><span class=summary-value></span></div><div class=summary-item><span class=summary-label>ËßÜÂõæÊï∞Èáè:</span><span class=summary-value></span></div><div class=summary-item><span class=summary-label>Âä†ËΩΩÊó∂Èó¥:</span><span class=summary-value></span></div></div><div class=tables-section><h5>üìã Êï∞ÊçÆË°®ÂàóË°®</h5><div class=tables-grid>"),Xa=f("<div class=schema-step><div class=step-header><h4>üóÇÔ∏è Êï∞ÊçÆÂ∫ìË°®ÁªìÊûÑ</h4><p>ÈÄâÊã©Ë¶ÅÊü•ËØ¢ÁöÑÊï∞ÊçÆË°®ÂíåÂ≠óÊÆµ"),Za=f('<div class=database-wizard><div class=wizard-header><button class=back-btn>‚Üê ËøîÂõû</button><div class=wizard-title><h3>üóÑÔ∏è ÂàõÂª∫Êï∞ÊçÆÂ∫ìÊï∞ÊçÆÊ∫ê</h3><p>ËøûÊé•Êï∞ÊçÆÂ∫ìÂπ∂ÈÖçÁΩÆÊü•ËØ¢ËØ≠Âè•</p></div></div><div class=wizard-progress><div><div class=step-indicator>1</div><div class=step-info><div class=step-title>Êï∞ÊçÆÂ∫ìËøûÊé•</div><div class=step-description>ÈÖçÁΩÆËøûÊé•‰ø°ÊÅØ</div></div></div><div><div class=step-indicator>2</div><div class=step-info><div class=step-title>Ë°®ÁªìÊûÑ</div><div class=step-description>ÈÄâÊã©Êï∞ÊçÆË°®</div></div></div><div><div class=step-indicator>3</div><div class=step-info><div class=step-title>Êü•ËØ¢ÊûÑÂª∫</div><div class=step-description>ÁºñÂÜôSQLÊü•ËØ¢</div></div></div><div><div class=step-indicator>4</div><div class=step-info><div class=step-title>È¢ÑËßà‰øùÂ≠ò</div><div class=step-description>ÊµãËØïÂπ∂‰øùÂ≠ò</div></div></div></div><div class=wizard-content></div><div class=wizard-controls><div class=control-buttons><button class="control-btn back-btn">‚Üê ‰∏ä‰∏ÄÊ≠•</button><button class="control-btn next-btn">‰∏ã‰∏ÄÊ≠• ‚Üí'),eo=f("<div class=error-message>‚ùå "),to=f("<span class=view-comment>"),no=f("<div class=view-item><div class=view-info><span class=view-name></span><span class=view-schema>"),lo=f("<div class=table-comment>"),io=f("<div class=more-columns>+<!> ‰∏™Â≠óÊÆµ..."),so=f("<span class=more-indexes>+"),ro=f("<div class=table-indexes><h6>Á¥¢Âºï (<!>)</h6><div class=indexes-list>"),ao=f("<span class=more-relations>+"),oo=f("<div class=table-relations><h6>ÂÖ≥ËÅî (<!>)</h6><div class=relations-list>"),co=f("<div><div class=table-card-header><div class=table-card-title><label class=table-checkbox><input type=checkbox><span class=table-name>üìã </span></label></div><div class=table-card-stats><span class=row-count title=È¢Ñ‰º∞Ë°åÊï∞> Ë°å</span><span class=table-size title=È¢Ñ‰º∞Â§ßÂ∞è></span></div></div><div class=table-columns><h6>Â≠óÊÆµ (<!>)</h6><div class=columns-preview>"),uo=f("<span class=pk-badge title=‰∏ªÈîÆ>üîë"),go=f("<span class=fk-badge title=Â§ñÈîÆ>üîó"),ho=f("<div class=column-item><span class=column-icon></span><span class=column-name></span><span class=column-type>"),vo=f("<span> "),fo=f("<span class=relation-badge>üîó "),mo=f('<div class=preview-step><div class=step-header><h4>üëÅÔ∏è È¢ÑËßàÂíå‰øùÂ≠ò</h4><p>È™åËØÅÈÖçÁΩÆ„ÄÅÈ¢ÑËßàÊï∞ÊçÆÂπ∂‰øùÂ≠òÊï∞ÊçÆÊ∫ê</p></div><div class=basic-info-section><h5>üìù Âü∫Êú¨‰ø°ÊÅØ</h5><div class=form-row><div class="form-group flex-2"><label>Êï∞ÊçÆÊ∫êÂêçÁß∞ *</label><input type=text placeholder=ËæìÂÖ•Êï∞ÊçÆÊ∫êÂêçÁß∞... required></div><div class="form-group flex-1"><label>Ê†áÁ≠æ</label><input type=text placeholder="Ê†áÁ≠æ1, Ê†áÁ≠æ2"></div></div><div class=form-group><label>ÊèèËø∞</label><textarea placeholder=ÊèèËø∞Ëøô‰∏™Êï∞ÊçÆÊ∫êÁöÑÁî®ÈÄî... rows=3>'),bo=f("<div class=config-summary><h5>‚öôÔ∏è ÈÖçÁΩÆÊëòË¶Å</h5><div class=summary-grid><div class=summary-item><span class=summary-label>Êï∞ÊçÆÂ∫ìÁ±ªÂûã:</span><span class=summary-value></span></div><div class=summary-item><span class=summary-label>ËøûÊé•Âú∞ÂùÄ:</span><span class=summary-value>:</span></div><div class=summary-item><span class=summary-label>Êï∞ÊçÆÂ∫ì:</span><span class=summary-value></span></div><div class=summary-item><span class=summary-label>Áî®Êà∑Âêç:</span><span class=summary-value></span></div><div class=summary-item><span class=summary-label>ÈÄâ‰∏≠Ë°®:</span><span class=summary-value> ‰∏™Ë°®</span></div><div class=summary-item><span class=summary-label>Êü•ËØ¢ÈïøÂ∫¶:</span><span class=summary-value> Â≠óÁ¨¶</span></div></div><div class=sql-preview><h6>SQLÊü•ËØ¢È¢ÑËßà:</h6><pre class=sql-code>"),po=f("<div class=validation-warnings><h6>‚ö†Ô∏è Ë≠¶Âëä"),yo=f("<div class=validation-errors><h6>‚ùå ÈîôËØØ"),$o=f("<div class=validation-suggestions><h6>üí° Âª∫ËÆÆ"),_o=f("<div class=validation-results><div class=validation-checks>"),xo=f("<div class=validation-section><div class=section-header><h5>‚úÖ È™åËØÅÁä∂ÊÄÅ</h5><button class=validate-btn>"),So=f("<div class=warning-item>"),wo=f("<div class=error-item>"),Co=f("<div class=suggestion-item>"),ko=f("<div><span class=check-icon></span><span class=check-label></span><span>"),To=f("<div class=no-data>Ê≤°ÊúâÊü•ËØ¢Âà∞Êï∞ÊçÆ"),Eo=f("<div class=preview-results><div class=preview-stats><div class=stat-item><span class=stat-label>Ê†∑Êú¨Ë°åÊï∞:</span><span class=stat-value></span></div><div class=stat-item><span class=stat-label>È¢Ñ‰º∞ÊÄªË°åÊï∞:</span><span class=stat-value></span></div><div class=stat-item><span class=stat-label>ÊâßË°åÊó∂Èó¥:</span><span class=stat-value>ms</span></div></div><div class=preview-data>"),Lo=f("<div class=data-preview-section><div class=section-header><h5>üìä Êï∞ÊçÆÈ¢ÑËßà</h5><button class=preview-btn>"),Do=f("<div class=no-data>Ê≤°ÊúâÊï∞ÊçÆ"),Po=f("<div class=table-footer>ÊòæÁ§∫Ââç10Ë°åÔºåÂÖ± <!> Ë°åÊï∞ÊçÆ"),Ao=f("<div class=data-table-container><table class=data-table><thead><tr></tr></thead><tbody>"),zo=f("<th>"),Ro=f("<tr>"),Mo=f("<td>"),No=f("<div class=result-details><div class=detail-item><span class=detail-label>Êï∞ÊçÆÊ∫êID:</span><span class=detail-value>"),Oo=f("<div class=result-warnings>"),Io=f("<div class=result-errors>"),Uo=f("<div class=save-requirements><h6>‰øùÂ≠òÂâçÈúÄË¶ÅÂÆåÊàê:</h6><ul><li>Â°´ÂÜôÊï∞ÊçÆÊ∫êÂêçÁß∞</li><li>Á°Æ‰øùSQLÊü•ËØ¢ÊúâÊïà</li><li>ÈÄöËøáÂü∫Êú¨È™åËØÅÊ£ÄÊü•"),Fo=f("<div class=save-section><div class=section-header><h5>üíæ ‰øùÂ≠òÊï∞ÊçÆÊ∫ê</h5><button>"),Bo=f("<div class=warning-item>‚ö†Ô∏è "),qo=f("<div class=error-item>‚ùå ");const jo={database_type:"mysql",host:"localhost",port:3306,database:"",username:"",password:"",ssl_enabled:!1,max_connections:10,min_connections:1,connection_timeout:30,idle_timeout:600,sql:"",use_custom_sql:!1,query_timeout:60,default_limit:1e3,enable_caching:!0,cache_ttl:300};function Ho(e){const[t,n]=Z({currentStep:"connection",name:"",description:"",tags:[],config:{...jo},schema:null,selectedTables:[],generatedSQL:"",customSQL:"",useCustomSQL:!1,testResult:null,queryResult:null,validation:null,dataSourceValidation:null,dataPreview:null,loading:!1,errors:[],isSaving:!1,saveResult:null}),l=Ce(()=>{var d;const v=t();return{connection:((d=v.testResult)==null?void 0:d.success)||!1,schema:v.schema!==null&&v.selectedTables.length>0,query:v.customSQL.trim().length>0,preview:v.name.trim().length>0&&v.customSQL.trim().length>0}}),i=v=>{n(d=>({...d,...v}))},s=v=>{n(d=>({...d,config:{...d.config,...v}}))},a=async()=>{i({loading:!0,errors:[]});try{const v=await we.testDatabaseConnection(t().config);i({testResult:v,loading:!1,errors:v.success?[]:[v.message]}),v.success&&setTimeout(()=>{i({currentStep:"schema"}),o()},1e3)}catch(v){i({loading:!1,errors:[`ËøûÊé•ÊµãËØïÂ§±Ë¥•: ${v}`],testResult:null})}},o=async()=>{i({loading:!0,errors:[]});try{const v=await we.loadDatabaseSchema(t().config);i({schema:v,loading:!1,errors:[]})}catch(v){i({loading:!1,errors:[`Êû∂ÊûÑÂä†ËΩΩÂ§±Ë¥•: ${v}`],schema:null})}},g=async()=>{i({loading:!0,errors:[]});try{const v={name:t().name,config:t().config,selected_tables:t().selectedTables,sql:t().customSQL,description:t().description,tags:t().tags,validate_before_save:!0},d=await we.validateDataSourceBeforeSave(v);return i({dataSourceValidation:d,loading:!1,errors:d.errors}),d}catch(v){return i({loading:!1,errors:[`È™åËØÅÂ§±Ë¥•: ${v}`]}),null}},c=async()=>{i({loading:!0,errors:[]});try{const v=await we.captureDataPreview(t().config,t().customSQL);return i({dataPreview:v,loading:!1}),v}catch(v){return i({loading:!1,errors:[`Êï∞ÊçÆÈ¢ÑËßàÂ§±Ë¥•: ${v}`]}),null}},b=async()=>{i({isSaving:!0,errors:[]});try{const v={name:t().name,config:t().config,selected_tables:t().selectedTables,sql:t().customSQL,description:t().description,tags:t().tags,validate_before_save:!0,capture_schema_snapshot:!0,capture_data_preview:!0,preview_row_limit:10},d=await we.saveDataSource(v);return i({saveResult:d,isSaving:!1}),d.success&&setTimeout(()=>{e.onSuccess()},2e3),d}catch(v){return i({isSaving:!1,errors:[`‰øùÂ≠òÂ§±Ë¥•: ${v}`]}),null}},u=v=>{i({currentStep:v})},m=()=>{switch(t().currentStep){case"schema":i({currentStep:"connection"});break;case"query":i({currentStep:"schema"});break;case"preview":i({currentStep:"query"});break;default:e.onBack()}};return(()=>{var v=Za(),d=v.firstChild,p=d.firstChild,_=d.nextSibling,y=_.firstChild,$=y.nextSibling,C=$.nextSibling,k=C.nextSibling,E=_.nextSibling,D=E.nextSibling,L=D.firstChild,O=L.firstChild,K=O.nextSibling;return p.$$click=m,y.$$click=()=>u("connection"),$.$$click=()=>l().connection&&u("schema"),C.$$click=()=>l().schema&&u("query"),k.$$click=()=>l().query&&u("preview"),r(E,h(M,{get when(){return t().errors.length>0},get children(){var R=qa();return r(R,h(oe,{get each(){return t().errors},children:P=>(()=>{var S=eo();return S.firstChild,r(S,P,null),S})()})),R}}),null),r(E,h(M,{get when(){return t().loading},get children(){return ja()}}),null),r(E,h(M,{get when(){return t().currentStep==="connection"},get children(){var R=Wa(),P=R.firstChild,S=P.nextSibling,Q=S.firstChild,B=Q.firstChild,w=B.nextSibling,z=Q.nextSibling,N=z.firstChild;return w.addEventListener("change",U=>{const H=U.currentTarget.value,J={mysql:3306,postgresql:5432,sqlserver:1433,oracle:1521,sqlite:0}[H];s({database_type:H,port:J})}),r(S,h(M,{get when(){return t().config.database_type!=="sqlite"},get children(){var U=Ha(),H=U.firstChild,J=H.firstChild,me=J.nextSibling,X=H.nextSibling,j=X.firstChild,se=j.nextSibling;return me.addEventListener("change",ve=>s({host:ve.currentTarget.value})),se.addEventListener("change",ve=>s({port:parseInt(ve.currentTarget.value)||3306})),A(()=>me.value=t().config.host),A(()=>se.value=t().config.port),U}}),z),r(S,h(M,{get when(){return t().config.database_type==="sqlite"},get children(){var U=Qa(),H=U.firstChild,J=H.nextSibling;return J.addEventListener("change",me=>s({database:me.currentTarget.value})),A(()=>J.value=t().config.database),U}}),z),r(S,h(M,{get when(){return t().config.database_type!=="sqlite"},get children(){return[(()=>{var U=Ja(),H=U.firstChild,J=H.nextSibling;return J.addEventListener("change",me=>s({database:me.currentTarget.value})),A(()=>J.value=t().config.database),U})(),(()=>{var U=Va(),H=U.firstChild,J=H.firstChild,me=J.nextSibling,X=H.nextSibling,j=X.firstChild,se=j.nextSibling;return me.addEventListener("change",ve=>s({username:ve.currentTarget.value})),se.addEventListener("change",ve=>s({password:ve.currentTarget.value})),A(()=>me.value=t().config.username),A(()=>se.value=t().config.password),U})()]}}),z),N.$$click=a,r(N,()=>t().loading?"‚è≥ ÊµãËØï‰∏≠...":"üîó ÊµãËØïËøûÊé•"),r(z,h(M,{get when(){return t().testResult},get children(){var U=kn(),H=U.firstChild,J=H.firstChild,me=J.nextSibling;return r(J,()=>{var X;return(X=t().testResult)!=null&&X.success?"‚úÖ":"‚ùå"}),r(me,()=>{var X;return(X=t().testResult)==null?void 0:X.message}),A(()=>{var X;return _e(U,`test-result ${(X=t().testResult)!=null&&X.success?"success":"error"}`)}),U}}),null),A(()=>N.disabled=t().loading),A(()=>w.value=t().config.database_type),R}}),null),r(E,h(M,{get when(){return t().currentStep==="schema"},get children(){var R=Xa();return R.firstChild,r(R,h(M,{get when(){return xe(()=>!t().schema)()&&!t().loading},get children(){var P=Ga(),S=P.firstChild;return S.$$click=o,P}}),null),r(R,h(M,{get when(){return t().schema},get children(){var P=Ya(),S=P.firstChild,Q=S.firstChild,B=Q.firstChild,w=B.nextSibling,z=Q.nextSibling,N=z.firstChild,U=N.nextSibling,H=z.nextSibling,J=H.firstChild,me=J.nextSibling,X=H.nextSibling,j=X.firstChild,se=j.nextSibling,ve=S.nextSibling,re=ve.firstChild,le=re.nextSibling;return r(w,()=>{var ee;return(ee=t().schema)==null?void 0:ee.database_name}),r(U,()=>{var ee,ne,de;return((de=(ne=(ee=t().schema)==null?void 0:ee.schemas[0])==null?void 0:ne.tables)==null?void 0:de.length)||0}),r(me,()=>{var ee,ne,de;return((de=(ne=(ee=t().schema)==null?void 0:ee.schemas[0])==null?void 0:ne.views)==null?void 0:de.length)||0}),r(se,()=>{var ee;return new Date(((ee=t().schema)==null?void 0:ee.loaded_at)||"").toLocaleString("zh-CN")}),r(le,h(oe,{get each(){var ee,ne;return((ne=(ee=t().schema)==null?void 0:ee.schemas[0])==null?void 0:ne.tables)||[]},children:ee=>h(Qo,{table:ee,get selected(){return t().selectedTables.includes(ee.name)},onToggle:(ne,de)=>{const Y=t().selectedTables;i(de?{selectedTables:[...Y,ne]}:{selectedTables:Y.filter(W=>W!==ne)})}})})),r(P,h(M,{get when(){return xe(()=>{var ee,ne;return!!((ne=(ee=t().schema)==null?void 0:ee.schemas[0])!=null&&ne.views)})()&&t().schema.schemas[0].views.length>0},get children(){var ee=Ka(),ne=ee.firstChild,de=ne.nextSibling;return r(de,h(oe,{get each(){var Y,W;return((W=(Y=t().schema)==null?void 0:Y.schemas[0])==null?void 0:W.views)||[]},children:Y=>(()=>{var W=no(),he=W.firstChild,be=he.firstChild,pe=be.nextSibling;return r(be,()=>Y.name),r(pe,()=>Y.schema),r(W,h(M,{get when(){return Y.comment},get children(){var ue=to();return r(ue,()=>Y.comment),ue}}),null),W})()})),ee}}),null),P}}),null),R}}),null),r(E,h(M,{get when(){return t().currentStep==="query"},get children(){return h(Ba,{get selectedTables(){return t().selectedTables},get schema(){return t().schema},get config(){return t().config},get sql(){return t().customSQL},onSQLChange:R=>i({customSQL:R}),onQueryResult:R=>i({queryResult:R}),onValidationChange:R=>i({validation:R})})}}),null),r(E,h(M,{get when(){return t().currentStep==="preview"},get children(){return h(Jo,{get state(){return t()},onStateUpdate:i,onSave:b,onValidate:g,onPreviewData:c})}}),null),O.$$click=m,K.$$click=()=>{var P;const R=t();R.currentStep==="connection"&&((P=R.testResult)!=null&&P.success)?(i({currentStep:"schema"}),R.schema||o()):R.currentStep==="schema"?i({currentStep:"query"}):R.currentStep==="query"&&i({currentStep:"preview"})},A(R=>{var P=`progress-step ${t().currentStep==="connection"?"active":""} ${l().connection?"completed":""}`,S=`progress-step ${t().currentStep==="schema"?"active":""} ${l().schema?"completed":""}`,Q=`progress-step ${t().currentStep==="query"?"active":""} ${l().query?"completed":""}`,B=`progress-step ${t().currentStep==="preview"?"active":""} ${l().preview?"completed":""}`,w=t().loading;return P!==R.e&&_e(y,R.e=P),S!==R.t&&_e($,R.t=S),Q!==R.a&&_e(C,R.a=Q),B!==R.o&&_e(k,R.o=B),w!==R.i&&(K.disabled=R.i=w),R},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),v})()}function Qo(e){const t=l=>l<1e3?l.toString():l<1e6?`${(l/1e3).toFixed(1)}K`:`${(l/1e6).toFixed(1)}M`,n=l=>{const i=l.toLowerCase();return i.includes("int")||i.includes("number")||i.includes("decimal")?"üî¢":i.includes("varchar")||i.includes("text")||i.includes("char")?"üìù":i.includes("date")||i.includes("time")?"üìÖ":i.includes("bool")?"‚úÖ":"üìã"};return(()=>{var l=co(),i=l.firstChild,s=i.firstChild,a=s.firstChild,o=a.firstChild,g=o.nextSibling;g.firstChild;var c=s.nextSibling,b=c.firstChild,u=b.firstChild,m=b.nextSibling,v=i.nextSibling,d=v.firstChild,p=d.firstChild,_=p.nextSibling;_.nextSibling;var y=d.nextSibling;return o.addEventListener("change",$=>e.onToggle(e.table.name,$.currentTarget.checked)),r(g,()=>e.table.name,null),r(b,()=>t(e.table.row_count_estimate),u),r(m,()=>e.table.size_estimate),r(l,h(M,{get when(){return e.table.comment},get children(){var $=lo();return r($,()=>e.table.comment),$}}),v),r(d,()=>{var $;return(($=e.table.columns)==null?void 0:$.length)||0},_),r(y,h(oe,{get each(){return(e.table.columns||[]).slice(0,6)},children:$=>(()=>{var C=ho(),k=C.firstChild,E=k.nextSibling,D=E.nextSibling;return r(k,()=>n($.data_type)),r(E,()=>$.name),r(D,()=>$.data_type),r(C,h(M,{get when(){return $.is_primary_key},get children(){return uo()}}),null),r(C,h(M,{get when(){return $.is_foreign_key},get children(){return go()}}),null),C})()}),null),r(y,h(M,{get when(){var $;return((($=e.table.columns)==null?void 0:$.length)||0)>6},get children(){var $=io(),C=$.firstChild,k=C.nextSibling;return k.nextSibling,r($,()=>{var E;return(((E=e.table.columns)==null?void 0:E.length)||0)-6},k),$}}),null),r(l,h(M,{get when(){return e.table.indexes&&e.table.indexes.length>0},get children(){var $=ro(),C=$.firstChild,k=C.firstChild,E=k.nextSibling;E.nextSibling;var D=C.nextSibling;return r(C,()=>e.table.indexes.length,E),r(D,h(oe,{get each(){return e.table.indexes.slice(0,3)},children:L=>(()=>{var O=vo(),K=O.firstChild;return r(O,()=>L.unique?"üîê":"üìá",K),r(O,()=>L.name,null),A(R=>{var P=`index-badge ${L.unique?"unique":""}`,S=L.columns.join(", ");return P!==R.e&&_e(O,R.e=P),S!==R.t&&q(O,"title",R.t=S),R},{e:void 0,t:void 0}),O})()}),null),r(D,h(M,{get when(){return e.table.indexes.length>3},get children(){var L=so();return L.firstChild,r(L,()=>e.table.indexes.length-3,null),L}}),null),$}}),null),r(l,h(M,{get when(){return e.table.foreign_keys&&e.table.foreign_keys.length>0},get children(){var $=oo(),C=$.firstChild,k=C.firstChild,E=k.nextSibling;E.nextSibling;var D=C.nextSibling;return r(C,()=>e.table.foreign_keys.length,E),r(D,h(oe,{get each(){return e.table.foreign_keys.slice(0,2)},children:L=>(()=>{var O=fo();return O.firstChild,r(O,()=>L.referenced_table,null),A(()=>q(O,"title",`${L.column_name} ‚Üí ${L.referenced_table}.${L.referenced_column}`)),O})()}),null),r(D,h(M,{get when(){return e.table.foreign_keys.length>2},get children(){var L=ao();return L.firstChild,r(L,()=>e.table.foreign_keys.length-2,null),L}}),null),$}}),null),A(()=>_e(l,`table-card ${e.selected?"selected":""}`)),A(()=>o.checked=e.selected),l})()}function Jo(e){return(()=>{var t=mo(),n=t.firstChild,l=n.nextSibling,i=l.firstChild,s=i.nextSibling,a=s.firstChild,o=a.firstChild,g=o.nextSibling,c=a.nextSibling,b=c.firstChild,u=b.nextSibling,m=s.nextSibling,v=m.firstChild,d=v.nextSibling;return g.$$input=p=>e.onStateUpdate({name:p.currentTarget.value}),u.$$input=p=>{const _=p.currentTarget.value.split(",").map(y=>y.trim()).filter(y=>y);e.onStateUpdate({tags:_})},d.$$input=p=>e.onStateUpdate({description:p.currentTarget.value}),r(t,h(Vo,{get state(){return e.state}}),null),r(t,h(Wo,{get validation(){return e.state.dataSourceValidation},get onValidate(){return e.onValidate},get loading(){return e.state.loading}}),null),r(t,h(Go,{get preview(){return e.state.dataPreview},get onPreviewData(){return e.onPreviewData},get loading(){return e.state.loading}}),null),r(t,h(Yo,{get saveResult(){return e.state.saveResult},get onSave(){return e.onSave},get isSaving(){return e.state.isSaving},get canSave(){return Xo(e.state)}}),null),A(()=>g.value=e.state.name),A(()=>u.value=e.state.tags.join(", ")),A(()=>d.value=e.state.description),t})()}function Vo(e){return(()=>{var t=bo(),n=t.firstChild,l=n.nextSibling,i=l.firstChild,s=i.firstChild,a=s.nextSibling,o=i.nextSibling,g=o.firstChild,c=g.nextSibling,b=c.firstChild,u=o.nextSibling,m=u.firstChild,v=m.nextSibling,d=u.nextSibling,p=d.firstChild,_=p.nextSibling,y=d.nextSibling,$=y.firstChild,C=$.nextSibling,k=C.firstChild,E=y.nextSibling,D=E.firstChild,L=D.nextSibling,O=L.firstChild,K=l.nextSibling,R=K.firstChild,P=R.nextSibling;return r(a,()=>e.state.config.database_type.toUpperCase()),r(c,()=>e.state.config.host,b),r(c,()=>e.state.config.port,null),r(v,()=>e.state.config.database),r(_,()=>e.state.config.username),r(C,()=>e.state.selectedTables.length,k),r(L,()=>e.state.customSQL.length,O),r(P,()=>e.state.customSQL.slice(0,200),null),r(P,()=>e.state.customSQL.length>200?"...":"",null),t})()}function Wo(e){return(()=>{var t=xo(),n=t.firstChild,l=n.firstChild,i=l.nextSibling;return Te(i,"click",e.onValidate),r(i,()=>e.loading?"‚è≥ È™åËØÅ‰∏≠...":"üîç ÂºÄÂßãÈ™åËØÅ"),r(t,h(M,{get when(){return e.validation},get children(){var s=_o(),a=s.firstChild;return r(a,h(gt,{label:"Êï∞ÊçÆÂ∫ìËøûÊé•",get status(){var o;return(o=e.validation)!=null&&o.connection_valid?"success":"error"},get icon(){var o;return(o=e.validation)!=null&&o.connection_valid?"‚úÖ":"‚ùå"}}),null),r(a,h(gt,{label:"SQLËØ≠Ê≥ï",get status(){var o;return(o=e.validation)!=null&&o.sql_valid?"success":"error"},get icon(){var o;return(o=e.validation)!=null&&o.sql_valid?"‚úÖ":"‚ùå"}}),null),r(a,h(gt,{label:"ÂÆâÂÖ®Ê£ÄÊü•",get status(){var o;return(o=e.validation)!=null&&o.security_passed?"success":"warning"},get icon(){var o;return(o=e.validation)!=null&&o.security_passed?"‚úÖ":"‚ö†Ô∏è"}}),null),r(a,h(gt,{label:"ÊÄßËÉΩËØÑ‰º∞",get status(){var o;return(o=e.validation)!=null&&o.performance_acceptable?"success":"info"},get icon(){var o;return(o=e.validation)!=null&&o.performance_acceptable?"‚úÖ":"‚ÑπÔ∏è"}}),null),r(s,h(M,{get when(){return e.validation&&e.validation.warnings.length>0},get children(){var o=po();return o.firstChild,r(o,h(oe,{get each(){return e.validation.warnings||[]},children:g=>(()=>{var c=So();return r(c,g),c})()}),null),o}}),null),r(s,h(M,{get when(){return e.validation&&e.validation.errors.length>0},get children(){var o=yo();return o.firstChild,r(o,h(oe,{get each(){return e.validation.errors||[]},children:g=>(()=>{var c=wo();return r(c,g),c})()}),null),o}}),null),r(s,h(M,{get when(){return e.validation&&e.validation.suggestions&&e.validation.suggestions.length>0},get children(){var o=$o();return o.firstChild,r(o,h(oe,{get each(){return e.validation.suggestions||[]},children:g=>(()=>{var c=Co();return r(c,g),c})()}),null),o}}),null),s}}),null),A(()=>i.disabled=e.loading),t})()}function gt(e){return(()=>{var t=ko(),n=t.firstChild,l=n.nextSibling,i=l.nextSibling;return r(n,()=>e.icon),r(l,()=>e.label),r(i,()=>e.status==="success"?"ÈÄöËøá":e.status==="error"?"Â§±Ë¥•":e.status==="warning"?"Ë≠¶Âëä":"‰ø°ÊÅØ"),A(s=>{var a=`validation-check ${e.status}`,o=`check-status ${e.status}`;return a!==s.e&&_e(t,s.e=a),o!==s.t&&_e(i,s.t=o),s},{e:void 0,t:void 0}),t})()}function Go(e){return(()=>{var t=Lo(),n=t.firstChild,l=n.firstChild,i=l.nextSibling;return Te(i,"click",e.onPreviewData),r(i,()=>e.loading?"‚è≥ Âä†ËΩΩ‰∏≠...":"üëÅÔ∏è È¢ÑËßàÊï∞ÊçÆ"),r(t,h(M,{get when(){return e.preview},get children(){var s=Eo(),a=s.firstChild,o=a.firstChild,g=o.firstChild,c=g.nextSibling,b=o.nextSibling,u=b.firstChild,m=u.nextSibling,v=b.nextSibling,d=v.firstChild,p=d.nextSibling,_=p.firstChild,y=a.nextSibling;return r(c,()=>{var $;return(($=e.preview)==null?void 0:$.sample_data.length)||0}),r(m,()=>{var $;return(($=e.preview)==null?void 0:$.total_estimated_rows.toLocaleString())||"Êú™Áü•"}),r(p,()=>{var $;return(($=e.preview)==null?void 0:$.execution_stats.execution_time)||0},_),r(y,h(M,{get when(){return e.preview&&e.preview.sample_data.length>0},get children(){return h(Ko,{get data(){return e.preview.sample_data||[]}})}}),null),r(y,h(M,{get when(){return!e.preview||e.preview.sample_data.length===0},get children(){return To()}}),null),s}}),null),A(()=>i.disabled=e.loading),t})()}function Ko(e){if(!e.data||e.data.length===0)return Do();const t=Object.keys(e.data[0]);return(()=>{var n=Ao(),l=n.firstChild,i=l.firstChild,s=i.firstChild,a=i.nextSibling;return r(s,h(oe,{each:t,children:o=>(()=>{var g=zo();return r(g,o),g})()})),r(a,h(oe,{get each(){return e.data.slice(0,10)},children:o=>(()=>{var g=Ro();return r(g,h(oe,{each:t,children:c=>(()=>{var b=Mo();return r(b,()=>Zo(o[c])),b})()})),g})()})),r(n,h(M,{get when(){return e.data.length>10},get children(){var o=Po(),g=o.firstChild,c=g.nextSibling;return c.nextSibling,r(o,()=>e.data.length,c),o}}),null),n})()}function Yo(e){return(()=>{var t=Fo(),n=t.firstChild,l=n.firstChild,i=l.nextSibling;return Te(i,"click",e.onSave),r(i,()=>e.isSaving?"üíæ ‰øùÂ≠ò‰∏≠...":"üíæ ‰øùÂ≠òÊï∞ÊçÆÊ∫ê"),r(t,h(M,{get when(){return e.saveResult},get children(){var s=kn(),a=s.firstChild,o=a.firstChild,g=o.nextSibling;return r(o,()=>{var c;return(c=e.saveResult)!=null&&c.success?"‚úÖ":"‚ùå"}),r(g,()=>{var c;return(c=e.saveResult)==null?void 0:c.message}),r(s,h(M,{get when(){var c;return((c=e.saveResult)==null?void 0:c.success)&&e.saveResult.data_source_id},get children(){var c=No(),b=c.firstChild,u=b.firstChild,m=u.nextSibling;return r(m,()=>e.saveResult.data_source_id),c}}),null),r(s,h(M,{get when(){return e.saveResult&&e.saveResult.warnings&&e.saveResult.warnings.length>0},get children(){var c=Oo();return r(c,h(oe,{get each(){return e.saveResult.warnings||[]},children:b=>(()=>{var u=Bo();return u.firstChild,r(u,b,null),u})()})),c}}),null),r(s,h(M,{get when(){return e.saveResult&&e.saveResult.errors&&e.saveResult.errors.length>0},get children(){var c=Io();return r(c,h(oe,{get each(){return e.saveResult.errors||[]},children:b=>(()=>{var u=qo();return u.firstChild,r(u,b,null),u})()})),c}}),null),A(()=>{var c;return _e(s,`save-result ${(c=e.saveResult)!=null&&c.success?"success":"error"}`)}),s}}),null),r(t,h(M,{get when(){return!e.canSave},get children(){return Uo()}}),null),A(s=>{var a=`save-btn ${e.canSave?"primary":"disabled"}`,o=e.isSaving||!e.canSave;return a!==s.e&&_e(i,s.e=a),o!==s.t&&(i.disabled=s.t=o),s},{e:void 0,t:void 0}),t})()}function Xo(e){var t;return!!(e.name.trim().length>0&&e.customSQL.trim().length>0&&((t=e.testResult)!=null&&t.success)&&!e.isSaving)}function Zo(e){return e==null?"(null)":typeof e=="string"&&e.length>50?e.substring(0,47)+"...":String(e)}Pe(["click","input"]);var ec=f("<input type=text class=search-input placeholder=ÊêúÁ¥¢Êï∞ÊçÆÊ∫ê...>"),tc=f("<div class=add-buttons-group><button class=add-data-source-btn>üìÑ Êñá‰ª∂Êï∞ÊçÆÊ∫ê</button><button class=add-database-source-btn>üóÑÔ∏è Êï∞ÊçÆÂ∫ìÊï∞ÊçÆÊ∫ê"),nc=f("<div class=error-message>"),lc=f("<div class=loading-message>Âä†ËΩΩ‰∏≠..."),ic=f("<div class=empty-state><p></p><button>Ê∑ªÂä†Á¨¨‰∏Ä‰∏™Êï∞ÊçÆÊ∫ê"),sc=f("<div class=data-source-grid>"),rc=f("<div class=main-view><div class=sidebar><div class=sidebar-section><h3>ÂàÜÁ±ªÂØºËà™</h3><ul class=nav-list><li><button>üìÅ ÂÖ®ÈÉ®Êï∞ÊçÆÊ∫ê (<!>)</button></li></ul></div><div class=sidebar-section><h3>ÊåâÁä∂ÊÄÅÂàÜÁ±ª</h3><ul class=nav-list><li><button>üü¢ Ê¥ªË∑É‰ΩøÁî® (<!>)</button></li><li><button>üî¥ ËøûÊé•ÂºÇÂ∏∏ (<!>)</button></li><li><button>üü° Á©∫Èó≤Áä∂ÊÄÅ (<!>)</button></li></ul></div><div class=sidebar-section><h3>ÊåâÁ±ªÂûãÂàÜÁ±ª</h3><ul class=nav-list><li><button>üìã ÊâÄÊúâÁ±ªÂûã</button></li></ul></div></div><div class=main-content>"),ac=f("<div class=edit-view><div class=edit-header><button>‚Üê ËøîÂõû</button><h2>ÁºñËæëÊï∞ÊçÆÊ∫ê: </h2></div><p>ÁºñËæëÂäüËÉΩÂ∞ÜÂú®ÂêéÁª≠ÁâàÊú¨‰∏≠ÂÆåÂñÑ..."),oc=f("<div class=preview-view><div class=preview-header><button>‚Üê ËøîÂõû</button><h2>Êï∞ÊçÆÈ¢ÑËßà: </h2><div class=preview-info>ÂÖ± <!> Ë°åÊï∞ÊçÆÔºåÊòæÁ§∫Ââç <!> Ë°å</div></div><div class=preview-table-container><table class=preview-table><thead><tr></tr></thead><tbody>"),cc=f("<div class=data-source-management-center><div class=management-header><button class=back-to-designer-btn>‚Üê ËøîÂõûËÆæËÆ°Âô®</button><h1>Êï∞ÊçÆÊ∫êÁÆ°ÁêÜ‰∏≠ÂøÉ</h1><div class=header-actions></div></div><div class=management-content>"),dc=f("<li><button> <!> (<!>)"),uc=f("<th>"),gc=f("<tr>"),hc=f("<td>"),vc=f('<div class=data-source-card><div class=card-header><div class=card-title><span class=type-icon></span><h4></h4></div><div class=status-indicator></div></div><div class=card-meta><div class=meta-row><span class=meta-label>Á±ªÂûã:</span><span class=meta-value></span></div><div class=meta-row><span class=meta-label>Áä∂ÊÄÅ:</span><span class=meta-value></span></div><div class=meta-row><span class=meta-label>ÊúÄÂêéÊõ¥Êñ∞:</span><span class=meta-value></span></div></div><div class=card-actions><button class="action-btn preview-btn"title=È¢ÑËßàÊï∞ÊçÆ>üëÅÔ∏è È¢ÑËßà</button><button class="action-btn test-btn"title=ÊµãËØïËøûÊé•>üîå ÊµãËØï</button><button class="action-btn edit-btn"title=ÁºñËæëÈÖçÁΩÆ>‚úèÔ∏è ÁºñËæë</button><button class="action-btn delete-btn"title=Âà†Èô§Êï∞ÊçÆÊ∫ê>üóëÔ∏è Âà†Èô§');function fc(e){console.log("üèóÔ∏è  DataSourceManagementCenter ÁªÑ‰ª∂Ê∏≤ÊüìÔºåisOpen:",e.isOpen);const[t,n]=Z([]),[l,i]=Z([]),[s,a]=Z("main"),[o,g]=Z(null),[c,b]=Z(null),[u,m]=Z(!1),[v,d]=Z(null),[p,_]=Z(""),[y,$]=Z("all"),[C,k]=Z("all");Ue(async()=>{try{await E(),await D()}catch(N){console.error("üö® Êï∞ÊçÆÊ∫êÁÆ°ÁêÜ‰∏≠ÂøÉÂàùÂßãÂåñÂ§±Ë¥•:",N),d(`ÂàùÂßãÂåñÂ§±Ë¥•: ${N}`)}});const E=async()=>{try{m(!0),console.log("üîÑ Âä†ËΩΩÊï∞ÊçÆÊ∫êÂàóË°®...");const N=await we.listDataSources();console.log("‚úÖ Êï∞ÊçÆÊ∫êÂàóË°®Âä†ËΩΩÊàêÂäü:",N),n(N),d(null)}catch(N){console.error("‚ùå Âä†ËΩΩÊï∞ÊçÆÊ∫êÂ§±Ë¥•:",N),d(`Âä†ËΩΩÊï∞ÊçÆÊ∫êÂ§±Ë¥•: ${N}`)}finally{m(!1)}},D=async()=>{try{console.log("üîÑ Âä†ËΩΩÂèØÁî®Êï∞ÊçÆÊ∫êÁ±ªÂûã...");const N=await we.getAvailableTypes();console.log("‚úÖ Êï∞ÊçÆÊ∫êÁ±ªÂûãÂä†ËΩΩÊàêÂäü:",N),i(N)}catch(N){console.error("‚ùå Âä†ËΩΩÊï∞ÊçÆÊ∫êÁ±ªÂûãÂ§±Ë¥•:",N)}},L=()=>{let N=t();if(p()){const U=p().toLowerCase();N=N.filter(H=>(H.name||"").toLowerCase().includes(U)||(H.type_name||"").toLowerCase().includes(U))}return y()!=="all"&&(N=N.filter(U=>U.status===y())),C()!=="all"&&(N=N.filter(U=>U.type_name===C())),N},O=N=>t().filter(U=>U.status===N).length,K=N=>t().filter(U=>U.type_name===N).length,R=()=>{a("add"),g(null)},P=()=>{a("add-database"),g(null)},S=N=>{g(N),a("edit")},Q=async N=>{try{m(!0),d(null),g(N),console.log("üîÑ ÂºÄÂßãÈ¢ÑËßàÊï∞ÊçÆÊ∫ê:",N.name);const U=await we.getPreview(N.id);b(U),a("preview"),console.log("‚úÖ Êï∞ÊçÆÈ¢ÑËßàÂä†ËΩΩÊàêÂäü:",U)}catch(U){console.error("‚ùå Êï∞ÊçÆÈ¢ÑËßàÂ§±Ë¥•:",U),d(`È¢ÑËßàÊï∞ÊçÆÊ∫ê "${N.name}" Â§±Ë¥•: ${U}`)}finally{m(!1)}},B=async N=>{try{m(!0);const U=t().find(J=>J.id===N);if(!U){d(`Êï∞ÊçÆÊ∫ê‰∏çÂ≠òÂú®: ${N}`);return}const H=await we.testConnection(U.provider_type,U.config||{});alert(H?`‚úÖ Êï∞ÊçÆÊ∫ê "${U.name}" ËøûÊé•ÊµãËØïÊàêÂäüÔºÅ`:`‚ùå Êï∞ÊçÆÊ∫ê "${U.name}" ËøûÊé•ÊµãËØïÂ§±Ë¥•`)}catch(U){console.error("‚ùå ÊµãËØïËøûÊé•Â§±Ë¥•:",U);const H=t().find(J=>J.id===N);alert(`‚ùå Êï∞ÊçÆÊ∫ê "${(H==null?void 0:H.name)||N}" ËøûÊé•ÊµãËØïÂ§±Ë¥•:
${U}`)}finally{m(!1)}},w=async N=>{const U=t().find(H=>H.id===N);if(confirm(`Á°ÆÂÆöË¶ÅÂà†Èô§Êï∞ÊçÆÊ∫ê "${U==null?void 0:U.name}" ÂêóÔºü`))try{await we.deleteDataSource(N),await E()}catch(H){d(`Âà†Èô§Êï∞ÊçÆÊ∫êÂ§±Ë¥•: ${H}`)}},z=()=>{a("main"),g(null),b(null),d(null)};return h(M,{get when(){return e.isOpen},get children(){var N=cc(),U=N.firstChild,H=U.firstChild,J=H.nextSibling,me=J.nextSibling,X=U.nextSibling;return Te(H,"click",e.onClose),r(me,h(M,{get when(){return s()==="main"},get children(){return[(()=>{var j=ec();return j.$$input=se=>_(se.currentTarget.value),A(()=>j.value=p()),j})(),(()=>{var j=tc(),se=j.firstChild,ve=se.nextSibling;return se.$$click=R,ve.$$click=P,j})()]}})),r(X,h(M,{get when(){return s()==="main"},get children(){var j=rc(),se=j.firstChild,ve=se.firstChild,re=ve.firstChild,le=re.nextSibling,ee=le.firstChild,ne=ee.firstChild,de=ne.firstChild,Y=de.nextSibling;Y.nextSibling;var W=ve.nextSibling,he=W.firstChild,be=he.nextSibling,pe=be.firstChild,ue=pe.firstChild,fe=ue.firstChild,te=fe.nextSibling;te.nextSibling;var ce=pe.nextSibling,x=ce.firstChild,T=x.firstChild,F=T.nextSibling;F.nextSibling;var I=ce.nextSibling,V=I.firstChild,ie=V.firstChild,G=ie.nextSibling;G.nextSibling;var ye=W.nextSibling,ke=ye.firstChild,ae=ke.nextSibling,ze=ae.firstChild,Ae=ze.firstChild,Re=se.nextSibling;return ne.$$click=()=>$("all"),r(ne,()=>t().length,Y),ue.$$click=()=>$("active"),r(ue,()=>O("active"),te),x.$$click=()=>$("error"),r(x,()=>O("error"),F),V.$$click=()=>$("disabled"),r(V,()=>O("disabled"),G),Ae.$$click=()=>k("all"),r(ae,h(oe,{get each(){return l()},children:Se=>(()=>{var Ee=dc(),Fe=Ee.firstChild,nt=Fe.firstChild,lt=nt.nextSibling,ut=lt.nextSibling,Ft=ut.nextSibling;return Ft.nextSibling,Fe.$$click=()=>k(Se.type_name),r(Fe,()=>Se.category==="file"?"üìÑ":Se.category==="api"?"üåê":Se.category==="database"?"üóÑÔ∏è":"üìä",nt),r(Fe,()=>Se.display_name,lt),r(Fe,()=>K(Se.type_name),Ft),A(()=>_e(Ee,C()===Se.type_name?"active":"")),Ee})()}),null),r(Re,h(M,{get when(){return v()},get children(){var Se=nc();return r(Se,v),Se}}),null),r(Re,h(M,{get when(){return u()},get children(){return lc()}}),null),r(Re,h(M,{get when(){return xe(()=>!u())()&&L().length===0},get children(){var Se=ic(),Ee=Se.firstChild,Fe=Ee.nextSibling;return r(Ee,()=>p()||y()!=="all"||C()!=="all"?"Ê≤°ÊúâÊâæÂà∞ÂåπÈÖçÁöÑÊï∞ÊçÆÊ∫ê":"Â∞öÊú™ÈÖçÁΩÆ‰ªª‰ΩïÊï∞ÊçÆÊ∫ê"),Fe.$$click=R,Se}}),null),r(Re,h(M,{get when(){return xe(()=>!u())()&&L().length>0},get children(){var Se=sc();return r(Se,h(oe,{get each(){return L()},children:Ee=>h(mc,{source:Ee,onPreview:()=>Q(Ee),onTest:()=>B(Ee.id),onEdit:()=>S(Ee),onDelete:()=>w(Ee.id)})})),Se}}),null),A(Se=>{var Ee=y()==="all"?"active":"",Fe=y()==="active"?"active":"",nt=y()==="error"?"active":"",lt=y()==="disabled"?"active":"",ut=C()==="all"?"active":"";return Ee!==Se.e&&_e(ee,Se.e=Ee),Fe!==Se.t&&_e(pe,Se.t=Fe),nt!==Se.a&&_e(ce,Se.a=nt),lt!==Se.o&&_e(I,Se.o=lt),ut!==Se.i&&_e(ze,Se.i=ut),Se},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),j}}),null),r(X,h(M,{get when(){return s()==="add"},get children(){return h(Cn,{get availableTypes(){return l()},onBack:z,onSuccess:()=>{E(),z()}})}}),null),r(X,h(M,{get when(){return s()==="add-database"},get children(){return h(Ho,{onBack:z,onSuccess:()=>{E(),z()}})}}),null),r(X,h(M,{get when(){return xe(()=>s()==="edit")()&&o()},get children(){var j=ac(),se=j.firstChild,ve=se.firstChild,re=ve.nextSibling;return re.firstChild,ve.$$click=z,r(re,()=>{var le;return(le=o())==null?void 0:le.name},null),j}}),null),r(X,h(M,{get when(){return xe(()=>!!(s()==="preview"&&o()))()&&c()},get children(){var j=oc(),se=j.firstChild,ve=se.firstChild,re=ve.nextSibling;re.firstChild;var le=re.nextSibling,ee=le.firstChild,ne=ee.nextSibling,de=ne.nextSibling,Y=de.nextSibling;Y.nextSibling;var W=se.nextSibling,he=W.firstChild,be=he.firstChild,pe=be.firstChild,ue=be.nextSibling;return ve.$$click=z,r(re,()=>{var fe;return(fe=o())==null?void 0:fe.name},null),r(le,()=>{var fe;return(fe=c())==null?void 0:fe.total_rows},ne),r(le,()=>{var fe;return(fe=c())==null?void 0:fe.rows.length},Y),r(pe,h(oe,{get each(){var fe;return(fe=c())==null?void 0:fe.columns},children:fe=>(()=>{var te=uc();return r(te,fe),te})()})),r(ue,h(oe,{get each(){var fe;return(fe=c())==null?void 0:fe.rows.slice(0,50)},children:fe=>(()=>{var te=gc();return r(te,h(oe,{get each(){var ce;return((ce=c())==null?void 0:ce.columns)||[]},children:ce=>(()=>{var x=hc();return r(x,(()=>{var T=xe(()=>typeof fe[ce]=="object");return()=>T()?JSON.stringify(fe[ce]):String(fe[ce]||"")})()),x})()})),te})()})),j}}),null),N}})}function mc(e){const t=s=>{switch(s){case"active":return"#22c55e";case"error":return"#ef4444";case"disabled":return"#6b7280";default:return"#6b7280"}},n=s=>{switch(s){case"active":return"Â∑≤ËøûÊé•";case"error":return"ËøûÊé•ÂºÇÂ∏∏";case"disabled":return"Êú™ÂêØÁî®";default:return"Êú™Áü•"}},l=s=>{const a=new Date,o=new Date(s),g=a.getTime()-o.getTime(),c=Math.floor(g/(1e3*60*60));return c<1?"ÂàöÂàöÊõ¥Êñ∞":c<24?`${c}Â∞èÊó∂Ââç`:o.toLocaleDateString("zh-CN")},i=s=>{const a=(s||"").toLowerCase();return a.includes("json")?"üìÑ":a.includes("api")?"üåê":a.includes("csv")?"üìä":a.includes("database")?"üóÑÔ∏è":"üìã"};return(()=>{var s=vc(),a=s.firstChild,o=a.firstChild,g=o.firstChild,c=g.nextSibling,b=o.nextSibling,u=a.nextSibling,m=u.firstChild,v=m.firstChild,d=v.nextSibling,p=m.nextSibling,_=p.firstChild,y=_.nextSibling,$=p.nextSibling,C=$.firstChild,k=C.nextSibling,E=u.nextSibling,D=E.firstChild,L=D.nextSibling,O=L.nextSibling,K=O.nextSibling;return r(g,()=>i(e.source.type_name)),r(c,()=>e.source.name),r(d,()=>e.source.type_name),r(y,()=>n(e.source.status)),r(k,()=>l(e.source.last_updated)),Te(D,"click",e.onPreview),Te(L,"click",e.onTest),Te(O,"click",e.onEdit),Te(K,"click",e.onDelete),A(R=>{var P=t(e.source.status),S=`Áä∂ÊÄÅ: ${n(e.source.status)}`,Q=e.source.status!=="active";return P!==R.e&&((R.e=P)!=null?b.style.setProperty("background-color",P):b.style.removeProperty("background-color")),S!==R.t&&q(b,"title",R.t=S),Q!==R.a&&(D.disabled=R.a=Q),R},{e:void 0,t:void 0,a:void 0}),s})()}Pe(["click","input"]);var bc=f('<div class="h-full flex flex-col bg-secondary"><div class="flex-1 flex overflow-hidden"><div class="w-80 bg-primary border-r border-default flex flex-col"></div><div class="flex-1 flex flex-col bg-tertiary"></div><div class="w-80 bg-primary border-l border-default flex flex-col"><div class="flex-1 overflow-y-auto custom-scrollbar"><div class=min-h-fit></div><div class="border-t border-default min-h-fit">');const pc=()=>{const[e,t]=Z(!1),[n,l]=Z(!1);console.log("üñ•Ô∏è  MainLayoutÊ∏≤ÊüìÔºåÁÆ°ÁêÜ‰∏≠ÂøÉÁä∂ÊÄÅ:",n());const i=()=>{console.log("üîÑ Êï∞ÊçÆÊ∫êÊåâÈíÆË¢´ÁÇπÂáªÔºåÂáÜÂ§áÊâìÂºÄÁÆ°ÁêÜ‰∏≠ÂøÉ"),console.log("üìä ÂΩìÂâçÁÆ°ÁêÜ‰∏≠ÂøÉÁä∂ÊÄÅ:",n()),l(!0),console.log("‚úÖ ÁÆ°ÁêÜ‰∏≠ÂøÉÁä∂ÊÄÅÂ∑≤ËÆæÁΩÆ‰∏∫ true"),console.log("üìä ËÆæÁΩÆÂêéÁöÑÁÆ°ÁêÜ‰∏≠ÂøÉÁä∂ÊÄÅ:",n())},s=()=>t(!1),a=()=>l(!1);return h(Gn,{get children(){var o=bc(),g=o.firstChild,c=g.firstChild,b=c.nextSibling,u=b.nextSibling,m=u.firstChild,v=m.firstChild,d=v.nextSibling;return r(o,h(vl,{onOpenDataSources:i}),g),r(c,h(bl,{})),r(b,h(fs,{})),r(v,h(Si,{})),r(d,h(ca,{})),r(o,h(fc,{get isOpen(){return n()},onClose:a}),null),r(o,h(Qr,{get isOpen(){return e()},onClose:s}),null),o}})},yc={copy:{action:"copy",combination:{key:"c",ctrl:!0}},paste:{action:"paste",combination:{key:"v",ctrl:!0}},cut:{action:"cut",combination:{key:"x",ctrl:!0}},delete:{action:"delete",combination:{key:"Delete"}},deleteAlt:{action:"delete",combination:{key:"Backspace"}},undo:{action:"undo",combination:{key:"z",ctrl:!0}},redo:{action:"redo",combination:{key:"y",ctrl:!0}},redoAlt:{action:"redo",combination:{key:"z",ctrl:!0,shift:!0}},selectAll:{action:"selectAll",combination:{key:"a",ctrl:!0}},clearSelection:{action:"clearSelection",combination:{key:"Escape"}},duplicate:{action:"duplicate",combination:{key:"d",ctrl:!0}},moveUp:{action:"moveUp",combination:{key:"ArrowUp"}},moveDown:{action:"moveDown",combination:{key:"ArrowDown"}},moveLeft:{action:"moveLeft",combination:{key:"ArrowLeft"}},moveRight:{action:"moveRight",combination:{key:"ArrowRight"}},moveFastUp:{action:"moveFastUp",combination:{key:"ArrowUp",shift:!0}},moveFastDown:{action:"moveFastDown",combination:{key:"ArrowDown",shift:!0}},moveFastLeft:{action:"moveFastLeft",combination:{key:"ArrowLeft",shift:!0}},moveFastRight:{action:"moveFastRight",combination:{key:"ArrowRight",shift:!0}}},$c=()=>{const{state:e,copySelectedElements:t,pasteElements:n,deleteElements:l,undo:i,redo:s,selectAllElements:a,clearSelection:o,moveElements:g}=Ve(),c=(d,p)=>{const _=d.key.toLowerCase()===p.key.toLowerCase()||d.key===p.key,y=!!p.ctrl===(d.ctrlKey||d.metaKey),$=!!p.alt===d.altKey,C=!!p.shift===d.shiftKey;return _&&y&&$&&C},b=async d=>{console.log("üéØ ÊâßË°åÂø´Êç∑ÈîÆ:",d);try{switch(d){case"copy":e.selected_ids.length>0&&(await t(),m("Â§çÂà∂ÊàêÂäü","‚úÖ"));break;case"paste":const p={x:20,y:20},_=await n(p.x,p.y);_.length>0&&m(`Á≤òË¥¥ ${_.length} ‰∏™ÂÖÉÁ¥†`,"üìã");break;case"cut":e.selected_ids.length>0&&(await t(),await l([...e.selected_ids]),m("Ââ™ÂàáÊàêÂäü","‚úÇÔ∏è"));break;case"delete":if(e.selected_ids.length>0){const y=e.selected_ids.length;await l([...e.selected_ids]),m(`Âà†Èô§ ${y} ‰∏™ÂÖÉÁ¥†`,"üóëÔ∏è")}break;case"undo":await i(),m("Êí§ÈîÄ","‚Ü∂");break;case"redo":await s(),m("ÈáçÂÅö","‚Ü∑");break;case"selectAll":await a(),m(`ÂÖ®ÈÄâ ${e.elements.length} ‰∏™ÂÖÉÁ¥†`,"üéØ");break;case"clearSelection":e.selected_ids.length>0&&(o(),m("Ê∏ÖÈô§ÈÄâÊã©","‚≠ï"));break;case"duplicate":if(e.selected_ids.length>0){await t();const y=await n(20,20);m(`Â§çÂà∂ ${y.length} ‰∏™ÂÖÉÁ¥†`,"üìÑ")}break;case"moveUp":case"moveDown":case"moveLeft":case"moveRight":case"moveFastUp":case"moveFastDown":case"moveFastLeft":case"moveFastRight":await u(d);break;default:console.warn("Êú™Áü•ÁöÑÂø´Êç∑ÈîÆÂä®‰Ωú:",d)}}catch(p){console.error("Âø´Êç∑ÈîÆÊâßË°åÂ§±Ë¥•:",p),m("Êìç‰ΩúÂ§±Ë¥•","‚ùå")}},u=async d=>{if(e.selected_ids.length===0)return;const p=d.includes("Fast"),_=p?10:1;let y=0,$=0;switch(d){case"moveUp":case"moveFastUp":$=-_;break;case"moveDown":case"moveFastDown":$=_;break;case"moveLeft":case"moveFastLeft":y=-_;break;case"moveRight":case"moveFastRight":y=_;break}(y!==0||$!==0)&&(await g([...e.selected_ids],y,$),p&&m(`Âø´ÈÄüÁßªÂä® ${_}px`,"üîÑ"))},m=(d,p)=>{const _=document.createElement("div");_.className="keyboard-feedback",_.innerHTML=`
      <div class="feedback-content">
        <span class="feedback-icon">${p}</span>
        <span class="feedback-text">${d}</span>
      </div>
    `,document.body.appendChild(_),setTimeout(()=>{_.parentNode&&_.parentNode.removeChild(_)},2e3)},v=d=>{const p=d.target;if(!(p.tagName==="INPUT"||p.tagName==="TEXTAREA"||p.contentEditable==="true")){for(const[y,$]of Object.entries(yc))if(c(d,$.combination)){d.preventDefault(),d.stopPropagation(),console.log("üéπ Âø´Êç∑ÈîÆËß¶Âèë:",y,$.action),b($.action);return}}};return Ue(()=>{if(document.addEventListener("keydown",v,!0),console.log("üéπ ÈîÆÁõòÂø´Êç∑ÈîÆÁÆ°ÁêÜÂô®Â∑≤ÂêØÂä®"),!document.getElementById("keyboard-feedback-styles")){const d=document.createElement("style");d.id="keyboard-feedback-styles",d.textContent=`
        .keyboard-feedback {
          position: fixed;
          top: 20px;
          right: 20px;
          background: rgba(0, 0, 0, 0.8);
          color: white;
          padding: 12px 16px;
          border-radius: 8px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
          z-index: 10000;
          animation: slideInRight 0.3s ease-out, fadeOut 0.3s ease-out 1.7s;
          pointer-events: none;
        }

        .feedback-content {
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .feedback-icon {
          font-size: 16px;
        }

        .feedback-text {
          font-size: 14px;
          font-weight: 500;
        }

        @keyframes slideInRight {
          from {
            transform: translateX(100%);
            opacity: 0;
          }
          to {
            transform: translateX(0);
            opacity: 1;
          }
        }

        @keyframes fadeOut {
          from {
            opacity: 1;
          }
          to {
            opacity: 0;
          }
        }
      `,document.head.appendChild(d)}}),wt(()=>{document.removeEventListener("keydown",v,!0),console.log("üéπ ÈîÆÁõòÂø´Êç∑ÈîÆÁÆ°ÁêÜÂô®Â∑≤ÂÅúÊ≠¢")}),null},_c=()=>(Ue(()=>{document.addEventListener("contextmenu",e=>e.preventDefault())}),h(ll,{get children(){return[h($c,{}),h(pc,{})]}})),xc=document.getElementById("root");qn(()=>h(_c,{}),xc);
