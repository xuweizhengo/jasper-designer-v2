(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))l(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function o(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function l(i){if(i.ep)return;i.ep=!0;const n=o(i);fetch(i.href,n)}})();const Wt=!1,Zt=(e,t)=>e===t,Ae=Symbol("solid-proxy"),st=Symbol("solid-track"),Ye={equals:Zt};let _t=Et;const ke=1,Xe=2,$t={owned:null,cleanups:null,context:null,owner:null};var Z=null;let ot=null,Jt=null,ne=null,oe=null,be=null,lt=0;function qe(e,t){const o=ne,l=Z,i=e.length===0,n=t===void 0?l:t,r=i?$t:{owned:null,cleanups:null,context:n?n.context:null,owner:n},s=i?e:()=>e(()=>ce(()=>Ne(r)));Z=r,ne=null;try{return De(s,!0)}finally{ne=o,Z=l}}function J(e,t){t=t?Object.assign({},Ye,t):Ye;const o={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},l=i=>(typeof i=="function"&&(i=i(o.value)),Ct(o,i));return[St.bind(o),l]}function A(e,t,o){const l=ht(e,t,!1,ke);Ge(l)}function Qt(e,t,o){_t=rn;const l=ht(e,t,!1,ke);l.user=!0,be?be.push(l):Ge(l)}function ie(e,t,o){o=o?Object.assign({},Ye,o):Ye;const l=ht(e,t,!0,0);return l.observers=null,l.observerSlots=null,l.comparator=o.equals||void 0,Ge(l),St.bind(l)}function en(e){return De(e,!1)}function ce(e){if(ne===null)return e();const t=ne;ne=null;try{return e()}finally{ne=t}}function He(e){Qt(()=>ce(e))}function it(e){return Z===null||(Z.cleanups===null?Z.cleanups=[e]:Z.cleanups.push(e)),e}function at(){return ne}function tn(e,t){const o=Symbol("context");return{id:o,Provider:an(o),defaultValue:e}}function nn(e){let t;return Z&&Z.context&&(t=Z.context[e.id])!==void 0?t:e.defaultValue}function kt(e){const t=ie(e),o=ie(()=>ct(t()));return o.toArray=()=>{const l=o();return Array.isArray(l)?l:l!=null?[l]:[]},o}function St(){if(this.sources&&this.state)if(this.state===ke)Ge(this);else{const e=oe;oe=null,De(()=>Ze(this),!1),oe=e}if(ne){const e=this.observers?this.observers.length:0;ne.sources?(ne.sources.push(this),ne.sourceSlots.push(e)):(ne.sources=[this],ne.sourceSlots=[e]),this.observers?(this.observers.push(ne),this.observerSlots.push(ne.sources.length-1)):(this.observers=[ne],this.observerSlots=[ne.sources.length-1])}return this.value}function Ct(e,t,o){let l=e.value;return(!e.comparator||!e.comparator(l,t))&&(e.value=t,e.observers&&e.observers.length&&De(()=>{for(let i=0;i<e.observers.length;i+=1){const n=e.observers[i],r=ot&&ot.running;r&&ot.disposed.has(n),(r?!n.tState:!n.state)&&(n.pure?oe.push(n):be.push(n),n.observers&&zt(n)),r||(n.state=ke)}if(oe.length>1e6)throw oe=[],new Error},!1)),t}function Ge(e){if(!e.fn)return;Ne(e);const t=lt;ln(e,e.value,t)}function ln(e,t,o){let l;const i=Z,n=ne;ne=Z=e;try{l=e.fn(t)}catch(r){return e.pure&&(e.state=ke,e.owned&&e.owned.forEach(Ne),e.owned=null),e.updatedAt=o+1,Pt(r)}finally{ne=n,Z=i}(!e.updatedAt||e.updatedAt<=o)&&(e.updatedAt!=null&&"observers"in e?Ct(e,l):e.value=l,e.updatedAt=o)}function ht(e,t,o,l=ke,i){const n={fn:e,state:l,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:Z,context:Z?Z.context:null,pure:o};return Z===null||Z!==$t&&(Z.owned?Z.owned.push(n):Z.owned=[n]),n}function We(e){if(e.state===0)return;if(e.state===Xe)return Ze(e);if(e.suspense&&ce(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<lt);)e.state&&t.push(e);for(let o=t.length-1;o>=0;o--)if(e=t[o],e.state===ke)Ge(e);else if(e.state===Xe){const l=oe;oe=null,De(()=>Ze(e,t[0]),!1),oe=l}}function De(e,t){if(oe)return e();let o=!1;t||(oe=[]),be?o=!0:be=[],lt++;try{const l=e();return on(o),l}catch(l){o||(be=null),oe=null,Pt(l)}}function on(e){if(oe&&(Et(oe),oe=null),e)return;const t=be;be=null,t.length&&De(()=>_t(t),!1)}function Et(e){for(let t=0;t<e.length;t++)We(e[t])}function rn(e){let t,o=0;for(t=0;t<e.length;t++){const l=e[t];l.user?e[o++]=l:We(l)}for(t=0;t<o;t++)We(e[t])}function Ze(e,t){e.state=0;for(let o=0;o<e.sources.length;o+=1){const l=e.sources[o];if(l.sources){const i=l.state;i===ke?l!==t&&(!l.updatedAt||l.updatedAt<lt)&&We(l):i===Xe&&Ze(l,t)}}}function zt(e){for(let t=0;t<e.observers.length;t+=1){const o=e.observers[t];o.state||(o.state=Xe,o.pure?oe.push(o):be.push(o),o.observers&&zt(o))}}function Ne(e){let t;if(e.sources)for(;e.sources.length;){const o=e.sources.pop(),l=e.sourceSlots.pop(),i=o.observers;if(i&&i.length){const n=i.pop(),r=o.observerSlots.pop();l<i.length&&(n.sourceSlots[r]=l,i[l]=n,o.observerSlots[l]=r)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)Ne(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)Ne(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function sn(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function Pt(e,t=Z){throw sn(e)}function ct(e){if(typeof e=="function"&&!e.length)return ct(e());if(Array.isArray(e)){const t=[];for(let o=0;o<e.length;o++){const l=ct(e[o]);Array.isArray(l)?t.push.apply(t,l):t.push(l)}return t}return e}function an(e,t){return function(l){let i;return A(()=>i=ce(()=>(Z.context={...Z.context,[e]:l.value},kt(()=>l.children))),void 0),i}}const cn=Symbol("fallback");function vt(e){for(let t=0;t<e.length;t++)e[t]()}function dn(e,t,o={}){let l=[],i=[],n=[],r=0,s=t.length>1?[]:null;return it(()=>vt(n)),()=>{let d=e()||[],a=d.length,v,h;return d[st],ce(()=>{let R,S,z,T,V,F,C,O,B;if(a===0)r!==0&&(vt(n),n=[],l=[],i=[],r=0,s&&(s=[])),o.fallback&&(l=[cn],i[0]=qe(I=>(n[0]=I,o.fallback())),r=1);else if(r===0){for(i=new Array(a),h=0;h<a;h++)l[h]=d[h],i[h]=qe(w);r=a}else{for(z=new Array(a),T=new Array(a),s&&(V=new Array(a)),F=0,C=Math.min(r,a);F<C&&l[F]===d[F];F++);for(C=r-1,O=a-1;C>=F&&O>=F&&l[C]===d[O];C--,O--)z[O]=i[C],T[O]=n[C],s&&(V[O]=s[C]);for(R=new Map,S=new Array(O+1),h=O;h>=F;h--)B=d[h],v=R.get(B),S[h]=v===void 0?-1:v,R.set(B,h);for(v=F;v<=C;v++)B=l[v],h=R.get(B),h!==void 0&&h!==-1?(z[h]=i[v],T[h]=n[v],s&&(V[h]=s[v]),h=S[h],R.set(B,h)):n[v]();for(h=F;h<a;h++)h in z?(i[h]=z[h],n[h]=T[h],s&&(s[h]=V[h],s[h](h))):i[h]=qe(w);i=i.slice(0,r=a),l=d.slice(0)}return i});function w(R){if(n[h]=R,s){const[S,z]=J(h);return s[h]=z,t(d[h],S)}return t(d[h])}}}function y(e,t){return ce(()=>e(t||{}))}const At=e=>`Stale read from <${e}>.`;function ze(e){const t="fallback"in e&&{fallback:()=>e.fallback};return ie(dn(()=>e.each,e.children,t||void 0))}function xe(e){const t=e.keyed,o=ie(()=>e.when,void 0,void 0),l=t?o:ie(o,void 0,{equals:(i,n)=>!i==!n});return ie(()=>{const i=l();if(i){const n=e.children;return typeof n=="function"&&n.length>0?ce(()=>n(t?i:()=>{if(!ce(l))throw At("Show");return o()})):n}return e.fallback},void 0,void 0)}function un(e){const t=kt(()=>e.children),o=ie(()=>{const l=t(),i=Array.isArray(l)?l:[l];let n=()=>{};for(let r=0;r<i.length;r++){const s=r,d=i[r],a=n,v=ie(()=>a()?void 0:d.when,void 0,void 0),h=d.keyed?v:ie(v,void 0,{equals:(w,R)=>!w==!R});n=()=>a()||(h()?[s,v,d]:void 0)}return n});return ie(()=>{const l=o()();if(!l)return e.fallback;const[i,n,r]=l,s=r.children;return typeof s=="function"&&s.length>0?ce(()=>s(r.keyed?n():()=>{var a;if(((a=ce(o)())==null?void 0:a[0])!==i)throw At("Match");return n()})):s},void 0,void 0)}function Re(e){return e}const ue=e=>ie(()=>e());function fn(e,t,o){let l=o.length,i=t.length,n=l,r=0,s=0,d=t[i-1].nextSibling,a=null;for(;r<i||s<n;){if(t[r]===o[s]){r++,s++;continue}for(;t[i-1]===o[n-1];)i--,n--;if(i===r){const v=n<l?s?o[s-1].nextSibling:o[n-s]:d;for(;s<n;)e.insertBefore(o[s++],v)}else if(n===s)for(;r<i;)(!a||!a.has(t[r]))&&t[r].remove(),r++;else if(t[r]===o[n-1]&&o[s]===t[i-1]){const v=t[--i].nextSibling;e.insertBefore(o[s++],t[r++].nextSibling),e.insertBefore(o[--n],v),t[i]=o[n]}else{if(!a){a=new Map;let h=s;for(;h<n;)a.set(o[h],h++)}const v=a.get(t[r]);if(v!=null)if(s<v&&v<n){let h=r,w=1,R;for(;++h<i&&h<n&&!((R=a.get(t[h]))==null||R!==v+w);)w++;if(w>v-s){const S=t[r];for(;s<v;)e.insertBefore(o[s++],S)}else e.replaceChild(o[s++],t[r++])}else r++;else t[r++].remove()}}}const yt="_$DX_DELEGATE";function hn(e,t,o,l={}){let i;return qe(n=>{i=n,t===document?e():f(t,e(),t.firstChild?null:void 0,o)},l.owner),()=>{i(),t.textContent=""}}function k(e,t,o,l){let i;const n=()=>{const s=l?document.createElementNS("http://www.w3.org/1998/Math/MathML","template"):document.createElement("template");return s.innerHTML=e,o?s.content.firstChild.firstChild:l?s.firstChild:s.content.firstChild},r=t?()=>ce(()=>document.importNode(i||(i=n()),!0)):()=>(i||(i=n())).cloneNode(!0);return r.cloneNode=r,r}function Se(e,t=window.document){const o=t[yt]||(t[yt]=new Set);for(let l=0,i=e.length;l<i;l++){const n=e[l];o.has(n)||(o.add(n),t.addEventListener(n,vn))}}function $(e,t,o){o==null?e.removeAttribute(t):e.setAttribute(t,o)}function Ue(e,t){t==null?e.removeAttribute("class"):e.className=t}function dt(e,t,o,l){Array.isArray(o)?(e[`$$${t}`]=o[0],e[`$$${t}Data`]=o[1]):e[`$$${t}`]=o}function gn(e,t,o){if(!t)return o?$(e,"style"):t;const l=e.style;if(typeof t=="string")return l.cssText=t;typeof o=="string"&&(l.cssText=o=void 0),o||(o={}),t||(t={});let i,n;for(n in o)t[n]==null&&l.removeProperty(n),delete o[n];for(n in t)i=t[n],i!==o[n]&&(l.setProperty(n,i),o[n]=i);return o}function It(e,t,o){return ce(()=>e(t,o))}function f(e,t,o,l){if(o!==void 0&&!l&&(l=[]),typeof t!="function")return Je(e,t,l,o);A(i=>Je(e,t(),i,o),l)}function vn(e){let t=e.target;const o=`$$${e.type}`,l=e.target,i=e.currentTarget,n=d=>Object.defineProperty(e,"target",{configurable:!0,value:d}),r=()=>{const d=t[o];if(d&&!t.disabled){const a=t[`${o}Data`];if(a!==void 0?d.call(t,a,e):d.call(t,e),e.cancelBubble)return}return t.host&&typeof t.host!="string"&&!t.host._$host&&t.contains(e.target)&&n(t.host),!0},s=()=>{for(;r()&&(t=t._$host||t.parentNode||t.host););};if(Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return t||document}}),e.composedPath){const d=e.composedPath();n(d[0]);for(let a=0;a<d.length-2&&(t=d[a],!!r());a++){if(t._$host){t=t._$host,s();break}if(t.parentNode===i)break}}else s();n(l)}function Je(e,t,o,l,i){for(;typeof o=="function";)o=o();if(t===o)return o;const n=typeof t,r=l!==void 0;if(e=r&&o[0]&&o[0].parentNode||e,n==="string"||n==="number"){if(n==="number"&&(t=t.toString(),t===o))return o;if(r){let s=o[0];s&&s.nodeType===3?s.data!==t&&(s.data=t):s=document.createTextNode(t),o=Ie(e,o,l,s)}else o!==""&&typeof o=="string"?o=e.firstChild.data=t:o=e.textContent=t}else if(t==null||n==="boolean")o=Ie(e,o,l);else{if(n==="function")return A(()=>{let s=t();for(;typeof s=="function";)s=s();o=Je(e,s,o,l)}),()=>o;if(Array.isArray(t)){const s=[],d=o&&Array.isArray(o);if(ut(s,t,o,i))return A(()=>o=Je(e,s,o,l,!0)),()=>o;if(s.length===0){if(o=Ie(e,o,l),r)return o}else d?o.length===0?mt(e,s,l):fn(e,o,s):(o&&Ie(e),mt(e,s));o=s}else if(t.nodeType){if(Array.isArray(o)){if(r)return o=Ie(e,o,l,t);Ie(e,o,null,t)}else o==null||o===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);o=t}}return o}function ut(e,t,o,l){let i=!1;for(let n=0,r=t.length;n<r;n++){let s=t[n],d=o&&o[e.length],a;if(!(s==null||s===!0||s===!1))if((a=typeof s)=="object"&&s.nodeType)e.push(s);else if(Array.isArray(s))i=ut(e,s,d)||i;else if(a==="function")if(l){for(;typeof s=="function";)s=s();i=ut(e,Array.isArray(s)?s:[s],Array.isArray(d)?d:[d])||i}else e.push(s),i=!0;else{const v=String(s);d&&d.nodeType===3&&d.data===v?e.push(d):e.push(document.createTextNode(v))}}return i}function mt(e,t,o=null){for(let l=0,i=t.length;l<i;l++)e.insertBefore(t[l],o)}function Ie(e,t,o,l){if(o===void 0)return e.textContent="";const i=l||document.createTextNode("");if(t.length){let n=!1;for(let r=t.length-1;r>=0;r--){const s=t[r];if(i!==s){const d=s.parentNode===e;!n&&!r?d?e.replaceChild(i,s):e.insertBefore(i,o):d&&s.remove()}else n=!0}}else e.insertBefore(i,o);return[i]}const ft=Symbol("store-raw"),Le=Symbol("store-node"),ye=Symbol("store-has"),Ut=Symbol("store-self");function Lt(e){let t=e[Ae];if(!t&&(Object.defineProperty(e,Ae,{value:t=new Proxy(e,bn)}),!Array.isArray(e))){const o=Object.keys(e),l=Object.getOwnPropertyDescriptors(e);for(let i=0,n=o.length;i<n;i++){const r=o[i];l[r].get&&Object.defineProperty(e,r,{enumerable:l[r].enumerable,get:l[r].get.bind(t)})}}return t}function Qe(e){let t;return e!=null&&typeof e=="object"&&(e[Ae]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function je(e,t=new Set){let o,l,i,n;if(o=e!=null&&e[ft])return o;if(!Qe(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let r=0,s=e.length;r<s;r++)i=e[r],(l=je(i,t))!==i&&(e[r]=l)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const r=Object.keys(e),s=Object.getOwnPropertyDescriptors(e);for(let d=0,a=r.length;d<a;d++)n=r[d],!s[n].get&&(i=e[n],(l=je(i,t))!==i&&(e[n]=l))}return e}function et(e,t){let o=e[t];return o||Object.defineProperty(e,t,{value:o=Object.create(null)}),o}function Be(e,t,o){if(e[t])return e[t];const[l,i]=J(o,{equals:!1,internal:!0});return l.$=i,e[t]=l}function yn(e,t){const o=Reflect.getOwnPropertyDescriptor(e,t);return!o||o.get||!o.configurable||t===Ae||t===Le||(delete o.value,delete o.writable,o.get=()=>e[Ae][t]),o}function Dt(e){at()&&Be(et(e,Le),Ut)()}function mn(e){return Dt(e),Reflect.ownKeys(e)}const bn={get(e,t,o){if(t===ft)return e;if(t===Ae)return o;if(t===st)return Dt(e),o;const l=et(e,Le),i=l[t];let n=i?i():e[t];if(t===Le||t===ye||t==="__proto__")return n;if(!i){const r=Object.getOwnPropertyDescriptor(e,t);at()&&(typeof n!="function"||e.hasOwnProperty(t))&&!(r&&r.get)&&(n=Be(l,t,n)())}return Qe(n)?Lt(n):n},has(e,t){return t===ft||t===Ae||t===st||t===Le||t===ye||t==="__proto__"?!0:(at()&&Be(et(e,ye),t)(),t in e)},set(){return!0},deleteProperty(){return!0},ownKeys:mn,getOwnPropertyDescriptor:yn};function tt(e,t,o,l=!1){if(!l&&e[t]===o)return;const i=e[t],n=e.length;o===void 0?(delete e[t],e[ye]&&e[ye][t]&&i!==void 0&&e[ye][t].$()):(e[t]=o,e[ye]&&e[ye][t]&&i===void 0&&e[ye][t].$());let r=et(e,Le),s;if((s=Be(r,t,i))&&s.$(()=>o),Array.isArray(e)&&e.length!==n){for(let d=e.length;d<n;d++)(s=r[d])&&s.$();(s=Be(r,"length",n))&&s.$(e.length)}(s=r[Ut])&&s.$()}function Mt(e,t){const o=Object.keys(t);for(let l=0;l<o.length;l+=1){const i=o[l];tt(e,i,t[i])}}function xn(e,t){if(typeof t=="function"&&(t=t(e)),t=je(t),Array.isArray(t)){if(e===t)return;let o=0,l=t.length;for(;o<l;o++){const i=t[o];e[o]!==i&&tt(e,o,i)}tt(e,"length",l)}else Mt(e,t)}function Oe(e,t,o=[]){let l,i=e;if(t.length>1){l=t.shift();const r=typeof l,s=Array.isArray(e);if(Array.isArray(l)){for(let d=0;d<l.length;d++)Oe(e,[l[d]].concat(t),o);return}else if(s&&r==="function"){for(let d=0;d<e.length;d++)l(e[d],d)&&Oe(e,[d].concat(t),o);return}else if(s&&r==="object"){const{from:d=0,to:a=e.length-1,by:v=1}=l;for(let h=d;h<=a;h+=v)Oe(e,[h].concat(t),o);return}else if(t.length>1){Oe(e[l],t,[l].concat(o));return}i=e[l],o=[l].concat(o)}let n=t[0];typeof n=="function"&&(n=n(i,o),n===i)||l===void 0&&n==null||(n=je(n),l===void 0||Qe(i)&&Qe(n)&&!Array.isArray(n)?Mt(i,n):tt(e,l,n))}function pn(...[e,t]){const o=je(e||{}),l=Array.isArray(o),i=Lt(o);function n(...r){en(()=>{l&&r.length===1?xn(o,r[0]):Oe(o,r)})}return[i,n]}function wn(){return window.crypto.getRandomValues(new Uint32Array(1))[0]}function bt(e,t=!1){const o=wn(),l=`_${o}`;return Object.defineProperty(window,l,{value:i=>(t&&Reflect.deleteProperty(window,l),e==null?void 0:e(i)),writable:!1,configurable:!0}),o}async function le(e,t={}){return new Promise((o,l)=>{const i=bt(r=>{o(r),Reflect.deleteProperty(window,`_${n}`)},!0),n=bt(r=>{l(r),Reflect.deleteProperty(window,`_${i}`)},!0);window.__TAURI_IPC__({cmd:e,callback:i,error:n,...t})})}const Tt=tn(),_n=e=>{const[t,o]=pn({elements:[],selected_ids:[],canvas_config:{width:595,height:842,zoom:1,offset_x:0,offset_y:0,show_grid:!0,show_rulers:!0,grid_size:10,snap_to_grid:!0,background_color:"#ffffff"},can_undo:!1,can_redo:!1,dirty:!1}),[l,i]=J(!1),[n,r]=J(null),[s,d]=J(!1),a=async()=>{try{i(!0),console.log("🔄 Loading app state...");const g=await le("get_app_state");console.log("🔄 App state loaded, selected_ids:",g.selected_ids),o(g)}catch(g){console.error("Failed to load app state:",g)}finally{i(!1)}};He(()=>{a()});const v=async(g,p,E,U={})=>{try{i(!0);const L=await le("create_element",{request:{element_type:g,position:p,size:E,content_data:U}});return await a(),L}catch(L){throw console.error("Failed to create element:",L),L}finally{i(!1)}},h=async(g,p)=>{try{i(!0),await le("update_element",{request:{id:g,updates:p}}),await a()}catch(E){throw console.error("Failed to update element:",E),E}finally{i(!1)}},w=async g=>{try{i(!0),await le("batch_update_positions",{request:{updates:g}}),o(p=>{const E=p.elements.map(U=>{const L=g.find(X=>X.element_id===U.id);return L?{...U,position:L.new_position}:U});return{...p,elements:E,dirty:!0}}),console.log("🚀 Optimized batch position update completed without full reload")}catch(p){throw console.error("Failed to batch update positions:",p),await a(),p}finally{i(!1)}},R=async g=>{try{i(!0),await le("delete_element",{elementId:g}),await a()}catch(p){throw console.error("Failed to delete element:",p),p}finally{i(!1)}},S=async g=>{try{console.log("Selecting element:",g),await le("select_element",{elementId:g}),console.log("Select command completed, reloading state..."),await a(),console.log("State reloaded, selected_ids:",t.selected_ids)}catch(p){throw console.error("Failed to select element:",p),p}},z=async g=>{try{console.log("Selecting multiple elements:",g),g.length>0?(await le("select_multiple",{elementIds:g}),console.log("✅ Multi-select completed for:",g.length,"elements")):await le("clear_selection"),await a()}catch(p){throw console.error("Failed to select multiple elements:",p),p}},T=async g=>{try{console.log("Adding to selection:",g),await le("add_to_selection",{elementId:g}),await a()}catch(p){throw console.error("Failed to add to selection:",p),p}},V=async g=>{try{console.log("Removing from selection:",g),await le("remove_from_selection",{elementId:g}),await a()}catch(p){throw console.error("Failed to remove from selection:",p),p}},F=async g=>{try{console.log("Toggling selection:",g),await le("toggle_selection",{elementId:g}),await a()}catch(p){throw console.error("Failed to toggle selection:",p),p}},C=async()=>{try{await le("clear_selection"),await a()}catch(g){throw console.error("Failed to clear selection:",g),g}},O=async()=>{try{await le("copy_selected")}catch(g){throw console.error("Failed to copy selected elements:",g),g}},K={state:t,createElement:v,updateElement:h,batchUpdatePositions:w,deleteElement:R,selectElement:S,selectMultiple:z,addToSelection:T,removeFromSelection:V,toggleSelection:F,clearSelection:C,copySelected:O,copySelectedElements:async()=>O(),pasteElements:async(g,p)=>{try{i(!0);const E=await le("paste_elements",{offsetX:g,offsetY:p});return await a(),E}catch(E){throw console.error("Failed to paste elements:",E),E}finally{i(!1)}},deleteElements:async g=>{try{i(!0);for(const p of g)await le("delete_element",{elementId:p});await a()}catch(p){throw console.error("Failed to delete elements:",p),p}finally{i(!1)}},selectAllElements:async()=>{try{const g=t.elements.map(p=>p.id);await z(g)}catch(g){throw console.error("Failed to select all elements:",g),g}},moveElements:async(g,p,E)=>{try{i(!0);const U=t.elements.filter(L=>g.includes(L.id)).map(L=>({element_id:L.id,new_position:{x:L.position.x+p,y:L.position.y+E}}));U.length>0&&await w(U)}catch(U){throw console.error("Failed to move elements:",U),U}finally{i(!1)}},undo:async()=>{try{i(!0),await le("undo"),await a()}catch(g){throw console.error("Failed to undo:",g),g}finally{i(!1)}},redo:async()=>{try{i(!0),await le("redo"),await a()}catch(g){throw console.error("Failed to redo:",g),g}finally{i(!1)}},updateCanvasConfig:async g=>{try{i(!0),await le("update_canvas_config",{request:g}),await a()}catch(p){throw console.error("Failed to update canvas config:",p),p}finally{i(!1)}},getElementsAtPoint:async(g,p)=>{try{return await le("get_elements_at_point",{x:g,y:p})}catch(E){return console.error("Failed to get elements at point:",E),[]}},isLoading:l,setLoading:i,dragOperation:n,setDragOperation:r,resizeOperation:s,setResizeOperation:d};return y(Tt.Provider,{value:K,get children(){return e.children}})},we=()=>{const e=nn(Tt);if(!e)throw new Error("useAppContext must be used within an AppProvider");return e};var $n=k("<span class=text-warning>●"),kn=k("<span class=ml-2> 个元素"),Sn=k('<span class="ml-2 text-primary">已选择 <!> 个'),Cn=k('<div class="h-12 bg-primary border-b border-default flex items-center justify-between px-4"><div class="flex items-center gap-2"><button class=toolbar-btn title="新建 (Ctrl+N)"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg><span>新建</span></button><button class=toolbar-btn title="打开 (Ctrl+O)"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"></path></svg><span>打开</span></button><button class=toolbar-btn title="保存 (Ctrl+S)"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path></svg><span>保存</span></button><div class="w-px h-6 bg-border-default mx-2"></div><button class=toolbar-btn title=预览><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg><span>预览</span></button></div><div class="flex items-center gap-2"><button><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"></path></svg></button><button><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M21 10H11a8 8 0 00-8 8v2m18-10l-6 6m6-6l-6-6"></path></svg></button><div class="w-px h-6 bg-border-default mx-2"></div><button class=toolbar-btn-icon title="缩小 (Ctrl+-)"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM13 10H7"></path></svg></button><select class=zoom-select><option value=25%>25%</option><option value=50%>50%</option><option value=75%>75%</option><option value=100%>100%</option><option value=125%>125%</option><option value=150%>150%</option><option value=200%>200%</option><option value=fit>适应窗口</option></select><button class=toolbar-btn-icon title="放大 (Ctrl++)"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"></path></svg></button><div class="w-px h-6 bg-border-default mx-2"></div><button title="显示网格 (Ctrl+G)"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"></path></svg></button><button title="显示标尺 (Ctrl+R)"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v14a2 2 0 01-2 2H7zM20 3v18l-4-4V7l4-4z"></path></svg></button><div class="w-px h-6 bg-border-default mx-2"></div><button class="toolbar-btn-icon bg-yellow-100 hover:bg-yellow-200 text-yellow-800"title="开启/关闭开发者工具 (F12)"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg></button></div><div class="flex items-center gap-2 text-secondary text-sm"><span>');const En=()=>{const{state:e,undo:t,redo:o,updateCanvasConfig:l}=we(),[i,n]=J(e.canvas_config.zoom*100),r=async w=>{const R=w/100;n(w);try{await l({zoom:R})}catch(S){console.error("Failed to update zoom:",S)}},s=()=>{const w=Math.min(i()+25,500);r(w)},d=()=>{const w=Math.max(i()-25,25);r(w)},a=async()=>{try{await l({show_grid:!e.canvas_config.show_grid})}catch(w){console.error("Failed to toggle grid:",w)}},v=async()=>{try{await l({show_rulers:!e.canvas_config.show_rulers})}catch(w){console.error("Failed to toggle rulers:",w)}},h=async()=>{try{await le("toggle_devtools"),console.log("🔧 DevTools toggled")}catch(w){console.error("Failed to toggle DevTools:",w)}};return(()=>{var w=Cn(),R=w.firstChild,S=R.nextSibling,z=S.firstChild,T=z.nextSibling,V=T.nextSibling,F=V.nextSibling,C=F.nextSibling,O=C.nextSibling,B=O.nextSibling,I=B.nextSibling,W=I.nextSibling,Y=W.nextSibling,Q=Y.nextSibling,D=S.nextSibling,M=D.firstChild;return dt(z,"click",t),dt(T,"click",o),F.$$click=d,C.addEventListener("change",b=>{const P=b.target.value;if(P==="fit")console.log("Fit to window");else{const K=parseInt(P.replace("%",""));r(K)}}),O.$$click=s,I.$$click=a,W.$$click=v,Q.$$click=h,f(D,y(xe,{get when(){return e.dirty},get children(){return $n()}}),M),f(M,()=>e.template_name||"未命名模板"),f(D,y(xe,{get when(){return e.elements.length>0},get children(){var b=kn(),P=b.firstChild;return f(b,()=>e.elements.length,P),b}}),null),f(D,y(xe,{get when(){return e.selected_ids.length>0},get children(){var b=Sn(),P=b.firstChild,K=P.nextSibling;return K.nextSibling,f(b,()=>e.selected_ids.length,K),b}}),null),A(b=>{var P=`toolbar-btn-icon ${e.can_undo?"":"opacity-50 cursor-not-allowed"}`,K=!e.can_undo,g=`撤销${e.undo_description?` (${e.undo_description})`:""} (Ctrl+Z)`,p=`toolbar-btn-icon ${e.can_redo?"":"opacity-50 cursor-not-allowed"}`,E=!e.can_redo,U=`重做${e.redo_description?` (${e.redo_description})`:""} (Ctrl+Y)`,L=`toolbar-btn-icon ${e.canvas_config.show_grid?"active":""}`,X=`toolbar-btn-icon ${e.canvas_config.show_rulers?"active":""}`;return P!==b.e&&Ue(z,b.e=P),K!==b.t&&(z.disabled=b.t=K),g!==b.a&&$(z,"title",b.a=g),p!==b.o&&Ue(T,b.o=p),E!==b.i&&(T.disabled=b.i=E),U!==b.n&&$(T,"title",b.n=U),L!==b.s&&Ue(I,b.s=L),X!==b.h&&Ue(W,b.h=X),b},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),A(()=>C.value=`${Math.round(i())}%`),w})()};Se(["click"]);var zn=k('<div class="flex flex-col h-full"><div class="p-4 border-b border-default"><h2 class="text-lg font-semibold text-primary mb-3">组件库</h2><input type=text placeholder=搜索组件... class=component-search></div><div class="flex-1 overflow-y-auto custom-scrollbar p-4"><div class=space-y-4><div><h3 class="text-sm font-medium text-secondary mb-2">基础组件</h3><div class="grid grid-cols-2 gap-2"></div></div><div><h3 class="text-sm font-medium text-secondary mb-2">数据组件</h3><div class="grid grid-cols-2 gap-2"></div></div><div><h3 class="text-sm font-medium text-secondary mb-2">银行组件</h3><div class="grid grid-cols-2 gap-2">'),Pn=k('<div class=component-item><div class=text-center><div class="text-lg mb-1"></div><div class="text-xs font-medium text-primary">');const An=()=>{const{createElement:e}=we(),[t,o]=J(""),l=[{id:"text",name:"文字",category:"basic",icon:"📝",description:"静态文字标签",default_size:{width:100,height:24},create_content:a=>({type:"Text",content:(a==null?void 0:a.text)||"文字内容",style:{font_family:"SimSun",font_size:14,font_weight:"normal",color:"#000000",align:"Left",border:{color:"#cccccc",width:1,style:"Solid",radius:0},background:{color:"#f8f9fa",opacity:.8,padding:2}}})},{id:"data_field",name:"数据字段",category:"data",icon:"🔗",description:"动态数据字段",default_size:{width:120,height:24},create_content:a=>({type:"DataField",expression:(a==null?void 0:a.expression)||"${fieldName}",format:a==null?void 0:a.format,style:{font_family:"SimSun",font_size:14,font_weight:"normal",color:"#000000",align:"Left",border:{color:"#cccccc",width:1,style:"Solid",radius:0},background:{color:"#f8f9fa",opacity:.8,padding:2}}})},{id:"rectangle",name:"矩形",category:"basic",icon:"▭",description:"矩形框架",default_size:{width:100,height:60},create_content:a=>({type:"Rectangle",fill_color:(a==null?void 0:a.fill_color)||"transparent",border:{color:(a==null?void 0:a.border_color)||"#000000",width:(a==null?void 0:a.border_width)||1,style:"Solid"}})},{id:"line",name:"线条",category:"basic",icon:"━",description:"分隔线",default_size:{width:200,height:2},create_content:a=>({type:"Line",color:(a==null?void 0:a.color)||"#000000",width:(a==null?void 0:a.width)||1})},{id:"image",name:"图片",category:"basic",icon:"🖼️",description:"图片占位符",default_size:{width:100,height:80},create_content:a=>({type:"Image",src:(a==null?void 0:a.src)||"",alt:(a==null?void 0:a.alt)||"图片"})}],i=[{id:"bank_header",name:"银行抬头",category:"bank",icon:"🏦",description:"银行标题和Logo区域",default_size:{width:300,height:60},create_content:()=>({type:"Text",content:"中国工商银行电子回单",style:{font_family:"SimHei",font_size:18,font_weight:"bold",color:"#000000",align:"Center",border:{color:"#cccccc",width:1,style:"Solid",radius:0},background:{color:"#f8f9fa",opacity:.8,padding:2}}})},{id:"amount_field",name:"金额字段",category:"bank",icon:"💰",description:"格式化金额显示",default_size:{width:120,height:24},create_content:()=>({type:"DataField",expression:"${amount}",format:"currency",style:{font_family:"SimSun",font_size:14,font_weight:"bold",color:"#000000",align:"Right",border:{color:"#cccccc",width:1,style:"Solid",radius:0},background:{color:"#f8f9fa",opacity:.8,padding:2}}})},{id:"customer_info",name:"客户信息",category:"bank",icon:"👤",description:"客户姓名和账号",default_size:{width:150,height:24},create_content:()=>({type:"DataField",expression:"${customerName}",style:{font_family:"SimSun",font_size:12,font_weight:"normal",color:"#000000",align:"Left",border:{color:"#cccccc",width:1,style:"Solid",radius:0},background:{color:"#f8f9fa",opacity:.8,padding:2}}})}],n=[...l,...i],r=()=>{const a=t().toLowerCase();return a?n.filter(v=>v.name.toLowerCase().includes(a)||v.description.toLowerCase().includes(a)):n},s=(a,v)=>{if(console.log("Starting drag for component:",a.id),v.dataTransfer){v.dataTransfer.effectAllowed="copy",v.dataTransfer.setData("application/json",JSON.stringify({type:"component",component:a}));const h=document.createElement("div");h.innerHTML=`
        <div style="
          background: #f3f4f6; 
          border: 2px solid #3b82f6; 
          border-radius: 8px; 
          padding: 8px 12px; 
          font-size: 12px;
          white-space: nowrap;
          box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        ">
          ${a.icon} ${a.name}
        </div>
      `,h.style.position="absolute",h.style.top="-1000px",document.body.appendChild(h),v.dataTransfer.setDragImage(h,50,20),setTimeout(()=>{document.body.removeChild(h)},0)}},d=async a=>{try{const v=await e(a.id,{x:100,y:100},a.default_size,a.create_content());console.log("Created element:",v)}catch(v){console.error("Failed to create element:",v)}};return(()=>{var a=zn(),v=a.firstChild,h=v.firstChild,w=h.nextSibling,R=v.nextSibling,S=R.firstChild,z=S.firstChild,T=z.firstChild,V=T.nextSibling,F=z.nextSibling,C=F.firstChild,O=C.nextSibling,B=F.nextSibling,I=B.firstChild,W=I.nextSibling;return w.$$input=Y=>o(Y.target.value),f(V,y(ze,{get each(){return r().filter(Y=>Y.category==="basic")},children:Y=>y(rt,{component:Y,onDrag:Q=>s(Y,Q),onClick:()=>d(Y)})})),f(O,y(ze,{get each(){return r().filter(Y=>Y.category==="data")},children:Y=>y(rt,{component:Y,onDrag:Q=>s(Y,Q),onClick:()=>d(Y)})})),f(W,y(ze,{get each(){return r().filter(Y=>Y.category==="bank")},children:Y=>y(rt,{component:Y,onDrag:Q=>s(Y,Q),onClick:()=>d(Y)})})),A(()=>w.value=t()),a})()},rt=e=>(()=>{var t=Pn(),o=t.firstChild,l=o.firstChild,i=l.nextSibling;return dt(t,"click",e.onClick),t.addEventListener("dragstart",n=>e.onDrag(n)),$(t,"draggable",!0),f(l,()=>e.component.icon),f(i,()=>e.component.name),A(()=>$(t,"title",e.component.description)),t})();Se(["input","click"]);var In=k('<div class="flex flex-col h-full"><div class="p-4 border-b border-default"><h2 class="text-lg font-semibold text-primary">属性面板</h2></div><div class="flex-1 overflow-y-auto custom-scrollbar">'),Un=k('<div class="p-4 text-center text-muted"><svg class="w-12 h-12 mx-auto mb-2 opacity-50"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"></path></svg><p class=text-sm>选择元素以查看属性'),Ln=k("<span class=property-value>"),Dn=k('<span class="property-value text-xs text-muted">'),nt=k("<div class=space-y-2>"),Fe=k("<input type=number class=property-input>"),Mn=k('<div class="grid grid-cols-2 gap-2">'),xt=k("<input type=checkbox class=property-checkbox>"),Tn=k('<div class="p-4 space-y-4">'),Rn=k("<div class=property-group><div class=property-group-title><span></span><span></span></div><div class=property-group-content>"),Fn=k("<div class=property-field><label class=property-label>"),On=k("<textarea class=property-textarea rows=2 placeholder=输入文本内容...>"),Rt=k('<select class=property-select><option value=SimSun>宋体</option><option value=SimHei>黑体</option><option value="Microsoft YaHei">微软雅黑</option><option value=KaiTi>楷体</option><option value=Arial>Arial</option><option value="Times New Roman">Times New Roman</option><option value=Helvetica>Helvetica'),Ft=k("<select class=property-select><option value=normal>正常</option><option value=bold>粗体</option><option value=lighter>细体</option><option value=100>100</option><option value=200>200</option><option value=300>300</option><option value=400>400</option><option value=500>500</option><option value=600>600</option><option value=700>700</option><option value=800>800</option><option value=900>900"),Nn=k('<div class=space-y-2><div class="grid grid-cols-2 gap-2">'),Ot=k("<select class=property-select><option value=Solid>实线</option><option value=Dashed>虚线</option><option value=Dotted>点线"),jn=k('<div class=space-y-2><div class="grid grid-cols-3 gap-2">'),Nt=k('<div class=space-y-3><div class="grid grid-cols-2 gap-2"></div><div class="grid grid-cols-2 gap-2">'),jt=k('<div class="flex gap-2 items-center"><input type=range class="property-slider flex-1"min=0 max=100 step=1><span class="property-value w-12 text-center">%'),Bn=k('<div class=space-y-3><div class=space-y-2><div class="grid grid-cols-2 gap-2">'),Hn=k("<select class=property-select><option value=Solid>实线</option><option value=Dashed>虚线</option><option value=Dotted>点线</option><option value=DashDot>点划线"),pt=k("<select class=property-select><option value=None>无</option><option value=Arrow>箭头</option><option value=Circle>圆点</option><option value=Square>方块"),Gn=k('<div class=space-y-3><div class="grid grid-cols-2 gap-2">'),Kn=k("<input type=text class=property-input placeholder=https://example.com/image.jpg>"),Vn=k("<input type=text class=property-input placeholder=图片描述文字>"),qn=k("<div class=property-image-preview><div class=property-image-placeholder><span>📷 无图片"),Yn=k("<div class=space-y-3>"),Xn=k("<img class=property-image>"),Wn=k("<input type=text class=property-input placeholder=${fieldName}>"),Zn=k("<select class=property-select><option value=default>默认</option><option value=currency>货币</option><option value=date>日期</option><option value=datetime>日期时间</option><option value=number>数字"),Jn=k("<div class=space-y-4>"),Qn=k('<div class=flex><input type=number class="property-input flex-1">'),el=k("<span class=property-unit>"),tl=k('<div class="flex gap-2"><div class=property-color-wrapper><input type=color class=property-color><div class=property-color-preview></div></div><input type=text class="property-input flex-1"placeholder=#000000>'),nl=k("<div class=property-alignment-group>"),ll=k("<button>");const il=()=>{const{state:e,updateElement:t}=we(),o=ie(()=>{const n=new Set(e.selected_ids);return e.elements.filter(r=>n.has(r.id))}),l=ie(()=>o()[0]),i=async(n,r,s)=>{try{await t(n,{[r]:s})}catch(d){console.error("Failed to update element property:",d)}};return(()=>{var n=In(),r=n.firstChild,s=r.nextSibling;return f(s,y(xe,{get when(){return l()},get fallback(){return Un()},get children(){return y(ol,{get element(){return l()},onUpdate:i})}})),n})()},ol=e=>{const t=(l,i)=>{const n={...e.element.position,[l]:i};e.onUpdate(e.element.id,"position",n)},o=(l,i)=>{const n={...e.element.size,[l]:Math.max(1,i)};e.onUpdate(e.element.id,"size",n)};return(()=>{var l=Tn();return f(l,y(pe,{title:"元素信息",icon:"ℹ️",get children(){var i=nt();return f(i,y(G,{label:"类型",get children(){var n=Ln();return f(n,()=>e.element.content.type),n}}),null),f(i,y(G,{label:"ID",get children(){var n=Dn();return f(n,()=>e.element.id),n}}),null),i}}),null),f(l,y(pe,{title:"位置和大小",icon:"📐",get children(){var i=Mn();return f(i,y(G,{label:"X",get children(){var n=Fe();return n.$$input=r=>t("x",parseFloat(r.target.value)||0),A(()=>n.value=e.element.position.x),n}}),null),f(i,y(G,{label:"Y",get children(){var n=Fe();return n.$$input=r=>t("y",parseFloat(r.target.value)||0),A(()=>n.value=e.element.position.y),n}}),null),f(i,y(G,{label:"宽度",get children(){var n=Fe();return n.$$input=r=>o("width",parseFloat(r.target.value)||1),A(()=>n.value=e.element.size.width),n}}),null),f(i,y(G,{label:"高度",get children(){var n=Fe();return n.$$input=r=>o("height",parseFloat(r.target.value)||1),A(()=>n.value=e.element.size.height),n}}),null),i}}),null),f(l,y(pe,{title:"状态",icon:"👁️",get children(){var i=nt();return f(i,y(G,{label:"可见",get children(){var n=xt();return n.addEventListener("change",r=>e.onUpdate(e.element.id,"visible",r.target.checked)),A(()=>n.checked=e.element.visible),n}}),null),f(i,y(G,{label:"锁定",get children(){var n=xt();return n.addEventListener("change",r=>e.onUpdate(e.element.id,"locked",r.target.checked)),A(()=>n.checked=e.element.locked),n}}),null),f(i,y(G,{label:"层级",get children(){var n=Fe();return n.$$input=r=>e.onUpdate(e.element.id,"z_index",parseInt(r.target.value)||0),A(()=>n.value=e.element.z_index),n}}),null),i}}),null),f(l,y(un,{get children(){return[y(Re,{get when(){return e.element.content.type==="Text"&&e.element.content},children:i=>y(rl,{get content(){return i()},onUpdate:n=>{console.log("Text content update:",n),e.onUpdate(e.element.id,"content",n)}})}),y(Re,{get when(){return e.element.content.type==="Rectangle"&&e.element.content},children:i=>y(sl,{get content(){return i()},onUpdate:n=>{console.log("Rectangle content update:",n),e.onUpdate(e.element.id,"content",n)}})}),y(Re,{get when(){return e.element.content.type==="Line"&&e.element.content},children:i=>y(al,{get content(){return i()},onUpdate:n=>{console.log("Line content update:",n),e.onUpdate(e.element.id,"content",n)}})}),y(Re,{get when(){return e.element.content.type==="Image"&&e.element.content},children:i=>y(cl,{get content(){return i()},onUpdate:n=>{console.log("Image content update:",n),e.onUpdate(e.element.id,"content",n)}})}),y(Re,{get when(){return e.element.content.type==="DataField"&&e.element.content},children:i=>y(dl,{get content(){return i()},onUpdate:n=>{console.log("DataField content update:",n),e.onUpdate(e.element.id,"content",n)}})})]}}),null),l})()},pe=e=>(()=>{var t=Rn(),o=t.firstChild,l=o.firstChild,i=l.nextSibling,n=o.nextSibling;return f(l,()=>e.icon),f(i,()=>e.title),f(n,()=>e.children),t})(),G=e=>(()=>{var t=Fn(),o=t.firstChild;return f(o,()=>e.label),f(t,()=>e.children,null),t})(),rl=e=>y(pe,{title:"文字样式",icon:"🔤",get children(){var t=Nt(),o=t.firstChild,l=o.nextSibling;return f(t,y(G,{label:"内容",get children(){var i=On();return i.$$input=n=>e.onUpdate({content:n.target.value}),A(()=>i.value=e.content.content),i}}),o),f(o,y(G,{label:"字体",get children(){var i=Rt();return i.addEventListener("change",n=>e.onUpdate({style:{...e.content.style,font_family:n.target.value}})),A(()=>i.value=e.content.style.font_family),i}}),null),f(o,y(G,{label:"大小",get children(){return y(me,{get value(){return e.content.style.font_size},min:6,max:72,step:1,unit:"px",onUpdate:i=>e.onUpdate({style:{...e.content.style,font_size:i}})})}}),null),f(l,y(G,{label:"字重",get children(){var i=Ft();return i.addEventListener("change",n=>e.onUpdate({style:{...e.content.style,font_weight:n.target.value}})),A(()=>i.value=e.content.style.font_weight),i}}),null),f(l,y(G,{label:"对齐",get children(){return y(Bt,{get value(){return e.content.style.align},onUpdate:i=>e.onUpdate({style:{...e.content.style,align:i}})})}}),null),f(t,y(G,{label:"颜色",get children(){return y(Pe,{get value(){return e.content.style.color},onUpdate:i=>e.onUpdate({style:{...e.content.style,color:i}})})}}),null),f(t,y(G,{label:"背景",get children(){var i=Nn(),n=i.firstChild;return f(i,y(Pe,{get value(){var r;return((r=e.content.style.background)==null?void 0:r.color)||"transparent"},onUpdate:r=>e.onUpdate({style:{...e.content.style,background:{...e.content.style.background,color:r}}})}),n),f(n,y(G,{label:"透明度",get children(){return y(me,{get value(){var r;return((r=e.content.style.background)==null?void 0:r.opacity)||1},min:0,max:1,step:.1,onUpdate:r=>e.onUpdate({style:{...e.content.style,background:{...e.content.style.background,opacity:r}}})})}}),null),f(n,y(G,{label:"内边距",get children(){return y(me,{get value(){var r;return((r=e.content.style.background)==null?void 0:r.padding)||0},min:0,max:20,step:1,unit:"px",onUpdate:r=>e.onUpdate({style:{...e.content.style,background:{...e.content.style.background,padding:r}}})})}}),null),i}}),null),f(t,y(G,{label:"边框",get children(){var i=jn(),n=i.firstChild;return f(i,y(Pe,{get value(){var r;return((r=e.content.style.border)==null?void 0:r.color)||"#000000"},onUpdate:r=>e.onUpdate({style:{...e.content.style,border:{...e.content.style.border,color:r}}})}),n),f(n,y(G,{label:"宽度",get children(){return y(me,{get value(){var r;return((r=e.content.style.border)==null?void 0:r.width)||1},min:0,max:10,step:.5,unit:"px",onUpdate:r=>e.onUpdate({style:{...e.content.style,border:{...e.content.style.border,width:r}}})})}}),null),f(n,y(G,{label:"样式",get children(){var r=Ot();return r.addEventListener("change",s=>e.onUpdate({style:{...e.content.style,border:{...e.content.style.border,style:s.target.value}}})),A(()=>{var s;return r.value=((s=e.content.style.border)==null?void 0:s.style)||"Solid"}),r}}),null),f(n,y(G,{label:"圆角",get children(){return y(me,{get value(){var r;return((r=e.content.style.border)==null?void 0:r.radius)||0},min:0,max:20,step:1,unit:"px",onUpdate:r=>e.onUpdate({style:{...e.content.style,border:{...e.content.style.border,radius:r}}})})}}),null),i}}),null),t}}),sl=e=>y(pe,{title:"矩形样式",icon:"▭",get children(){var t=Bn(),o=t.firstChild,l=o.firstChild;return f(t,y(G,{label:"填充颜色",get children(){return y(Pe,{get value(){return e.content.fill_color||"#ffffff"},onUpdate:i=>e.onUpdate({fill_color:i})})}}),o),f(o,y(G,{label:"边框",get children(){var i=nt();return f(i,y(Pe,{get value(){var n;return((n=e.content.border)==null?void 0:n.color)||"#000000"},onUpdate:n=>e.onUpdate({border:{...e.content.border,color:n}})})),i}}),l),f(l,y(G,{label:"宽度",get children(){return y(me,{get value(){var i;return((i=e.content.border)==null?void 0:i.width)||1},min:0,max:20,step:.5,unit:"px",onUpdate:i=>e.onUpdate({border:{...e.content.border,width:i}})})}}),null),f(l,y(G,{label:"样式",get children(){var i=Ot();return i.addEventListener("change",n=>e.onUpdate({border:{...e.content.border,style:n.target.value}})),A(()=>{var n;return i.value=((n=e.content.border)==null?void 0:n.style)||"Solid"}),i}}),null),f(t,y(G,{label:"圆角半径",get children(){return y(me,{get value(){return e.content.corner_radius||0},min:0,max:50,step:1,unit:"px",onUpdate:i=>e.onUpdate({corner_radius:i})})}}),null),f(t,y(G,{label:"透明度",get children(){var i=jt(),n=i.firstChild,r=n.nextSibling,s=r.firstChild;return n.$$input=d=>e.onUpdate({opacity:parseFloat(d.target.value)/100}),f(r,()=>Math.round((e.content.opacity||1)*100),s),A(()=>n.value=(e.content.opacity||1)*100),i}}),null),t}}),al=e=>y(pe,{title:"线条样式",icon:"━",get children(){var t=Gn(),o=t.firstChild;return f(t,y(G,{label:"颜色",get children(){return y(Pe,{get value(){return e.content.color},onUpdate:l=>e.onUpdate({color:l})})}}),o),f(t,y(G,{label:"宽度",get children(){return y(me,{get value(){return e.content.width},min:.5,max:20,step:.5,unit:"px",onUpdate:l=>e.onUpdate({width:l})})}}),o),f(t,y(G,{label:"样式",get children(){var l=Hn();return l.addEventListener("change",i=>e.onUpdate({line_style:i.target.value})),A(()=>l.value=e.content.line_style||"Solid"),l}}),o),f(o,y(G,{label:"起点",get children(){var l=pt();return l.addEventListener("change",i=>e.onUpdate({start_cap:i.target.value})),A(()=>l.value=e.content.start_cap||"None"),l}}),null),f(o,y(G,{label:"终点",get children(){var l=pt();return l.addEventListener("change",i=>e.onUpdate({end_cap:i.target.value})),A(()=>l.value=e.content.end_cap||"None"),l}}),null),f(t,y(G,{label:"透明度",get children(){var l=jt(),i=l.firstChild,n=i.nextSibling,r=n.firstChild;return i.$$input=s=>e.onUpdate({opacity:parseFloat(s.target.value)/100}),f(n,()=>Math.round((e.content.opacity||1)*100),r),A(()=>i.value=(e.content.opacity||1)*100),l}}),null),t}}),cl=e=>y(pe,{title:"图片属性",icon:"🖼️",get children(){var t=Yn();return f(t,y(G,{label:"图片地址",get children(){var o=Kn();return o.$$input=l=>e.onUpdate({src:l.target.value}),A(()=>o.value=e.content.src),o}}),null),f(t,y(G,{label:"替代文本",get children(){var o=Vn();return o.$$input=l=>e.onUpdate({alt:l.target.value}),A(()=>o.value=e.content.alt||""),o}}),null),f(t,y(G,{label:"预览",get children(){var o=qn(),l=o.firstChild;return f(o,(()=>{var i=ue(()=>!!e.content.src);return()=>i()?(()=>{var n=Xn();return n.addEventListener("load",r=>{const s=r.target,d=s.nextElementSibling;s&&(s.style.display="block"),d&&(d.style.display="none")}),n.addEventListener("error",r=>{const s=r.target,d=s.nextElementSibling;s&&(s.style.display="none"),d&&(d.style.display="flex")}),A(r=>{var s=e.content.src,d=e.content.alt||"图片预览";return s!==r.e&&$(n,"src",r.e=s),d!==r.t&&$(n,"alt",r.t=d),r},{e:void 0,t:void 0}),n})():null})(),l),A(i=>(i=e.content.src?"none":"flex")!=null?l.style.setProperty("display",i):l.style.removeProperty("display")),o}}),null),t}}),dl=e=>(()=>{var t=Jn();return f(t,y(pe,{title:"数据字段",icon:"🔗",get children(){var o=nt();return f(o,y(G,{label:"表达式",get children(){var l=Wn();return l.$$input=i=>e.onUpdate({expression:i.target.value}),A(()=>l.value=e.content.expression),l}}),null),f(o,y(G,{label:"格式",get children(){var l=Zn();return l.addEventListener("change",i=>e.onUpdate({format:i.target.value==="default"?void 0:i.target.value})),A(()=>l.value=e.content.format||"default"),l}}),null),o}}),null),f(t,y(pe,{title:"字段样式",icon:"🎨",get children(){var o=Nt(),l=o.firstChild,i=l.nextSibling;return f(l,y(G,{label:"字体",get children(){var n=Rt();return n.addEventListener("change",r=>e.onUpdate({style:{...e.content.style,font_family:r.target.value}})),A(()=>n.value=e.content.style.font_family),n}}),null),f(l,y(G,{label:"大小",get children(){return y(me,{get value(){return e.content.style.font_size},min:6,max:72,step:1,unit:"px",onUpdate:n=>e.onUpdate({style:{...e.content.style,font_size:n}})})}}),null),f(i,y(G,{label:"字重",get children(){var n=Ft();return n.addEventListener("change",r=>e.onUpdate({style:{...e.content.style,font_weight:r.target.value}})),A(()=>n.value=e.content.style.font_weight),n}}),null),f(i,y(G,{label:"对齐",get children(){return y(Bt,{get value(){return e.content.style.align},onUpdate:n=>e.onUpdate({style:{...e.content.style,align:n}})})}}),null),f(o,y(G,{label:"颜色",get children(){return y(Pe,{get value(){return e.content.style.color},onUpdate:n=>e.onUpdate({style:{...e.content.style,color:n}})})}}),null),o}}),null),t})(),me=e=>(()=>{var t=Qn(),o=t.firstChild;return o.addEventListener("blur",l=>{const i=parseFloat(l.target.value)||e.value,n=Math.max(e.min||-1/0,Math.min(e.max||1/0,i));n!==i&&(l.target.value=n.toString(),e.onUpdate(n))}),o.$$input=l=>{const i=parseFloat(l.target.value);if(!isNaN(i)){const n=Math.max(e.min||-1/0,Math.min(e.max||1/0,i));e.onUpdate(n)}},f(t,(()=>{var l=ue(()=>!!e.unit);return()=>l()&&(()=>{var i=el();return f(i,()=>e.unit),i})()})(),null),A(l=>{var i=e.min,n=e.max,r=e.step||1;return i!==l.e&&$(o,"min",l.e=i),n!==l.t&&$(o,"max",l.t=n),r!==l.a&&$(o,"step",l.a=r),l},{e:void 0,t:void 0,a:void 0}),A(()=>o.value=e.value),t})(),Pe=e=>(()=>{var t=tl(),o=t.firstChild,l=o.firstChild,i=l.nextSibling,n=o.nextSibling;return l.$$input=r=>e.onUpdate(r.target.value),n.$$input=r=>{const s=r.target.value;(/^#[0-9A-Fa-f]{6}$/.test(s)||/^#[0-9A-Fa-f]{3}$/.test(s))&&e.onUpdate(s)},A(r=>(r=e.value)!=null?i.style.setProperty("background-color",r):i.style.removeProperty("background-color")),A(()=>l.value=e.value),A(()=>n.value=e.value),t})(),Bt=e=>{const t=[{value:"Left",icon:"⬅️",label:"左对齐"},{value:"Center",icon:"↔️",label:"居中"},{value:"Right",icon:"➡️",label:"右对齐"}];return(()=>{var o=nl();return f(o,()=>t.map(l=>(()=>{var i=ll();return i.$$click=()=>e.onUpdate(l.value),f(i,()=>l.icon),A(n=>{var r=`property-alignment-btn ${e.value===l.value?"active":""}`,s=l.label;return r!==n.e&&Ue(i,n.e=r),s!==n.t&&$(i,"title",n.t=s),n},{e:void 0,t:void 0}),i})())),o})()};Se(["input","click"]);var ul=k("<svg><defs><pattern id=canvas-grid patternUnits=userSpaceOnUse><line y1=0 stroke=#cbd5e1 stroke-width=0.5 opacity=0.8></line><line x1=0 stroke=#cbd5e1 stroke-width=0.5 opacity=0.8></svg>",!1,!0,!1),fl=k("<svg><rect fill=url(#canvas-grid)></svg>",!1,!0,!1);const hl=e=>y(xe,{get when(){return e.config.show_grid},get children(){return[(()=>{var t=ul(),o=t.firstChild,l=o.firstChild,i=l.nextSibling;return A(n=>{var r=e.config.grid_size,s=e.config.grid_size,d=e.config.grid_size,a=e.config.grid_size,v=e.config.grid_size,h=e.config.grid_size,w=e.config.grid_size,R=e.config.grid_size;return r!==n.e&&$(o,"width",n.e=r),s!==n.t&&$(o,"height",n.t=s),d!==n.a&&$(l,"x1",n.a=d),a!==n.o&&$(l,"x2",n.o=a),v!==n.i&&$(l,"y2",n.i=v),h!==n.n&&$(i,"y1",n.n=h),w!==n.s&&$(i,"x2",n.s=w),R!==n.h&&$(i,"y2",n.h=R),n},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),t})(),(()=>{var t=fl();return A(o=>{var l=e.config.width,i=e.config.height;return l!==o.e&&$(t,"width",o.e=l),i!==o.t&&$(t,"height",o.t=i),o},{e:void 0,t:void 0}),t})()]}});var gl=k("<svg><g class=resize-handles></svg>",!1,!0,!1),vl=k("<svg><g><circle r=6 fill=white stroke=#cccccc stroke-width=1 pointer-events=none></circle><rect class=resize-handle width=8 height=8 rx=1 fill=#007bff stroke=white stroke-width=1></svg>",!1,!0,!1);const yl=e=>{const{updateElement:t,setResizeOperation:o}=we(),[l,i]=J(!1),[n,r]=J(null),[s,d]=J({x:0,y:0}),[a,v]=J({width:0,height:0}),[h,w]=J({x:0,y:0}),[R,S]=J({width:0,height:0}),[z,T]=J({x:0,y:0}),[V,F]=J(!1),C=ie(()=>{const{position:D,size:M}=e.element,P=8/2,K=D.x,g=D.y,p=D.x+M.width,E=D.y+M.height,U=D.x+M.width/2,L=D.y+M.height/2;return[{position:"nw",cursor:"nw-resize",x:K-P,y:g-P},{position:"ne",cursor:"ne-resize",x:p-P,y:g-P},{position:"sw",cursor:"sw-resize",x:K-P,y:E-P},{position:"se",cursor:"se-resize",x:p-P,y:E-P},{position:"n",cursor:"n-resize",x:U-P,y:g-P},{position:"s",cursor:"s-resize",x:U-P,y:E-P},{position:"w",cursor:"w-resize",x:K-P,y:L-P},{position:"e",cursor:"e-resize",x:p-P,y:L-P}]}),O=(D,M,b,P=!1,K=!1)=>{const g=a(),p=h();let E=g.width,U=g.height,L=p.x,X=p.y;switch(D){case"nw":E=g.width-M,U=g.height-b,L=p.x+M,X=p.y+b;break;case"ne":E=g.width+M,U=g.height-b,X=p.y+b;break;case"sw":E=g.width-M,U=g.height+b,L=p.x+M;break;case"se":E=g.width+M,U=g.height+b;break;case"n":U=g.height-b,X=p.y+b;break;case"s":U=g.height+b;break;case"w":E=g.width-M,L=p.x+M;break;case"e":E=g.width+M;break}if(P&&(D==="nw"||D==="ne"||D==="sw"||D==="se")){const se=g.width/g.height;E/U>se?(E=U*se,(D==="nw"||D==="sw")&&(L=p.x+(g.width-E))):(U=E/se,(D==="nw"||D==="ne")&&(X=p.y+(g.height-U)))}if(K){const se=p.x+g.width/2,N=p.y+g.height/2;L=se-E/2,X=N-U/2}const fe=20;return E=Math.max(fe,E),U=Math.max(fe,U),{size:{width:E,height:U},position:{x:L,y:X}}},B=D=>(D.preventDefault(),D.stopPropagation(),D.stopImmediatePropagation(),!1),I=(D,M)=>{var b;o(!0),document.addEventListener("click",B,{capture:!0}),i(!0),r(D),d({x:M.clientX,y:M.clientY}),v({width:e.element.size.width,height:e.element.size.height}),w({x:e.element.position.x,y:e.element.position.y}),S(e.element.size),T(e.element.position),F(!1),document.addEventListener("mousemove",Y),document.addEventListener("mouseup",Q),document.body.style.cursor=((b=C().find(P=>P.position===D))==null?void 0:b.cursor)||"default"};let W=0;const Y=D=>{if(!l())return;const M=n();if(!M)return;const b=s(),P=D.clientX-b.x,K=D.clientY-b.y,g=O(M,P,K,D.shiftKey,D.altKey);S(g.size),T(g.position),F(Math.abs(P)>2||Math.abs(K)>2);const p=Date.now();if(p-W>50)try{t(e.element.id,{size:g.size,position:g.position}),W=p}catch{}},Q=()=>{if(!l()||!n())return;const M=()=>{document.removeEventListener("click",B,{capture:!0}),o(!1),i(!1),r(null),document.body.style.cursor="default",document.removeEventListener("mousemove",Y),document.removeEventListener("mouseup",Q)};if(V()){const b=R(),P=z();t(e.element.id,{size:b,position:P}).catch(K=>{t(e.element.id,{size:a(),position:h()}).catch(g=>{})})}M()};return it(()=>{o(!1),document.removeEventListener("click",B,{capture:!0}),document.removeEventListener("mousemove",Y),document.removeEventListener("mouseup",Q),document.body.style.cursor="default"}),(()=>{var D=gl();return f(D,()=>C().map(M=>(()=>{var b=vl(),P=b.firstChild,K=P.nextSibling;return K.addEventListener("mouseleave",g=>{l()||(document.body.style.cursor="default")}),K.addEventListener("mouseenter",g=>{l()||(document.body.style.cursor=M.cursor)}),K.$$mousedown=g=>{g.stopPropagation(),g.preventDefault(),I(M.position,g)},K.style.setProperty("pointer-events","all"),A(g=>{var p=M.x+4,E=M.y+4,U=M.x,L=M.y,X=M.cursor;return p!==g.e&&$(P,"cx",g.e=p),E!==g.t&&$(P,"cy",g.t=E),U!==g.a&&$(K,"x",g.a=U),L!==g.o&&$(K,"y",g.o=L),X!==g.i&&((g.i=X)!=null?K.style.setProperty("cursor",X):K.style.removeProperty("cursor")),g},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),b})())),D})()};Se(["mousedown"]);var ae=(e=>(e.IDLE="idle",e.HOVER="hover",e.SELECTING="selecting",e.DRAGGING="dragging",e))(ae||{});const ml={dragThreshold:3,updateThrottle:16};var bl=k("<div tabindex=0>"),xl=k("<div>"),pl=k("<div><div>🎯 修复版交互层</div><div>模式: </div><div>选中: </div><div>光标: "),wl=k("<div>拖拽: <!>个元素"),_l=k("<div>[<!>]");const $l=e=>{const{resizeOperation:t,setResizeOperation:o}=we(),l=ml;let i;const[n,r]=J(ae.IDLE),[s,d]=J([]),[a,v]=J(null),[h,w]=J(null),[R,S]=J(null),z=(c,u)=>Math.sqrt(Math.pow(c.x-u.x,2)+Math.pow(c.y-u.y,2)),T=(c,u)=>c.length===u.length&&c.every((x,m)=>x===u[m]),V=()=>{S(null)},[F,C]=J(null);let O="default";const B=(c,u)=>{!i||O===c||(i.style.cursor=c,O=c)},I=(c,...u)=>{console.log(`🎯 [InteractionLayer] ${c}`,...u)},W=c=>{if(!i)return{x:0,y:0};const u=i.getBoundingClientRect();return{x:c.clientX-u.left,y:c.clientY-u.top}},Y=(c,u)=>c.x>=u.position.x&&c.x<=u.position.x+u.size.width&&c.y>=u.position.y&&c.y<=u.position.y+u.size.height,Q=c=>{var x;const u=D(c);return u.length>0&&(x=u[0])!=null?x:null},D=c=>{const u=e.getAllElements();return u.filter(m=>m&&m.visible&&Y(c,m)).sort((m,_)=>{var ee,te;const j=(ee=m.z_index)!=null?ee:u.indexOf(m);return((te=_.z_index)!=null?te:u.indexOf(_))-j})},M=c=>{const u=s();if(u.length===0)return null;const x=e.getAllElements();for(const m of u){const _=x.find($e=>$e.id===m);if(!_||!_.visible)continue;const j=8,H=j/2,ee=_.position.x,te=_.position.y,q=_.position.x+_.size.width,Ee=_.position.y+_.size.height,ve=_.position.x+_.size.width/2,Te=_.position.y+_.size.height/2,Xt=[{direction:"nw",cursor:"nw-resize",x:ee-H,y:te-H},{direction:"ne",cursor:"ne-resize",x:q-H,y:te-H},{direction:"sw",cursor:"sw-resize",x:ee-H,y:Ee-H},{direction:"se",cursor:"se-resize",x:q-H,y:Ee-H},{direction:"n",cursor:"n-resize",x:ve-H,y:te-H},{direction:"s",cursor:"s-resize",x:ve-H,y:Ee-H},{direction:"w",cursor:"w-resize",x:ee-H,y:Te-H},{direction:"e",cursor:"e-resize",x:q-H,y:Te-H}];for(const $e of Xt)if(c.x>=$e.x&&c.x<$e.x+j&&c.y>=$e.y&&c.y<$e.y+j)return{elementId:_.id,direction:$e.direction,cursor:$e.cursor}}return null},b=c=>e.getAllElements().filter(x=>{if(!x.visible)return!1;const m={x:x.position.x,y:x.position.y,width:x.size.width,height:x.size.height};return!(m.x>c.x+c.width||m.x+m.width<c.x||m.y>c.y+c.height||m.y+m.height<c.y)}),P=(c,u)=>{var m,_,j;const x=D(c);return I("重叠选择检测",{elementsCount:x.length,isCtrlClick:u,elementIds:x.map(H=>H.id)}),x.length===0?null:x.length===1?(V(),((m=x[0])==null?void 0:m.id)||null):u?K(c,x):(V(),I("普通点击选中最上层",{elementId:(_=x[0])==null?void 0:_.id}),((j=x[0])==null?void 0:j.id)||null)},K=(c,u)=>{var j,H,ee,te;const x=R(),m=Date.now();if(I("循环选择开始",{hasContext:!!x,elementIds:u.map(q=>q.id)}),!x||z(c,x.clickPoint)>5||m-x.lastClickTime>3e3||!T(u.map(q=>q.id),x.overlappingElements.map(q=>q.id))){const q=u.length>1?1:0;return S({clickPoint:c,overlappingElements:u,currentSelectedIndex:q,lastClickTime:m}),I("循环选择重置",{selectedIndex:q,selectedId:(j=u[q])==null?void 0:j.id,reason:x?z(c,x.clickPoint)>5?"position_changed":m-x.lastClickTime>3e3?"timeout":"elements_changed":"no_context"}),g(q+1,u.length,c),((H=u[q])==null?void 0:H.id)||null}else{const q=(x.currentSelectedIndex+1)%u.length;return S({...x,currentSelectedIndex:q,lastClickTime:m}),I("循环选择继续",{selectedIndex:q,selectedId:(ee=u[q])==null?void 0:ee.id}),g(q+1,u.length,c),((te=u[q])==null?void 0:te.id)||null}},g=(c,u,x)=>{const m=document.querySelector(".overlap-indicator");m!=null&&m.parentNode&&m.parentNode.removeChild(m);const _=document.createElement("div");_.className="overlap-indicator",_.textContent=`${c}/${u}`,Object.assign(_.style,{position:"fixed",background:"rgba(0, 0, 0, 0.8)",color:"white",padding:"2px 6px",fontSize:"11px",fontFamily:"monospace",borderRadius:"3px",pointerEvents:"none",zIndex:"9999",whiteSpace:"nowrap",left:`${x.x+10}px`,top:`${x.y-20}px`}),document.body.appendChild(_),I("显示重叠指示器",{current:c,total:u,point:x}),setTimeout(()=>{_.parentNode&&(_.parentNode.removeChild(_),I("移除重叠指示器"))},1500)},p=c=>{var x;const u=W(c);if(F()){Ht(u);return}if(n()===ae.DRAGGING){Ke(u);return}if(n()===ae.SELECTING){Ve(u);return}if(n()===ae.IDLE&&a()&&!((x=a())!=null&&x.isDragging)){he(u);return}n()===ae.IDLE&&!a()&&!F()&&E(u)},E=c=>{const u=M(c);if(u){B(u.cursor);return}const x=Q(c);if(x){const _=s().includes(x.id)?"grab":"pointer";B(_);return}B("default")},U=c=>{const u=W(c),x=M(u);if(x){I("点击ResizeHandle",{elementId:x.elementId,direction:x.direction}),L(x,u);return}if(t()){I("调整大小操作进行中，跳过交互处理");return}const m=P(u,c.ctrlKey);if(I("鼠标按下",{point:u,selectedElementId:m,currentMode:n(),isCtrlClick:c.ctrlKey}),m){const _=e.getAllElements().find(j=>j.id===m);_&&X(_,u,c)}else fe(u)},L=(c,u,x)=>{const m=e.getAllElements().find(_=>_.id===c.elementId);m&&(I("开始resize操作",{elementId:c.elementId,direction:c.direction}),o(!0),C({elementId:c.elementId,handlePosition:c.direction,startPoint:u,initialSize:{width:m.size.width,height:m.size.height},initialPosition:{x:m.position.x,y:m.position.y},cursor:c.cursor}),B(c.cursor),I("resize状态已设置",F()))},X=(c,u,x)=>{const m=s().includes(c.id),_=s(),j=!!R();I("元素点击",{elementId:c.id,isSelected:m,currentlySelected:_,ctrlKey:x.ctrlKey,shiftKey:x.shiftKey,hasOverlapContext:j}),x.ctrlKey&&!j?se(c.id):x.shiftKey&&s().length>0?N(c.id):m?(I("点击已选中元素，准备拖拽",{selectedCount:_.length}),de(_,u)):re(c.id,u)},fe=(c,u)=>{var x;I("开始框选",{point:c}),d([]),(x=e.onElementsSelect)==null||x.call(e,[]),V(),r(ae.SELECTING),B("crosshair"),w({startPoint:c,currentPoint:c,selectedIds:[]})},se=c=>{var m;const u=s(),x=u.includes(c)?u.filter(_=>_!==c):[...u,c];I("切换选择",{elementId:c,newSelection:x}),d(x),(m=e.onElementsSelect)==null||m.call(e,x)},N=c=>{var x;const u=s();if(!u.includes(c)){const m=[...u,c];I("添加到选择",{elementId:c,newSelection:m}),d(m),(x=e.onElementsSelect)==null||x.call(e,m)}},re=(c,u,x)=>{var m;I("选择并准备拖拽",{elementId:c,point:u}),d([c]),(m=e.onElementsSelect)==null||m.call(e,[c]),de([c],u)},de=(c,u,x)=>{I("准备拖拽操作",{elementIds:c,startPoint:u});const m=e.getAllElements(),_=new Map;c.forEach(j=>{const H=m.find(ee=>ee.id===j);H&&_.set(j,{x:H.position.x,y:H.position.y})}),v({elementIds:c,startPoint:u,startPositions:_,currentOffset:{x:0,y:0},isDragging:!1})},he=c=>{const u=a();if(!u)return;const x=Math.sqrt(Math.pow(c.x-u.startPoint.x,2)+Math.pow(c.y-u.startPoint.y,2));x>l.dragThreshold&&(I("开始拖拽",{distance:x,threshold:l.dragThreshold}),r(ae.DRAGGING),B("grabbing"),v({...u,isDragging:!0}))};let ge=!1,Ce=0;const _e=(c,u=!1)=>{if(u){c();return}Date.now()-Ce>=l.updateThrottle&&!ge&&(ge=!0,requestAnimationFrame(()=>{c(),ge=!1,Ce=Date.now()}))},Ke=c=>{const u=a();if(!u)return;const x={x:c.x-u.startPoint.x,y:c.y-u.startPoint.y};v({...u,currentOffset:x}),_e(()=>{if(e.onBatchUpdatePositions&&u.elementIds.length>1){const m=u.elementIds.map(_=>{const j=u.startPositions.get(_);return j?{element_id:_,new_position:{x:j.x+x.x,y:j.y+x.y}}:null}).filter(Boolean);m.length>0&&e.onBatchUpdatePositions(m).catch(()=>{})}else if(e.onElementMove){const m=u.elementIds.map(_=>{const j=u.startPositions.get(_);if(j)return e.onElementMove(_,{x:j.x+x.x,y:j.y+x.y})}).filter(Boolean);Promise.allSettled(m).catch(()=>{})}})},Ve=c=>{const u=h();if(!u)return;const x={...u,currentPoint:c};w(x);const m={x:Math.min(u.startPoint.x,c.x),y:Math.min(u.startPoint.y,c.y),width:Math.abs(c.x-u.startPoint.x),height:Math.abs(c.y-u.startPoint.y)},j=b(m).map(H=>H.id);w({...x,selectedIds:j}),d(j)},Ht=c=>{const u=F();if(!u)return;const x=c.x-u.startPoint.x,m=c.y-u.startPoint.y,_=Gt(u.handlePosition,x,m,u.initialSize,u.initialPosition);_e(()=>{e.onElementResize&&e.onElementResize(u.elementId,_.size,_.position)})},Gt=(c,u,x,m,_)=>{let j=m.width,H=m.height,ee=_.x,te=_.y;switch(c){case"nw":j=m.width-u,H=m.height-x,ee=_.x+u,te=_.y+x;break;case"ne":j=m.width+u,H=m.height-x,te=_.y+x;break;case"sw":j=m.width-u,H=m.height+x,ee=_.x+u;break;case"se":j=m.width+u,H=m.height+x;break;case"n":H=m.height-x,te=_.y+x;break;case"s":H=m.height+x;break;case"w":j=m.width-u,ee=_.x+u;break;case"e":j=m.width+u;break}const q=10;return j=Math.max(q,j),H=Math.max(q,H),{size:{width:j,height:H},position:{x:ee,y:te}}},gt=()=>{const c=n();if(I("鼠标释放",{currentMode:c,hasResizeState:!!F()}),F()){qt();return}c===ae.DRAGGING?Kt():c===ae.SELECTING&&Vt(),Yt()},Kt=()=>{const c=a();if(!c||!c.isDragging&&c.currentOffset.x===0&&c.currentOffset.y===0){I("拖拽完成，无实际移动");return}if(e.onBatchUpdatePositions&&c.elementIds.length>1){const u=c.elementIds.map(x=>{const m=c.startPositions.get(x);return m?{element_id:x,new_position:{x:m.x+c.currentOffset.x,y:m.y+c.currentOffset.y}}:null}).filter(Boolean);u.length>0&&(I("拖拽完成 - 批量更新",{elementCount:u.length}),e.onBatchUpdatePositions(u).catch(x=>{console.warn("批量更新最终位置失败:",x)}))}},Vt=()=>{const c=h();c&&(I("框选完成",{selectedCount:c.selectedIds.length}),e.onElementsSelect&&e.onElementsSelect(c.selectedIds))},qt=()=>{const c=F();c&&(I("完成resize操作",{elementId:c.elementId}),o(!1),C(null))},Yt=()=>{r(ae.IDLE),B("default"),v(null),w(null),C(null),o(!1),V(),I("状态重置完成")};He(async()=>{document.addEventListener("mousemove",p),document.addEventListener("mouseup",gt),I("修复版交互层已初始化")}),it(()=>{document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",gt),I("修复版交互层已清理")});const Me=()=>{const c=h();if(!c||n()!==ae.SELECTING)return null;const{startPoint:u,currentPoint:x}=c;return{x:Math.min(u.x,x.x),y:Math.min(u.y,x.y),width:Math.abs(x.x-u.x),height:Math.abs(x.y-u.y)}};return(()=>{var c=bl();c.$$mousedown=U;var u=i;return typeof u=="function"?It(u,c):i=c,c.style.setProperty("position","absolute"),c.style.setProperty("top","0"),c.style.setProperty("left","0"),c.style.setProperty("width","100%"),c.style.setProperty("height","100%"),c.style.setProperty("z-index","10"),c.style.setProperty("pointer-events","all"),c.style.setProperty("background","transparent"),c.style.setProperty("user-select","none"),f(c,(()=>{var x=ue(()=>!!Me());return()=>x()&&(()=>{var m=xl();return m.style.setProperty("position","absolute"),m.style.setProperty("border","1px dashed #007acc"),m.style.setProperty("background","rgba(0, 122, 204, 0.1)"),m.style.setProperty("pointer-events","none"),A(_=>{var j=`${Me().x}px`,H=`${Me().y}px`,ee=`${Me().width}px`,te=`${Me().height}px`;return j!==_.e&&((_.e=j)!=null?m.style.setProperty("left",j):m.style.removeProperty("left")),H!==_.t&&((_.t=H)!=null?m.style.setProperty("top",H):m.style.removeProperty("top")),ee!==_.a&&((_.a=ee)!=null?m.style.setProperty("width",ee):m.style.removeProperty("width")),te!==_.o&&((_.o=te)!=null?m.style.setProperty("height",te):m.style.removeProperty("height")),_},{e:void 0,t:void 0,a:void 0,o:void 0}),m})()})(),null),f(c,(()=>{var x=ue(()=>!!e.enableDebugMode);return()=>x()&&(()=>{var m=pl(),_=m.firstChild,j=_.nextSibling;j.firstChild;var H=j.nextSibling;H.firstChild;var ee=H.nextSibling;return ee.firstChild,m.style.setProperty("position","fixed"),m.style.setProperty("top","10px"),m.style.setProperty("right","10px"),m.style.setProperty("padding","8px"),m.style.setProperty("background","rgba(0, 0, 0, 0.8)"),m.style.setProperty("color","white"),m.style.setProperty("font-family","monospace"),m.style.setProperty("font-size","12px"),m.style.setProperty("border-radius","4px"),m.style.setProperty("z-index","9999"),m.style.setProperty("pointer-events","none"),f(j,n,null),f(H,()=>s().length,null),f(ee,O,null),f(m,(()=>{var te=ue(()=>{var q;return!!((q=a())!=null&&q.isDragging)});return()=>te()&&(()=>{var q=wl(),Ee=q.firstChild,ve=Ee.nextSibling;return ve.nextSibling,q.style.setProperty("color","#ffeb3b"),f(q,()=>{var Te;return(Te=a())==null?void 0:Te.elementIds.length},ve),q})()})(),null),f(m,(()=>{var te=ue(()=>s().length>0);return()=>te()&&(()=>{var q=_l(),Ee=q.firstChild,ve=Ee.nextSibling;return ve.nextSibling,q.style.setProperty("font-size","10px"),q.style.setProperty("color","#ccc"),f(q,()=>s().slice(0,3).join(", "),ve),f(q,()=>s().length>3&&"...",ve),q})()})(),null),m})()})(),null),c})()};Se(["mousedown"]);var kl=k("<div class=toolbar-section><div class=section-title>智能建议</div><button class=smart-align-button><div class=smart-icon>🎯</div><div class=smart-text></div></button><div class=smart-reason>"),Sl=k("<div class=toolbar-status><div class=status-text>选择至少2个元素以使用对齐功能"),Cl=k('<div class=toolbar-status><div class="status-text aligning"><div class=spinner></div>正在执行对齐操作...'),El=k('<div class=alignment-toolbar><div class=toolbar-section><div class=section-title>对齐</div><div class=button-group><button class="align-button left"title=左对齐><div class=align-icon><div class="line left-line"></div><div class=shapes><div class=shape></div><div class=shape></div><div class=shape></div></div></div></button><button class="align-button h-center"title=水平居中对齐><div class=align-icon><div class="line center-line"></div><div class=shapes><div class=shape></div><div class=shape></div><div class=shape></div></div></div></button><button class="align-button right"title=右对齐><div class=align-icon><div class="line right-line"></div><div class=shapes><div class=shape></div><div class=shape></div><div class=shape></div></div></div></button></div></div><div class=toolbar-section><div class=section-title>垂直对齐</div><div class=button-group><button class="align-button top"title=顶部对齐><div class="align-icon vertical"><div class="line top-line"></div><div class="shapes vertical"><div class=shape></div><div class=shape></div><div class=shape></div></div></div></button><button class="align-button v-center"title=垂直居中对齐><div class="align-icon vertical"><div class="line v-center-line"></div><div class="shapes vertical"><div class=shape></div><div class=shape></div><div class=shape></div></div></div></button><button class="align-button bottom"title=底部对齐><div class="align-icon vertical"><div class="line bottom-line"></div><div class="shapes vertical"><div class=shape></div><div class=shape></div><div class=shape></div></div></div></button></div></div><div class=toolbar-section><div class=section-title>分布</div><div class=button-group><button class="align-button distribute-h"title=水平均匀分布><div class=align-icon><div class="shapes distribute"><div class=shape></div><div class=spacer></div><div class=shape></div><div class=spacer></div><div class=shape></div></div></div></button><button class="align-button distribute-v"title=垂直均匀分布><div class="align-icon vertical"><div class="shapes distribute vertical"><div class=shape></div><div class=spacer></div><div class=shape></div><div class=spacer></div><div class=shape>');const zl=(e,t)=>{if(e.length<2)return[];const o=e.map(l=>({x:l.position.x,y:l.position.y,width:l.size.width,height:l.size.height}));return o.map((l,i)=>{let n=l.x,r=l.y;switch(t){case"left":n=Math.min(...o.map(h=>h.x));break;case"right":n=Math.max(...o.map(h=>h.x+h.width))-l.width;break;case"top":r=Math.min(...o.map(h=>h.y));break;case"bottom":r=Math.max(...o.map(h=>h.y+h.height))-l.height;break;case"h_center":n=o.reduce((h,w)=>h+w.x+w.width/2,0)/o.length-l.width/2;break;case"v_center":r=o.reduce((h,w)=>h+w.y+w.height/2,0)/o.length-l.height/2;break}return{element_id:e[i].id,new_position:{x:n,y:r}}})},Pl=e=>{const{batchUpdatePositions:t,state:o}=we(),[l,i]=J(!1),n=()=>e.selectedElementIds().length>=2,r=()=>{const v=e.selectedElementIds();return o.elements.filter(h=>v.includes(h.id))},s=async v=>{const h=r();if(h.length<2){console.warn("对齐功能需要至少2个元素");return}try{i(!0),console.log(`🎯 执行${v}对齐:`,h.length,"个元素");const w=zl(h,v);await t(w),console.log("✅ 对齐操作完成"),e.onAlignmentComplete&&e.onAlignmentComplete(w)}catch(w){console.error("❌ 对齐操作失败:",w)}finally{i(!1)}},d=()=>r().length<2?null:{recommended:"left",reason:"建议左对齐",results:[]},a=()=>d();return(()=>{var v=El(),h=v.firstChild,w=h.firstChild,R=w.nextSibling,S=R.firstChild,z=S.nextSibling,T=z.nextSibling,V=h.nextSibling,F=V.firstChild,C=F.nextSibling,O=C.firstChild,B=O.nextSibling,I=B.nextSibling,W=V.nextSibling,Y=W.firstChild,Q=Y.nextSibling,D=Q.firstChild,M=D.nextSibling;return S.$$click=()=>s("left"),z.addEventListener("mouseenter",()=>{var b;return(b=e.onAlignmentPreview)==null?void 0:b.call(e,"h_center")}),z.$$click=()=>s("h_center"),T.addEventListener("mouseenter",()=>{var b;return(b=e.onAlignmentPreview)==null?void 0:b.call(e,"right")}),T.$$click=()=>s("right"),O.addEventListener("mouseenter",()=>{var b;return(b=e.onAlignmentPreview)==null?void 0:b.call(e,"top")}),O.$$click=()=>s("top"),B.addEventListener("mouseenter",()=>{var b;return(b=e.onAlignmentPreview)==null?void 0:b.call(e,"v_center")}),B.$$click=()=>s("v_center"),I.addEventListener("mouseenter",()=>{var b;return(b=e.onAlignmentPreview)==null?void 0:b.call(e,"bottom")}),I.$$click=()=>s("bottom"),D.addEventListener("mouseenter",()=>{var b;return(b=e.onAlignmentPreview)==null?void 0:b.call(e,"distribute_h")}),D.$$click=()=>s("distribute_h"),M.addEventListener("mouseenter",()=>{var b;return(b=e.onAlignmentPreview)==null?void 0:b.call(e,"distribute_v")}),M.$$click=()=>s("distribute_v"),f(v,y(xe,{get when(){return ue(()=>!!n())()&&a()},get children(){var b=kl(),P=b.firstChild,K=P.nextSibling,g=K.firstChild,p=g.nextSibling,E=K.nextSibling;return K.$$click=()=>s(a().recommended),f(p,()=>a().recommended==="left"&&"左对齐",null),f(p,()=>a().recommended==="right"&&"右对齐",null),f(p,()=>a().recommended==="top"&&"顶对齐",null),f(p,()=>a().recommended==="bottom"&&"底对齐",null),f(p,()=>a().recommended==="h_center"&&"水平居中",null),f(p,()=>a().recommended==="v_center"&&"垂直居中",null),f(E,()=>a().reason),A(U=>{var L=l(),X=a().reason;return L!==U.e&&(K.disabled=U.e=L),X!==U.t&&$(K,"title",U.t=X),U},{e:void 0,t:void 0}),b}}),null),f(v,y(xe,{get when(){return!n()},get children(){var b=Sl(),P=b.firstChild;return P.firstChild,f(P,()=>e.selectedElementIds().length<3&&"，至少3个元素以使用分布功能",null),b}}),null),f(v,y(xe,{get when(){return l()},get children(){return Cl()}}),null),A(b=>{var P=!n()||l(),K=!n()||l(),g=!n()||l(),p=!n()||l(),E=!n()||l(),U=!n()||l(),L=e.selectedElementIds().length<3||l(),X=e.selectedElementIds().length<3||l();return P!==b.e&&(S.disabled=b.e=P),K!==b.t&&(z.disabled=b.t=K),g!==b.a&&(T.disabled=b.a=g),p!==b.o&&(O.disabled=b.o=p),E!==b.i&&(B.disabled=b.i=E),U!==b.n&&(I.disabled=b.n=U),L!==b.s&&(D.disabled=b.s=L),X!==b.h&&(M.disabled=b.h=X),b},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),v})()},Al=`
.alignment-toolbar {
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding: 16px;
  background: #f8f9fa;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  min-width: 280px;
}

.toolbar-section {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.section-title {
  font-size: 12px;
  font-weight: 600;
  color: #6b7280;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.button-group {
  display: flex;
  gap: 4px;
}

.align-button {
  width: 36px;
  height: 36px;
  border: 1px solid #d1d5db;
  background: white;
  border-radius: 6px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  position: relative;
}

.align-button:hover:not(:disabled) {
  background: #f3f4f6;
  border-color: #9ca3af;
  transform: translateY(-1px);
}

.align-button:active:not(:disabled) {
  transform: translateY(0);
  background: #e5e7eb;
}

.align-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.align-icon {
  position: relative;
  width: 20px;
  height: 16px;
}

.align-icon.vertical {
  width: 16px;
  height: 20px;
}

.line {
  position: absolute;
  background: #3b82f6;
  z-index: 2;
}

.left-line, .right-line, .center-line {
  width: 2px;
  height: 16px;
  top: 0;
}

.left-line { left: 2px; }
.right-line { right: 2px; }
.center-line { left: 9px; }

.top-line, .bottom-line, .v-center-line {
  height: 2px;
  width: 16px;
  left: 0;
}

.top-line { top: 2px; }
.bottom-line { bottom: 2px; }
.v-center-line { top: 9px; }

.shapes {
  display: flex;
  gap: 2px;
  align-items: flex-start;
}

.shapes.vertical {
  flex-direction: column;
  height: 100%;
  align-items: flex-start;
}

.shapes.distribute {
  align-items: center;
  justify-content: space-between;
  width: 100%;
}

.shapes.distribute.vertical {
  height: 100%;
  width: auto;
}

.shape {
  width: 4px;
  height: 6px;
  background: #6b7280;
  border-radius: 1px;
}

.shapes.vertical .shape {
  width: 6px;
  height: 4px;
}

.spacer {
  width: 2px;
  height: 1px;
  background: #d1d5db;
}

.shapes.distribute.vertical .spacer {
  width: 1px;
  height: 2px;
}

.smart-align-button {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  background: #3b82f6;
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.smart-align-button:hover:not(:disabled) {
  background: #2563eb;
  transform: translateY(-1px);
}

.smart-align-button:disabled {
  opacity: 0.7;
  cursor: not-allowed;
}

.smart-icon {
  font-size: 16px;
}

.smart-text {
  font-size: 14px;
  font-weight: 500;
}

.smart-reason {
  font-size: 11px;
  color: #6b7280;
  font-style: italic;
  margin-top: 4px;
}

.toolbar-status {
  padding: 8px;
  border-radius: 4px;
  background: #f3f4f6;
  border: 1px solid #d1d5db;
}

.status-text {
  font-size: 12px;
  color: #6b7280;
  text-align: center;
}

.status-text.aligning {
  color: #3b82f6;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.spinner {
  width: 12px;
  height: 12px;
  border: 2px solid #e5e7eb;
  border-top: 2px solid #3b82f6;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

.preview-info {
  padding: 6px 8px;
  background: #eff6ff;
  border: 1px solid #bfdbfe;
  border-radius: 4px;
}

.preview-text {
  font-size: 11px;
  color: #1d4ed8;
  text-align: center;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
`;if(typeof document<"u"){const e=document.createElement("style");e.textContent=Al,document.head.appendChild(e)}Se(["click"]);var Il=k("<div>"),Ul=k('<div class="flex-1 flex flex-col overflow-hidden"><div class="h-12 bg-primary border-b border-default flex items-center px-4"><div class="text-sm text-secondary">Canvas: <!> × <!>px<span class="ml-4 px-2 py-1 bg-blue-100 rounded text-xs">元素: <!> | 选中: </span></div></div><div class="flex-1 overflow-auto custom-scrollbar bg-tertiary p-4"><div class="flex items-center justify-center min-h-full"><div class="bg-canvas-bg shadow-lg rounded-lg overflow-hidden"><svg class=block><rect></rect><rect fill=none stroke=var(--color-border) stroke-width=1></rect><g class=elements-layer></g><g class=resize-handles-layer>'),Ll=k("<span class=ml-2>Zoom: <!>%"),wt=k("<svg><text dominant-baseline=hanging></svg>",!1,!0,!1),Dl=k("<svg><tspan></svg>",!1,!0,!1),Ml=k("<svg><rect x=0 y=0></svg>",!1,!0,!1),Tl=k("<svg><line x1=0></svg>",!1,!0,!1),Rl=k('<svg><rect x=0 y=0 fill="rgba(59, 130, 246, 0.1)"stroke="rgba(59, 130, 246, 0.3)"stroke-width=1 stroke-dasharray=2,2></svg>',!1,!0,!1),Fl=k("<svg><rect x=0 y=0 fill=#f0f0f0 stroke=#ccc stroke-width=1 stroke-dasharray=5,5></svg>",!1,!0,!1),Ol=k("<svg><g></svg>",!1,!0,!1);const Nl=()=>{const{state:e,selectElement:t,clearSelection:o,createElement:l,selectMultiple:i,updateElement:n,batchUpdatePositions:r}=we();let s;const[d,a]=J([]),v=ie(()=>e.elements.filter(C=>C.visible)),h=(C,O)=>{if(!s)return{x:0,y:0};const B=s.getBoundingClientRect(),I=(C-B.left)/e.canvas_config.zoom,W=(O-B.top)/e.canvas_config.zoom;return{x:I,y:W}},w=async C=>{console.log("🎯 选择元素",C),a([...C]);try{C.length===0?await o():C.length===1?await t(C[0]):await i([...C])}catch(O){console.error("❌ 选择元素失败:",O)}},R=async C=>{try{await r(C)}catch(O){console.error("❌ 批量更新位置失败:",O)}},S=async(C,O)=>{try{await n(C,{position:{x:O.x,y:O.y}})}catch(B){console.error("❌ 移动元素失败:",B)}},z=async(C,O,B)=>{try{await n(C,{size:O,position:B})}catch(I){console.error("❌ 调整大小失败:",I)}},T=async C=>{console.log("🖱️ 画布点击",C)},V=async C=>{var O;C.preventDefault();try{const B=(O=C.dataTransfer)==null?void 0:O.getData("application/json");if(!B)return;const{type:I,component:W}=JSON.parse(B);if(I==="component"){const{x:Y,y:Q}=h(C.clientX,C.clientY),D=Math.max(0,Y-W.default_size.width/2),M=Math.max(0,Q-W.default_size.height/2);console.log("🎯 通过拖放创建组件:",W.name,"at",D,M);const b=await l(W.id,{x:D,y:M},W.default_size,W.create_content());console.log("✅ 通过拖放创建元素成功:",b),a([b]),await t(b)}}catch(B){console.error("拖放处理失败:",B)}};He(()=>{a([...e.selected_ids])}),ie(()=>{a([...e.selected_ids])});const F=ie(()=>{const{width:C,height:O}=e.canvas_config;return`0 0 ${C} ${O}`});return(()=>{var C=Ul(),O=C.firstChild,B=O.firstChild,I=B.firstChild,W=I.nextSibling,Y=W.nextSibling,Q=Y.nextSibling,D=Q.nextSibling,M=D.nextSibling,b=M.firstChild,P=b.nextSibling;P.nextSibling;var K=O.nextSibling,g=K.firstChild,p=g.firstChild,E=p.firstChild,U=E.firstChild,L=U.nextSibling,X=L.nextSibling,fe=X.nextSibling;f(B,()=>e.canvas_config.width,W),f(B,()=>e.canvas_config.height,Q),f(B,(()=>{var N=ue(()=>e.canvas_config.zoom!==1);return()=>N()&&(()=>{var re=Ll(),de=re.firstChild,he=de.nextSibling;return he.nextSibling,f(re,()=>Math.round(e.canvas_config.zoom*100),he),re})()})(),M),f(M,()=>e.elements.length,P),f(M,()=>d().length,null),p.style.setProperty("position","relative"),E.addEventListener("drop",V),E.addEventListener("dragover",N=>{N.preventDefault(),N.dataTransfer.dropEffect="copy"}),E.$$contextmenu=N=>N.preventDefault();var se=s;return typeof se=="function"?It(se,E):s=E,f(E,y(hl,{get config(){return e.canvas_config}}),L),f(X,y(ze,{get each(){return v()},children:N=>y(jl,{element:N,get selected(){return d().includes(N.id)}})})),f(fe,y(ze,{get each(){return v().filter(N=>d().includes(N.id))},children:N=>y(yl,{element:N})})),f(p,y($l,{canvasRef:s,getAllElements:()=>[...e.elements],onElementsSelect:w,onElementMove:S,onBatchUpdatePositions:R,onElementResize:z,onCanvasClick:T,get enableDebugMode(){return!1}}),null),f(p,y(xe,{get when(){return d().length>=2},get children(){var N=Il();return N.style.setProperty("position","fixed"),N.style.setProperty("top","80px"),N.style.setProperty("right","20px"),N.style.setProperty("z-index","1000"),N.style.setProperty("background","white"),N.style.setProperty("border-radius","8px"),N.style.setProperty("box-shadow","0 4px 12px rgba(0, 0, 0, 0.15)"),N.style.setProperty("border","1px solid #e5e7eb"),f(N,y(Pl,{selectedElementIds:d,onAlignmentComplete:re=>{console.log("✅ 对齐操作完成:",re)},onAlignmentPreview:re=>{console.log("👁️ 对齐预览:",re)},onPreviewCancel:()=>{console.log("❌ 取消对齐预览")}})),N}}),null),A(N=>{var re=e.canvas_config.width*e.canvas_config.zoom,de=e.canvas_config.height*e.canvas_config.zoom,he=F(),ge=e.canvas_config.width,Ce=e.canvas_config.height,_e=e.canvas_config.background_color,Ke=e.canvas_config.width,Ve=e.canvas_config.height;return re!==N.e&&$(E,"width",N.e=re),de!==N.t&&$(E,"height",N.t=de),he!==N.a&&$(E,"viewBox",N.a=he),ge!==N.o&&$(U,"width",N.o=ge),Ce!==N.i&&$(U,"height",N.i=Ce),_e!==N.n&&$(U,"fill",N.n=_e),Ke!==N.s&&$(L,"width",N.s=Ke),Ve!==N.h&&$(L,"height",N.h=Ve),N},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),C})()},jl=e=>{const t=ie(()=>{const{position:l}=e.element;return{transform:`translate(${l.x}px, ${l.y}px)`,opacity:e.element.visible?1:.5}}),o=()=>{const{content:l,size:i}=e.element;if(l.type==="Text"&&l.content&&l.style){const n=l.style.align,r=n==="Center"?"middle":n==="Right"?"end":"start",s=n==="Center"?i.width/2:n==="Right"?i.width:0;return(()=>{var d=wt();return $(d,"x",s),$(d,"text-anchor",r),f(d,()=>l.content.split(`
`).map((a,v)=>(()=>{var h=Dl();return $(h,"x",s),f(h,a),A(()=>$(h,"dy",v===0?0:l.style.font_size*1.2)),h})())),A(a=>{var v=l.style.font_size*.75,h=l.style.font_family,w=`${l.style.font_size}`,R=l.style.font_weight,S=l.style.color;return v!==a.e&&$(d,"y",a.e=v),h!==a.t&&$(d,"font-family",a.t=h),w!==a.a&&$(d,"font-size",a.a=w),R!==a.o&&$(d,"font-weight",a.o=R),S!==a.i&&$(d,"fill",a.i=S),a},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),d})()}if(l.type==="Rectangle"){const n=l.opacity!==void 0?l.opacity:1,r=l.corner_radius||0;return(()=>{var s=Ml();return $(s,"rx",r),$(s,"ry",r),$(s,"fill-opacity",n),$(s,"stroke-opacity",n),A(d=>{var z,T,V,F;var a=i.width,v=i.height,h=l.fill_color||"transparent",w=((z=l.border)==null?void 0:z.color)||"#000000",R=((T=l.border)==null?void 0:T.width)||1,S=((V=l.border)==null?void 0:V.style)==="Dashed"?"5,5":((F=l.border)==null?void 0:F.style)==="Dotted"?"2,2":"none";return a!==d.e&&$(s,"width",d.e=a),v!==d.t&&$(s,"height",d.t=v),h!==d.a&&$(s,"fill",d.a=h),w!==d.o&&$(s,"stroke",d.o=w),R!==d.i&&$(s,"stroke-width",d.i=R),S!==d.n&&$(s,"stroke-dasharray",d.n=S),d},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),s})()}if(l.type==="Line"){const n=l.opacity!==void 0?l.opacity:1,r=l.line_style||"Solid",s=r==="Dashed"?"8,4":r==="Dotted"?"2,2":r==="DashDot"?"8,4,2,4":"none";return(()=>{var d=Tl();return $(d,"stroke-opacity",n),$(d,"stroke-dasharray",s),A(a=>{var v=i.height/2,h=i.width,w=i.height/2,R=l.color,S=l.width;return v!==a.e&&$(d,"y1",a.e=v),h!==a.t&&$(d,"x2",a.t=h),w!==a.a&&$(d,"y2",a.a=w),R!==a.o&&$(d,"stroke",a.o=R),S!==a.i&&$(d,"stroke-width",a.i=S),a},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),d})()}return l.type==="DataField"&&l.style?[(()=>{var n=Rl();return A(r=>{var s=i.width,d=i.height;return s!==r.e&&$(n,"width",r.e=s),d!==r.t&&$(n,"height",r.t=d),r},{e:void 0,t:void 0}),n})(),(()=>{var n=wt();return f(n,()=>l.expression||"[数据字段]"),A(r=>{var s=l.style.align==="Center"?i.width/2:l.style.align==="Right"?i.width-4:4,d=l.style.font_size*.8,a=l.style.font_family,v=`${l.style.font_size}`,h=l.style.font_weight,w=l.style.color,R=l.style.align==="Center"?"middle":l.style.align==="Right"?"end":"start";return s!==r.e&&$(n,"x",r.e=s),d!==r.t&&$(n,"y",r.t=d),a!==r.a&&$(n,"font-family",r.a=a),v!==r.o&&$(n,"font-size",r.o=v),h!==r.i&&$(n,"font-weight",r.i=h),w!==r.n&&$(n,"fill",r.n=w),R!==r.s&&$(n,"text-anchor",r.s=R),r},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),n})()]:(()=>{var n=Fl();return A(r=>{var s=i.width,d=i.height;return s!==r.e&&$(n,"width",r.e=s),d!==r.t&&$(n,"height",r.t=d),r},{e:void 0,t:void 0}),n})()};return(()=>{var l=Ol();return f(l,o),A(i=>{var n=`element ${e.selected?"element-selected":""}`,r=t(),s=e.element.id,d=e.element.content.type;return n!==i.e&&$(l,"class",i.e=n),i.t=gn(l,r,i.t),s!==i.a&&$(l,"data-element-id",i.a=s),d!==i.o&&$(l,"data-element-type",i.o=d),i},{e:void 0,t:void 0,a:void 0,o:void 0}),l})()};Se(["contextmenu"]);var Bl=k('<button class="fixed top-20 right-4 z-50 bg-yellow-500 hover:bg-yellow-600 text-white px-3 py-2 rounded-lg shadow-lg text-sm font-medium"title=开启/关闭测试面板>🧪 测试'),Hl=k('<div class="fixed top-16 right-4 z-40 bg-white rounded-lg shadow-xl border border-gray-200 p-4 w-80 max-h-96 overflow-y-auto"><div class="flex items-center justify-between mb-4"><h3 class="text-lg font-semibold text-gray-800">🧪 测试面板</h3><button class="text-gray-500 hover:text-gray-700">✕</button></div><div class="mb-4 p-3 bg-gray-50 rounded-lg"><div class="text-sm text-gray-600"><div>元素总数: <span class=font-medium></span></div><div>已选择: <span class=font-medium></span></div><div>可撤销: <span class=font-medium></span></div><div>可重做: <span class=font-medium></span></div></div></div><div class="space-y-2 mb-4"><button class="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 px-3 rounded text-sm">🚀 运行所有测试</button><button class="w-full bg-red-500 hover:bg-red-600 text-white py-2 px-3 rounded text-sm">🧹 清理元素</button></div><div class=space-y-2><h4 class="text-sm font-medium text-gray-700 mb-2">单独测试:</h4></div><div class=mt-4><h4 class="text-sm font-medium text-gray-700 mb-2">当前元素:</h4><div class="max-h-32 overflow-y-auto">'),Gl=k('<button class="w-full bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 px-3 rounded text-sm text-left">'),Kl=k('<div><div class=font-medium></div><div class="text-gray-500 truncate">ID: <!>...</div><div class=text-gray-500>位置: (<!>, <!>)'),Vl=k('<div class="text-xs text-gray-500 p-2">暂无元素');const ql=()=>{const{state:e,createElement:t,selectElement:o,clearSelection:l}=we(),[i,n]=J(!1),r=[{name:"创建文字元素",action:async()=>{const v=await t("text",{x:100,y:100},{width:100,height:24},{type:"Text",content:"测试文字",style:{font_family:"SimSun",font_size:14,font_weight:"normal",color:"#000000",align:"Left"}});return console.log("✅ 测试文字元素创建成功:",v),v}},{name:"创建矩形元素",action:async()=>{const v=await t("rectangle",{x:250,y:100},{width:100,height:60},{type:"Rectangle",fill_color:"rgba(59, 130, 246, 0.2)",border:{color:"#3b82f6",width:2,style:"Solid"}});return console.log("✅ 测试矩形元素创建成功:",v),v}},{name:"创建线条元素",action:async()=>{const v=await t("line",{x:400,y:130},{width:150,height:2},{type:"Line",color:"#ef4444",width:3});return console.log("✅ 测试线条元素创建成功:",v),v}},{name:"创建数据字段",action:async()=>{const v=await t("data_field",{x:100,y:200},{width:120,height:24},{type:"DataField",expression:"${测试数据}",format:void 0,style:{font_family:"SimSun",font_size:12,font_weight:"bold",color:"#059669",align:"Left"}});return console.log("✅ 测试数据字段创建成功:",v),v}}],s=async v=>{try{console.log(`🧪 开始测试: ${v.name}`);const h=await v.action();await o(h),console.log(`✅ 测试完成: ${v.name}, 元素ID: ${h}`)}catch(h){console.error(`❌ 测试失败: ${v.name}`,h)}},d=async()=>{console.log("🚀 开始运行所有测试案例..."),await l();for(const v of r)await s(v),await new Promise(h=>setTimeout(h,500));console.log("🎉 所有测试案例运行完成!")},a=async()=>{try{console.log("🧹 清理所有测试元素..."),await l(),console.log("✅ 清理完成")}catch(v){console.error("❌ 清理失败:",v)}};return[(()=>{var v=Bl();return v.$$click=()=>n(!i()),v})(),ue(()=>ue(()=>!!i())()&&(()=>{var v=Hl(),h=v.firstChild,w=h.firstChild,R=w.nextSibling,S=h.nextSibling,z=S.firstChild,T=z.firstChild,V=T.firstChild,F=V.nextSibling,C=T.nextSibling,O=C.firstChild,B=O.nextSibling,I=C.nextSibling,W=I.firstChild,Y=W.nextSibling,Q=I.nextSibling,D=Q.firstChild,M=D.nextSibling,b=S.nextSibling,P=b.firstChild,K=P.nextSibling,g=b.nextSibling;g.firstChild;var p=g.nextSibling,E=p.firstChild,U=E.nextSibling;return R.$$click=()=>n(!1),f(F,()=>e.elements.length),f(B,()=>e.selected_ids.length),f(Y,()=>e.can_undo?"是":"否"),f(M,()=>e.can_redo?"是":"否"),P.$$click=d,K.$$click=a,f(g,y(ze,{each:r,children:L=>(()=>{var X=Gl();return X.$$click=()=>s(L),f(X,()=>L.name),X})()}),null),f(U,y(ze,{get each(){return e.elements},children:L=>(()=>{var X=Kl(),fe=X.firstChild,se=fe.nextSibling,N=se.firstChild,re=N.nextSibling;re.nextSibling;var de=se.nextSibling,he=de.firstChild,ge=he.nextSibling,Ce=ge.nextSibling,_e=Ce.nextSibling;return _e.nextSibling,X.$$click=()=>o(L.id),f(fe,()=>L.content.type),f(se,()=>L.id.slice(0,8),re),f(de,()=>Math.round(L.position.x),ge),f(de,()=>Math.round(L.position.y),_e),A(()=>Ue(X,`text-xs p-2 mb-1 rounded cursor-pointer ${e.selected_ids.includes(L.id)?"bg-blue-100 border border-blue-300":"bg-gray-50 hover:bg-gray-100"}`)),X})()}),null),f(U,(()=>{var L=ue(()=>e.elements.length===0);return()=>L()&&Vl()})(),null),v})())]};Se(["click"]);var Yl=k('<div class="h-full flex flex-col bg-secondary"><div class="flex-1 flex overflow-hidden"><div class="w-80 bg-primary border-r border-default flex flex-col"></div><div class="flex-1 flex flex-col bg-tertiary"></div><div class="w-80 bg-primary border-l border-default flex flex-col">');const Xl=()=>(()=>{var e=Yl(),t=e.firstChild,o=t.firstChild,l=o.nextSibling,i=l.nextSibling;return f(e,y(En,{}),t),f(o,y(An,{})),f(l,y(Nl,{})),f(i,y(il,{})),f(e,y(ql,{}),null),e})(),Wl={copy:{action:"copy",combination:{key:"c",ctrl:!0}},paste:{action:"paste",combination:{key:"v",ctrl:!0}},cut:{action:"cut",combination:{key:"x",ctrl:!0}},delete:{action:"delete",combination:{key:"Delete"}},deleteAlt:{action:"delete",combination:{key:"Backspace"}},undo:{action:"undo",combination:{key:"z",ctrl:!0}},redo:{action:"redo",combination:{key:"y",ctrl:!0}},redoAlt:{action:"redo",combination:{key:"z",ctrl:!0,shift:!0}},selectAll:{action:"selectAll",combination:{key:"a",ctrl:!0}},clearSelection:{action:"clearSelection",combination:{key:"Escape"}},duplicate:{action:"duplicate",combination:{key:"d",ctrl:!0}},moveUp:{action:"moveUp",combination:{key:"ArrowUp"}},moveDown:{action:"moveDown",combination:{key:"ArrowDown"}},moveLeft:{action:"moveLeft",combination:{key:"ArrowLeft"}},moveRight:{action:"moveRight",combination:{key:"ArrowRight"}},moveFastUp:{action:"moveFastUp",combination:{key:"ArrowUp",shift:!0}},moveFastDown:{action:"moveFastDown",combination:{key:"ArrowDown",shift:!0}},moveFastLeft:{action:"moveFastLeft",combination:{key:"ArrowLeft",shift:!0}},moveFastRight:{action:"moveFastRight",combination:{key:"ArrowRight",shift:!0}}},Zl=()=>{const{state:e,copySelectedElements:t,pasteElements:o,deleteElements:l,undo:i,redo:n,selectAllElements:r,clearSelection:s,moveElements:d}=we(),a=(S,z)=>{const T=S.key.toLowerCase()===z.key.toLowerCase()||S.key===z.key,V=!!z.ctrl===(S.ctrlKey||S.metaKey),F=!!z.alt===S.altKey,C=!!z.shift===S.shiftKey;return T&&V&&F&&C},v=async S=>{console.log("🎯 执行快捷键:",S);try{switch(S){case"copy":e.selected_ids.length>0&&(await t(),w("复制成功","✅"));break;case"paste":const z={x:20,y:20},T=await o(z.x,z.y);T.length>0&&w(`粘贴 ${T.length} 个元素`,"📋");break;case"cut":e.selected_ids.length>0&&(await t(),await l([...e.selected_ids]),w("剪切成功","✂️"));break;case"delete":if(e.selected_ids.length>0){const V=e.selected_ids.length;await l([...e.selected_ids]),w(`删除 ${V} 个元素`,"🗑️")}break;case"undo":await i(),w("撤销","↶");break;case"redo":await n(),w("重做","↷");break;case"selectAll":await r(),w(`全选 ${e.elements.length} 个元素`,"🎯");break;case"clearSelection":e.selected_ids.length>0&&(s(),w("清除选择","⭕"));break;case"duplicate":if(e.selected_ids.length>0){await t();const V=await o(20,20);w(`复制 ${V.length} 个元素`,"📄")}break;case"moveUp":case"moveDown":case"moveLeft":case"moveRight":case"moveFastUp":case"moveFastDown":case"moveFastLeft":case"moveFastRight":await h(S);break;default:console.warn("未知的快捷键动作:",S)}}catch(z){console.error("快捷键执行失败:",z),w("操作失败","❌")}},h=async S=>{if(e.selected_ids.length===0)return;const z=S.includes("Fast"),T=z?10:1;let V=0,F=0;switch(S){case"moveUp":case"moveFastUp":F=-T;break;case"moveDown":case"moveFastDown":F=T;break;case"moveLeft":case"moveFastLeft":V=-T;break;case"moveRight":case"moveFastRight":V=T;break}(V!==0||F!==0)&&(await d([...e.selected_ids],V,F),z&&w(`快速移动 ${T}px`,"🔄"))},w=(S,z)=>{const T=document.createElement("div");T.className="keyboard-feedback",T.innerHTML=`
      <div class="feedback-content">
        <span class="feedback-icon">${z}</span>
        <span class="feedback-text">${S}</span>
      </div>
    `,document.body.appendChild(T),setTimeout(()=>{T.parentNode&&T.parentNode.removeChild(T)},2e3)},R=S=>{const z=S.target;if(!(z.tagName==="INPUT"||z.tagName==="TEXTAREA"||z.contentEditable==="true")){for(const[V,F]of Object.entries(Wl))if(a(S,F.combination)){S.preventDefault(),S.stopPropagation(),console.log("🎹 快捷键触发:",V,F.action),v(F.action);return}}};return He(()=>{if(document.addEventListener("keydown",R,!0),console.log("🎹 键盘快捷键管理器已启动"),!document.getElementById("keyboard-feedback-styles")){const S=document.createElement("style");S.id="keyboard-feedback-styles",S.textContent=`
        .keyboard-feedback {
          position: fixed;
          top: 20px;
          right: 20px;
          background: rgba(0, 0, 0, 0.8);
          color: white;
          padding: 12px 16px;
          border-radius: 8px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
          z-index: 10000;
          animation: slideInRight 0.3s ease-out, fadeOut 0.3s ease-out 1.7s;
          pointer-events: none;
        }

        .feedback-content {
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .feedback-icon {
          font-size: 16px;
        }

        .feedback-text {
          font-size: 14px;
          font-weight: 500;
        }

        @keyframes slideInRight {
          from {
            transform: translateX(100%);
            opacity: 0;
          }
          to {
            transform: translateX(0);
            opacity: 1;
          }
        }

        @keyframes fadeOut {
          from {
            opacity: 1;
          }
          to {
            opacity: 0;
          }
        }
      `,document.head.appendChild(S)}}),it(()=>{document.removeEventListener("keydown",R,!0),console.log("🎹 键盘快捷键管理器已停止")}),null},Jl=()=>(He(()=>{document.addEventListener("contextmenu",e=>e.preventDefault())}),y(_n,{get children(){return[y(Zl,{}),y(Xl,{})]}})),Ql=document.getElementById("root");hn(()=>y(Jl,{}),Ql);
