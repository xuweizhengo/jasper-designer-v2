(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const r of l.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function i(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(n){if(n.ep)return;n.ep=!0;const l=i(n);fetch(n.href,l)}})();const Kt=!1,Wt=(e,t)=>e===t,$e=Symbol("solid-proxy"),it=Symbol("solid-track"),qe={equals:Wt};let _t=Et;const me=1,Ke=2,$t={owned:null,cleanups:null,context:null,owner:null};var Z=null;let lt=null,Zt=null,te=null,re=null,ge=null,tt=0;function Ve(e,t){const i=te,o=Z,n=e.length===0,l=t===void 0?o:t,r=n?$t:{owned:null,cleanups:null,context:l?l.context:null,owner:l},s=n?e:()=>e(()=>de(()=>Fe(r)));Z=r,te=null;try{return De(s,!0)}finally{te=i,Z=o}}function Q(e,t){t=t?Object.assign({},qe,t):qe;const i={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},o=n=>(typeof n=="function"&&(n=n(i.value)),kt(i,n));return[Ct.bind(i),o]}function k(e,t,i){const o=ft(e,t,!1,me);Be(o)}function Jt(e,t,i){_t=nn;const o=ft(e,t,!1,me);o.user=!0,ge?ge.push(o):Be(o)}function ie(e,t,i){i=i?Object.assign({},qe,i):qe;const o=ft(e,t,!0,0);return o.observers=null,o.observerSlots=null,o.comparator=i.equals||void 0,Be(o),Ct.bind(o)}function Qt(e){return De(e,!1)}function de(e){if(te===null)return e();const t=te;te=null;try{return e()}finally{te=t}}function nt(e){Jt(()=>de(e))}function ut(e){return Z===null||(Z.cleanups===null?Z.cleanups=[e]:Z.cleanups.push(e)),e}function rt(){return te}function Yt(e,t){const i=Symbol("context");return{id:i,Provider:on(i),defaultValue:e}}function Xt(e){let t;return Z&&Z.context&&(t=Z.context[e.id])!==void 0?t:e.defaultValue}function St(e){const t=ie(e),i=ie(()=>st(t()));return i.toArray=()=>{const o=i();return Array.isArray(o)?o:o!=null?[o]:[]},i}function Ct(){if(this.sources&&this.state)if(this.state===me)Be(this);else{const e=re;re=null,De(()=>Ze(this),!1),re=e}if(te){const e=this.observers?this.observers.length:0;te.sources?(te.sources.push(this),te.sourceSlots.push(e)):(te.sources=[this],te.sourceSlots=[e]),this.observers?(this.observers.push(te),this.observerSlots.push(te.sources.length-1)):(this.observers=[te],this.observerSlots=[te.sources.length-1])}return this.value}function kt(e,t,i){let o=e.value;return(!e.comparator||!e.comparator(o,t))&&(e.value=t,e.observers&&e.observers.length&&De(()=>{for(let n=0;n<e.observers.length;n+=1){const l=e.observers[n],r=lt&&lt.running;r&&lt.disposed.has(l),(r?!l.tState:!l.state)&&(l.pure?re.push(l):ge.push(l),l.observers&&zt(l)),r||(l.state=me)}if(re.length>1e6)throw re=[],new Error},!1)),t}function Be(e){if(!e.fn)return;Fe(e);const t=tt;en(e,e.value,t)}function en(e,t,i){let o;const n=Z,l=te;te=Z=e;try{o=e.fn(t)}catch(r){return e.pure&&(e.state=me,e.owned&&e.owned.forEach(Fe),e.owned=null),e.updatedAt=i+1,Pt(r)}finally{te=l,Z=n}(!e.updatedAt||e.updatedAt<=i)&&(e.updatedAt!=null&&"observers"in e?kt(e,o):e.value=o,e.updatedAt=i)}function ft(e,t,i,o=me,n){const l={fn:e,state:o,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:Z,context:Z?Z.context:null,pure:i};return Z===null||Z!==$t&&(Z.owned?Z.owned.push(l):Z.owned=[l]),l}function We(e){if(e.state===0)return;if(e.state===Ke)return Ze(e);if(e.suspense&&de(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<tt);)e.state&&t.push(e);for(let i=t.length-1;i>=0;i--)if(e=t[i],e.state===me)Be(e);else if(e.state===Ke){const o=re;re=null,De(()=>Ze(e,t[0]),!1),re=o}}function De(e,t){if(re)return e();let i=!1;t||(re=[]),ge?i=!0:ge=[],tt++;try{const o=e();return tn(i),o}catch(o){i||(ge=null),re=null,Pt(o)}}function tn(e){if(re&&(Et(re),re=null),e)return;const t=ge;ge=null,t.length&&De(()=>_t(t),!1)}function Et(e){for(let t=0;t<e.length;t++)We(e[t])}function nn(e){let t,i=0;for(t=0;t<e.length;t++){const o=e[t];o.user?e[i++]=o:We(o)}for(t=0;t<i;t++)We(e[t])}function Ze(e,t){e.state=0;for(let i=0;i<e.sources.length;i+=1){const o=e.sources[i];if(o.sources){const n=o.state;n===me?o!==t&&(!o.updatedAt||o.updatedAt<tt)&&We(o):n===Ke&&Ze(o,t)}}}function zt(e){for(let t=0;t<e.observers.length;t+=1){const i=e.observers[t];i.state||(i.state=Ke,i.pure?re.push(i):ge.push(i),i.observers&&zt(i))}}function Fe(e){let t;if(e.sources)for(;e.sources.length;){const i=e.sources.pop(),o=e.sourceSlots.pop(),n=i.observers;if(n&&n.length){const l=n.pop(),r=i.observerSlots.pop();o<n.length&&(l.sourceSlots[r]=o,n[o]=l,i.observerSlots[o]=r)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)Fe(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)Fe(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function ln(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function Pt(e,t=Z){throw ln(e)}function st(e){if(typeof e=="function"&&!e.length)return st(e());if(Array.isArray(e)){const t=[];for(let i=0;i<e.length;i++){const o=st(e[i]);Array.isArray(o)?t.push.apply(t,o):t.push(o)}return t}return e}function on(e,t){return function(o){let n;return k(()=>n=de(()=>(Z.context={...Z.context,[e]:o.value},St(()=>o.children))),void 0),n}}const rn=Symbol("fallback");function vt(e){for(let t=0;t<e.length;t++)e[t]()}function sn(e,t,i={}){let o=[],n=[],l=[],r=0,s=t.length>1?[]:null;return ut(()=>vt(l)),()=>{let c=e()||[],a=c.length,v,g;return c[it],de(()=>{let I,R,z,K,M,D,L,V,B;if(a===0)r!==0&&(vt(l),l=[],o=[],n=[],r=0,s&&(s=[])),i.fallback&&(o=[rn],n[0]=Ve(ne=>(l[0]=ne,i.fallback())),r=1);else if(r===0){for(n=new Array(a),g=0;g<a;g++)o[g]=c[g],n[g]=Ve(C);r=a}else{for(z=new Array(a),K=new Array(a),s&&(M=new Array(a)),D=0,L=Math.min(r,a);D<L&&o[D]===c[D];D++);for(L=r-1,V=a-1;L>=D&&V>=D&&o[L]===c[V];L--,V--)z[V]=n[L],K[V]=l[L],s&&(M[V]=s[L]);for(I=new Map,R=new Array(V+1),g=V;g>=D;g--)B=c[g],v=I.get(B),R[g]=v===void 0?-1:v,I.set(B,g);for(v=D;v<=L;v++)B=o[v],g=I.get(B),g!==void 0&&g!==-1?(z[g]=n[v],K[g]=l[v],s&&(M[g]=s[v]),g=R[g],I.set(B,g)):l[v]();for(g=D;g<a;g++)g in z?(n[g]=z[g],l[g]=K[g],s&&(s[g]=M[g],s[g](g))):n[g]=Ve(C);n=n.slice(0,r=a),o=c.slice(0)}return n});function C(I){if(l[g]=I,s){const[R,z]=Q(g);return s[g]=z,t(c[g],R)}return t(c[g])}}}function y(e,t){return de(()=>e(t||{}))}const At=e=>`Stale read from <${e}>.`;function _e(e){const t="fallback"in e&&{fallback:()=>e.fallback};return ie(sn(()=>e.each,e.children,t||void 0))}function Oe(e){const t=e.keyed,i=ie(()=>e.when,void 0,void 0),o=t?i:ie(i,void 0,{equals:(n,l)=>!n==!l});return ie(()=>{const n=o();if(n){const l=e.children;return typeof l=="function"&&l.length>0?de(()=>l(t?n:()=>{if(!de(o))throw At("Show");return i()})):l}return e.fallback},void 0,void 0)}function an(e){const t=St(()=>e.children),i=ie(()=>{const o=t(),n=Array.isArray(o)?o:[o];let l=()=>{};for(let r=0;r<n.length;r++){const s=r,c=n[r],a=l,v=ie(()=>a()?void 0:c.when,void 0,void 0),g=c.keyed?v:ie(v,void 0,{equals:(C,I)=>!C==!I});l=()=>a()||(g()?[s,v,c]:void 0)}return l});return ie(()=>{const o=i()();if(!o)return e.fallback;const[n,l,r]=o,s=r.children;return typeof s=="function"&&s.length>0?de(()=>s(r.keyed?l():()=>{var a;if(((a=de(i)())==null?void 0:a[0])!==n)throw At("Match");return l()})):s},void 0,void 0)}function Ue(e){return e}const ue=e=>ie(()=>e());function cn(e,t,i){let o=i.length,n=t.length,l=o,r=0,s=0,c=t[n-1].nextSibling,a=null;for(;r<n||s<l;){if(t[r]===i[s]){r++,s++;continue}for(;t[n-1]===i[l-1];)n--,l--;if(n===r){const v=l<o?s?i[s-1].nextSibling:i[l-s]:c;for(;s<l;)e.insertBefore(i[s++],v)}else if(l===s)for(;r<n;)(!a||!a.has(t[r]))&&t[r].remove(),r++;else if(t[r]===i[l-1]&&i[s]===t[n-1]){const v=t[--n].nextSibling;e.insertBefore(i[s++],t[r++].nextSibling),e.insertBefore(i[--l],v),t[n]=i[l]}else{if(!a){a=new Map;let g=s;for(;g<l;)a.set(i[g],g++)}const v=a.get(t[r]);if(v!=null)if(s<v&&v<l){let g=r,C=1,I;for(;++g<n&&g<l&&!((I=a.get(t[g]))==null||I!==v+C);)C++;if(C>v-s){const R=t[r];for(;s<v;)e.insertBefore(i[s++],R)}else e.replaceChild(i[s++],t[r++])}else r++;else t[r++].remove()}}}const yt="_$DX_DELEGATE";function dn(e,t,i,o={}){let n;return Ve(l=>{n=l,t===document?e():f(t,e(),t.firstChild?null:void 0,i)},o.owner),()=>{n(),t.textContent=""}}function $(e,t,i,o){let n;const l=()=>{const s=o?document.createElementNS("http://www.w3.org/1998/Math/MathML","template"):document.createElement("template");return s.innerHTML=e,i?s.content.firstChild.firstChild:o?s.firstChild:s.content.firstChild},r=t?()=>de(()=>document.importNode(n||(n=l()),!0)):()=>(n||(n=l())).cloneNode(!0);return r.cloneNode=r,r}function Se(e,t=window.document){const i=t[yt]||(t[yt]=new Set);for(let o=0,n=e.length;o<n;o++){const l=e[o];i.has(l)||(i.add(l),t.addEventListener(l,fn))}}function x(e,t,i){i==null?e.removeAttribute(t):e.setAttribute(t,i)}function Ae(e,t){t==null?e.removeAttribute("class"):e.className=t}function at(e,t,i,o){Array.isArray(i)?(e[`$$${t}`]=i[0],e[`$$${t}Data`]=i[1]):e[`$$${t}`]=i}function un(e,t,i){if(!t)return i?x(e,"style"):t;const o=e.style;if(typeof t=="string")return o.cssText=t;typeof i=="string"&&(o.cssText=i=void 0),i||(i={}),t||(t={});let n,l;for(l in i)t[l]==null&&o.removeProperty(l),delete i[l];for(l in t)n=t[l],n!==i[l]&&(o.setProperty(l,n),i[l]=n);return i}function Mt(e,t,i){return de(()=>e(t,i))}function f(e,t,i,o){if(i!==void 0&&!o&&(o=[]),typeof t!="function")return Je(e,t,o,i);k(n=>Je(e,t(),n,i),o)}function fn(e){let t=e.target;const i=`$$${e.type}`,o=e.target,n=e.currentTarget,l=c=>Object.defineProperty(e,"target",{configurable:!0,value:c}),r=()=>{const c=t[i];if(c&&!t.disabled){const a=t[`${i}Data`];if(a!==void 0?c.call(t,a,e):c.call(t,e),e.cancelBubble)return}return t.host&&typeof t.host!="string"&&!t.host._$host&&t.contains(e.target)&&l(t.host),!0},s=()=>{for(;r()&&(t=t._$host||t.parentNode||t.host););};if(Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return t||document}}),e.composedPath){const c=e.composedPath();l(c[0]);for(let a=0;a<c.length-2&&(t=c[a],!!r());a++){if(t._$host){t=t._$host,s();break}if(t.parentNode===n)break}}else s();l(o)}function Je(e,t,i,o,n){for(;typeof i=="function";)i=i();if(t===i)return i;const l=typeof t,r=o!==void 0;if(e=r&&i[0]&&i[0].parentNode||e,l==="string"||l==="number"){if(l==="number"&&(t=t.toString(),t===i))return i;if(r){let s=i[0];s&&s.nodeType===3?s.data!==t&&(s.data=t):s=document.createTextNode(t),i=Pe(e,i,o,s)}else i!==""&&typeof i=="string"?i=e.firstChild.data=t:i=e.textContent=t}else if(t==null||l==="boolean")i=Pe(e,i,o);else{if(l==="function")return k(()=>{let s=t();for(;typeof s=="function";)s=s();i=Je(e,s,i,o)}),()=>i;if(Array.isArray(t)){const s=[],c=i&&Array.isArray(i);if(ct(s,t,i,n))return k(()=>i=Je(e,s,i,o,!0)),()=>i;if(s.length===0){if(i=Pe(e,i,o),r)return i}else c?i.length===0?mt(e,s,o):cn(e,i,s):(i&&Pe(e),mt(e,s));i=s}else if(t.nodeType){if(Array.isArray(i)){if(r)return i=Pe(e,i,o,t);Pe(e,i,null,t)}else i==null||i===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);i=t}}return i}function ct(e,t,i,o){let n=!1;for(let l=0,r=t.length;l<r;l++){let s=t[l],c=i&&i[e.length],a;if(!(s==null||s===!0||s===!1))if((a=typeof s)=="object"&&s.nodeType)e.push(s);else if(Array.isArray(s))n=ct(e,s,c)||n;else if(a==="function")if(o){for(;typeof s=="function";)s=s();n=ct(e,Array.isArray(s)?s:[s],Array.isArray(c)?c:[c])||n}else e.push(s),n=!0;else{const v=String(s);c&&c.nodeType===3&&c.data===v?e.push(c):e.push(document.createTextNode(v))}}return n}function mt(e,t,i=null){for(let o=0,n=t.length;o<n;o++)e.insertBefore(t[o],i)}function Pe(e,t,i,o){if(i===void 0)return e.textContent="";const n=o||document.createTextNode("");if(t.length){let l=!1;for(let r=t.length-1;r>=0;r--){const s=t[r];if(n!==s){const c=s.parentNode===e;!l&&!r?c?e.replaceChild(n,s):e.insertBefore(n,i):c&&s.remove()}else l=!0}}else e.insertBefore(n,i);return[n]}const dt=Symbol("store-raw"),Me=Symbol("store-node"),he=Symbol("store-has"),Dt=Symbol("store-self");function It(e){let t=e[$e];if(!t&&(Object.defineProperty(e,$e,{value:t=new Proxy(e,vn)}),!Array.isArray(e))){const i=Object.keys(e),o=Object.getOwnPropertyDescriptors(e);for(let n=0,l=i.length;n<l;n++){const r=i[n];o[r].get&&Object.defineProperty(e,r,{enumerable:o[r].enumerable,get:o[r].get.bind(t)})}}return t}function Qe(e){let t;return e!=null&&typeof e=="object"&&(e[$e]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function Ne(e,t=new Set){let i,o,n,l;if(i=e!=null&&e[dt])return i;if(!Qe(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let r=0,s=e.length;r<s;r++)n=e[r],(o=Ne(n,t))!==n&&(e[r]=o)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const r=Object.keys(e),s=Object.getOwnPropertyDescriptors(e);for(let c=0,a=r.length;c<a;c++)l=r[c],!s[l].get&&(n=e[l],(o=Ne(n,t))!==n&&(e[l]=o))}return e}function Ye(e,t){let i=e[t];return i||Object.defineProperty(e,t,{value:i=Object.create(null)}),i}function He(e,t,i){if(e[t])return e[t];const[o,n]=Q(i,{equals:!1,internal:!0});return o.$=n,e[t]=o}function hn(e,t){const i=Reflect.getOwnPropertyDescriptor(e,t);return!i||i.get||!i.configurable||t===$e||t===Me||(delete i.value,delete i.writable,i.get=()=>e[$e][t]),i}function Lt(e){rt()&&He(Ye(e,Me),Dt)()}function gn(e){return Lt(e),Reflect.ownKeys(e)}const vn={get(e,t,i){if(t===dt)return e;if(t===$e)return i;if(t===it)return Lt(e),i;const o=Ye(e,Me),n=o[t];let l=n?n():e[t];if(t===Me||t===he||t==="__proto__")return l;if(!n){const r=Object.getOwnPropertyDescriptor(e,t);rt()&&(typeof l!="function"||e.hasOwnProperty(t))&&!(r&&r.get)&&(l=He(o,t,l)())}return Qe(l)?It(l):l},has(e,t){return t===dt||t===$e||t===it||t===Me||t===he||t==="__proto__"?!0:(rt()&&He(Ye(e,he),t)(),t in e)},set(){return!0},deleteProperty(){return!0},ownKeys:gn,getOwnPropertyDescriptor:hn};function Xe(e,t,i,o=!1){if(!o&&e[t]===i)return;const n=e[t],l=e.length;i===void 0?(delete e[t],e[he]&&e[he][t]&&n!==void 0&&e[he][t].$()):(e[t]=i,e[he]&&e[he][t]&&n===void 0&&e[he][t].$());let r=Ye(e,Me),s;if((s=He(r,t,n))&&s.$(()=>i),Array.isArray(e)&&e.length!==l){for(let c=e.length;c<l;c++)(s=r[c])&&s.$();(s=He(r,"length",l))&&s.$(e.length)}(s=r[Dt])&&s.$()}function Ut(e,t){const i=Object.keys(t);for(let o=0;o<i.length;o+=1){const n=i[o];Xe(e,n,t[n])}}function yn(e,t){if(typeof t=="function"&&(t=t(e)),t=Ne(t),Array.isArray(t)){if(e===t)return;let i=0,o=t.length;for(;i<o;i++){const n=t[i];e[i]!==n&&Xe(e,i,n)}Xe(e,"length",o)}else Ut(e,t)}function Re(e,t,i=[]){let o,n=e;if(t.length>1){o=t.shift();const r=typeof o,s=Array.isArray(e);if(Array.isArray(o)){for(let c=0;c<o.length;c++)Re(e,[o[c]].concat(t),i);return}else if(s&&r==="function"){for(let c=0;c<e.length;c++)o(e[c],c)&&Re(e,[c].concat(t),i);return}else if(s&&r==="object"){const{from:c=0,to:a=e.length-1,by:v=1}=o;for(let g=c;g<=a;g+=v)Re(e,[g].concat(t),i);return}else if(t.length>1){Re(e[o],t,[o].concat(i));return}n=e[o],i=[o].concat(i)}let l=t[0];typeof l=="function"&&(l=l(n,i),l===n)||o===void 0&&l==null||(l=Ne(l),o===void 0||Qe(n)&&Qe(l)&&!Array.isArray(l)?Ut(n,l):Xe(e,o,l))}function mn(...[e,t]){const i=Ne(e||{}),o=Array.isArray(i),n=It(i);function l(...r){Qt(()=>{o&&r.length===1?yn(i,r[0]):Re(i,r)})}return[n,l]}function wn(){return window.crypto.getRandomValues(new Uint32Array(1))[0]}function wt(e,t=!1){const i=wn(),o=`_${i}`;return Object.defineProperty(window,o,{value:n=>(t&&Reflect.deleteProperty(window,o),e==null?void 0:e(n)),writable:!1,configurable:!0}),i}async function le(e,t={}){return new Promise((i,o)=>{const n=wt(r=>{i(r),Reflect.deleteProperty(window,`_${l}`)},!0),l=wt(r=>{o(r),Reflect.deleteProperty(window,`_${n}`)},!0);window.__TAURI_IPC__({cmd:e,callback:n,error:l,...t})})}const Tt=Yt(),bn=e=>{const[t,i]=mn({elements:[],selected_ids:[],canvas_config:{width:595,height:842,zoom:1,offset_x:0,offset_y:0,show_grid:!0,show_rulers:!0,grid_size:10,snap_to_grid:!0,background_color:"#ffffff"},can_undo:!1,can_redo:!1,dirty:!1}),[o,n]=Q(!1),[l,r]=Q(null),[s,c]=Q(!1),a=async()=>{try{n(!0),console.log("🔄 Loading app state...");const w=await le("get_app_state");console.log("🔄 App state loaded, selected_ids:",w.selected_ids),i(w)}catch(w){console.error("Failed to load app state:",w)}finally{n(!1)}};nt(()=>{a()});const E={state:t,createElement:async(w,m,S,T={})=>{try{n(!0);const p=await le("create_element",{request:{element_type:w,position:m,size:S,content_data:T}});return await a(),p}catch(p){throw console.error("Failed to create element:",p),p}finally{n(!1)}},updateElement:async(w,m)=>{try{n(!0),await le("update_element",{request:{id:w,updates:m}}),await a()}catch(S){throw console.error("Failed to update element:",S),S}finally{n(!1)}},batchUpdatePositions:async w=>{try{n(!0),await le("batch_update_positions",{request:{updates:w}}),i(m=>{const S=m.elements.map(T=>{const p=w.find(N=>N.element_id===T.id);return p?{...T,position:p.new_position}:T});return{...m,elements:S,dirty:!0}}),console.log("🚀 Optimized batch position update completed without full reload")}catch(m){throw console.error("Failed to batch update positions:",m),await a(),m}finally{n(!1)}},deleteElement:async w=>{try{n(!0),await le("delete_element",{elementId:w}),await a()}catch(m){throw console.error("Failed to delete element:",m),m}finally{n(!1)}},selectElement:async w=>{try{console.log("Selecting element:",w),await le("select_element",{elementId:w}),console.log("Select command completed, reloading state..."),await a(),console.log("State reloaded, selected_ids:",t.selected_ids)}catch(m){throw console.error("Failed to select element:",m),m}},selectMultiple:async w=>{try{console.log("Selecting multiple elements:",w),w.length>0?(await le("select_multiple",{elementIds:w}),console.log("✅ Multi-select completed for:",w.length,"elements")):await le("clear_selection"),await a()}catch(m){throw console.error("Failed to select multiple elements:",m),m}},addToSelection:async w=>{try{console.log("Adding to selection:",w),await le("add_to_selection",{elementId:w}),await a()}catch(m){throw console.error("Failed to add to selection:",m),m}},removeFromSelection:async w=>{try{console.log("Removing from selection:",w),await le("remove_from_selection",{elementId:w}),await a()}catch(m){throw console.error("Failed to remove from selection:",m),m}},toggleSelection:async w=>{try{console.log("Toggling selection:",w),await le("toggle_selection",{elementId:w}),await a()}catch(m){throw console.error("Failed to toggle selection:",m),m}},clearSelection:async()=>{try{await le("clear_selection"),await a()}catch(w){throw console.error("Failed to clear selection:",w),w}},copySelected:async()=>{try{await le("copy_selected")}catch(w){throw console.error("Failed to copy selected elements:",w),w}},pasteElements:async(w,m)=>{try{n(!0);const S=await le("paste_elements",{offsetX:w,offsetY:m});return await a(),S}catch(S){throw console.error("Failed to paste elements:",S),S}finally{n(!1)}},undo:async()=>{try{n(!0),await le("undo"),await a()}catch(w){throw console.error("Failed to undo:",w),w}finally{n(!1)}},redo:async()=>{try{n(!0),await le("redo"),await a()}catch(w){throw console.error("Failed to redo:",w),w}finally{n(!1)}},updateCanvasConfig:async w=>{try{n(!0),await le("update_canvas_config",{request:w}),await a()}catch(m){throw console.error("Failed to update canvas config:",m),m}finally{n(!1)}},getElementsAtPoint:async(w,m)=>{try{return await le("get_elements_at_point",{x:w,y:m})}catch(S){return console.error("Failed to get elements at point:",S),[]}},isLoading:o,setLoading:n,dragOperation:l,setDragOperation:r,resizeOperation:s,setResizeOperation:c};return y(Tt.Provider,{value:E,get children(){return e.children}})},Ce=()=>{const e=Xt(Tt);if(!e)throw new Error("useAppContext must be used within an AppProvider");return e};var pn=$("<span class=text-warning>●"),xn=$("<span class=ml-2> 个元素"),_n=$('<span class="ml-2 text-primary">已选择 <!> 个'),$n=$('<div class="h-12 bg-primary border-b border-default flex items-center justify-between px-4"><div class="flex items-center gap-2"><button class=toolbar-btn title="新建 (Ctrl+N)"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg><span>新建</span></button><button class=toolbar-btn title="打开 (Ctrl+O)"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"></path></svg><span>打开</span></button><button class=toolbar-btn title="保存 (Ctrl+S)"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path></svg><span>保存</span></button><div class="w-px h-6 bg-border-default mx-2"></div><button class=toolbar-btn title=预览><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg><span>预览</span></button></div><div class="flex items-center gap-2"><button><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"></path></svg></button><button><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M21 10H11a8 8 0 00-8 8v2m18-10l-6 6m6-6l-6-6"></path></svg></button><div class="w-px h-6 bg-border-default mx-2"></div><button class=toolbar-btn-icon title="缩小 (Ctrl+-)"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM13 10H7"></path></svg></button><select class=zoom-select><option value=25%>25%</option><option value=50%>50%</option><option value=75%>75%</option><option value=100%>100%</option><option value=125%>125%</option><option value=150%>150%</option><option value=200%>200%</option><option value=fit>适应窗口</option></select><button class=toolbar-btn-icon title="放大 (Ctrl++)"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"></path></svg></button><div class="w-px h-6 bg-border-default mx-2"></div><button title="显示网格 (Ctrl+G)"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"></path></svg></button><button title="显示标尺 (Ctrl+R)"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v14a2 2 0 01-2 2H7zM20 3v18l-4-4V7l4-4z"></path></svg></button><div class="w-px h-6 bg-border-default mx-2"></div><button class="toolbar-btn-icon bg-yellow-100 hover:bg-yellow-200 text-yellow-800"title="开启/关闭开发者工具 (F12)"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg></button></div><div class="flex items-center gap-2 text-secondary text-sm"><span>');const Sn=()=>{const{state:e,undo:t,redo:i,updateCanvasConfig:o}=Ce(),[n,l]=Q(e.canvas_config.zoom*100),r=async C=>{const I=C/100;l(C);try{await o({zoom:I})}catch(R){console.error("Failed to update zoom:",R)}},s=()=>{const C=Math.min(n()+25,500);r(C)},c=()=>{const C=Math.max(n()-25,25);r(C)},a=async()=>{try{await o({show_grid:!e.canvas_config.show_grid})}catch(C){console.error("Failed to toggle grid:",C)}},v=async()=>{try{await o({show_rulers:!e.canvas_config.show_rulers})}catch(C){console.error("Failed to toggle rulers:",C)}},g=async()=>{try{await le("toggle_devtools"),console.log("🔧 DevTools toggled")}catch(C){console.error("Failed to toggle DevTools:",C)}};return(()=>{var C=$n(),I=C.firstChild,R=I.nextSibling,z=R.firstChild,K=z.nextSibling,M=K.nextSibling,D=M.nextSibling,L=D.nextSibling,V=L.nextSibling,B=V.nextSibling,ne=B.nextSibling,J=ne.nextSibling,F=J.nextSibling,W=F.nextSibling,E=R.nextSibling,w=E.firstChild;return at(z,"click",t),at(K,"click",i),D.$$click=c,L.addEventListener("change",m=>{const S=m.target.value;if(S==="fit")console.log("Fit to window");else{const T=parseInt(S.replace("%",""));r(T)}}),V.$$click=s,ne.$$click=a,J.$$click=v,W.$$click=g,f(E,y(Oe,{get when(){return e.dirty},get children(){return pn()}}),w),f(w,()=>e.template_name||"未命名模板"),f(E,y(Oe,{get when(){return e.elements.length>0},get children(){var m=xn(),S=m.firstChild;return f(m,()=>e.elements.length,S),m}}),null),f(E,y(Oe,{get when(){return e.selected_ids.length>0},get children(){var m=_n(),S=m.firstChild,T=S.nextSibling;return T.nextSibling,f(m,()=>e.selected_ids.length,T),m}}),null),k(m=>{var S=`toolbar-btn-icon ${e.can_undo?"":"opacity-50 cursor-not-allowed"}`,T=!e.can_undo,p=`撤销${e.undo_description?` (${e.undo_description})`:""} (Ctrl+Z)`,N=`toolbar-btn-icon ${e.can_redo?"":"opacity-50 cursor-not-allowed"}`,H=!e.can_redo,G=`重做${e.redo_description?` (${e.redo_description})`:""} (Ctrl+Y)`,j=`toolbar-btn-icon ${e.canvas_config.show_grid?"active":""}`,q=`toolbar-btn-icon ${e.canvas_config.show_rulers?"active":""}`;return S!==m.e&&Ae(z,m.e=S),T!==m.t&&(z.disabled=m.t=T),p!==m.a&&x(z,"title",m.a=p),N!==m.o&&Ae(K,m.o=N),H!==m.i&&(K.disabled=m.i=H),G!==m.n&&x(K,"title",m.n=G),j!==m.s&&Ae(ne,m.s=j),q!==m.h&&Ae(J,m.h=q),m},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),k(()=>L.value=`${Math.round(n())}%`),C})()};Se(["click"]);var Cn=$('<div class="flex flex-col h-full"><div class="p-4 border-b border-default"><h2 class="text-lg font-semibold text-primary mb-3">组件库</h2><input type=text placeholder=搜索组件... class=component-search></div><div class="flex-1 overflow-y-auto custom-scrollbar p-4"><div class=space-y-4><div><h3 class="text-sm font-medium text-secondary mb-2">基础组件</h3><div class="grid grid-cols-2 gap-2"></div></div><div><h3 class="text-sm font-medium text-secondary mb-2">数据组件</h3><div class="grid grid-cols-2 gap-2"></div></div><div><h3 class="text-sm font-medium text-secondary mb-2">银行组件</h3><div class="grid grid-cols-2 gap-2">'),kn=$('<div class=component-item><div class=text-center><div class="text-lg mb-1"></div><div class="text-xs font-medium text-primary">');const En=()=>{const{createElement:e}=Ce(),[t,i]=Q(""),o=[{id:"text",name:"文字",category:"basic",icon:"📝",description:"静态文字标签",default_size:{width:100,height:24},create_content:a=>({type:"Text",content:(a==null?void 0:a.text)||"文字内容",style:{font_family:"SimSun",font_size:14,font_weight:"normal",color:"#000000",align:"Left"}})},{id:"data_field",name:"数据字段",category:"data",icon:"🔗",description:"动态数据字段",default_size:{width:120,height:24},create_content:a=>({type:"DataField",expression:(a==null?void 0:a.expression)||"${fieldName}",format:a==null?void 0:a.format,style:{font_family:"SimSun",font_size:14,font_weight:"normal",color:"#000000",align:"Left"}})},{id:"rectangle",name:"矩形",category:"basic",icon:"▭",description:"矩形框架",default_size:{width:100,height:60},create_content:a=>({type:"Rectangle",fill_color:(a==null?void 0:a.fill_color)||"transparent",border:{color:(a==null?void 0:a.border_color)||"#000000",width:(a==null?void 0:a.border_width)||1,style:"Solid"}})},{id:"line",name:"线条",category:"basic",icon:"━",description:"分隔线",default_size:{width:200,height:2},create_content:a=>({type:"Line",color:(a==null?void 0:a.color)||"#000000",width:(a==null?void 0:a.width)||1})},{id:"image",name:"图片",category:"basic",icon:"🖼️",description:"图片占位符",default_size:{width:100,height:80},create_content:a=>({type:"Image",src:(a==null?void 0:a.src)||"",alt:(a==null?void 0:a.alt)||"图片"})}],n=[{id:"bank_header",name:"银行抬头",category:"bank",icon:"🏦",description:"银行标题和Logo区域",default_size:{width:300,height:60},create_content:()=>({type:"Text",content:"中国工商银行电子回单",style:{font_family:"SimHei",font_size:18,font_weight:"bold",color:"#000000",align:"Center"}})},{id:"amount_field",name:"金额字段",category:"bank",icon:"💰",description:"格式化金额显示",default_size:{width:120,height:24},create_content:()=>({type:"DataField",expression:"${amount}",format:"currency",style:{font_family:"SimSun",font_size:14,font_weight:"bold",color:"#000000",align:"Right"}})},{id:"customer_info",name:"客户信息",category:"bank",icon:"👤",description:"客户姓名和账号",default_size:{width:150,height:24},create_content:()=>({type:"DataField",expression:"${customerName}",style:{font_family:"SimSun",font_size:12,font_weight:"normal",color:"#000000",align:"Left"}})}],l=[...o,...n],r=()=>{const a=t().toLowerCase();return a?l.filter(v=>v.name.toLowerCase().includes(a)||v.description.toLowerCase().includes(a)):l},s=(a,v)=>{if(console.log("Starting drag for component:",a.id),v.dataTransfer){v.dataTransfer.effectAllowed="copy",v.dataTransfer.setData("application/json",JSON.stringify({type:"component",component:a}));const g=document.createElement("div");g.innerHTML=`
        <div style="
          background: #f3f4f6; 
          border: 2px solid #3b82f6; 
          border-radius: 8px; 
          padding: 8px 12px; 
          font-size: 12px;
          white-space: nowrap;
          box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        ">
          ${a.icon} ${a.name}
        </div>
      `,g.style.position="absolute",g.style.top="-1000px",document.body.appendChild(g),v.dataTransfer.setDragImage(g,50,20),setTimeout(()=>{document.body.removeChild(g)},0)}},c=async a=>{try{const v=await e(a.id,{x:100,y:100},a.default_size,a.create_content());console.log("Created element:",v)}catch(v){console.error("Failed to create element:",v)}};return(()=>{var a=Cn(),v=a.firstChild,g=v.firstChild,C=g.nextSibling,I=v.nextSibling,R=I.firstChild,z=R.firstChild,K=z.firstChild,M=K.nextSibling,D=z.nextSibling,L=D.firstChild,V=L.nextSibling,B=D.nextSibling,ne=B.firstChild,J=ne.nextSibling;return C.$$input=F=>i(F.target.value),f(M,y(_e,{get each(){return r().filter(F=>F.category==="basic")},children:F=>y(ot,{component:F,onDrag:W=>s(F,W),onClick:()=>c(F)})})),f(V,y(_e,{get each(){return r().filter(F=>F.category==="data")},children:F=>y(ot,{component:F,onDrag:W=>s(F,W),onClick:()=>c(F)})})),f(J,y(_e,{get each(){return r().filter(F=>F.category==="bank")},children:F=>y(ot,{component:F,onDrag:W=>s(F,W),onClick:()=>c(F)})})),k(()=>C.value=t()),a})()},ot=e=>(()=>{var t=kn(),i=t.firstChild,o=i.firstChild,n=o.nextSibling;return at(t,"click",e.onClick),t.addEventListener("dragstart",l=>e.onDrag(l)),x(t,"draggable",!0),f(o,()=>e.component.icon),f(n,()=>e.component.name),k(()=>x(t,"title",e.component.description)),t})();Se(["input","click"]);var zn=$('<div class="flex flex-col h-full"><div class="p-4 border-b border-default"><h2 class="text-lg font-semibold text-primary">属性面板</h2></div><div class="flex-1 overflow-y-auto custom-scrollbar">'),Pn=$('<div class="p-4 text-center text-muted"><svg class="w-12 h-12 mx-auto mb-2 opacity-50"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"></path></svg><p class=text-sm>选择元素以查看属性'),An=$("<span class=property-value>"),Mn=$('<span class="property-value text-xs text-muted">'),et=$("<div class=space-y-2>"),Te=$("<input type=number class=property-input>"),Dn=$('<div class="grid grid-cols-2 gap-2">'),bt=$("<input type=checkbox class=property-checkbox>"),In=$('<div class="p-4 space-y-4">'),Ln=$("<div class=property-group><div class=property-group-title><span></span><span></span></div><div class=property-group-content>"),Un=$("<div class=property-field><label class=property-label>"),Tn=$("<textarea class=property-textarea rows=2 placeholder=输入文本内容...>"),Rt=$('<select class=property-select><option value=SimSun>宋体</option><option value=SimHei>黑体</option><option value="Microsoft YaHei">微软雅黑</option><option value=KaiTi>楷体</option><option value=Arial>Arial</option><option value="Times New Roman">Times New Roman</option><option value=Helvetica>Helvetica'),Ot=$("<select class=property-select><option value=normal>正常</option><option value=bold>粗体</option><option value=lighter>细体</option><option value=100>100</option><option value=200>200</option><option value=300>300</option><option value=400>400</option><option value=500>500</option><option value=600>600</option><option value=700>700</option><option value=800>800</option><option value=900>900"),Ft=$('<div class=space-y-3><div class="grid grid-cols-2 gap-2"></div><div class="grid grid-cols-2 gap-2">'),Rn=$("<select class=property-select><option value=Solid>实线</option><option value=Dashed>虚线</option><option value=Dotted>点线"),Nt=$('<div class="flex gap-2 items-center"><input type=range class="property-slider flex-1"min=0 max=100 step=1><span class="property-value w-12 text-center">%'),On=$('<div class=space-y-3><div class=space-y-2><div class="grid grid-cols-2 gap-2">'),Fn=$("<select class=property-select><option value=Solid>实线</option><option value=Dashed>虚线</option><option value=Dotted>点线</option><option value=DashDot>点划线"),pt=$("<select class=property-select><option value=None>无</option><option value=Arrow>箭头</option><option value=Circle>圆点</option><option value=Square>方块"),Nn=$('<div class=space-y-3><div class="grid grid-cols-2 gap-2">'),Hn=$("<input type=text class=property-input placeholder=https://example.com/image.jpg>"),jn=$("<input type=text class=property-input placeholder=图片描述文字>"),Gn=$("<div class=property-image-preview><div class=property-image-placeholder><span>📷 无图片"),Bn=$("<div class=space-y-3>"),Vn=$("<img class=property-image>"),qn=$("<input type=text class=property-input placeholder=${fieldName}>"),Kn=$("<select class=property-select><option value=default>默认</option><option value=currency>货币</option><option value=date>日期</option><option value=datetime>日期时间</option><option value=number>数字"),Wn=$("<div class=space-y-4>"),Zn=$('<div class=flex><input type=number class="property-input flex-1">'),Jn=$("<span class=property-unit>"),Qn=$('<div class="flex gap-2"><div class=property-color-wrapper><input type=color class=property-color><div class=property-color-preview></div></div><input type=text class="property-input flex-1"placeholder=#000000>'),Yn=$("<div class=property-alignment-group>"),Xn=$("<button>");const el=()=>{const{state:e,updateElement:t}=Ce(),i=ie(()=>{const l=new Set(e.selected_ids);return e.elements.filter(r=>l.has(r.id))}),o=ie(()=>i()[0]),n=async(l,r,s)=>{try{await t(l,{[r]:s})}catch(c){console.error("Failed to update element property:",c)}};return(()=>{var l=zn(),r=l.firstChild,s=r.nextSibling;return f(s,y(Oe,{get when(){return o()},get fallback(){return Pn()},get children(){return y(tl,{get element(){return o()},onUpdate:n})}})),l})()},tl=e=>{const t=(o,n)=>{const l={...e.element.position,[o]:n};e.onUpdate(e.element.id,"position",l)},i=(o,n)=>{const l={...e.element.size,[o]:Math.max(1,n)};e.onUpdate(e.element.id,"size",l)};return(()=>{var o=In();return f(o,y(ve,{title:"元素信息",icon:"ℹ️",get children(){var n=et();return f(n,y(O,{label:"类型",get children(){var l=An();return f(l,()=>e.element.content.type),l}}),null),f(n,y(O,{label:"ID",get children(){var l=Mn();return f(l,()=>e.element.id),l}}),null),n}}),null),f(o,y(ve,{title:"位置和大小",icon:"📐",get children(){var n=Dn();return f(n,y(O,{label:"X",get children(){var l=Te();return l.$$input=r=>t("x",parseFloat(r.target.value)||0),k(()=>l.value=e.element.position.x),l}}),null),f(n,y(O,{label:"Y",get children(){var l=Te();return l.$$input=r=>t("y",parseFloat(r.target.value)||0),k(()=>l.value=e.element.position.y),l}}),null),f(n,y(O,{label:"宽度",get children(){var l=Te();return l.$$input=r=>i("width",parseFloat(r.target.value)||1),k(()=>l.value=e.element.size.width),l}}),null),f(n,y(O,{label:"高度",get children(){var l=Te();return l.$$input=r=>i("height",parseFloat(r.target.value)||1),k(()=>l.value=e.element.size.height),l}}),null),n}}),null),f(o,y(ve,{title:"状态",icon:"👁️",get children(){var n=et();return f(n,y(O,{label:"可见",get children(){var l=bt();return l.addEventListener("change",r=>e.onUpdate(e.element.id,"visible",r.target.checked)),k(()=>l.checked=e.element.visible),l}}),null),f(n,y(O,{label:"锁定",get children(){var l=bt();return l.addEventListener("change",r=>e.onUpdate(e.element.id,"locked",r.target.checked)),k(()=>l.checked=e.element.locked),l}}),null),f(n,y(O,{label:"层级",get children(){var l=Te();return l.$$input=r=>e.onUpdate(e.element.id,"z_index",parseInt(r.target.value)||0),k(()=>l.value=e.element.z_index),l}}),null),n}}),null),f(o,y(an,{get children(){return[y(Ue,{get when(){return e.element.content.type==="Text"&&e.element.content},children:n=>y(nl,{get content(){return n()},onUpdate:l=>{console.log("Text content update:",l),e.onUpdate(e.element.id,"content",l)}})}),y(Ue,{get when(){return e.element.content.type==="Rectangle"&&e.element.content},children:n=>y(ll,{get content(){return n()},onUpdate:l=>{console.log("Rectangle content update:",l),e.onUpdate(e.element.id,"content",l)}})}),y(Ue,{get when(){return e.element.content.type==="Line"&&e.element.content},children:n=>y(ol,{get content(){return n()},onUpdate:l=>{console.log("Line content update:",l),e.onUpdate(e.element.id,"content",l)}})}),y(Ue,{get when(){return e.element.content.type==="Image"&&e.element.content},children:n=>y(il,{get content(){return n()},onUpdate:l=>{console.log("Image content update:",l),e.onUpdate(e.element.id,"content",l)}})}),y(Ue,{get when(){return e.element.content.type==="DataField"&&e.element.content},children:n=>y(rl,{get content(){return n()},onUpdate:l=>{console.log("DataField content update:",l),e.onUpdate(e.element.id,"content",l)}})})]}}),null),o})()},ve=e=>(()=>{var t=Ln(),i=t.firstChild,o=i.firstChild,n=o.nextSibling,l=i.nextSibling;return f(o,()=>e.icon),f(n,()=>e.title),f(l,()=>e.children),t})(),O=e=>(()=>{var t=Un(),i=t.firstChild;return f(i,()=>e.label),f(t,()=>e.children,null),t})(),nl=e=>y(ve,{title:"文字样式",icon:"🔤",get children(){var t=Ft(),i=t.firstChild,o=i.nextSibling;return f(t,y(O,{label:"内容",get children(){var n=Tn();return n.$$input=l=>e.onUpdate({content:l.target.value}),k(()=>n.value=e.content.content),n}}),i),f(i,y(O,{label:"字体",get children(){var n=Rt();return n.addEventListener("change",l=>e.onUpdate({style:{...e.content.style,font_family:l.target.value}})),k(()=>n.value=e.content.style.font_family),n}}),null),f(i,y(O,{label:"大小",get children(){return y(je,{get value(){return e.content.style.font_size},min:6,max:72,step:1,unit:"px",onUpdate:n=>e.onUpdate({style:{...e.content.style,font_size:n}})})}}),null),f(o,y(O,{label:"字重",get children(){var n=Ot();return n.addEventListener("change",l=>e.onUpdate({style:{...e.content.style,font_weight:l.target.value}})),k(()=>n.value=e.content.style.font_weight),n}}),null),f(o,y(O,{label:"对齐",get children(){return y(Ht,{get value(){return e.content.style.align},onUpdate:n=>e.onUpdate({style:{...e.content.style,align:n}})})}}),null),f(t,y(O,{label:"颜色",get children(){return y(Ge,{get value(){return e.content.style.color},onUpdate:n=>e.onUpdate({style:{...e.content.style,color:n}})})}}),null),t}}),ll=e=>y(ve,{title:"矩形样式",icon:"▭",get children(){var t=On(),i=t.firstChild,o=i.firstChild;return f(t,y(O,{label:"填充颜色",get children(){return y(Ge,{get value(){return e.content.fill_color||"#ffffff"},onUpdate:n=>e.onUpdate({fill_color:n})})}}),i),f(i,y(O,{label:"边框",get children(){var n=et();return f(n,y(Ge,{get value(){var l;return((l=e.content.border)==null?void 0:l.color)||"#000000"},onUpdate:l=>e.onUpdate({border:{...e.content.border,color:l}})})),n}}),o),f(o,y(O,{label:"宽度",get children(){return y(je,{get value(){var n;return((n=e.content.border)==null?void 0:n.width)||1},min:0,max:20,step:.5,unit:"px",onUpdate:n=>e.onUpdate({border:{...e.content.border,width:n}})})}}),null),f(o,y(O,{label:"样式",get children(){var n=Rn();return n.addEventListener("change",l=>e.onUpdate({border:{...e.content.border,style:l.target.value}})),k(()=>{var l;return n.value=((l=e.content.border)==null?void 0:l.style)||"Solid"}),n}}),null),f(t,y(O,{label:"圆角半径",get children(){return y(je,{get value(){return e.content.corner_radius||0},min:0,max:50,step:1,unit:"px",onUpdate:n=>e.onUpdate({corner_radius:n})})}}),null),f(t,y(O,{label:"透明度",get children(){var n=Nt(),l=n.firstChild,r=l.nextSibling,s=r.firstChild;return l.$$input=c=>e.onUpdate({opacity:parseFloat(c.target.value)/100}),f(r,()=>Math.round((e.content.opacity||1)*100),s),k(()=>l.value=(e.content.opacity||1)*100),n}}),null),t}}),ol=e=>y(ve,{title:"线条样式",icon:"━",get children(){var t=Nn(),i=t.firstChild;return f(t,y(O,{label:"颜色",get children(){return y(Ge,{get value(){return e.content.color},onUpdate:o=>e.onUpdate({color:o})})}}),i),f(t,y(O,{label:"宽度",get children(){return y(je,{get value(){return e.content.width},min:.5,max:20,step:.5,unit:"px",onUpdate:o=>e.onUpdate({width:o})})}}),i),f(t,y(O,{label:"样式",get children(){var o=Fn();return o.addEventListener("change",n=>e.onUpdate({line_style:n.target.value})),k(()=>o.value=e.content.line_style||"Solid"),o}}),i),f(i,y(O,{label:"起点",get children(){var o=pt();return o.addEventListener("change",n=>e.onUpdate({start_cap:n.target.value})),k(()=>o.value=e.content.start_cap||"None"),o}}),null),f(i,y(O,{label:"终点",get children(){var o=pt();return o.addEventListener("change",n=>e.onUpdate({end_cap:n.target.value})),k(()=>o.value=e.content.end_cap||"None"),o}}),null),f(t,y(O,{label:"透明度",get children(){var o=Nt(),n=o.firstChild,l=n.nextSibling,r=l.firstChild;return n.$$input=s=>e.onUpdate({opacity:parseFloat(s.target.value)/100}),f(l,()=>Math.round((e.content.opacity||1)*100),r),k(()=>n.value=(e.content.opacity||1)*100),o}}),null),t}}),il=e=>y(ve,{title:"图片属性",icon:"🖼️",get children(){var t=Bn();return f(t,y(O,{label:"图片地址",get children(){var i=Hn();return i.$$input=o=>e.onUpdate({src:o.target.value}),k(()=>i.value=e.content.src),i}}),null),f(t,y(O,{label:"替代文本",get children(){var i=jn();return i.$$input=o=>e.onUpdate({alt:o.target.value}),k(()=>i.value=e.content.alt||""),i}}),null),f(t,y(O,{label:"预览",get children(){var i=Gn(),o=i.firstChild;return f(i,(()=>{var n=ue(()=>!!e.content.src);return()=>n()?(()=>{var l=Vn();return l.addEventListener("load",r=>{const s=r.target,c=s.nextElementSibling;s&&(s.style.display="block"),c&&(c.style.display="none")}),l.addEventListener("error",r=>{const s=r.target,c=s.nextElementSibling;s&&(s.style.display="none"),c&&(c.style.display="flex")}),k(r=>{var s=e.content.src,c=e.content.alt||"图片预览";return s!==r.e&&x(l,"src",r.e=s),c!==r.t&&x(l,"alt",r.t=c),r},{e:void 0,t:void 0}),l})():null})(),o),k(n=>(n=e.content.src?"none":"flex")!=null?o.style.setProperty("display",n):o.style.removeProperty("display")),i}}),null),t}}),rl=e=>(()=>{var t=Wn();return f(t,y(ve,{title:"数据字段",icon:"🔗",get children(){var i=et();return f(i,y(O,{label:"表达式",get children(){var o=qn();return o.$$input=n=>e.onUpdate({expression:n.target.value}),k(()=>o.value=e.content.expression),o}}),null),f(i,y(O,{label:"格式",get children(){var o=Kn();return o.addEventListener("change",n=>e.onUpdate({format:n.target.value==="default"?void 0:n.target.value})),k(()=>o.value=e.content.format||"default"),o}}),null),i}}),null),f(t,y(ve,{title:"字段样式",icon:"🎨",get children(){var i=Ft(),o=i.firstChild,n=o.nextSibling;return f(o,y(O,{label:"字体",get children(){var l=Rt();return l.addEventListener("change",r=>e.onUpdate({style:{...e.content.style,font_family:r.target.value}})),k(()=>l.value=e.content.style.font_family),l}}),null),f(o,y(O,{label:"大小",get children(){return y(je,{get value(){return e.content.style.font_size},min:6,max:72,step:1,unit:"px",onUpdate:l=>e.onUpdate({style:{...e.content.style,font_size:l}})})}}),null),f(n,y(O,{label:"字重",get children(){var l=Ot();return l.addEventListener("change",r=>e.onUpdate({style:{...e.content.style,font_weight:r.target.value}})),k(()=>l.value=e.content.style.font_weight),l}}),null),f(n,y(O,{label:"对齐",get children(){return y(Ht,{get value(){return e.content.style.align},onUpdate:l=>e.onUpdate({style:{...e.content.style,align:l}})})}}),null),f(i,y(O,{label:"颜色",get children(){return y(Ge,{get value(){return e.content.style.color},onUpdate:l=>e.onUpdate({style:{...e.content.style,color:l}})})}}),null),i}}),null),t})(),je=e=>(()=>{var t=Zn(),i=t.firstChild;return i.addEventListener("blur",o=>{const n=parseFloat(o.target.value)||e.value,l=Math.max(e.min||-1/0,Math.min(e.max||1/0,n));l!==n&&(o.target.value=l.toString(),e.onUpdate(l))}),i.$$input=o=>{const n=parseFloat(o.target.value);if(!isNaN(n)){const l=Math.max(e.min||-1/0,Math.min(e.max||1/0,n));e.onUpdate(l)}},f(t,(()=>{var o=ue(()=>!!e.unit);return()=>o()&&(()=>{var n=Jn();return f(n,()=>e.unit),n})()})(),null),k(o=>{var n=e.min,l=e.max,r=e.step||1;return n!==o.e&&x(i,"min",o.e=n),l!==o.t&&x(i,"max",o.t=l),r!==o.a&&x(i,"step",o.a=r),o},{e:void 0,t:void 0,a:void 0}),k(()=>i.value=e.value),t})(),Ge=e=>(()=>{var t=Qn(),i=t.firstChild,o=i.firstChild,n=o.nextSibling,l=i.nextSibling;return o.$$input=r=>e.onUpdate(r.target.value),l.$$input=r=>{const s=r.target.value;(/^#[0-9A-Fa-f]{6}$/.test(s)||/^#[0-9A-Fa-f]{3}$/.test(s))&&e.onUpdate(s)},k(r=>(r=e.value)!=null?n.style.setProperty("background-color",r):n.style.removeProperty("background-color")),k(()=>o.value=e.value),k(()=>l.value=e.value),t})(),Ht=e=>{const t=[{value:"Left",icon:"⬅️",label:"左对齐"},{value:"Center",icon:"↔️",label:"居中"},{value:"Right",icon:"➡️",label:"右对齐"}];return(()=>{var i=Yn();return f(i,()=>t.map(o=>(()=>{var n=Xn();return n.$$click=()=>e.onUpdate(o.value),f(n,()=>o.icon),k(l=>{var r=`property-alignment-btn ${e.value===o.value?"active":""}`,s=o.label;return r!==l.e&&Ae(n,l.e=r),s!==l.t&&x(n,"title",l.t=s),l},{e:void 0,t:void 0}),n})())),i})()};Se(["input","click"]);var sl=$("<svg><defs><pattern id=canvas-grid patternUnits=userSpaceOnUse><line y1=0 stroke=#cbd5e1 stroke-width=0.5 opacity=0.8></line><line x1=0 stroke=#cbd5e1 stroke-width=0.5 opacity=0.8></svg>",!1,!0,!1),al=$("<svg><rect fill=url(#canvas-grid)></svg>",!1,!0,!1);const cl=e=>y(Oe,{get when(){return e.config.show_grid},get children(){return[(()=>{var t=sl(),i=t.firstChild,o=i.firstChild,n=o.nextSibling;return k(l=>{var r=e.config.grid_size,s=e.config.grid_size,c=e.config.grid_size,a=e.config.grid_size,v=e.config.grid_size,g=e.config.grid_size,C=e.config.grid_size,I=e.config.grid_size;return r!==l.e&&x(i,"width",l.e=r),s!==l.t&&x(i,"height",l.t=s),c!==l.a&&x(o,"x1",l.a=c),a!==l.o&&x(o,"x2",l.o=a),v!==l.i&&x(o,"y2",l.i=v),g!==l.n&&x(n,"y1",l.n=g),C!==l.s&&x(n,"x2",l.s=C),I!==l.h&&x(n,"y2",l.h=I),l},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),t})(),(()=>{var t=al();return k(i=>{var o=e.config.width,n=e.config.height;return o!==i.e&&x(t,"width",i.e=o),n!==i.t&&x(t,"height",i.t=n),i},{e:void 0,t:void 0}),t})()]}});var dl=$("<svg><g class=resize-handles></svg>",!1,!0,!1),ul=$("<svg><g><circle r=6 fill=white stroke=#cccccc stroke-width=1 pointer-events=none></circle><rect class=resize-handle width=8 height=8 rx=1 fill=#007bff stroke=white stroke-width=1></svg>",!1,!0,!1);const fl=e=>{const{updateElement:t,setResizeOperation:i}=Ce(),[o,n]=Q(!1),[l,r]=Q(null),[s,c]=Q({x:0,y:0}),[a,v]=Q({width:0,height:0}),[g,C]=Q({x:0,y:0}),[I,R]=Q({width:0,height:0}),[z,K]=Q({x:0,y:0}),[M,D]=Q(!1),L=ie(()=>{const{position:E,size:w}=e.element,S=8/2,T=E.x,p=E.y,N=E.x+w.width,H=E.y+w.height,G=E.x+w.width/2,j=E.y+w.height/2;return[{position:"nw",cursor:"nw-resize",x:T-S,y:p-S},{position:"ne",cursor:"ne-resize",x:N-S,y:p-S},{position:"sw",cursor:"sw-resize",x:T-S,y:H-S},{position:"se",cursor:"se-resize",x:N-S,y:H-S},{position:"n",cursor:"n-resize",x:G-S,y:p-S},{position:"s",cursor:"s-resize",x:G-S,y:H-S},{position:"w",cursor:"w-resize",x:T-S,y:j-S},{position:"e",cursor:"e-resize",x:N-S,y:j-S}]}),V=(E,w,m,S=!1,T=!1)=>{const p=a(),N=g();let H=p.width,G=p.height,j=N.x,q=N.y;switch(E){case"nw":H=p.width-w,G=p.height-m,j=N.x+w,q=N.y+m;break;case"ne":H=p.width+w,G=p.height-m,q=N.y+m;break;case"sw":H=p.width-w,G=p.height+m,j=N.x+w;break;case"se":H=p.width+w,G=p.height+m;break;case"n":G=p.height-m,q=N.y+m;break;case"s":G=p.height+m;break;case"w":H=p.width-w,j=N.x+w;break;case"e":H=p.width+w;break}if(S&&(E==="nw"||E==="ne"||E==="sw"||E==="se")){const Y=p.width/p.height;H/G>Y?(H=G*Y,(E==="nw"||E==="sw")&&(j=N.x+(p.width-H))):(G=H/Y,(E==="nw"||E==="ne")&&(q=N.y+(p.height-G)))}if(T){const Y=N.x+p.width/2,ae=N.y+p.height/2;j=Y-H/2,q=ae-G/2}const U=20;return H=Math.max(U,H),G=Math.max(U,G),{size:{width:H,height:G},position:{x:j,y:q}}},B=E=>(E.preventDefault(),E.stopPropagation(),E.stopImmediatePropagation(),!1),ne=(E,w)=>{var m;i(!0),document.addEventListener("click",B,{capture:!0}),n(!0),r(E),c({x:w.clientX,y:w.clientY}),v({width:e.element.size.width,height:e.element.size.height}),C({x:e.element.position.x,y:e.element.position.y}),R(e.element.size),K(e.element.position),D(!1),document.addEventListener("mousemove",F),document.addEventListener("mouseup",W),document.body.style.cursor=((m=L().find(S=>S.position===E))==null?void 0:m.cursor)||"default"};let J=0;const F=E=>{if(!o())return;const w=l();if(!w)return;const m=s(),S=E.clientX-m.x,T=E.clientY-m.y,p=V(w,S,T,E.shiftKey,E.altKey);R(p.size),K(p.position),D(Math.abs(S)>2||Math.abs(T)>2);const N=Date.now();if(N-J>50)try{t(e.element.id,{size:p.size,position:p.position}),J=N}catch{}},W=()=>{if(!o()||!l())return;const w=()=>{document.removeEventListener("click",B,{capture:!0}),i(!1),n(!1),r(null),document.body.style.cursor="default",document.removeEventListener("mousemove",F),document.removeEventListener("mouseup",W)};if(M()){const m=I(),S=z();t(e.element.id,{size:m,position:S}).catch(T=>{t(e.element.id,{size:a(),position:g()}).catch(p=>{})})}w()};return ut(()=>{i(!1),document.removeEventListener("click",B,{capture:!0}),document.removeEventListener("mousemove",F),document.removeEventListener("mouseup",W),document.body.style.cursor="default"}),(()=>{var E=dl();return f(E,()=>L().map(w=>(()=>{var m=ul(),S=m.firstChild,T=S.nextSibling;return T.addEventListener("mouseleave",p=>{o()||(document.body.style.cursor="default")}),T.addEventListener("mouseenter",p=>{o()||(document.body.style.cursor=w.cursor)}),T.$$mousedown=p=>{p.stopPropagation(),p.preventDefault(),ne(w.position,p)},T.style.setProperty("pointer-events","all"),k(p=>{var N=w.x+4,H=w.y+4,G=w.x,j=w.y,q=w.cursor;return N!==p.e&&x(S,"cx",p.e=N),H!==p.t&&x(S,"cy",p.t=H),G!==p.a&&x(T,"x",p.a=G),j!==p.o&&x(T,"y",p.o=j),q!==p.i&&((p.i=q)!=null?T.style.setProperty("cursor",q):T.style.removeProperty("cursor")),p},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),m})())),E})()};Se(["mousedown"]);var ce=(e=>(e.IDLE="idle",e.SELECTING="selecting",e.DRAGGING="dragging",e))(ce||{});const hl={dragThreshold:3,updateThrottle:16};var gl=$("<div tabindex=0>"),vl=$("<div>"),yl=$("<div><div>🎯 统一交互层</div><div>模式: </div><div>选中: </div><div>悬停: "),ml=$("<div>拖拽: <!>个元素"),wl=$("<div>[<!>]");const bl=e=>{const{resizeOperation:t,setResizeOperation:i}=Ce(),o=hl;let n;const[l,r]=Q(ce.IDLE),[s,c]=Q([]),[a,v]=Q(null),[g,C]=Q(null),[I,R]=Q(null),z=(d,...u)=>{},K=d=>{if(!n)return{x:0,y:0};const u=n.getBoundingClientRect();return{x:d.clientX-u.left,y:d.clientY-u.top}},M=(d,u)=>d.x>=u.position.x&&d.x<=u.position.x+u.size.width&&d.y>=u.position.y&&d.y<=u.position.y+u.size.height,D=d=>{const u=e.getAllElements();for(let b=u.length-1;b>=0;b--){const h=u[b];if(h&&h.visible&&M(d,h))return h}return null},L=()=>{const d=[],u=s(),b=e.getAllElements();return u.forEach(h=>{const _=b.find(ze=>ze.id===h);if(!_||!_.visible)return;const A=8,P=A/2,X=_.position.x,oe=_.position.y,ee=_.position.x+_.size.width,xe=_.position.y+_.size.height,fe=_.position.x+_.size.width/2,Le=_.position.y+_.size.height/2;[{position:"nw",cursor:"nw-resize",x:X-P,y:oe-P},{position:"ne",cursor:"ne-resize",x:ee-P,y:oe-P},{position:"sw",cursor:"sw-resize",x:X-P,y:xe-P},{position:"se",cursor:"se-resize",x:ee-P,y:xe-P},{position:"n",cursor:"n-resize",x:fe-P,y:oe-P},{position:"s",cursor:"s-resize",x:fe-P,y:xe-P},{position:"w",cursor:"w-resize",x:X-P,y:Le-P},{position:"e",cursor:"e-resize",x:ee-P,y:Le-P}].forEach(ze=>{d.push({elementId:_.id,position:ze.position,cursor:ze.cursor,bounds:{x:ze.x,y:ze.y,width:A,height:A}})})}),d},V=d=>{const u=ye();for(let b=u.length-1;b>=0;b--){const h=u[b];if(!h)continue;const _=h.bounds;if(d.x>=_.x&&d.x<=_.x+_.width&&d.y>=_.y&&d.y<=_.y+_.height)return h}return null},B=d=>e.getAllElements().filter(b=>{if(!b.visible)return!1;const h={x:b.position.x,y:b.position.y,width:b.size.width,height:b.size.height};return!(h.x>d.x+d.width||h.x+h.width<d.x||h.y>d.y+d.height||h.y+h.height<d.y)}),ne=d=>{const u=K(d),b=V(u);if(b){z("点击ResizeHandle",{elementId:b.elementId,position:b.position}),W(b,u);return}if(t()){z();return}const h=D(u);z("鼠标按下",{point:u,elementId:h==null?void 0:h.id,currentMode:l()}),h?S(h,u,d):T(u)},[J,F]=Q(null),W=(d,u,b)=>{const h=e.getAllElements().find(_=>_.id===d.elementId);h&&(z("开始resize操作",{elementId:d.elementId,position:d.position}),i(!0),F({elementId:d.elementId,handlePosition:d.position,startPoint:u,initialSize:{width:h.size.width,height:h.size.height},initialPosition:{x:h.position.x,y:h.position.y},cursor:d.cursor}),Ee(d.cursor),z("resize状态已设置",J()))},E=(d,u,b,h,_)=>{let A=h.width,P=h.height,X=_.x,oe=_.y;switch(d){case"nw":A=h.width-u,P=h.height-b,X=_.x+u,oe=_.y+b;break;case"ne":A=h.width+u,P=h.height-b,oe=_.y+b;break;case"sw":A=h.width-u,P=h.height+b,X=_.x+u;break;case"se":A=h.width+u,P=h.height+b;break;case"n":P=h.height-b,oe=_.y+b;break;case"s":P=h.height+b;break;case"w":A=h.width-u,X=_.x+u;break;case"e":A=h.width+u;break}const ee=10;return A=Math.max(ee,A),P=Math.max(ee,P),{size:{width:A,height:P},position:{x:X,y:oe}}},w=d=>{const u=J();if(!u)return;const b=d.x-u.startPoint.x,h=d.y-u.startPoint.y,_=E(u.handlePosition,b,h,u.initialSize,u.initialPosition);U(()=>{e.onElementResize&&e.onElementResize(u.elementId,_.size,_.position)})},m=()=>{const d=J();d&&(z("完成resize操作",{elementId:d.elementId}),i(!1),F(null),Ee(),se.clear(),Y=[],z())},S=(d,u,b)=>{const h=s().includes(d.id);b.ctrlKey?p(d.id):b.shiftKey&&s().length>0?N(d.id):h?G(s(),u):H(d.id,u)},T=(d,u)=>{var b;z("开始框选",{point:d}),c([]),(b=e.onElementsSelect)==null||b.call(e,[]),r(ce.SELECTING),R({startPoint:d,currentPoint:d,selectedIds:[]})},p=d=>{var h;const u=s(),b=u.includes(d)?u.filter(_=>_!==d):[...u,d];z("切换选择",{elementId:d,newSelection:b}),c(b),(h=e.onElementsSelect)==null||h.call(e,b)},N=d=>{var b;const u=s();if(!u.includes(d)){const h=[...u,d];z("添加到选择",{elementId:d,newSelection:h}),c(h),(b=e.onElementsSelect)==null||b.call(e,h)}},H=(d,u,b)=>{var h;z("选择并准备拖拽",{elementId:d,point:u}),c([d]),(h=e.onElementsSelect)==null||h.call(e,[d]),G([d],u)},G=(d,u,b)=>{z("准备拖拽操作",{elementIds:d,startPoint:u});const h=e.getAllElements(),_=new Map;d.forEach(A=>{const P=h.find(X=>X.id===A);P&&_.set(A,{x:P.position.x,y:P.position.y})}),C({elementIds:d,startPoint:u,startPositions:_,currentOffset:{x:0,y:0},isDragging:!1})};let j=!1,q=0;const U=(d,u=!1)=>{if(u){d();return}Date.now()-q>=o.updateThrottle&&!j&&(j=!0,requestAnimationFrame(()=>{d(),j=!1,q=Date.now()}))};let Y=[],ae=[],se=new Map;const ye=()=>{const d=s(),u=e.getAllElements(),b=d.length!==ae.length||!d.every((_,A)=>_===ae[A]);let h=!1;if(!b)for(const _ of d){const A=u.find(oe=>oe.id===_);if(!A)continue;const P=se.get(_),X={x:A.position.x,y:A.position.y,width:A.size.width,height:A.size.height};if(!P||P.x!==X.x||P.y!==X.y||P.width!==X.width||P.height!==X.height){h=!0;break}}if(b||h){Y=L(),ae=[...d],se.clear();for(const _ of d){const A=u.find(P=>P.id===_);A&&se.set(_,{x:A.position.x,y:A.position.y,width:A.size.width,height:A.size.height})}z("ResizeHandle缓存更新",{reason:b?"selection":"geometry",selectedCount:d.length,handlesCount:Y.length})}return Y},we=d=>{const u=K(d),b=l();if(J()){w(u);return}b===ce.IDLE&&g()?ke(u):b===ce.DRAGGING?pe(u):b===ce.SELECTING?jt(u):be(u)},be=d=>{const u=V(d);if(u){Ee(u.cursor),a()!==null&&v(null);return}const b=D(d),h=(b==null?void 0:b.id)||null,_=a();h!==_&&(v(h),Ee())},ke=d=>{const u=g();if(!u)return;const b=Math.sqrt(Math.pow(d.x-u.startPoint.x,2)+Math.pow(d.y-u.startPoint.y,2));b>o.dragThreshold&&(z("开始拖拽",{distance:b,threshold:o.dragThreshold}),r(ce.DRAGGING),C({...u,isDragging:!0}),Ee("grabbing"))},pe=d=>{const u=g();if(!u)return;const b={x:d.x-u.startPoint.x,y:d.y-u.startPoint.y};C({...u,currentOffset:b}),U(()=>{if(!e.onElementMove)return;const h=u.elementIds.map(_=>{const A=u.startPositions.get(_);if(A)return e.onElementMove(_,{x:A.x+b.x,y:A.y+b.y})}).filter(Boolean);Promise.allSettled(h).catch(()=>{})})},jt=d=>{const u=I();if(!u)return;const b={...u,currentPoint:d};R(b);const h={x:Math.min(u.startPoint.x,d.x),y:Math.min(u.startPoint.y,d.y),width:Math.abs(d.x-u.startPoint.x),height:Math.abs(d.y-u.startPoint.y)},A=B(h).map(P=>P.id);R({...b,selectedIds:A}),c(A)};let ht="default";const Ee=d=>{if(!n)return;let u=d;if(!u){const b=l(),h=a();b===ce.DRAGGING?u="grabbing":b===ce.SELECTING?u="crosshair":h&&s().includes(h)?u="grab":h?u="pointer":u="default"}ht!==u&&(n.style.cursor=u,ht=u)},gt=()=>{const d=l();if(z("鼠标释放",{currentMode:d,hasResizeState:!!J()}),J()){m();return}d===ce.DRAGGING?Gt():d===ce.SELECTING&&Bt(),Vt()},Gt=()=>{const d=g();if(!d||!d.isDragging&&d.currentOffset.x===0&&d.currentOffset.y===0){z();return}U(()=>{if(!e.onElementMove)return;const u=d.elementIds.map(async b=>{const h=d.startPositions.get(b);if(h){const _={x:h.x+d.currentOffset.x,y:h.y+d.currentOffset.y};return z("拖拽完成",{elementId:b,finalPosition:_}),e.onElementMove(b,_)}}).filter(Boolean);Promise.allSettled(u).catch(b=>{console.warn("拖拽最终更新部分失败:",b)})},!0),(d.currentOffset.x!==0||d.currentOffset.y!==0)&&(se.clear(),Y=[],z())},Bt=()=>{const d=I();d&&(z("框选完成",{selectedCount:d.selectedIds.length}),e.onElementsSelect&&e.onElementsSelect(d.selectedIds))},Vt=()=>{r(ce.IDLE),C(null),R(null),Ee()},qt=()=>{};nt(()=>{document.addEventListener("mousemove",we),document.addEventListener("mouseup",gt),z()}),ut(()=>{document.removeEventListener("mousemove",we),document.removeEventListener("mouseup",gt),z()});const Ie=()=>{const d=I();if(!d||l()!==ce.SELECTING)return null;const{startPoint:u,currentPoint:b}=d;return{x:Math.min(u.x,b.x),y:Math.min(u.y,b.y),width:Math.abs(b.x-u.x),height:Math.abs(b.y-u.y)}};return(()=>{var d=gl();d.$$click=qt,d.$$mousedown=ne;var u=n;return typeof u=="function"?Mt(u,d):n=d,d.style.setProperty("position","absolute"),d.style.setProperty("top","0"),d.style.setProperty("left","0"),d.style.setProperty("width","100%"),d.style.setProperty("height","100%"),d.style.setProperty("z-index","10"),d.style.setProperty("pointer-events","all"),d.style.setProperty("background","transparent"),d.style.setProperty("user-select","none"),f(d,(()=>{var b=ue(()=>!!Ie());return()=>b()&&(()=>{var h=vl();return h.style.setProperty("position","absolute"),h.style.setProperty("border","1px dashed #007acc"),h.style.setProperty("background","rgba(0, 122, 204, 0.1)"),h.style.setProperty("pointer-events","none"),k(_=>{var A=`${Ie().x}px`,P=`${Ie().y}px`,X=`${Ie().width}px`,oe=`${Ie().height}px`;return A!==_.e&&((_.e=A)!=null?h.style.setProperty("left",A):h.style.removeProperty("left")),P!==_.t&&((_.t=P)!=null?h.style.setProperty("top",P):h.style.removeProperty("top")),X!==_.a&&((_.a=X)!=null?h.style.setProperty("width",X):h.style.removeProperty("width")),oe!==_.o&&((_.o=oe)!=null?h.style.setProperty("height",oe):h.style.removeProperty("height")),_},{e:void 0,t:void 0,a:void 0,o:void 0}),h})()})(),null),f(d,(()=>{var b=ue(()=>!!e.enableDebugMode);return()=>b()&&(()=>{var h=yl(),_=h.firstChild,A=_.nextSibling;A.firstChild;var P=A.nextSibling;P.firstChild;var X=P.nextSibling;return X.firstChild,h.style.setProperty("position","fixed"),h.style.setProperty("top","10px"),h.style.setProperty("right","10px"),h.style.setProperty("padding","8px"),h.style.setProperty("background","rgba(0, 0, 0, 0.8)"),h.style.setProperty("color","white"),h.style.setProperty("font-family","monospace"),h.style.setProperty("font-size","12px"),h.style.setProperty("border-radius","4px"),h.style.setProperty("z-index","9999"),h.style.setProperty("pointer-events","none"),f(A,l,null),f(P,()=>s().length,null),f(X,()=>a()||"无",null),f(h,(()=>{var oe=ue(()=>{var ee;return!!((ee=g())!=null&&ee.isDragging)});return()=>oe()&&(()=>{var ee=ml(),xe=ee.firstChild,fe=xe.nextSibling;return fe.nextSibling,ee.style.setProperty("color","#ffeb3b"),f(ee,()=>{var Le;return(Le=g())==null?void 0:Le.elementIds.length},fe),ee})()})(),null),f(h,(()=>{var oe=ue(()=>s().length>0);return()=>oe()&&(()=>{var ee=wl(),xe=ee.firstChild,fe=xe.nextSibling;return fe.nextSibling,ee.style.setProperty("font-size","10px"),ee.style.setProperty("color","#ccc"),f(ee,()=>s().slice(0,3).join(", "),fe),f(ee,()=>s().length>3&&"...",fe),ee})()})(),null),h})()})(),null),d})()};Se(["mousedown","click"]);var pl=$('<div class="flex-1 flex flex-col overflow-hidden"><div class="h-12 bg-primary border-b border-default flex items-center px-4"><div class="text-sm text-secondary">Canvas: <!> × <!>px<span class="ml-4 px-2 py-1 bg-blue-100 rounded text-xs">元素: <!> | 选中: </span></div></div><div class="flex-1 overflow-auto custom-scrollbar bg-tertiary p-4"><div class="flex items-center justify-center min-h-full"><div class="bg-canvas-bg shadow-lg rounded-lg overflow-hidden"><svg class=block><rect></rect><rect fill=none stroke=var(--color-border) stroke-width=1></rect><g class=elements-layer></g><g class=resize-handles-layer>'),xl=$("<span class=ml-2>Zoom: <!>%"),xt=$("<svg><text dominant-baseline=hanging></svg>",!1,!0,!1),_l=$("<svg><tspan></svg>",!1,!0,!1),$l=$("<svg><rect x=0 y=0></svg>",!1,!0,!1),Sl=$("<svg><line x1=0></svg>",!1,!0,!1),Cl=$('<svg><rect x=0 y=0 fill="rgba(59, 130, 246, 0.1)"stroke="rgba(59, 130, 246, 0.3)"stroke-width=1 stroke-dasharray=2,2></svg>',!1,!0,!1),kl=$("<svg><rect x=0 y=0 fill=#f0f0f0 stroke=#ccc stroke-width=1 stroke-dasharray=5,5></svg>",!1,!0,!1),El=$("<svg><g></svg>",!1,!0,!1);const zl=()=>{const{state:e,selectElement:t,clearSelection:i,createElement:o,selectMultiple:n,updateElement:l}=Ce();let r;const[s,c]=Q([]),a=ie(()=>e.elements.filter(M=>M.visible)),v=(M,D)=>{if(!r)return{x:0,y:0};const L=r.getBoundingClientRect(),V=(M-L.left)/e.canvas_config.zoom,B=(D-L.top)/e.canvas_config.zoom;return{x:V,y:B}},g=async M=>{console.log("🎯 选择元素",M),c([...M]);try{M.length===0?await i():M.length===1?await t(M[0]):await n([...M])}catch(D){console.error("❌ 选择元素失败:",D)}},C=async(M,D)=>{try{await l(M,{position:{x:D.x,y:D.y}})}catch(L){console.error("❌ 移动元素失败:",L)}},I=async(M,D,L)=>{try{await l(M,{size:D,position:L})}catch(V){console.error("❌ 调整大小失败:",V)}},R=async M=>{console.log("🖱️ 画布点击",M)},z=async M=>{var D;M.preventDefault();try{const L=(D=M.dataTransfer)==null?void 0:D.getData("application/json");if(!L)return;const{type:V,component:B}=JSON.parse(L);if(V==="component"){const{x:ne,y:J}=v(M.clientX,M.clientY),F=Math.max(0,ne-B.default_size.width/2),W=Math.max(0,J-B.default_size.height/2);console.log("🎯 通过拖放创建组件:",B.name,"at",F,W);const E=await o(B.id,{x:F,y:W},B.default_size,B.create_content());console.log("✅ 通过拖放创建元素成功:",E),c([E]),await t(E)}}catch(L){console.error("拖放处理失败:",L)}};nt(()=>{c([...e.selected_ids])}),ie(()=>{c([...e.selected_ids])});const K=ie(()=>{const{width:M,height:D}=e.canvas_config;return`0 0 ${M} ${D}`});return(()=>{var M=pl(),D=M.firstChild,L=D.firstChild,V=L.firstChild,B=V.nextSibling,ne=B.nextSibling,J=ne.nextSibling,F=J.nextSibling,W=F.nextSibling,E=W.firstChild,w=E.nextSibling;w.nextSibling;var m=D.nextSibling,S=m.firstChild,T=S.firstChild,p=T.firstChild,N=p.firstChild,H=N.nextSibling,G=H.nextSibling,j=G.nextSibling;f(L,()=>e.canvas_config.width,B),f(L,()=>e.canvas_config.height,J),f(L,(()=>{var U=ue(()=>e.canvas_config.zoom!==1);return()=>U()&&(()=>{var Y=xl(),ae=Y.firstChild,se=ae.nextSibling;return se.nextSibling,f(Y,()=>Math.round(e.canvas_config.zoom*100),se),Y})()})(),W),f(W,()=>e.elements.length,w),f(W,()=>s().length,null),T.style.setProperty("position","relative"),p.addEventListener("drop",z),p.addEventListener("dragover",U=>{U.preventDefault(),U.dataTransfer.dropEffect="copy"}),p.$$contextmenu=U=>U.preventDefault();var q=r;return typeof q=="function"?Mt(q,p):r=p,f(p,y(cl,{get config(){return e.canvas_config}}),H),f(G,y(_e,{get each(){return a()},children:U=>y(Pl,{element:U,get selected(){return s().includes(U.id)}})})),f(j,y(_e,{get each(){return a().filter(U=>s().includes(U.id))},children:U=>y(fl,{element:U})})),f(T,y(bl,{canvasRef:r,getAllElements:()=>[...e.elements],onElementsSelect:g,onElementMove:C,onElementResize:I,onCanvasClick:R,get enableDebugMode(){return!1}}),null),k(U=>{var Y=e.canvas_config.width*e.canvas_config.zoom,ae=e.canvas_config.height*e.canvas_config.zoom,se=K(),ye=e.canvas_config.width,we=e.canvas_config.height,be=e.canvas_config.background_color,ke=e.canvas_config.width,pe=e.canvas_config.height;return Y!==U.e&&x(p,"width",U.e=Y),ae!==U.t&&x(p,"height",U.t=ae),se!==U.a&&x(p,"viewBox",U.a=se),ye!==U.o&&x(N,"width",U.o=ye),we!==U.i&&x(N,"height",U.i=we),be!==U.n&&x(N,"fill",U.n=be),ke!==U.s&&x(H,"width",U.s=ke),pe!==U.h&&x(H,"height",U.h=pe),U},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),M})()},Pl=e=>{const t=ie(()=>{const{position:o}=e.element;return{transform:`translate(${o.x}px, ${o.y}px)`,opacity:e.element.visible?1:.5}}),i=()=>{const{content:o,size:n}=e.element;if(o.type==="Text"&&o.content&&o.style){const l=o.style.align,r=l==="Center"?"middle":l==="Right"?"end":"start",s=l==="Center"?n.width/2:l==="Right"?n.width:0;return(()=>{var c=xt();return x(c,"x",s),x(c,"text-anchor",r),f(c,()=>o.content.split(`
`).map((a,v)=>(()=>{var g=_l();return x(g,"x",s),f(g,a),k(()=>x(g,"dy",v===0?0:o.style.font_size*1.2)),g})())),k(a=>{var v=o.style.font_size*.75,g=o.style.font_family,C=`${o.style.font_size}`,I=o.style.font_weight,R=o.style.color;return v!==a.e&&x(c,"y",a.e=v),g!==a.t&&x(c,"font-family",a.t=g),C!==a.a&&x(c,"font-size",a.a=C),I!==a.o&&x(c,"font-weight",a.o=I),R!==a.i&&x(c,"fill",a.i=R),a},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),c})()}if(o.type==="Rectangle"){const l=o.opacity!==void 0?o.opacity:1,r=o.corner_radius||0;return(()=>{var s=$l();return x(s,"rx",r),x(s,"ry",r),x(s,"fill-opacity",l),x(s,"stroke-opacity",l),k(c=>{var z,K,M,D;var a=n.width,v=n.height,g=o.fill_color||"transparent",C=((z=o.border)==null?void 0:z.color)||"#000000",I=((K=o.border)==null?void 0:K.width)||1,R=((M=o.border)==null?void 0:M.style)==="Dashed"?"5,5":((D=o.border)==null?void 0:D.style)==="Dotted"?"2,2":"none";return a!==c.e&&x(s,"width",c.e=a),v!==c.t&&x(s,"height",c.t=v),g!==c.a&&x(s,"fill",c.a=g),C!==c.o&&x(s,"stroke",c.o=C),I!==c.i&&x(s,"stroke-width",c.i=I),R!==c.n&&x(s,"stroke-dasharray",c.n=R),c},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),s})()}if(o.type==="Line"){const l=o.opacity!==void 0?o.opacity:1,r=o.line_style||"Solid",s=r==="Dashed"?"8,4":r==="Dotted"?"2,2":r==="DashDot"?"8,4,2,4":"none";return(()=>{var c=Sl();return x(c,"stroke-opacity",l),x(c,"stroke-dasharray",s),k(a=>{var v=n.height/2,g=n.width,C=n.height/2,I=o.color,R=o.width;return v!==a.e&&x(c,"y1",a.e=v),g!==a.t&&x(c,"x2",a.t=g),C!==a.a&&x(c,"y2",a.a=C),I!==a.o&&x(c,"stroke",a.o=I),R!==a.i&&x(c,"stroke-width",a.i=R),a},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),c})()}return o.type==="DataField"&&o.style?[(()=>{var l=Cl();return k(r=>{var s=n.width,c=n.height;return s!==r.e&&x(l,"width",r.e=s),c!==r.t&&x(l,"height",r.t=c),r},{e:void 0,t:void 0}),l})(),(()=>{var l=xt();return f(l,()=>o.expression||"[数据字段]"),k(r=>{var s=o.style.align==="Center"?n.width/2:o.style.align==="Right"?n.width-4:4,c=o.style.font_size*.8,a=o.style.font_family,v=`${o.style.font_size}`,g=o.style.font_weight,C=o.style.color,I=o.style.align==="Center"?"middle":o.style.align==="Right"?"end":"start";return s!==r.e&&x(l,"x",r.e=s),c!==r.t&&x(l,"y",r.t=c),a!==r.a&&x(l,"font-family",r.a=a),v!==r.o&&x(l,"font-size",r.o=v),g!==r.i&&x(l,"font-weight",r.i=g),C!==r.n&&x(l,"fill",r.n=C),I!==r.s&&x(l,"text-anchor",r.s=I),r},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),l})()]:(()=>{var l=kl();return k(r=>{var s=n.width,c=n.height;return s!==r.e&&x(l,"width",r.e=s),c!==r.t&&x(l,"height",r.t=c),r},{e:void 0,t:void 0}),l})()};return(()=>{var o=El();return f(o,i),k(n=>{var l=`element ${e.selected?"element-selected":""}`,r=t(),s=e.element.id,c=e.element.content.type;return l!==n.e&&x(o,"class",n.e=l),n.t=un(o,r,n.t),s!==n.a&&x(o,"data-element-id",n.a=s),c!==n.o&&x(o,"data-element-type",n.o=c),n},{e:void 0,t:void 0,a:void 0,o:void 0}),o})()};Se(["contextmenu"]);var Al=$('<button class="fixed top-20 right-4 z-50 bg-yellow-500 hover:bg-yellow-600 text-white px-3 py-2 rounded-lg shadow-lg text-sm font-medium"title=开启/关闭测试面板>🧪 测试'),Ml=$('<div class="fixed top-16 right-4 z-40 bg-white rounded-lg shadow-xl border border-gray-200 p-4 w-80 max-h-96 overflow-y-auto"><div class="flex items-center justify-between mb-4"><h3 class="text-lg font-semibold text-gray-800">🧪 测试面板</h3><button class="text-gray-500 hover:text-gray-700">✕</button></div><div class="mb-4 p-3 bg-gray-50 rounded-lg"><div class="text-sm text-gray-600"><div>元素总数: <span class=font-medium></span></div><div>已选择: <span class=font-medium></span></div><div>可撤销: <span class=font-medium></span></div><div>可重做: <span class=font-medium></span></div></div></div><div class="space-y-2 mb-4"><button class="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 px-3 rounded text-sm">🚀 运行所有测试</button><button class="w-full bg-red-500 hover:bg-red-600 text-white py-2 px-3 rounded text-sm">🧹 清理元素</button></div><div class=space-y-2><h4 class="text-sm font-medium text-gray-700 mb-2">单独测试:</h4></div><div class=mt-4><h4 class="text-sm font-medium text-gray-700 mb-2">当前元素:</h4><div class="max-h-32 overflow-y-auto">'),Dl=$('<button class="w-full bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 px-3 rounded text-sm text-left">'),Il=$('<div><div class=font-medium></div><div class="text-gray-500 truncate">ID: <!>...</div><div class=text-gray-500>位置: (<!>, <!>)'),Ll=$('<div class="text-xs text-gray-500 p-2">暂无元素');const Ul=()=>{const{state:e,createElement:t,selectElement:i,clearSelection:o}=Ce(),[n,l]=Q(!1),r=[{name:"创建文字元素",action:async()=>{const v=await t("text",{x:100,y:100},{width:100,height:24},{type:"Text",content:"测试文字",style:{font_family:"SimSun",font_size:14,font_weight:"normal",color:"#000000",align:"Left"}});return console.log("✅ 测试文字元素创建成功:",v),v}},{name:"创建矩形元素",action:async()=>{const v=await t("rectangle",{x:250,y:100},{width:100,height:60},{type:"Rectangle",fill_color:"rgba(59, 130, 246, 0.2)",border:{color:"#3b82f6",width:2,style:"Solid"}});return console.log("✅ 测试矩形元素创建成功:",v),v}},{name:"创建线条元素",action:async()=>{const v=await t("line",{x:400,y:130},{width:150,height:2},{type:"Line",color:"#ef4444",width:3});return console.log("✅ 测试线条元素创建成功:",v),v}},{name:"创建数据字段",action:async()=>{const v=await t("data_field",{x:100,y:200},{width:120,height:24},{type:"DataField",expression:"${测试数据}",format:void 0,style:{font_family:"SimSun",font_size:12,font_weight:"bold",color:"#059669",align:"Left"}});return console.log("✅ 测试数据字段创建成功:",v),v}}],s=async v=>{try{console.log(`🧪 开始测试: ${v.name}`);const g=await v.action();await i(g),console.log(`✅ 测试完成: ${v.name}, 元素ID: ${g}`)}catch(g){console.error(`❌ 测试失败: ${v.name}`,g)}},c=async()=>{console.log("🚀 开始运行所有测试案例..."),await o();for(const v of r)await s(v),await new Promise(g=>setTimeout(g,500));console.log("🎉 所有测试案例运行完成!")},a=async()=>{try{console.log("🧹 清理所有测试元素..."),await o(),console.log("✅ 清理完成")}catch(v){console.error("❌ 清理失败:",v)}};return[(()=>{var v=Al();return v.$$click=()=>l(!n()),v})(),ue(()=>ue(()=>!!n())()&&(()=>{var v=Ml(),g=v.firstChild,C=g.firstChild,I=C.nextSibling,R=g.nextSibling,z=R.firstChild,K=z.firstChild,M=K.firstChild,D=M.nextSibling,L=K.nextSibling,V=L.firstChild,B=V.nextSibling,ne=L.nextSibling,J=ne.firstChild,F=J.nextSibling,W=ne.nextSibling,E=W.firstChild,w=E.nextSibling,m=R.nextSibling,S=m.firstChild,T=S.nextSibling,p=m.nextSibling;p.firstChild;var N=p.nextSibling,H=N.firstChild,G=H.nextSibling;return I.$$click=()=>l(!1),f(D,()=>e.elements.length),f(B,()=>e.selected_ids.length),f(F,()=>e.can_undo?"是":"否"),f(w,()=>e.can_redo?"是":"否"),S.$$click=c,T.$$click=a,f(p,y(_e,{each:r,children:j=>(()=>{var q=Dl();return q.$$click=()=>s(j),f(q,()=>j.name),q})()}),null),f(G,y(_e,{get each(){return e.elements},children:j=>(()=>{var q=Il(),U=q.firstChild,Y=U.nextSibling,ae=Y.firstChild,se=ae.nextSibling;se.nextSibling;var ye=Y.nextSibling,we=ye.firstChild,be=we.nextSibling,ke=be.nextSibling,pe=ke.nextSibling;return pe.nextSibling,q.$$click=()=>i(j.id),f(U,()=>j.content.type),f(Y,()=>j.id.slice(0,8),se),f(ye,()=>Math.round(j.position.x),be),f(ye,()=>Math.round(j.position.y),pe),k(()=>Ae(q,`text-xs p-2 mb-1 rounded cursor-pointer ${e.selected_ids.includes(j.id)?"bg-blue-100 border border-blue-300":"bg-gray-50 hover:bg-gray-100"}`)),q})()}),null),f(G,(()=>{var j=ue(()=>e.elements.length===0);return()=>j()&&Ll()})(),null),v})())]};Se(["click"]);var Tl=$('<div class="h-full flex flex-col bg-secondary"><div class="flex-1 flex overflow-hidden"><div class="w-80 bg-primary border-r border-default flex flex-col"></div><div class="flex-1 flex flex-col bg-tertiary"></div><div class="w-80 bg-primary border-l border-default flex flex-col">');const Rl=()=>(()=>{var e=Tl(),t=e.firstChild,i=t.firstChild,o=i.nextSibling,n=o.nextSibling;return f(e,y(Sn,{}),t),f(i,y(En,{})),f(o,y(zl,{})),f(n,y(el,{})),f(e,y(Ul,{}),null),e})(),Ol=()=>(nt(()=>{document.addEventListener("contextmenu",e=>e.preventDefault())}),y(bn,{get children(){return y(Rl,{})}})),Fl=document.getElementById("root");dn(()=>y(Ol,{}),Fl);
