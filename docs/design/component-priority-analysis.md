# ğŸ¯ æ¶æ„ç»„ä»¶ä¼˜å…ˆçº§åˆ†æ

**çŠ¶æ€**: â¸ï¸ **å·²æš‚åœ** - å‚è€ƒç”¨é€”  
**æš‚åœæ—¥æœŸ**: 2025-01-27  
**å†³ç­–æ–‡æ¡£**: [P0è®¾è®¡è®¨è®ºv2.4 - æš‚åœæ¢ç´¢](./p0-design-discussion-v2.4.md)  
**è°ƒæ•´ä¸º**: åŠŸèƒ½å¼€å‘ä¼˜å…ˆçº§åˆ†æ

---

## âš ï¸ **é‡è¦è¯´æ˜ - æ¶æ„é‡æ„å·²æš‚åœ**

**æš‚åœåŸå› **:
1. ğŸ“Š **ç°æœ‰æ¶æ„è´¨é‡è¢«é‡æ–°è¯„ä¼°** - Solid.js + Tauriæ¶æ„å·²ç»ä¼˜ç§€
2. ğŸ¯ **åŸå§‹é—®é¢˜å·²å¤§éƒ¨åˆ†è§£å†³** - æ–‡æœ¬é€‰ä¸­ã€äº¤äº’å†²çªç­‰æ ¸å¿ƒé—®é¢˜å·²ä¿®å¤
3. ğŸ’° **æˆæœ¬æ”¶ç›Šä¸åŒ¹é…** - 6-15å‘¨é‡æ„æˆæœ¬ vs æœ‰é™ç”¨æˆ·ä»·å€¼
4. ğŸš€ **ä¸šåŠ¡å‘å±•éœ€è¦åŠŸèƒ½åˆ›æ–°** - èµ„æºåº”èšç„¦æ–°å…ƒç´ ã€å¯¼å‡ºã€æ¨¡æ¿ç­‰åŠŸèƒ½

**æ–°ç­–ç•¥**: åŸºäºç°æœ‰æ¶æ„è¿›è¡Œç²¾ç¡®ä¼˜åŒ–ï¼Œç„¶åèšç„¦åŠŸèƒ½å¼€å‘

---

## ğŸ¯ **æ–°çš„ä¼˜å…ˆçº§ï¼šåŠŸèƒ½å¼€å‘å¯¼å‘**

åŸºäºæš‚åœæ¶æ„é‡æ„çš„å†³ç­–ï¼Œæˆ‘ä»¬é‡æ–°å®šä¹‰ä¼˜å…ˆçº§ä¸º**ç”¨æˆ·ä»·å€¼å¯¼å‘çš„åŠŸèƒ½å¼€å‘**ï¼š

### ğŸ”¥ **P0çº§ - ç”¨æˆ·ä½“éªŒä¼˜åŒ–** (ç«‹å³æ‰§è¡Œ)
```typescript
ğŸ“ˆ 1å‘¨é«˜ä»·å€¼ä¼˜åŒ–è®¡åˆ’:
â”œâ”€â”€ Day 1-2: æ€§èƒ½å¾®è°ƒ
â”‚   â”œâ”€â”€ æ‰©å±•batchUpdatePositionsä¸ºé€šç”¨æ‰¹é‡æ“ä½œ
â”‚   â”œâ”€â”€ ä¼˜åŒ–ä¸å¿…è¦çš„loadAppStateè°ƒç”¨
â”‚   â””â”€â”€ å†…å­˜æ³„æ¼æ£€æŸ¥å’Œä¿®å¤
â”œâ”€â”€ Day 3-4: ç”¨æˆ·ä½“éªŒå®Œå–„
â”‚   â”œâ”€â”€ å…‰æ ‡çŠ¶æ€ç®¡ç†ä¼˜åŒ–
â”‚   â”œâ”€â”€ è§†è§‰åé¦ˆå¢å¼º
â”‚   â””â”€â”€ é”™è¯¯æç¤ºå‹å¥½åŒ–
â””â”€â”€ Day 5: å¼€å‘ä½“éªŒæ”¹è¿›
    â”œâ”€â”€ å…³é”®æ¨¡å—æ–‡æ¡£å®Œå–„
    â””â”€â”€ ä»£ç ç»“æ„å¾®è°ƒ
```

### ğŸŸ¡ **P1çº§ - åŠŸèƒ½æ‰©å±•** (æ¥ä¸‹æ¥1-2ä¸ªæœˆ)
```typescript
ğŸ¯ æ–°å…ƒç´ ç±»å‹å¼€å‘:
â”œâ”€â”€ å›¾è¡¨å…ƒç´  (æŸ±çŠ¶å›¾ã€é¥¼å›¾ã€æŠ˜çº¿å›¾)
â”œâ”€â”€ è¡¨æ ¼å…ƒç´  (å¯ç¼–è¾‘è¡¨æ ¼)
â”œâ”€â”€ æ¡ç å…ƒç´  (ä¸€ç»´ç ã€äºŒç»´ç )
â””â”€â”€ å›¾ç‰‡å…ƒç´ å¢å¼º (ç¼©æ”¾ã€è£å‰ª)

ğŸ“¤ å¯¼å‡ºç³»ç»Ÿå¢å¼º:
â”œâ”€â”€ PDFè´¨é‡æå‡
â”œâ”€â”€ å¤šæ ¼å¼æ”¯æŒ (PNGã€SVGã€HTML)
â”œâ”€â”€ æ‰¹é‡å¯¼å‡ºåŠŸèƒ½
â””â”€â”€ å¯¼å‡ºé¢„è§ˆåŠŸèƒ½

ğŸ“‹ æ¨¡æ¿ç³»ç»Ÿå®Œå–„:
â”œâ”€â”€ æ¨¡æ¿åº“ç®¡ç†
â”œâ”€â”€ æ¨¡æ¿åˆ†ç±»å’Œæœç´¢
â”œâ”€â”€ æ¨¡æ¿åˆ†äº«æœºåˆ¶
â””â”€â”€ è‡ªå®šä¹‰æ¨¡æ¿åˆ›å»º
```

### ğŸ”µ **P2çº§ - å¹³å°æ‰©å±•** (2-4ä¸ªæœˆ)
```typescript
ğŸŒ Webç‰ˆæœ¬å¼€å‘:
â”œâ”€â”€ å“åº”å¼ç•Œé¢é€‚é…
â”œâ”€â”€ æµè§ˆå™¨å…¼å®¹æ€§å¤„ç†
â”œâ”€â”€ Webç«¯æ€§èƒ½ä¼˜åŒ–
â””â”€â”€ è·¨å¹³å°æ•°æ®åŒæ­¥

ğŸ“± ç§»åŠ¨ç«¯é€‚é…:
â”œâ”€â”€ è§¦æ‘¸äº¤äº’ä¼˜åŒ–
â”œâ”€â”€ ç§»åŠ¨ç«¯å¸ƒå±€è°ƒæ•´
â”œâ”€â”€ æ‰‹åŠ¿æ“ä½œæ”¯æŒ
â””â”€â”€ ç¦»çº¿ç¼–è¾‘åŠŸèƒ½

ğŸ”Œ APIæ¥å£å¼€æ”¾:
â”œâ”€â”€ RESTful APIè®¾è®¡
â”œâ”€â”€ ç¬¬ä¸‰æ–¹é›†æˆæ¥å£
â”œâ”€â”€ Webhookæ”¯æŒ
â””â”€â”€ APIæ–‡æ¡£å’ŒSDK
```

### ğŸŸ¢ **P3çº§ - é«˜çº§åŠŸèƒ½** (æŒ‰ä¸šåŠ¡éœ€æ±‚)
```typescript
ğŸ¤ åä½œåŠŸèƒ½:
â”œâ”€â”€ å¤šç”¨æˆ·å®æ—¶ç¼–è¾‘
â”œâ”€â”€ ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ
â”œâ”€â”€ æƒé™ç®¡ç†
â””â”€â”€ è¯„è®ºå’Œå®¡æ‰¹æµç¨‹

ğŸ“Š ä¼ä¸šçº§åŠŸèƒ½:
â”œâ”€â”€ æ•°æ®æºé›†æˆ (æ•°æ®åº“ã€API)
â”œâ”€â”€ åŠ¨æ€æ•°æ®ç»‘å®š
â”œâ”€â”€ è‡ªåŠ¨åŒ–æŠ¥è¡¨ç”Ÿæˆ
â””â”€â”€ ä¼ä¸šçº§å®‰å…¨å’Œæƒé™
```

---

## ğŸ“Š **åŸæ¶æ„åˆ†æä¿ç•™** (æŠ€æœ¯å‚è€ƒ)

> ä»¥ä¸‹ä¸ºåŸå§‹æ¶æ„ä¼˜å…ˆçº§åˆ†æï¼Œä¿ç•™ä½œä¸ºæŠ€æœ¯å†³ç­–å‚è€ƒ

### è¯„ä¼°ç»´åº¦å®šä¹‰
- **åŠŸèƒ½ä¾èµ–**: å…¶ä»–ç»„ä»¶å¯¹è¯¥ç»„ä»¶çš„ä¾èµ–ç¨‹åº¦ (1-5åˆ†)
- **ç”¨æˆ·ä»·å€¼**: å¯¹æœ€ç»ˆç”¨æˆ·ä½“éªŒçš„ç›´æ¥å½±å“ (1-5åˆ†)  
- **å®ç°å¤æ‚åº¦**: å¼€å‘éš¾åº¦å’ŒæŠ€æœ¯é£é™© (1-5åˆ†ï¼Œåˆ†æ•°è¶Šé«˜è¶Šå¤æ‚)
- **æ¶æ„å½±å“**: å¯¹æ•´ä½“æ¶æ„ç¨³å®šæ€§çš„é‡è¦æ€§ (1-5åˆ†)

## ğŸ—ï¸ ä¾èµ–å…³ç³»åˆ†æ

```
ä¾èµ–å±‚æ¬¡å›¾ (ä»åº•å±‚åˆ°é¡¶å±‚):

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  åº”ç”¨å±‚
â”‚  JasperDesigner â”‚  â† é›†æˆæ‰€æœ‰ç»„ä»¶
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  æ’ä»¶ç³»ç»Ÿå±‚  
â”‚  PluginManager  â”‚  â† æ‰©å±•åŠŸèƒ½
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  æ¸²æŸ“å±‚ç³»ç»Ÿ
â”‚ LayerManager    â”‚  â† æ¸²æŸ“æ¶æ„æ ¸å¿ƒ
â”‚ ContentRenderer â”‚  â† è§†è§‰è¾“å‡ºæ ¸å¿ƒ  
â”‚ SelectionRender â”‚  â† é€‰ä¸­è§†è§‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  ä¸“ä¸šåŠŸèƒ½å±‚
â”‚ SelectionSystem â”‚  â† ç”¨æˆ·äº¤äº’æ ¸å¿ƒ
â”‚ InteractionSys  â”‚  â† ç”¨æˆ·äº¤äº’æ ¸å¿ƒ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  æ ¸å¿ƒæŠ½è±¡å±‚
â”‚ ElementManager  â”‚  â† ä¸šåŠ¡é€»è¾‘æ ¸å¿ƒ
â”‚ RenderLayer     â”‚  â† æ¸²æŸ“æŠ½è±¡
â”‚ RenderableElem  â”‚  â† å…ƒç´ æ¥å£
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  åŸºç¡€è®¾æ–½å±‚
â”‚ EventBus        â”‚  â† ç³»ç»Ÿé€šä¿¡åŸºç¡€
â”‚ StateEngine     â”‚  â† çŠ¶æ€ç®¡ç†åŸºç¡€
â”‚ GeometryEngine  â”‚  â† å‡ ä½•è®¡ç®—åŸºç¡€
â”‚ RenderEngine    â”‚  â† æ¸²æŸ“å¼•æ“åŸºç¡€
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  æ•°æ®å±‚ (å¯é€‰)
â”‚ DataSourceMgr   â”‚  â† ä¼ä¸šåŠŸèƒ½
â”‚ QueryEngine     â”‚  â† æ•°æ®å¤„ç†
â”‚ DataBindingMgr  â”‚  â† æ•°æ®ç»‘å®š
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‹ ç»„ä»¶ä¼˜å…ˆçº§çŸ©é˜µ

| ç»„ä»¶ | åŠŸèƒ½ä¾èµ– | ç”¨æˆ·ä»·å€¼ | å®ç°å¤æ‚åº¦ | æ¶æ„å½±å“ | ç»¼åˆè¯„åˆ† | ä¼˜å…ˆçº§ |
|------|----------|----------|------------|----------|----------|--------|
| **EventBus** | 5 | 2 | 2 | 5 | **14** | ğŸ”¥ P0 |
| **StateEngine** | 5 | 3 | 3 | 5 | **16** | ğŸ”¥ P0 |
| **ElementManager** | 4 | 5 | 3 | 4 | **16** | ğŸ”¥ P0 |
| **RenderEngine** | 4 | 4 | 4 | 4 | **16** | ğŸ”¥ P0 |
| **ContentRenderer** | 3 | 5 | 2 | 3 | **13** | ğŸŸ¡ P1 |
| **SelectionSystem** | 2 | 5 | 2 | 3 | **12** | ğŸŸ¡ P1 |
| **InteractionSystem** | 2 | 5 | 3 | 3 | **13** | ğŸŸ¡ P1 |
| **LayerManager** | 3 | 3 | 2 | 4 | **12** | ğŸŸ¡ P1 |
| **GeometryEngine** | 3 | 2 | 2 | 3 | **10** | ğŸ”µ P2 |
| **SelectionRenderer** | 1 | 4 | 2 | 2 | **9** | ğŸ”µ P2 |
| **PluginManager** | 1 | 2 | 4 | 3 | **10** | ğŸ”µ P2 |
| **DataSourceManager** | 1 | 3 | 3 | 2 | **9** | ğŸŸ¢ P3 |
| **QueryEngine** | 1 | 3 | 4 | 2 | **10** | ğŸŸ¢ P3 |
| **DataBindingManager** | 1 | 4 | 4 | 2 | **11** | ğŸŸ¢ P3 |

## ğŸ¯ ä¼˜å…ˆçº§åˆ†ç±»è¯¦è§£

### ğŸ”¥ P0 - æ¶æ„åŸºç¡€å±‚ (å¿…é¡»ä¼˜å…ˆå®ç°)

#### **EventBus** - ç³»ç»Ÿç¥ç»ç½‘ç»œ
```typescript
// ä¸ºä»€ä¹ˆæ˜¯P0ï¼š
// 1. æ‰€æœ‰ç»„ä»¶é€šä¿¡çš„åŸºç¡€ (åŠŸèƒ½ä¾èµ–: 5åˆ†)
// 2. æ¶æ„ç¨³å®šæ€§çš„æ ¸å¿ƒ (æ¶æ„å½±å“: 5åˆ†)  
// 3. å®ç°ç›¸å¯¹ç®€å• (å¤æ‚åº¦: 2åˆ†)

interface EventBus {
  emit<T>(event: string, payload: T): void;
  on<T>(event: string, handler: (payload: T) => void): () => void;
  namespace(ns: string): EventBus; // å‘½åç©ºé—´æ”¯æŒ
}

// å®ç°å»ºè®®ï¼š
// - å…ˆå®ç°åŸºç¡€å‘å¸ƒ/è®¢é˜…
// - åæœŸæ·»åŠ å‘½åç©ºé—´å’Œè¿‡æ»¤å™¨
```

#### **StateEngine** - æ•°æ®æµåŸºç¡€  
```typescript
// ä¸ºä»€ä¹ˆæ˜¯P0ï¼š
// 1. ElementManagerç­‰æ ¸å¿ƒç»„ä»¶ä¾èµ– (åŠŸèƒ½ä¾èµ–: 5åˆ†)
// 2. å“åº”å¼æ›´æ–°çš„åŸºç¡€ (æ¶æ„å½±å“: 5åˆ†)
// 3. ç›´æ¥å½±å“æ•°æ®ä¸€è‡´æ€§ (ç”¨æˆ·ä»·å€¼: 3åˆ†)

interface StateEngine {
  get<T>(path: string): T;
  set<T>(path: string, value: T): void;
  subscribe(path: string, callback: (value: any) => void): () => void;
  batch(updates: () => void): void;
}

// å®ç°å»ºè®®ï¼š
// - åŸºäºSolid.jsçš„createStoreå®ç°
// - æ”¯æŒè·¯å¾„è®¿é—®å’Œæ‰¹é‡æ›´æ–°
```

#### **ElementManager** - ä¸šåŠ¡æ ¸å¿ƒ
```typescript
// ä¸ºä»€ä¹ˆæ˜¯P0ï¼š
// 1. ä¸šåŠ¡é€»è¾‘çš„æ ¸å¿ƒ (ç”¨æˆ·ä»·å€¼: 5åˆ†)
// 2. ContentRendererç­‰ä¾èµ– (åŠŸèƒ½ä¾èµ–: 4åˆ†) 
// 3. æ¶æ„ç¨³å®šæ€§å…³é”® (æ¶æ„å½±å“: 4åˆ†)

interface ElementManager {
  create(type: string, data: ElementData): Element;
  get(id: string): Element | null;
  update(id: string, updates: Partial<Element>): void;
  delete(id: string): void;
}

// å®ç°å»ºè®®ï¼š
// - å…ˆå®ç°åŸºç¡€CRUD
// - åæœŸæ·»åŠ æ‰¹é‡æ“ä½œå’Œäº‹åŠ¡æ”¯æŒ
```

#### **RenderEngine** - è§†è§‰åŸºç¡€
```typescript
// ä¸ºä»€ä¹ˆæ˜¯P0ï¼š
// 1. æ‰€æœ‰è§†è§‰è¾“å‡ºçš„åŸºç¡€ (åŠŸèƒ½ä¾èµ–: 4åˆ†)
// 2. ç”¨æˆ·èƒ½çœ‹åˆ°ç•Œé¢çš„å‰æ (ç”¨æˆ·ä»·å€¼: 4åˆ†)
// 3. æ¶æ„å½±å“æ˜¾è‘— (æ¶æ„å½±å“: 4åˆ†)

interface RenderEngine {
  createLayer(id: string, zIndex: number): RenderLayer;
  render(): void;
  scheduleRender(): void;
}

// å®ç°å»ºè®®ï¼š  
// - åŸºäºSVGå®ç°ï¼Œç®€å•å¯é 
// - åæœŸå¯æ‰©å±•Canvasæ”¯æŒ
```

### ğŸŸ¡ P1 - æ ¸å¿ƒåŠŸèƒ½å±‚ (ç¬¬äºŒä¼˜å…ˆçº§)

#### **ContentRenderer** - å†…å®¹æ¸²æŸ“æ ¸å¿ƒ
```typescript
// ä¸ºä»€ä¹ˆæ˜¯P1ï¼š
// 1. ç”¨æˆ·çœ‹åˆ°å…ƒç´ å†…å®¹çš„å…³é”® (ç”¨æˆ·ä»·å€¼: 5åˆ†)
// 2. ä¾èµ–P0ç»„ä»¶ï¼Œè‡ªèº«è¢«ä¾èµ–è¾ƒå°‘ (åŠŸèƒ½ä¾èµ–: 3åˆ†)
// 3. å®ç°ç›¸å¯¹ç®€å• (å¤æ‚åº¦: 2åˆ†)

class ContentRenderer {
  private factories = new Map<string, ElementFactory>();
  
  registerFactory(type: string, factory: ElementFactory): void;
  render(element: Element): void;
}

// å®ç°å»ºè®®ï¼š
// - å·¥å‚æ¨¡å¼æ”¯æŒå¤šç§å…ƒç´ ç±»å‹
// - å…ˆæ”¯æŒTextã€Rectangleç­‰åŸºç¡€ç±»å‹
```

#### **SelectionSystem** - ç”¨æˆ·äº¤äº’æ ¸å¿ƒ
```typescript
// ä¸ºä»€ä¹ˆæ˜¯P1ï¼š
// 1. ç›´æ¥å½±å“ç”¨æˆ·æ“ä½œä½“éªŒ (ç”¨æˆ·ä»·å€¼: 5åˆ†)
// 2. ç›¸å¯¹ç‹¬ç«‹ï¼Œä¾èµ–å…³ç³»ç®€å• (åŠŸèƒ½ä¾èµ–: 2åˆ†)
// 3. å®ç°ä¸å¤æ‚ (å¤æ‚åº¦: 2åˆ†)

interface SelectionSystem {
  select(elementIds: string[]): void;
  getSelected(): string[];
  
  // ä¸EventBusé›†æˆï¼Œé€šçŸ¥é€‰ä¸­å˜åŒ–
  // selection:changed äº‹ä»¶
}

// å®ç°å»ºè®®ï¼š
// - åŸºäºSetç®¡ç†é€‰ä¸­çŠ¶æ€
// - é€šè¿‡EventBusé€šçŸ¥å˜åŒ–
```

#### **InteractionSystem** - äº¤äº’åˆ†å‘æ ¸å¿ƒ
```typescript
// ä¸ºä»€ä¹ˆæ˜¯P1ï¼š
// 1. ç”¨æˆ·æ“ä½œçš„å…¥å£ (ç”¨æˆ·ä»·å€¼: 5åˆ†) 
// 2. éœ€è¦å¤„ç†å¤æ‚çš„äº‹ä»¶åˆ†å‘ (å¤æ‚åº¦: 3åˆ†)
// 3. æ¶æ„å½±å“ä¸­ç­‰ (æ¶æ„å½±å“: 3åˆ†)

interface InteractionSystem {
  register(handler: InteractionHandler): void;
  process(event: InteractionEvent): InteractionResult;
  activateTool(toolId: string): void;
}

// å®ç°å»ºè®®ï¼š
// - è´£ä»»é“¾æ¨¡å¼å¤„ç†äº‹ä»¶
// - å…ˆå®ç°æ‹–æ‹½ã€é€‰æ‹©ç­‰åŸºç¡€äº¤äº’
```

### ğŸ”µ P2 - å¢å¼ºåŠŸèƒ½å±‚ (ç¬¬ä¸‰ä¼˜å…ˆçº§)

#### **GeometryEngine** - å‡ ä½•è®¡ç®—æ”¯æ’‘
```typescript
// ä¸ºä»€ä¹ˆæ˜¯P2ï¼š
// 1. è¢«é€‰ä¸­ã€äº¤äº’ç³»ç»Ÿä¾èµ– (åŠŸèƒ½ä¾èµ–: 3åˆ†)
// 2. ç”¨æˆ·ä¸ç›´æ¥æ„ŸçŸ¥ (ç”¨æˆ·ä»·å€¼: 2åˆ†)
// 3. å®ç°ç®€å• (å¤æ‚åº¦: 2åˆ†)

interface GeometryEngine {
  calculateBounds(element: Element): BoundingBox;
  isPointInBounds(point: Point, bounds: BoundingBox): boolean;
}

// å®ç°å»ºè®®ï¼š
// - å·¥å…·å‡½æ•°é›†åˆï¼Œæ— çŠ¶æ€è®¾è®¡
// - å¯ä»¥é€æ­¥æ·»åŠ å¤æ‚å‡ ä½•è®¡ç®—
```

#### **SelectionRenderer** - é€‰ä¸­è§†è§‰
```typescript
// ä¸ºä»€ä¹ˆæ˜¯P2ï¼š
// 1. æå‡ç”¨æˆ·ä½“éªŒ (ç”¨æˆ·ä»·å€¼: 4åˆ†)
// 2. ç›¸å¯¹ç‹¬ç«‹ (åŠŸèƒ½ä¾èµ–: 1åˆ†)
// 3. å®ç°ç®€å• (å¤æ‚åº¦: 2åˆ†)

class SelectionRenderer {
  showSelection(element: Element, state: SelectionState): void;
  hideSelection(elementId: string): void;
}

// å®ç°å»ºè®®ï¼š
// - ç›‘å¬selection:changedäº‹ä»¶
// - æ¸²æŸ“åˆ°ç‹¬ç«‹çš„selectionå±‚
```

#### **PluginManager** - æ‰©å±•æ”¯æ’‘
```typescript
// ä¸ºä»€ä¹ˆæ˜¯P2ï¼š
// 1. æ‰©å±•æ€§é‡è¦ä½†éå¿…éœ€ (ç”¨æˆ·ä»·å€¼: 2åˆ†)
// 2. å®ç°ç›¸å¯¹å¤æ‚ (å¤æ‚åº¦: 4åˆ†)  
// 3. æ¶æ„å½±å“ä¸­ç­‰ (æ¶æ„å½±å“: 3åˆ†)

interface PluginManager {
  register(plugin: Plugin): Promise<void>;
  registerElementType(type: string, factory: ElementFactory): void;
}

// å®ç°å»ºè®®ï¼š
// - ç®€åŒ–ç‰ˆæ’ä»¶ç³»ç»Ÿ
// - é‡ç‚¹æ”¯æŒå…ƒç´ ç±»å‹æ‰©å±•
```

### ğŸŸ¢ P3 - ä¼ä¸šåŠŸèƒ½å±‚ (å¯é€‰å®ç°)

#### **æ•°æ®å±‚ç»„ä»¶ç¾¤**
```typescript
// ä¸ºä»€ä¹ˆæ˜¯P3ï¼š
// 1. ä¼ä¸šçº§åŠŸèƒ½ï¼ŒéåŸºç¡€éœ€æ±‚ (åŠŸèƒ½ä¾èµ–: 1åˆ†)
// 2. å¯¹æœ‰æ•°æ®ç»‘å®šéœ€æ±‚çš„ç”¨æˆ·ä»·å€¼é«˜ (ç”¨æˆ·ä»·å€¼: 3-4åˆ†)
// 3. å®ç°å¤æ‚åº¦è¾ƒé«˜ (å¤æ‚åº¦: 3-4åˆ†)

// DataSourceManager, QueryEngine, DataBindingManager
// å»ºè®®ï¼šä½œä¸ºä¸€ä¸ªåŠŸèƒ½åŒ…æ•´ä½“å®ç°
```

## ğŸ›£ï¸ å®æ–½è·¯çº¿å›¾

### Phase 1: MVPåŸºç¡€ (2-3å‘¨)
```typescript
// P0ç»„ä»¶å®ç°
âœ… EventBus - åŸºç¡€å‘å¸ƒ/è®¢é˜…
âœ… StateEngine - åŸºäºSolid.js stores  
âœ… ElementManager - åŸºç¡€CRUD
âœ… RenderEngine - SVGæ¸²æŸ“åŸºç¡€

// ç›®æ ‡ï¼šèƒ½åˆ›å»ºã€æ¸²æŸ“ã€åŸºç¡€æ“ä½œå…ƒç´ 
```

### Phase 2: äº¤äº’å®Œå–„ (2-3å‘¨)  
```typescript
// P1ç»„ä»¶å®ç°
âœ… ContentRenderer - æ”¯æŒTextã€Rectangle
âœ… SelectionSystem - å•é€‰ã€å¤šé€‰æ”¯æŒ
âœ… InteractionSystem - æ‹–æ‹½ã€ç‚¹å‡»ã€æ¡†é€‰
âœ… LayerManager - åˆ†å±‚æ¸²æŸ“

// ç›®æ ‡ï¼šå®Œæ•´çš„ç”¨æˆ·äº¤äº’ä½“éªŒ
```

### Phase 3: ä½“éªŒå¢å¼º (2-3å‘¨)
```typescript
// P2ç»„ä»¶å®ç°  
âœ… GeometryEngine - è¾¹ç•Œè®¡ç®—ã€ç¢°æ’æ£€æµ‹
âœ… SelectionRenderer - é€‰ä¸­è§†è§‰æ•ˆæœ
âœ… PluginManager - åŸºç¡€æ’ä»¶æ”¯æŒ

// ç›®æ ‡ï¼šä¸“ä¸šè®¾è®¡è½¯ä»¶ä½“éªŒ
```

### Phase 4: ä¼ä¸šåŠŸèƒ½ (æŒ‰éœ€)
```typescript
// P3ç»„ä»¶å®ç°
â­• DataSourceManager - æ•°æ®æºç®¡ç†
â­• QueryEngine - æ•°æ®æŸ¥è¯¢
â­• DataBindingManager - æ•°æ®ç»‘å®š

// ç›®æ ‡ï¼šä¼ä¸šçº§æŠ¥è¡¨è®¾è®¡èƒ½åŠ›
```

## ğŸ¯ å…³é”®å®ç°å»ºè®®

### 1. **P0ç»„ä»¶å®ç°è¦ç‚¹**
- EventBusï¼šä½¿ç”¨Mapç®¡ç†ç›‘å¬å™¨ï¼Œæ”¯æŒé€šé…ç¬¦
- StateEngineï¼šåŒ…è£…Solid.jsçš„createStoreï¼Œæ·»åŠ è·¯å¾„è®¿é—®
- ElementManagerï¼šå†…å­˜å­˜å‚¨ + äº‹ä»¶é€šçŸ¥ï¼ŒåæœŸå¯æ·»åŠ æŒä¹…åŒ–
- RenderEngineï¼šSVG-basedï¼Œæ¸…æ™°çš„å±‚çº§ç®¡ç†

### 2. **ä¾èµ–æ³¨å…¥ç­–ç•¥**
```typescript
// æ¨èä¾èµ–æ³¨å…¥æ¨¡å¼ï¼Œé¿å…å¾ªç¯ä¾èµ–
class JasperDesigner {
  constructor(config: DesignerConfig) {
    // æŒ‰ä¾èµ–é¡ºåºåˆå§‹åŒ–
    const eventBus = new EventBusImpl();
    const stateEngine = new StateEngineImpl();  
    const elementManager = new ElementManagerImpl(stateEngine, eventBus);
    // ...
  }
}
```

### 3. **æ€§èƒ½è€ƒè™‘**
- EventBusï¼šé¿å…é¢‘ç¹äº‹ä»¶ï¼Œæ”¯æŒæ‰¹é‡é€šçŸ¥
- StateEngineï¼šæ‰¹é‡æ›´æ–°é¿å…é¢‘ç¹æ¸²æŸ“
- RenderEngineï¼šè„æ£€æŸ¥ + è¯·æ±‚åŠ¨ç”»å¸§ä¼˜åŒ–

## ğŸ’¡ æ€»ç»“

**æ ¸å¿ƒæ´å¯Ÿ**ï¼š
1. **åŸºç¡€è®¾æ–½å±‚æ˜¯æ ¹åŸº** - EventBuså’ŒStateEngineå½±å“æ•´ä¸ªæ¶æ„
2. **ä¸šåŠ¡é€»è¾‘æ˜¯æ ¸å¿ƒ** - ElementManagerç›´æ¥å…³ç³»ç”¨æˆ·ä»·å€¼  
3. **æ¸è¿›å®ç°æ˜¯å…³é”®** - P0â†’P1â†’P2â†’P3çš„é¡ºåºç¡®ä¿æ¯ä¸ªé˜¶æ®µéƒ½æœ‰å¯ç”¨äº§å“
4. **ä¾èµ–ç®¡ç†æ˜¯éš¾ç‚¹** - éœ€è¦ä»”ç»†è®¾è®¡åˆå§‹åŒ–é¡ºåºå’Œæ¥å£

**å®æ–½å»ºè®®**ï¼šä¸¥æ ¼æŒ‰ç…§P0â†’P1â†’P2â†’P3çš„ä¼˜å…ˆçº§å®æ–½ï¼Œæ¯ä¸ªPhaseç»“æŸéƒ½åº”è¯¥æœ‰ä¸€ä¸ªå¯ç”¨çš„äº§å“ç‰ˆæœ¬ã€‚