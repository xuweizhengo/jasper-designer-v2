# 数据源管理中心 - UI/UX设计文档

**版本**: v1.0  
**创建日期**: 2025-08-24  
**状态**: 设计完成，待实施  

## 1. 设计概述

### 1.1 设计目标
- 提供统一的数据源管理界面，从主数据源按钮进入
- 为不同类型的数据源提供专门的测试、预览、编辑功能  
- 建立可扩展的信息架构，支持未来的权限管理和协作功能
- 保持与Jasper Designer V2.0整体设计语言的一致性

### 1.2 核心设计原则
- **功能独立性**: 每种数据源类型有专门优化的操作界面
- **上下文相关**: 根据数据源特性提供针对性的工具和反馈
- **渐进式披露**: 从概览到详情的层次化信息展示
- **统一体验**: 保持一致的交互模式和视觉语言

## 2. 整体架构设计

### 2.1 入口与导航
```
主工具栏 [数据源按钮] → 数据源管理中心 → 类型专用页面
```

**导航流程：**
1. 用户点击主界面的数据源按钮
2. 进入数据源管理中心主界面
3. 通过卡片操作进入对应的专用页面

### 2.2 信息架构层级
```
数据源管理中心
├── 浏览与发现层
│   ├── 分类导航 (类型/状态/标签)
│   ├── 搜索与筛选
│   └── 批量操作工具
├── 概览与预览层  
│   ├── 卡片网格视图
│   ├── 快速预览面板
│   └── 状态仪表板
└── 深度操作层
    ├── JSON专用页面 (结构分析)
    ├── API专用页面 (端点测试) 
    ├── CSV专用页面 (格式处理)
    └── 数据库专用页面 (查询管理)
```

## 3. 主界面设计

### 3.1 布局结构
```
┌────────────────────────────────────────────────────────────────┐
│ [← 返回设计器] [数据源管理中心] [快速搜索框] [筛选] [+ 新建数据源]   │
├────────────────────────────────────────────────────────────────┤
│ 左侧边栏 (240px)          │  右侧主视图 (flexible width)        │
│ ─────────────────────     │  ────────────────────────────      │
│ 📁 分类导航                │  数据源卡片网格/列表视图             │
│   • 全部数据源             │                                   │
│   • 按类型分类             │  ┌─────────────────────────────┐   │
│     - JSON文件            │  │ [类型图标] 数据源名称          │   │
│     - CSV表格             │  │ 📊 销售数据API               │   │
│     - API接口             │  │ ─────────────────────────── │   │
│     - 数据库连接           │  │ 状态: ● 已连接  最后更新: 2小时前 │   │
│   • 按状态分类             │  │ 记录: 1,245条  大小: 2.3MB    │   │
│     - 活跃使用中           │  │ 标签: #销售 #月报             │   │
│     - 未连接/错误          │  │ ─────────────────────────── │   │
│     - 测试阶段            │  │ [预览] [测试] [编辑] [••• 更多] │   │
│   • 标签分组              │  └─────────────────────────────┘   │
│   • 收藏夹               │                                   │
│                          │  详情预览面板 (可折叠)              │
└──────────────────────────┴─────────────────────────────────────┘
```

### 3.2 顶部导航区设计
- **返回按钮**: 返回主设计器界面
- **标题**: 数据源管理中心，显示当前页面层级
- **搜索框**: 支持按名称、类型、标签快速搜索
- **筛选器**: 多条件筛选功能
- **新建按钮**: 快速创建新数据源的入口

### 3.3 数据源卡片设计 (280x200px)
```
┌─────────────────────────────────┐
│ [类型图标] 数据源名称              │
│ 📊 销售数据API                   │
│ ─────────────────────────────── │
│ 状态: ● 已连接  最后更新: 2小时前   │
│ 记录: 1,245条  大小: 2.3MB       │
│ 标签: #销售 #月报                │
│ ─────────────────────────────── │
│ [预览] [测试] [编辑] [••• 更多]    │
└─────────────────────────────────┘
```

**卡片元素说明:**
- **类型图标**: 视觉化区分不同数据源类型
- **状态指示器**: 实时连接状态，颜色编码 (绿色=正常，红色=异常，黄色=警告)
- **元数据**: 数据量、大小、更新时间等关键信息
- **标签**: 业务分类和技术标签
- **操作按钮**: 预览、测试、编辑功能独立分离

## 4. 数据源组织架构

### 4.1 按类型分类 (Type-Based)
```
📄 文件数据源
   ├── JSON文件 (*.json)
   ├── CSV表格 (*.csv)  
   ├── Excel文档 (*.xlsx, *.xls)
   └── XML数据 (*.xml)

🌐 网络数据源  
   ├── REST API
   ├── GraphQL API
   ├── WebSocket连接
   └── 网页数据抓取

🗄️ 数据库连接
   ├── 关系型数据库 (MySQL, PostgreSQL)
   ├── NoSQL数据库 (MongoDB, Redis)
   ├── 时序数据库 (InfluxDB)
   └── 云数据库服务
```

### 4.2 按状态管理 (Status-Based)
```
🟢 活跃使用 (Active)
   - 正在被设计元素引用
   - 数据正常更新，连接稳定
   
🟡 空闲状态 (Idle)  
   - 已配置完成但当前未被使用
   - 可以随时激活和引用
   
🔴 连接异常 (Error)
   - 连接失败或数据访问异常
   - 需要修复配置或检查权限

🔵 测试阶段 (Testing)
   - 新创建或配置修改中
   - 需要验证和测试配置
```

### 4.3 智能标签系统
```
业务标签: #销售 #运营 #财务 #产品 #用户 #营销
技术标签: #实时 #批处理 #高频更新 #大数据 #敏感数据
来源标签: #内部系统 #第三方API #文件导入 #数据库直连
优先级标签: #核心业务 #重要数据 #一般用途 #测试环境 #已废弃
```

## 5. 专用页面设计

### 5.1 JSON数据源专用页面
```
┌────────────────────────────────────────────────────────────────┐
│ 数据源管理 > JSON数据源 > 销售数据.json                           │
├────────────────────────────────────────────────────────────────┤
│ 左栏 (基本信息)          │  右栏 (功能区域)                      │
│ ─────────────────       │  ─────────────────────               │
│ 📄 文件信息              │  ┌─ 预览模式 ─────────────────────┐   │
│   • 文件路径/URL         │  │ [表格预览] [树形预览] [原始JSON] │   │
│   • 文件大小: 2.3MB      │  │                               │   │
│   • 编码: UTF-8          │  │ {                             │   │
│   • 最后修改: 2小时前     │  │   "sales": [                   │   │
│                         │  │     {"id": 1, "amount": 1500}, │   │
│ 🔗 连接配置              │  │     {"id": 2, "amount": 2300}  │   │
│   • 自动刷新: 每小时      │  │   ]                           │   │
│   • 错误重试: 3次        │  │ }                             │   │
│   • 缓存策略: 本地缓存    │  │                               │   │
│                         │  └───────────────────────────────┘   │
│ 📊 数据结构分析          │                                     │
│   • 字段数量: 12个       │  ┌─ 测试工具 ─────────────────────┐   │
│   • 记录总数: 1,245条    │  │ [数据验证] [字段映射] [格式检查] │   │
│   • 数据类型: 混合       │  │                               │   │
│   • 嵌套层级: 3层        │  │ ✅ JSON格式验证通过            │   │
│                         │  │ ✅ 字段结构完整                 │   │
│                         │  │ ⚠️  发现3个空值字段             │   │
│                         │  │ 📊 数据质量评分: 85/100         │   │
│                         │  └───────────────────────────────┘   │
└────────────────────────┴─────────────────────────────────────────┘
```

### 5.2 API数据源专用页面
```
┌────────────────────────────────────────────────────────────────┐
│ 数据源管理 > API数据源 > 销售数据API                              │
├────────────────────────────────────────────────────────────────┤
│ 左栏 (连接配置)          │  右栏 (测试与预览)                    │
│ ─────────────────       │  ─────────────────────               │
│ 🌐 基础配置              │  ┌─ API测试器 ──────────────────────┐ │
│   • 端点URL              │  │ GET /api/sales/data              │ │
│   • 请求方法: GET        │  │ [发送请求] [保存请求] [历史记录]   │ │
│   • 内容类型: JSON       │  │                                 │ │
│                         │  │ 响应状态: 200 OK                 │ │
│ 🔐 认证配置              │  │ 响应时间: 245ms                  │ │
│   • 认证类型: API Key    │  │ 数据大小: 12.5KB                │ │
│   • Header配置           │  │                                 │ │
│   • Token管理            │  └─────────────────────────────────┘ │
│                         │                                     │
│ ⚙️ 高级设置              │  ┌─ 响应数据预览 ────────────────────┐ │
│   • 请求超时: 30秒       │  │ [结构化视图] [原始响应] [字段分析] │ │
│   • 重试策略: 指数退避    │  │                                 │ │
│   • 响应缓存: 5分钟      │  │ {                               │ │
│   • 错误处理: 自动重试    │  │   "data": [                     │ │
│                         │  │     {                           │ │
│ 📈 监控状态              │  │       "id": 1,                  │ │
│   • 成功率: 98.5%        │  │       "amount": 1500,           │ │
│   • 平均响应: 230ms      │  │       "date": "2025-08-24"      │ │
│   • 最后调用: 5分钟前     │  │     }                           │ │
│                         │  │   ],                            │ │
│                         │  │   "total": 1245                 │ │
│                         │  │ }                               │ │
│                         │  └─────────────────────────────────┘ │
└────────────────────────┴─────────────────────────────────────────┘
```

### 5.3 数据库连接专用页面
```
┌────────────────────────────────────────────────────────────────┐
│ 数据源管理 > 数据库连接 > MySQL-销售数据库                        │
├────────────────────────────────────────────────────────────────┤
│ 左栏 (连接信息)          │  右栏 (查询与预览)                    │
│ ─────────────────       │  ─────────────────────               │
│ 🗄️ 数据库配置            │  ┌─ SQL编辑器 ──────────────────────┐ │
│   • 类型: MySQL 8.0      │  │ SELECT * FROM sales_data         │ │
│   • 服务器: 192.168.1.10 │  │ WHERE date >= '2025-08-01'       │ │
│   • 端口: 3306           │  │ ORDER BY amount DESC             │ │
│   • 数据库: sales_db     │  │ LIMIT 100;                       │ │
│                         │  │                                 │ │
│ 🔐 认证信息              │  │ [执行查询] [格式化] [保存查询]      │ │
│   • 用户名: ****         │  │ [查询历史] [执行计划] [导出结果]    │ │
│   • 密码: ****           │  └─────────────────────────────────┘ │
│   • SSL: 启用            │                                     │
│                         │  ┌─ 查询结果 ────────────────────────┐ │
│ ⚙️ 连接池配置            │  │ 查询成功 | 执行时间: 125ms          │ │
│   • 最大连接: 20         │  │ 返回记录: 89 条                   │ │
│   • 最小连接: 5          │  │                                 │ │
│   • 连接超时: 30秒       │  │ id │ amount │ date       │ ...     │ │
│   • 空闲检测: 启用       │  │ ─────────────────────────────── │ │
│                         │  │ 1  │ 2500   │ 2025-08-24 │ ...     │ │
│ 📊 性能监控              │  │ 2  │ 2300   │ 2025-08-24 │ ...     │ │
│   • 活跃连接: 3/20       │  │ 3  │ 2100   │ 2025-08-23 │ ...     │ │
│   • 平均查询: 180ms      │  │ ...                             │ │
│   • 错误率: 0.2%         │  │                                 │ │
│                         │  │ [导出CSV] [导出JSON] [复制数据]    │ │
│                         │  └─────────────────────────────────┘ │
└────────────────────────┴─────────────────────────────────────────┘
```

## 6. 功能工作流程设计

### 6.1 预览工作流程 (主界面完成)
```
[点击预览] → [右侧面板展开] → [数据加载] → [格式化显示]
     ↓              ↓            ↓           ↓
  卡片操作      滑出式面板      异步获取      类型特定渲染
```

**预览面板功能:**
- 数据结构树形展示
- 前50条记录表格预览
- 字段类型自动分析
- 数据质量基础报告
- 快速统计信息展示

### 6.2 测试工作流程 (跳转专用页面)
```
[点击测试] → [跳转专用页面] → [连接测试] → [功能验证] → [结果报告]
     ↓              ↓             ↓           ↓           ↓
  卡片操作      类型专用界面      实时检测      自动验证      详细反馈
```

**测试页面功能:**
- **连接状态检测**: 验证网络连接和认证
- **数据访问验证**: 确认数据读取权限  
- **性能基准测试**: 响应时间和吞吐量测试
- **错误模拟测试**: 异常情况处理验证
- **数据完整性检查**: 字段完整性和数据类型验证

### 6.3 编辑工作流程 (跳转专用页面)
```
[点击编辑] → [跳转专用页面] → [配置修改] → [实时验证] → [保存确认]
     ↓              ↓             ↓           ↓           ↓
  卡片操作      类型专用界面      参数调整      即时反馈      变更记录
```

**编辑页面功能:**
- **配置参数修改**: 连接信息、认证设置、查询配置
- **实时验证反馈**: 配置变更即时验证和错误提示
- **变更历史记录**: 记录所有配置变更的历史版本
- **回滚操作支持**: 快速恢复到之前的稳定配置
- **测试连接功能**: 保存前验证新配置的有效性

## 7. 响应式设计

### 7.1 设备适配策略
- **桌面端 (>1024px)**: 完整的侧边栏 + 主视图布局
- **平板端 (768-1024px)**: 可折叠侧边栏 + 自适应卡片网格
- **移动端 (<768px)**: 底部标签导航 + 单列卡片列表

### 7.2 关键断点设计
```css
/* 桌面端 */
@media (min-width: 1024px) {
  .data-source-management {
    grid-template-columns: 240px 1fr;
  }
  .source-cards {
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  }
}

/* 平板端 */
@media (max-width: 1023px) and (min-width: 768px) {
  .sidebar {
    transform: translateX(-100%);
    transition: transform 0.3s;
  }
  .sidebar.open {
    transform: translateX(0);
  }
}

/* 移动端 */
@media (max-width: 767px) {
  .source-cards {
    grid-template-columns: 1fr;
  }
  .navigation {
    position: fixed;
    bottom: 0;
  }
}
```

## 8. 技术实现规范

### 8.1 组件结构规划
```
src/components/DataSourceManagement/
├── DataSourceManagementCenter.tsx    # 主管理中心组件
├── DataSourceCard.tsx                # 数据源卡片组件
├── DataSourcePreview.tsx             # 预览面板组件
├── Sidebar/
│   ├── CategoryNavigation.tsx        # 分类导航组件
│   ├── StatusFilter.tsx              # 状态筛选组件
│   └── TagFilter.tsx                 # 标签筛选组件
├── SpecializedPages/
│   ├── JsonDataSourcePage.tsx        # JSON数据源专用页面
│   ├── ApiDataSourcePage.tsx         # API数据源专用页面
│   ├── DatabaseDataSourcePage.tsx    # 数据库连接专用页面
│   └── CsvDataSourcePage.tsx         # CSV数据源专用页面
└── Common/
    ├── SearchBar.tsx                 # 搜索框组件
    ├── StatusIndicator.tsx           # 状态指示器组件
    └── ActionButtons.tsx             # 操作按钮组件
```

### 8.2 状态管理设计
```typescript
// 数据源管理状态接口
interface DataSourceManagementState {
  // 数据源列表
  dataSources: DataSource[];
  
  // 当前筛选条件
  filters: {
    type: DataSourceType | null;
    status: DataSourceStatus | null;
    tags: string[];
    searchQuery: string;
  };
  
  // 当前选中的数据源
  selectedDataSource: DataSource | null;
  
  // 预览面板状态
  previewPanel: {
    isOpen: boolean;
    dataSource: DataSource | null;
    previewData: any;
    loading: boolean;
  };
  
  // 加载状态
  loading: boolean;
  error: string | null;
}
```

### 8.3 路由设计
```typescript
// 路由配置
const routes = [
  {
    path: '/data-sources',
    component: DataSourceManagementCenter,
    children: [
      {
        path: '',
        component: DataSourceGrid
      },
      {
        path: '/json/:id',
        component: JsonDataSourcePage
      },
      {
        path: '/api/:id',
        component: ApiDataSourcePage
      },
      {
        path: '/database/:id',
        component: DatabaseDataSourcePage
      },
      {
        path: '/csv/:id',
        component: CsvDataSourcePage
      }
    ]
  }
];
```

## 9. 实施计划

### 9.1 开发优先级
**P0 - 核心功能 (立即实施)**
- [ ] 修复现有JSON数据源的测试、预览、编辑功能
- [ ] 实现基础的管理中心主界面
- [ ] 完成数据源卡片组件和基础交互

**P1 - 基础扩展 (近期实施)**
- [ ] 实现JSON数据源专用页面
- [ ] 添加基础的分类导航和筛选功能
- [ ] 完善预览面板的数据展示

**P2 - 功能完善 (中期实施)**
- [ ] 扩展API和CSV数据源的专用页面
- [ ] 实现高级筛选和搜索功能
- [ ] 添加标签管理和项目分组

**P3 - 高级特性 (长期规划)**
- [ ] 集成权限管理系统
- [ ] 实现团队协作功能
- [ ] 添加数据源性能监控和分析

### 9.2 质量保证
- **单元测试**: 每个组件需要95%以上的测试覆盖率
- **集成测试**: 完整的用户操作流程测试
- **性能测试**: 大量数据源情况下的响应性能
- **可访问性测试**: 确保符合WCAG 2.1标准
- **跨浏览器测试**: 支持主流桌面浏览器

## 10. 设计变更记录

### v1.0 (2025-08-24)
- 初始版本完成
- 确定整体架构和UI布局
- 完成三种主要数据源类型的专用页面设计
- 建立响应式适配策略

---

**文档维护者**: Claude Code  
**审核状态**: 待产品团队审核  
**下次更新**: 根据开发进度和用户反馈更新